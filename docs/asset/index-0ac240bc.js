(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Xs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Uw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Vw(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var m2={exports:{}},Tf={},p2={exports:{}},Jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var od=Symbol.for("react.element"),Hw=Symbol.for("react.portal"),Gw=Symbol.for("react.fragment"),Ww=Symbol.for("react.strict_mode"),Zw=Symbol.for("react.profiler"),Jw=Symbol.for("react.provider"),Kw=Symbol.for("react.context"),Yw=Symbol.for("react.forward_ref"),Qw=Symbol.for("react.suspense"),Xw=Symbol.for("react.memo"),eN=Symbol.for("react.lazy"),B1=Symbol.iterator;function tN(t){return t===null||typeof t!="object"?null:(t=B1&&t[B1]||t["@@iterator"],typeof t=="function"?t:null)}var g2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v2=Object.assign,x2={};function xc(t,e,n){this.props=t,this.context=e,this.refs=x2,this.updater=n||g2}xc.prototype.isReactComponent={};xc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};xc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function y2(){}y2.prototype=xc.prototype;function Qg(t,e,n){this.props=t,this.context=e,this.refs=x2,this.updater=n||g2}var Xg=Qg.prototype=new y2;Xg.constructor=Qg;v2(Xg,xc.prototype);Xg.isPureReactComponent=!0;var q1=Array.isArray,b2=Object.prototype.hasOwnProperty,e0={current:null},w2={key:!0,ref:!0,__self:!0,__source:!0};function N2(t,e,n){var r,i={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)b2.call(e,r)&&!w2.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:od,type:t,key:a,ref:o,props:i,_owner:e0.current}}function nN(t,e){return{$$typeof:od,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function t0(t){return typeof t=="object"&&t!==null&&t.$$typeof===od}function rN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var U1=/\/+/g;function Rm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?rN(""+t.key):e.toString(36)}function zh(t,e,n,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case od:case Hw:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Rm(o,0):r,q1(i)?(n="",t!=null&&(n=t.replace(U1,"$&/")+"/"),zh(i,e,n,"",function(d){return d})):i!=null&&(t0(i)&&(i=nN(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(U1,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",q1(t))for(var l=0;l<t.length;l++){a=t[l];var c=r+Rm(a,l);o+=zh(a,e,n,c,i)}else if(c=tN(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=r+Rm(a,l++),o+=zh(a,e,n,c,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function eh(t,e,n){if(t==null)return t;var r=[],i=0;return zh(t,r,"","",function(a){return e.call(n,a,i++)}),r}function sN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var is={current:null},Oh={transition:null},iN={ReactCurrentDispatcher:is,ReactCurrentBatchConfig:Oh,ReactCurrentOwner:e0};function j2(){throw Error("act(...) is not supported in production builds of React.")}Jt.Children={map:eh,forEach:function(t,e,n){eh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return eh(t,function(){e++}),e},toArray:function(t){return eh(t,function(e){return e})||[]},only:function(t){if(!t0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Jt.Component=xc;Jt.Fragment=Gw;Jt.Profiler=Zw;Jt.PureComponent=Qg;Jt.StrictMode=Ww;Jt.Suspense=Qw;Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iN;Jt.act=j2;Jt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=v2({},t.props),i=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=e0.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)b2.call(e,c)&&!w2.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:od,type:t.type,key:i,ref:a,props:r,_owner:o}};Jt.createContext=function(t){return t={$$typeof:Kw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Jw,_context:t},t.Consumer=t};Jt.createElement=N2;Jt.createFactory=function(t){var e=N2.bind(null,t);return e.type=t,e};Jt.createRef=function(){return{current:null}};Jt.forwardRef=function(t){return{$$typeof:Yw,render:t}};Jt.isValidElement=t0;Jt.lazy=function(t){return{$$typeof:eN,_payload:{_status:-1,_result:t},_init:sN}};Jt.memo=function(t,e){return{$$typeof:Xw,type:t,compare:e===void 0?null:e}};Jt.startTransition=function(t){var e=Oh.transition;Oh.transition={};try{t()}finally{Oh.transition=e}};Jt.unstable_act=j2;Jt.useCallback=function(t,e){return is.current.useCallback(t,e)};Jt.useContext=function(t){return is.current.useContext(t)};Jt.useDebugValue=function(){};Jt.useDeferredValue=function(t){return is.current.useDeferredValue(t)};Jt.useEffect=function(t,e){return is.current.useEffect(t,e)};Jt.useId=function(){return is.current.useId()};Jt.useImperativeHandle=function(t,e,n){return is.current.useImperativeHandle(t,e,n)};Jt.useInsertionEffect=function(t,e){return is.current.useInsertionEffect(t,e)};Jt.useLayoutEffect=function(t,e){return is.current.useLayoutEffect(t,e)};Jt.useMemo=function(t,e){return is.current.useMemo(t,e)};Jt.useReducer=function(t,e,n){return is.current.useReducer(t,e,n)};Jt.useRef=function(t){return is.current.useRef(t)};Jt.useState=function(t){return is.current.useState(t)};Jt.useSyncExternalStore=function(t,e,n){return is.current.useSyncExternalStore(t,e,n)};Jt.useTransition=function(){return is.current.useTransition()};Jt.version="18.3.1";p2.exports=Jt;var q=p2.exports;const Zs=Uw(q);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aN=q,oN=Symbol.for("react.element"),lN=Symbol.for("react.fragment"),cN=Object.prototype.hasOwnProperty,uN=aN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dN={key:!0,ref:!0,__self:!0,__source:!0};function S2(t,e,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)cN.call(e,r)&&!dN.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:oN,type:t,key:a,ref:o,props:i,_owner:uN.current}}Tf.Fragment=lN;Tf.jsx=S2;Tf.jsxs=S2;m2.exports=Tf;var s=m2.exports,Ip={},_2={exports:{}},Os={},k2={exports:{}},C2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(P,Q){var G=P.length;P.push(Q);e:for(;0<G;){var de=G-1>>>1,w=P[de];if(0<i(w,Q))P[de]=Q,P[G]=w,G=de;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var Q=P[0],G=P.pop();if(G!==Q){P[0]=G;e:for(var de=0,w=P.length,O=w>>>1;de<O;){var R=2*(de+1)-1,H=P[R],re=R+1,oe=P[re];if(0>i(H,G))re<w&&0>i(oe,H)?(P[de]=oe,P[re]=G,de=re):(P[de]=H,P[R]=G,de=R);else if(re<w&&0>i(oe,G))P[de]=oe,P[re]=G,de=re;else break e}}return Q}function i(P,Q){var G=P.sortIndex-Q.sortIndex;return G!==0?G:P.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,p=null,v=3,m=!1,N=!1,_=!1,k=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(P){for(var Q=n(d);Q!==null;){if(Q.callback===null)r(d);else if(Q.startTime<=P)r(d),Q.sortIndex=Q.expirationTime,e(c,Q);else break;Q=n(d)}}function C(P){if(_=!1,j(P),!N)if(n(c)!==null)N=!0,W(B);else{var Q=n(d);Q!==null&&ue(C,Q.startTime-P)}}function B(P,Q){N=!1,_&&(_=!1,y(z),z=-1),m=!0;var G=v;try{for(j(Q),p=n(c);p!==null&&(!(p.expirationTime>Q)||P&&!I());){var de=p.callback;if(typeof de=="function"){p.callback=null,v=p.priorityLevel;var w=de(p.expirationTime<=Q);Q=t.unstable_now(),typeof w=="function"?p.callback=w:p===n(c)&&r(c),j(Q)}else r(c);p=n(c)}if(p!==null)var O=!0;else{var R=n(d);R!==null&&ue(C,R.startTime-Q),O=!1}return O}finally{p=null,v=G,m=!1}}var K=!1,Z=null,z=-1,J=5,te=-1;function I(){return!(t.unstable_now()-te<J)}function A(){if(Z!==null){var P=t.unstable_now();te=P;var Q=!0;try{Q=Z(!0,P)}finally{Q?T():(K=!1,Z=null)}}else K=!1}var T;if(typeof b=="function")T=function(){b(A)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,ne=F.port2;F.port1.onmessage=A,T=function(){ne.postMessage(null)}}else T=function(){k(A,0)};function W(P){Z=P,K||(K=!0,T())}function ue(P,Q){z=k(function(){P(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_continueExecution=function(){N||m||(N=!0,W(B))},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(P){switch(v){case 1:case 2:case 3:var Q=3;break;default:Q=v}var G=v;v=Q;try{return P()}finally{v=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(P,Q){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var G=v;v=P;try{return Q()}finally{v=G}},t.unstable_scheduleCallback=function(P,Q,G){var de=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?de+G:de):G=de,P){case 1:var w=-1;break;case 2:w=250;break;case 5:w=1073741823;break;case 4:w=1e4;break;default:w=5e3}return w=G+w,P={id:f++,callback:Q,priorityLevel:P,startTime:G,expirationTime:w,sortIndex:-1},G>de?(P.sortIndex=G,e(d,P),n(c)===null&&P===n(d)&&(_?(y(z),z=-1):_=!0,ue(C,G-de))):(P.sortIndex=w,e(c,P),N||m||(N=!0,W(B))),P},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(P){var Q=v;return function(){var G=v;v=Q;try{return P.apply(this,arguments)}finally{v=G}}}})(C2);k2.exports=C2;var hN=k2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fN=q,zs=hN;function nt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var A2=new Set,Ou={};function Yo(t,e){uc(t,e),uc(t+"Capture",e)}function uc(t,e){for(Ou[t]=e,t=0;t<e.length;t++)A2.add(e[t])}var ua=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ep=Object.prototype.hasOwnProperty,mN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,V1={},H1={};function pN(t){return Ep.call(H1,t)?!0:Ep.call(V1,t)?!1:mN.test(t)?H1[t]=!0:(V1[t]=!0,!1)}function gN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function vN(t,e,n,r){if(e===null||typeof e>"u"||gN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function as(t,e,n,r,i,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var Tr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tr[t]=new as(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tr[e]=new as(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tr[t]=new as(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tr[t]=new as(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tr[t]=new as(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tr[t]=new as(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tr[t]=new as(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tr[t]=new as(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tr[t]=new as(t,5,!1,t.toLowerCase(),null,!1,!1)});var n0=/[\-:]([a-z])/g;function r0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(n0,r0);Tr[e]=new as(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(n0,r0);Tr[e]=new as(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(n0,r0);Tr[e]=new as(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tr[t]=new as(t,1,!1,t.toLowerCase(),null,!1,!1)});Tr.xlinkHref=new as("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tr[t]=new as(t,1,!1,t.toLowerCase(),null,!0,!0)});function s0(t,e,n,r){var i=Tr.hasOwnProperty(e)?Tr[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vN(e,n,i,r)&&(n=null),r||i===null?pN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ma=fN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,th=Symbol.for("react.element"),Rl=Symbol.for("react.portal"),Fl=Symbol.for("react.fragment"),i0=Symbol.for("react.strict_mode"),Lp=Symbol.for("react.profiler"),P2=Symbol.for("react.provider"),I2=Symbol.for("react.context"),a0=Symbol.for("react.forward_ref"),Tp=Symbol.for("react.suspense"),zp=Symbol.for("react.suspense_list"),o0=Symbol.for("react.memo"),Fa=Symbol.for("react.lazy"),E2=Symbol.for("react.offscreen"),G1=Symbol.iterator;function Yc(t){return t===null||typeof t!="object"?null:(t=G1&&t[G1]||t["@@iterator"],typeof t=="function"?t:null)}var Mn=Object.assign,Fm;function du(t){if(Fm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Fm=e&&e[1]||""}return`
`+Fm+t}var $m=!1;function Bm(t,e){if(!t||$m)return"";$m=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{$m=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?du(t):""}function xN(t){switch(t.tag){case 5:return du(t.type);case 16:return du("Lazy");case 13:return du("Suspense");case 19:return du("SuspenseList");case 0:case 2:case 15:return t=Bm(t.type,!1),t;case 11:return t=Bm(t.type.render,!1),t;case 1:return t=Bm(t.type,!0),t;default:return""}}function Op(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Fl:return"Fragment";case Rl:return"Portal";case Lp:return"Profiler";case i0:return"StrictMode";case Tp:return"Suspense";case zp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case I2:return(t.displayName||"Context")+".Consumer";case P2:return(t._context.displayName||"Context")+".Provider";case a0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case o0:return e=t.displayName||null,e!==null?e:Op(t.type)||"Memo";case Fa:e=t._payload,t=t._init;try{return Op(t(e))}catch{}}return null}function yN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Op(e);case 8:return e===i0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ro(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function L2(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function bN(t){var e=L2(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nh(t){t._valueTracker||(t._valueTracker=bN(t))}function T2(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=L2(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Qh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dp(t,e){var n=e.checked;return Mn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function W1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ro(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function z2(t,e){e=e.checked,e!=null&&s0(t,"checked",e,!1)}function Mp(t,e){z2(t,e);var n=ro(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Rp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rp(t,e.type,ro(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Z1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Rp(t,e,n){(e!=="number"||Qh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var hu=Array.isArray;function Ql(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ro(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Fp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(nt(91));return Mn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function J1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(nt(92));if(hu(n)){if(1<n.length)throw Error(nt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ro(n)}}function O2(t,e){var n=ro(e.value),r=ro(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function K1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function D2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $p(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?D2(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var rh,M2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(rh=rh||document.createElement("div"),rh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Du(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var bu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wN=["Webkit","ms","Moz","O"];Object.keys(bu).forEach(function(t){wN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bu[e]=bu[t]})});function R2(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||bu.hasOwnProperty(t)&&bu[t]?(""+e).trim():e+"px"}function F2(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=R2(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var NN=Mn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bp(t,e){if(e){if(NN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(nt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(nt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(nt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(nt(62))}}function qp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Up=null;function l0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Vp=null,Xl=null,ec=null;function Y1(t){if(t=ud(t)){if(typeof Vp!="function")throw Error(nt(280));var e=t.stateNode;e&&(e=Rf(e),Vp(t.stateNode,t.type,e))}}function $2(t){Xl?ec?ec.push(t):ec=[t]:Xl=t}function B2(){if(Xl){var t=Xl,e=ec;if(ec=Xl=null,Y1(t),e)for(t=0;t<e.length;t++)Y1(e[t])}}function q2(t,e){return t(e)}function U2(){}var qm=!1;function V2(t,e,n){if(qm)return t(e,n);qm=!0;try{return q2(t,e,n)}finally{qm=!1,(Xl!==null||ec!==null)&&(U2(),B2())}}function Mu(t,e){var n=t.stateNode;if(n===null)return null;var r=Rf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(nt(231,e,typeof n));return n}var Hp=!1;if(ua)try{var Qc={};Object.defineProperty(Qc,"passive",{get:function(){Hp=!0}}),window.addEventListener("test",Qc,Qc),window.removeEventListener("test",Qc,Qc)}catch{Hp=!1}function jN(t,e,n,r,i,a,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var wu=!1,Xh=null,ef=!1,Gp=null,SN={onError:function(t){wu=!0,Xh=t}};function _N(t,e,n,r,i,a,o,l,c){wu=!1,Xh=null,jN.apply(SN,arguments)}function kN(t,e,n,r,i,a,o,l,c){if(_N.apply(this,arguments),wu){if(wu){var d=Xh;wu=!1,Xh=null}else throw Error(nt(198));ef||(ef=!0,Gp=d)}}function Qo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function H2(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Q1(t){if(Qo(t)!==t)throw Error(nt(188))}function CN(t){var e=t.alternate;if(!e){if(e=Qo(t),e===null)throw Error(nt(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Q1(i),t;if(a===r)return Q1(i),e;a=a.sibling}throw Error(nt(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(nt(189))}}if(n.alternate!==r)throw Error(nt(190))}if(n.tag!==3)throw Error(nt(188));return n.stateNode.current===n?t:e}function G2(t){return t=CN(t),t!==null?W2(t):null}function W2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=W2(t);if(e!==null)return e;t=t.sibling}return null}var Z2=zs.unstable_scheduleCallback,X1=zs.unstable_cancelCallback,AN=zs.unstable_shouldYield,PN=zs.unstable_requestPaint,Kn=zs.unstable_now,IN=zs.unstable_getCurrentPriorityLevel,c0=zs.unstable_ImmediatePriority,J2=zs.unstable_UserBlockingPriority,tf=zs.unstable_NormalPriority,EN=zs.unstable_LowPriority,K2=zs.unstable_IdlePriority,zf=null,qi=null;function LN(t){if(qi&&typeof qi.onCommitFiberRoot=="function")try{qi.onCommitFiberRoot(zf,t,void 0,(t.current.flags&128)===128)}catch{}}var yi=Math.clz32?Math.clz32:ON,TN=Math.log,zN=Math.LN2;function ON(t){return t>>>=0,t===0?32:31-(TN(t)/zN|0)|0}var sh=64,ih=4194304;function fu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function nf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=fu(l):(a&=o,a!==0&&(r=fu(a)))}else o=n&~i,o!==0?r=fu(o):a!==0&&(r=fu(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-yi(e),i=1<<n,r|=t[n],e&=~i;return r}function DN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function MN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-yi(a),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=DN(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function Wp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Y2(){var t=sh;return sh<<=1,!(sh&4194240)&&(sh=64),t}function Um(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ld(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-yi(e),t[e]=n}function RN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-yi(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}function u0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-yi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var hn=0;function Q2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var X2,d0,ey,ty,ny,Zp=!1,ah=[],Ja=null,Ka=null,Ya=null,Ru=new Map,Fu=new Map,Ba=[],FN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ev(t,e){switch(t){case"focusin":case"focusout":Ja=null;break;case"dragenter":case"dragleave":Ka=null;break;case"mouseover":case"mouseout":Ya=null;break;case"pointerover":case"pointerout":Ru.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fu.delete(e.pointerId)}}function Xc(t,e,n,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=ud(e),e!==null&&d0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function $N(t,e,n,r,i){switch(e){case"focusin":return Ja=Xc(Ja,t,e,n,r,i),!0;case"dragenter":return Ka=Xc(Ka,t,e,n,r,i),!0;case"mouseover":return Ya=Xc(Ya,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return Ru.set(a,Xc(Ru.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Fu.set(a,Xc(Fu.get(a)||null,t,e,n,r,i)),!0}return!1}function ry(t){var e=Do(t.target);if(e!==null){var n=Qo(e);if(n!==null){if(e=n.tag,e===13){if(e=H2(n),e!==null){t.blockedOn=e,ny(t.priority,function(){ey(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Dh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Jp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Up=r,n.target.dispatchEvent(r),Up=null}else return e=ud(n),e!==null&&d0(e),t.blockedOn=n,!1;e.shift()}return!0}function tv(t,e,n){Dh(t)&&n.delete(e)}function BN(){Zp=!1,Ja!==null&&Dh(Ja)&&(Ja=null),Ka!==null&&Dh(Ka)&&(Ka=null),Ya!==null&&Dh(Ya)&&(Ya=null),Ru.forEach(tv),Fu.forEach(tv)}function eu(t,e){t.blockedOn===e&&(t.blockedOn=null,Zp||(Zp=!0,zs.unstable_scheduleCallback(zs.unstable_NormalPriority,BN)))}function $u(t){function e(i){return eu(i,t)}if(0<ah.length){eu(ah[0],t);for(var n=1;n<ah.length;n++){var r=ah[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ja!==null&&eu(Ja,t),Ka!==null&&eu(Ka,t),Ya!==null&&eu(Ya,t),Ru.forEach(e),Fu.forEach(e),n=0;n<Ba.length;n++)r=Ba[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ba.length&&(n=Ba[0],n.blockedOn===null);)ry(n),n.blockedOn===null&&Ba.shift()}var tc=ma.ReactCurrentBatchConfig,rf=!0;function qN(t,e,n,r){var i=hn,a=tc.transition;tc.transition=null;try{hn=1,h0(t,e,n,r)}finally{hn=i,tc.transition=a}}function UN(t,e,n,r){var i=hn,a=tc.transition;tc.transition=null;try{hn=4,h0(t,e,n,r)}finally{hn=i,tc.transition=a}}function h0(t,e,n,r){if(rf){var i=Jp(t,e,n,r);if(i===null)Xm(t,e,r,sf,n),ev(t,r);else if($N(i,t,e,n,r))r.stopPropagation();else if(ev(t,r),e&4&&-1<FN.indexOf(t)){for(;i!==null;){var a=ud(i);if(a!==null&&X2(a),a=Jp(t,e,n,r),a===null&&Xm(t,e,r,sf,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else Xm(t,e,r,null,n)}}var sf=null;function Jp(t,e,n,r){if(sf=null,t=l0(r),t=Do(t),t!==null)if(e=Qo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=H2(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return sf=t,null}function sy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(IN()){case c0:return 1;case J2:return 4;case tf:case EN:return 16;case K2:return 536870912;default:return 16}default:return 16}}var Va=null,f0=null,Mh=null;function iy(){if(Mh)return Mh;var t,e=f0,n=e.length,r,i="value"in Va?Va.value:Va.textContent,a=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[a-r];r++);return Mh=i.slice(t,1<r?1-r:void 0)}function Rh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function oh(){return!0}function nv(){return!1}function Ds(t){function e(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?oh:nv,this.isPropagationStopped=nv,this}return Mn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=oh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=oh)},persist:function(){},isPersistent:oh}),e}var yc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},m0=Ds(yc),cd=Mn({},yc,{view:0,detail:0}),VN=Ds(cd),Vm,Hm,tu,Of=Mn({},cd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==tu&&(tu&&t.type==="mousemove"?(Vm=t.screenX-tu.screenX,Hm=t.screenY-tu.screenY):Hm=Vm=0,tu=t),Vm)},movementY:function(t){return"movementY"in t?t.movementY:Hm}}),rv=Ds(Of),HN=Mn({},Of,{dataTransfer:0}),GN=Ds(HN),WN=Mn({},cd,{relatedTarget:0}),Gm=Ds(WN),ZN=Mn({},yc,{animationName:0,elapsedTime:0,pseudoElement:0}),JN=Ds(ZN),KN=Mn({},yc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YN=Ds(KN),QN=Mn({},yc,{data:0}),sv=Ds(QN),XN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ej={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nj(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=tj[t])?!!e[t]:!1}function p0(){return nj}var rj=Mn({},cd,{key:function(t){if(t.key){var e=XN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Rh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ej[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p0,charCode:function(t){return t.type==="keypress"?Rh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Rh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sj=Ds(rj),ij=Mn({},Of,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),iv=Ds(ij),aj=Mn({},cd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p0}),oj=Ds(aj),lj=Mn({},yc,{propertyName:0,elapsedTime:0,pseudoElement:0}),cj=Ds(lj),uj=Mn({},Of,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dj=Ds(uj),hj=[9,13,27,32],g0=ua&&"CompositionEvent"in window,Nu=null;ua&&"documentMode"in document&&(Nu=document.documentMode);var fj=ua&&"TextEvent"in window&&!Nu,ay=ua&&(!g0||Nu&&8<Nu&&11>=Nu),av=String.fromCharCode(32),ov=!1;function oy(t,e){switch(t){case"keyup":return hj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ly(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $l=!1;function mj(t,e){switch(t){case"compositionend":return ly(e);case"keypress":return e.which!==32?null:(ov=!0,av);case"textInput":return t=e.data,t===av&&ov?null:t;default:return null}}function pj(t,e){if($l)return t==="compositionend"||!g0&&oy(t,e)?(t=iy(),Mh=f0=Va=null,$l=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ay&&e.locale!=="ko"?null:e.data;default:return null}}var gj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gj[t.type]:e==="textarea"}function cy(t,e,n,r){$2(r),e=af(e,"onChange"),0<e.length&&(n=new m0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ju=null,Bu=null;function vj(t){by(t,0)}function Df(t){var e=Ul(t);if(T2(e))return t}function xj(t,e){if(t==="change")return e}var uy=!1;if(ua){var Wm;if(ua){var Zm="oninput"in document;if(!Zm){var cv=document.createElement("div");cv.setAttribute("oninput","return;"),Zm=typeof cv.oninput=="function"}Wm=Zm}else Wm=!1;uy=Wm&&(!document.documentMode||9<document.documentMode)}function uv(){ju&&(ju.detachEvent("onpropertychange",dy),Bu=ju=null)}function dy(t){if(t.propertyName==="value"&&Df(Bu)){var e=[];cy(e,Bu,t,l0(t)),V2(vj,e)}}function yj(t,e,n){t==="focusin"?(uv(),ju=e,Bu=n,ju.attachEvent("onpropertychange",dy)):t==="focusout"&&uv()}function bj(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Df(Bu)}function wj(t,e){if(t==="click")return Df(e)}function Nj(t,e){if(t==="input"||t==="change")return Df(e)}function jj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ni=typeof Object.is=="function"?Object.is:jj;function qu(t,e){if(Ni(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Ep.call(e,i)||!Ni(t[i],e[i]))return!1}return!0}function dv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hv(t,e){var n=dv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dv(n)}}function hy(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?hy(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function fy(){for(var t=window,e=Qh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Qh(t.document)}return e}function v0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Sj(t){var e=fy(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hy(n.ownerDocument.documentElement,n)){if(r!==null&&v0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=hv(n,a);var o=hv(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var _j=ua&&"documentMode"in document&&11>=document.documentMode,Bl=null,Kp=null,Su=null,Yp=!1;function fv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yp||Bl==null||Bl!==Qh(r)||(r=Bl,"selectionStart"in r&&v0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Su&&qu(Su,r)||(Su=r,r=af(Kp,"onSelect"),0<r.length&&(e=new m0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Bl)))}function lh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ql={animationend:lh("Animation","AnimationEnd"),animationiteration:lh("Animation","AnimationIteration"),animationstart:lh("Animation","AnimationStart"),transitionend:lh("Transition","TransitionEnd")},Jm={},my={};ua&&(my=document.createElement("div").style,"AnimationEvent"in window||(delete ql.animationend.animation,delete ql.animationiteration.animation,delete ql.animationstart.animation),"TransitionEvent"in window||delete ql.transitionend.transition);function Mf(t){if(Jm[t])return Jm[t];if(!ql[t])return t;var e=ql[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in my)return Jm[t]=e[n];return t}var py=Mf("animationend"),gy=Mf("animationiteration"),vy=Mf("animationstart"),xy=Mf("transitionend"),yy=new Map,mv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function lo(t,e){yy.set(t,e),Yo(e,[t])}for(var Km=0;Km<mv.length;Km++){var Ym=mv[Km],kj=Ym.toLowerCase(),Cj=Ym[0].toUpperCase()+Ym.slice(1);lo(kj,"on"+Cj)}lo(py,"onAnimationEnd");lo(gy,"onAnimationIteration");lo(vy,"onAnimationStart");lo("dblclick","onDoubleClick");lo("focusin","onFocus");lo("focusout","onBlur");lo(xy,"onTransitionEnd");uc("onMouseEnter",["mouseout","mouseover"]);uc("onMouseLeave",["mouseout","mouseover"]);uc("onPointerEnter",["pointerout","pointerover"]);uc("onPointerLeave",["pointerout","pointerover"]);Yo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Yo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Yo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Yo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Yo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Yo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Aj=new Set("cancel close invalid load scroll toggle".split(" ").concat(mu));function pv(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,kN(r,e,void 0,t),t.currentTarget=null}function by(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==a&&i.isPropagationStopped())break e;pv(i,l,d),a=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==a&&i.isPropagationStopped())break e;pv(i,l,d),a=c}}}if(ef)throw t=Gp,ef=!1,Gp=null,t}function _n(t,e){var n=e[ng];n===void 0&&(n=e[ng]=new Set);var r=t+"__bubble";n.has(r)||(wy(e,t,2,!1),n.add(r))}function Qm(t,e,n){var r=0;e&&(r|=4),wy(n,t,r,e)}var ch="_reactListening"+Math.random().toString(36).slice(2);function Uu(t){if(!t[ch]){t[ch]=!0,A2.forEach(function(n){n!=="selectionchange"&&(Aj.has(n)||Qm(n,!1,t),Qm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ch]||(e[ch]=!0,Qm("selectionchange",!1,e))}}function wy(t,e,n,r){switch(sy(e)){case 1:var i=qN;break;case 4:i=UN;break;default:i=h0}n=i.bind(null,e,n,t),i=void 0,!Hp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Xm(t,e,n,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Do(l),o===null)return;if(c=o.tag,c===5||c===6){r=a=o;continue e}l=l.parentNode}}r=r.return}V2(function(){var d=a,f=l0(n),p=[];e:{var v=yy.get(t);if(v!==void 0){var m=m0,N=t;switch(t){case"keypress":if(Rh(n)===0)break e;case"keydown":case"keyup":m=sj;break;case"focusin":N="focus",m=Gm;break;case"focusout":N="blur",m=Gm;break;case"beforeblur":case"afterblur":m=Gm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=rv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=GN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=oj;break;case py:case gy:case vy:m=JN;break;case xy:m=cj;break;case"scroll":m=VN;break;case"wheel":m=dj;break;case"copy":case"cut":case"paste":m=YN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=iv}var _=(e&4)!==0,k=!_&&t==="scroll",y=_?v!==null?v+"Capture":null:v;_=[];for(var b=d,j;b!==null;){j=b;var C=j.stateNode;if(j.tag===5&&C!==null&&(j=C,y!==null&&(C=Mu(b,y),C!=null&&_.push(Vu(b,C,j)))),k)break;b=b.return}0<_.length&&(v=new m(v,N,null,n,f),p.push({event:v,listeners:_}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",v&&n!==Up&&(N=n.relatedTarget||n.fromElement)&&(Do(N)||N[da]))break e;if((m||v)&&(v=f.window===f?f:(v=f.ownerDocument)?v.defaultView||v.parentWindow:window,m?(N=n.relatedTarget||n.toElement,m=d,N=N?Do(N):null,N!==null&&(k=Qo(N),N!==k||N.tag!==5&&N.tag!==6)&&(N=null)):(m=null,N=d),m!==N)){if(_=rv,C="onMouseLeave",y="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(_=iv,C="onPointerLeave",y="onPointerEnter",b="pointer"),k=m==null?v:Ul(m),j=N==null?v:Ul(N),v=new _(C,b+"leave",m,n,f),v.target=k,v.relatedTarget=j,C=null,Do(f)===d&&(_=new _(y,b+"enter",N,n,f),_.target=j,_.relatedTarget=k,C=_),k=C,m&&N)t:{for(_=m,y=N,b=0,j=_;j;j=Nl(j))b++;for(j=0,C=y;C;C=Nl(C))j++;for(;0<b-j;)_=Nl(_),b--;for(;0<j-b;)y=Nl(y),j--;for(;b--;){if(_===y||y!==null&&_===y.alternate)break t;_=Nl(_),y=Nl(y)}_=null}else _=null;m!==null&&gv(p,v,m,_,!1),N!==null&&k!==null&&gv(p,k,N,_,!0)}}e:{if(v=d?Ul(d):window,m=v.nodeName&&v.nodeName.toLowerCase(),m==="select"||m==="input"&&v.type==="file")var B=xj;else if(lv(v))if(uy)B=Nj;else{B=bj;var K=yj}else(m=v.nodeName)&&m.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(B=wj);if(B&&(B=B(t,d))){cy(p,B,n,f);break e}K&&K(t,v,d),t==="focusout"&&(K=v._wrapperState)&&K.controlled&&v.type==="number"&&Rp(v,"number",v.value)}switch(K=d?Ul(d):window,t){case"focusin":(lv(K)||K.contentEditable==="true")&&(Bl=K,Kp=d,Su=null);break;case"focusout":Su=Kp=Bl=null;break;case"mousedown":Yp=!0;break;case"contextmenu":case"mouseup":case"dragend":Yp=!1,fv(p,n,f);break;case"selectionchange":if(_j)break;case"keydown":case"keyup":fv(p,n,f)}var Z;if(g0)e:{switch(t){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else $l?oy(t,n)&&(z="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(z="onCompositionStart");z&&(ay&&n.locale!=="ko"&&($l||z!=="onCompositionStart"?z==="onCompositionEnd"&&$l&&(Z=iy()):(Va=f,f0="value"in Va?Va.value:Va.textContent,$l=!0)),K=af(d,z),0<K.length&&(z=new sv(z,t,null,n,f),p.push({event:z,listeners:K}),Z?z.data=Z:(Z=ly(n),Z!==null&&(z.data=Z)))),(Z=fj?mj(t,n):pj(t,n))&&(d=af(d,"onBeforeInput"),0<d.length&&(f=new sv("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=Z))}by(p,e)})}function Vu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function af(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Mu(t,n),a!=null&&r.unshift(Vu(t,a,i)),a=Mu(t,e),a!=null&&r.push(Vu(t,a,i))),t=t.return}return r}function Nl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function gv(t,e,n,r,i){for(var a=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,i?(c=Mu(n,a),c!=null&&o.unshift(Vu(n,c,l))):i||(c=Mu(n,a),c!=null&&o.push(Vu(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Pj=/\r\n?/g,Ij=/\u0000|\uFFFD/g;function vv(t){return(typeof t=="string"?t:""+t).replace(Pj,`
`).replace(Ij,"")}function uh(t,e,n){if(e=vv(e),vv(t)!==e&&n)throw Error(nt(425))}function of(){}var Qp=null,Xp=null;function eg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var tg=typeof setTimeout=="function"?setTimeout:void 0,Ej=typeof clearTimeout=="function"?clearTimeout:void 0,xv=typeof Promise=="function"?Promise:void 0,Lj=typeof queueMicrotask=="function"?queueMicrotask:typeof xv<"u"?function(t){return xv.resolve(null).then(t).catch(Tj)}:tg;function Tj(t){setTimeout(function(){throw t})}function ep(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),$u(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);$u(e)}function Qa(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function yv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var bc=Math.random().toString(36).slice(2),$i="__reactFiber$"+bc,Hu="__reactProps$"+bc,da="__reactContainer$"+bc,ng="__reactEvents$"+bc,zj="__reactListeners$"+bc,Oj="__reactHandles$"+bc;function Do(t){var e=t[$i];if(e)return e;for(var n=t.parentNode;n;){if(e=n[da]||n[$i]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=yv(t);t!==null;){if(n=t[$i])return n;t=yv(t)}return e}t=n,n=t.parentNode}return null}function ud(t){return t=t[$i]||t[da],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ul(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(nt(33))}function Rf(t){return t[Hu]||null}var rg=[],Vl=-1;function co(t){return{current:t}}function An(t){0>Vl||(t.current=rg[Vl],rg[Vl]=null,Vl--)}function jn(t,e){Vl++,rg[Vl]=t.current,t.current=e}var so={},Zr=co(so),xs=co(!1),qo=so;function dc(t,e){var n=t.type.contextTypes;if(!n)return so;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ys(t){return t=t.childContextTypes,t!=null}function lf(){An(xs),An(Zr)}function bv(t,e,n){if(Zr.current!==so)throw Error(nt(168));jn(Zr,e),jn(xs,n)}function Ny(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(nt(108,yN(t)||"Unknown",i));return Mn({},n,r)}function cf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||so,qo=Zr.current,jn(Zr,t),jn(xs,xs.current),!0}function wv(t,e,n){var r=t.stateNode;if(!r)throw Error(nt(169));n?(t=Ny(t,e,qo),r.__reactInternalMemoizedMergedChildContext=t,An(xs),An(Zr),jn(Zr,t)):An(xs),jn(xs,n)}var aa=null,Ff=!1,tp=!1;function jy(t){aa===null?aa=[t]:aa.push(t)}function Dj(t){Ff=!0,jy(t)}function uo(){if(!tp&&aa!==null){tp=!0;var t=0,e=hn;try{var n=aa;for(hn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}aa=null,Ff=!1}catch(i){throw aa!==null&&(aa=aa.slice(t+1)),Z2(c0,uo),i}finally{hn=e,tp=!1}}return null}var Hl=[],Gl=0,uf=null,df=0,Hs=[],Gs=0,Uo=null,oa=1,la="";function Io(t,e){Hl[Gl++]=df,Hl[Gl++]=uf,uf=t,df=e}function Sy(t,e,n){Hs[Gs++]=oa,Hs[Gs++]=la,Hs[Gs++]=Uo,Uo=t;var r=oa;t=la;var i=32-yi(r)-1;r&=~(1<<i),n+=1;var a=32-yi(e)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,oa=1<<32-yi(e)+i|n<<i|r,la=a+t}else oa=1<<a|n<<i|r,la=t}function x0(t){t.return!==null&&(Io(t,1),Sy(t,1,0))}function y0(t){for(;t===uf;)uf=Hl[--Gl],Hl[Gl]=null,df=Hl[--Gl],Hl[Gl]=null;for(;t===Uo;)Uo=Hs[--Gs],Hs[Gs]=null,la=Hs[--Gs],Hs[Gs]=null,oa=Hs[--Gs],Hs[Gs]=null}var Ts=null,Es=null,In=!1,xi=null;function _y(t,e){var n=Js(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Nv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ts=t,Es=Qa(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ts=t,Es=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Uo!==null?{id:oa,overflow:la}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Js(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ts=t,Es=null,!0):!1;default:return!1}}function sg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ig(t){if(In){var e=Es;if(e){var n=e;if(!Nv(t,e)){if(sg(t))throw Error(nt(418));e=Qa(n.nextSibling);var r=Ts;e&&Nv(t,e)?_y(r,n):(t.flags=t.flags&-4097|2,In=!1,Ts=t)}}else{if(sg(t))throw Error(nt(418));t.flags=t.flags&-4097|2,In=!1,Ts=t}}}function jv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ts=t}function dh(t){if(t!==Ts)return!1;if(!In)return jv(t),In=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!eg(t.type,t.memoizedProps)),e&&(e=Es)){if(sg(t))throw ky(),Error(nt(418));for(;e;)_y(t,e),e=Qa(e.nextSibling)}if(jv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(nt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Es=Qa(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Es=null}}else Es=Ts?Qa(t.stateNode.nextSibling):null;return!0}function ky(){for(var t=Es;t;)t=Qa(t.nextSibling)}function hc(){Es=Ts=null,In=!1}function b0(t){xi===null?xi=[t]:xi.push(t)}var Mj=ma.ReactCurrentBatchConfig;function nu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(nt(309));var r=n.stateNode}if(!r)throw Error(nt(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(nt(284));if(!n._owner)throw Error(nt(290,t))}return t}function hh(t,e){throw t=Object.prototype.toString.call(e),Error(nt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Sv(t){var e=t._init;return e(t._payload)}function Cy(t){function e(y,b){if(t){var j=y.deletions;j===null?(y.deletions=[b],y.flags|=16):j.push(b)}}function n(y,b){if(!t)return null;for(;b!==null;)e(y,b),b=b.sibling;return null}function r(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function i(y,b){return y=no(y,b),y.index=0,y.sibling=null,y}function a(y,b,j){return y.index=j,t?(j=y.alternate,j!==null?(j=j.index,j<b?(y.flags|=2,b):j):(y.flags|=2,b)):(y.flags|=1048576,b)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,b,j,C){return b===null||b.tag!==6?(b=lp(j,y.mode,C),b.return=y,b):(b=i(b,j),b.return=y,b)}function c(y,b,j,C){var B=j.type;return B===Fl?f(y,b,j.props.children,C,j.key):b!==null&&(b.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Fa&&Sv(B)===b.type)?(C=i(b,j.props),C.ref=nu(y,b,j),C.return=y,C):(C=Hh(j.type,j.key,j.props,null,y.mode,C),C.ref=nu(y,b,j),C.return=y,C)}function d(y,b,j,C){return b===null||b.tag!==4||b.stateNode.containerInfo!==j.containerInfo||b.stateNode.implementation!==j.implementation?(b=cp(j,y.mode,C),b.return=y,b):(b=i(b,j.children||[]),b.return=y,b)}function f(y,b,j,C,B){return b===null||b.tag!==7?(b=$o(j,y.mode,C,B),b.return=y,b):(b=i(b,j),b.return=y,b)}function p(y,b,j){if(typeof b=="string"&&b!==""||typeof b=="number")return b=lp(""+b,y.mode,j),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case th:return j=Hh(b.type,b.key,b.props,null,y.mode,j),j.ref=nu(y,null,b),j.return=y,j;case Rl:return b=cp(b,y.mode,j),b.return=y,b;case Fa:var C=b._init;return p(y,C(b._payload),j)}if(hu(b)||Yc(b))return b=$o(b,y.mode,j,null),b.return=y,b;hh(y,b)}return null}function v(y,b,j,C){var B=b!==null?b.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return B!==null?null:l(y,b,""+j,C);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case th:return j.key===B?c(y,b,j,C):null;case Rl:return j.key===B?d(y,b,j,C):null;case Fa:return B=j._init,v(y,b,B(j._payload),C)}if(hu(j)||Yc(j))return B!==null?null:f(y,b,j,C,null);hh(y,j)}return null}function m(y,b,j,C,B){if(typeof C=="string"&&C!==""||typeof C=="number")return y=y.get(j)||null,l(b,y,""+C,B);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case th:return y=y.get(C.key===null?j:C.key)||null,c(b,y,C,B);case Rl:return y=y.get(C.key===null?j:C.key)||null,d(b,y,C,B);case Fa:var K=C._init;return m(y,b,j,K(C._payload),B)}if(hu(C)||Yc(C))return y=y.get(j)||null,f(b,y,C,B,null);hh(b,C)}return null}function N(y,b,j,C){for(var B=null,K=null,Z=b,z=b=0,J=null;Z!==null&&z<j.length;z++){Z.index>z?(J=Z,Z=null):J=Z.sibling;var te=v(y,Z,j[z],C);if(te===null){Z===null&&(Z=J);break}t&&Z&&te.alternate===null&&e(y,Z),b=a(te,b,z),K===null?B=te:K.sibling=te,K=te,Z=J}if(z===j.length)return n(y,Z),In&&Io(y,z),B;if(Z===null){for(;z<j.length;z++)Z=p(y,j[z],C),Z!==null&&(b=a(Z,b,z),K===null?B=Z:K.sibling=Z,K=Z);return In&&Io(y,z),B}for(Z=r(y,Z);z<j.length;z++)J=m(Z,y,z,j[z],C),J!==null&&(t&&J.alternate!==null&&Z.delete(J.key===null?z:J.key),b=a(J,b,z),K===null?B=J:K.sibling=J,K=J);return t&&Z.forEach(function(I){return e(y,I)}),In&&Io(y,z),B}function _(y,b,j,C){var B=Yc(j);if(typeof B!="function")throw Error(nt(150));if(j=B.call(j),j==null)throw Error(nt(151));for(var K=B=null,Z=b,z=b=0,J=null,te=j.next();Z!==null&&!te.done;z++,te=j.next()){Z.index>z?(J=Z,Z=null):J=Z.sibling;var I=v(y,Z,te.value,C);if(I===null){Z===null&&(Z=J);break}t&&Z&&I.alternate===null&&e(y,Z),b=a(I,b,z),K===null?B=I:K.sibling=I,K=I,Z=J}if(te.done)return n(y,Z),In&&Io(y,z),B;if(Z===null){for(;!te.done;z++,te=j.next())te=p(y,te.value,C),te!==null&&(b=a(te,b,z),K===null?B=te:K.sibling=te,K=te);return In&&Io(y,z),B}for(Z=r(y,Z);!te.done;z++,te=j.next())te=m(Z,y,z,te.value,C),te!==null&&(t&&te.alternate!==null&&Z.delete(te.key===null?z:te.key),b=a(te,b,z),K===null?B=te:K.sibling=te,K=te);return t&&Z.forEach(function(A){return e(y,A)}),In&&Io(y,z),B}function k(y,b,j,C){if(typeof j=="object"&&j!==null&&j.type===Fl&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case th:e:{for(var B=j.key,K=b;K!==null;){if(K.key===B){if(B=j.type,B===Fl){if(K.tag===7){n(y,K.sibling),b=i(K,j.props.children),b.return=y,y=b;break e}}else if(K.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Fa&&Sv(B)===K.type){n(y,K.sibling),b=i(K,j.props),b.ref=nu(y,K,j),b.return=y,y=b;break e}n(y,K);break}else e(y,K);K=K.sibling}j.type===Fl?(b=$o(j.props.children,y.mode,C,j.key),b.return=y,y=b):(C=Hh(j.type,j.key,j.props,null,y.mode,C),C.ref=nu(y,b,j),C.return=y,y=C)}return o(y);case Rl:e:{for(K=j.key;b!==null;){if(b.key===K)if(b.tag===4&&b.stateNode.containerInfo===j.containerInfo&&b.stateNode.implementation===j.implementation){n(y,b.sibling),b=i(b,j.children||[]),b.return=y,y=b;break e}else{n(y,b);break}else e(y,b);b=b.sibling}b=cp(j,y.mode,C),b.return=y,y=b}return o(y);case Fa:return K=j._init,k(y,b,K(j._payload),C)}if(hu(j))return N(y,b,j,C);if(Yc(j))return _(y,b,j,C);hh(y,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,b!==null&&b.tag===6?(n(y,b.sibling),b=i(b,j),b.return=y,y=b):(n(y,b),b=lp(j,y.mode,C),b.return=y,y=b),o(y)):n(y,b)}return k}var fc=Cy(!0),Ay=Cy(!1),hf=co(null),ff=null,Wl=null,w0=null;function N0(){w0=Wl=ff=null}function j0(t){var e=hf.current;An(hf),t._currentValue=e}function ag(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function nc(t,e){ff=t,w0=Wl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vs=!0),t.firstContext=null)}function ei(t){var e=t._currentValue;if(w0!==t)if(t={context:t,memoizedValue:e,next:null},Wl===null){if(ff===null)throw Error(nt(308));Wl=t,ff.dependencies={lanes:0,firstContext:t}}else Wl=Wl.next=t;return e}var Mo=null;function S0(t){Mo===null?Mo=[t]:Mo.push(t)}function Py(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,S0(e)):(n.next=i.next,i.next=n),e.interleaved=n,ha(t,r)}function ha(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var $a=!1;function _0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Iy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ca(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xa(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,nn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ha(t,n)}return i=r.interleaved,i===null?(e.next=e,S0(r)):(e.next=i.next,i.next=e),r.interleaved=e,ha(t,n)}function Fh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,u0(t,n)}}function _v(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=e:a=a.next=e}else i=a=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function mf(t,e,n,r){var i=t.updateQueue;$a=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?a=d:o.next=d,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(a!==null){var p=i.baseState;o=0,f=d=c=null,l=a;do{var v=l.lane,m=l.eventTime;if((r&v)===v){f!==null&&(f=f.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var N=t,_=l;switch(v=e,m=n,_.tag){case 1:if(N=_.payload,typeof N=="function"){p=N.call(m,p,v);break e}p=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=_.payload,v=typeof N=="function"?N.call(m,p,v):N,v==null)break e;p=Mn({},p,v);break e;case 2:$a=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,v=i.effects,v===null?i.effects=[l]:v.push(l))}else m={eventTime:m,lane:v,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=m,c=p):f=f.next=m,o|=v;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;v=l,l=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(1);if(f===null&&(c=p),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Ho|=o,t.lanes=o,t.memoizedState=p}}function kv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(nt(191,i));i.call(r)}}}var dd={},Ui=co(dd),Gu=co(dd),Wu=co(dd);function Ro(t){if(t===dd)throw Error(nt(174));return t}function k0(t,e){switch(jn(Wu,e),jn(Gu,t),jn(Ui,dd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:$p(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=$p(e,t)}An(Ui),jn(Ui,e)}function mc(){An(Ui),An(Gu),An(Wu)}function Ey(t){Ro(Wu.current);var e=Ro(Ui.current),n=$p(e,t.type);e!==n&&(jn(Gu,t),jn(Ui,n))}function C0(t){Gu.current===t&&(An(Ui),An(Gu))}var On=co(0);function pf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var np=[];function A0(){for(var t=0;t<np.length;t++)np[t]._workInProgressVersionPrimary=null;np.length=0}var $h=ma.ReactCurrentDispatcher,rp=ma.ReactCurrentBatchConfig,Vo=0,Dn=null,mr=null,wr=null,gf=!1,_u=!1,Zu=0,Rj=0;function Rr(){throw Error(nt(321))}function P0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ni(t[n],e[n]))return!1;return!0}function I0(t,e,n,r,i,a){if(Vo=a,Dn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$h.current=t===null||t.memoizedState===null?qj:Uj,t=n(r,i),_u){a=0;do{if(_u=!1,Zu=0,25<=a)throw Error(nt(301));a+=1,wr=mr=null,e.updateQueue=null,$h.current=Vj,t=n(r,i)}while(_u)}if($h.current=vf,e=mr!==null&&mr.next!==null,Vo=0,wr=mr=Dn=null,gf=!1,e)throw Error(nt(300));return t}function E0(){var t=Zu!==0;return Zu=0,t}function Ri(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wr===null?Dn.memoizedState=wr=t:wr=wr.next=t,wr}function ti(){if(mr===null){var t=Dn.alternate;t=t!==null?t.memoizedState:null}else t=mr.next;var e=wr===null?Dn.memoizedState:wr.next;if(e!==null)wr=e,mr=t;else{if(t===null)throw Error(nt(310));mr=t,t={memoizedState:mr.memoizedState,baseState:mr.baseState,baseQueue:mr.baseQueue,queue:mr.queue,next:null},wr===null?Dn.memoizedState=wr=t:wr=wr.next=t}return wr}function Ju(t,e){return typeof e=="function"?e(t):e}function sp(t){var e=ti(),n=e.queue;if(n===null)throw Error(nt(311));n.lastRenderedReducer=t;var r=mr,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=o=null,c=null,d=a;do{var f=d.lane;if((Vo&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,Dn.lanes|=f,Ho|=f}d=d.next}while(d!==null&&d!==a);c===null?o=r:c.next=l,Ni(r,e.memoizedState)||(vs=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do a=i.lane,Dn.lanes|=a,Ho|=a,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ip(t){var e=ti(),n=e.queue;if(n===null)throw Error(nt(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=t(a,o.action),o=o.next;while(o!==i);Ni(a,e.memoizedState)||(vs=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function Ly(){}function Ty(t,e){var n=Dn,r=ti(),i=e(),a=!Ni(r.memoizedState,i);if(a&&(r.memoizedState=i,vs=!0),r=r.queue,L0(Dy.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||wr!==null&&wr.memoizedState.tag&1){if(n.flags|=2048,Ku(9,Oy.bind(null,n,r,i,e),void 0,null),jr===null)throw Error(nt(349));Vo&30||zy(n,e,i)}return i}function zy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Dn.updateQueue,e===null?(e={lastEffect:null,stores:null},Dn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Oy(t,e,n,r){e.value=n,e.getSnapshot=r,My(e)&&Ry(t)}function Dy(t,e,n){return n(function(){My(e)&&Ry(t)})}function My(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ni(t,n)}catch{return!0}}function Ry(t){var e=ha(t,1);e!==null&&bi(e,t,1,-1)}function Cv(t){var e=Ri();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ju,lastRenderedState:t},e.queue=t,t=t.dispatch=Bj.bind(null,Dn,t),[e.memoizedState,t]}function Ku(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Dn.updateQueue,e===null?(e={lastEffect:null,stores:null},Dn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Fy(){return ti().memoizedState}function Bh(t,e,n,r){var i=Ri();Dn.flags|=t,i.memoizedState=Ku(1|e,n,void 0,r===void 0?null:r)}function $f(t,e,n,r){var i=ti();r=r===void 0?null:r;var a=void 0;if(mr!==null){var o=mr.memoizedState;if(a=o.destroy,r!==null&&P0(r,o.deps)){i.memoizedState=Ku(e,n,a,r);return}}Dn.flags|=t,i.memoizedState=Ku(1|e,n,a,r)}function Av(t,e){return Bh(8390656,8,t,e)}function L0(t,e){return $f(2048,8,t,e)}function $y(t,e){return $f(4,2,t,e)}function By(t,e){return $f(4,4,t,e)}function qy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Uy(t,e,n){return n=n!=null?n.concat([t]):null,$f(4,4,qy.bind(null,e,t),n)}function T0(){}function Vy(t,e){var n=ti();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Hy(t,e){var n=ti();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Gy(t,e,n){return Vo&21?(Ni(n,e)||(n=Y2(),Dn.lanes|=n,Ho|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vs=!0),t.memoizedState=n)}function Fj(t,e){var n=hn;hn=n!==0&&4>n?n:4,t(!0);var r=rp.transition;rp.transition={};try{t(!1),e()}finally{hn=n,rp.transition=r}}function Wy(){return ti().memoizedState}function $j(t,e,n){var r=to(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Zy(t))Jy(e,n);else if(n=Py(t,e,n,r),n!==null){var i=ss();bi(n,t,r,i),Ky(n,e,r)}}function Bj(t,e,n){var r=to(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Zy(t))Jy(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,n);if(i.hasEagerState=!0,i.eagerState=l,Ni(l,o)){var c=e.interleaved;c===null?(i.next=i,S0(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=Py(t,e,i,r),n!==null&&(i=ss(),bi(n,t,r,i),Ky(n,e,r))}}function Zy(t){var e=t.alternate;return t===Dn||e!==null&&e===Dn}function Jy(t,e){_u=gf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ky(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,u0(t,n)}}var vf={readContext:ei,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},qj={readContext:ei,useCallback:function(t,e){return Ri().memoizedState=[t,e===void 0?null:e],t},useContext:ei,useEffect:Av,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Bh(4194308,4,qy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Bh(4194308,4,t,e)},useInsertionEffect:function(t,e){return Bh(4,2,t,e)},useMemo:function(t,e){var n=Ri();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ri();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=$j.bind(null,Dn,t),[r.memoizedState,t]},useRef:function(t){var e=Ri();return t={current:t},e.memoizedState=t},useState:Cv,useDebugValue:T0,useDeferredValue:function(t){return Ri().memoizedState=t},useTransition:function(){var t=Cv(!1),e=t[0];return t=Fj.bind(null,t[1]),Ri().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Dn,i=Ri();if(In){if(n===void 0)throw Error(nt(407));n=n()}else{if(n=e(),jr===null)throw Error(nt(349));Vo&30||zy(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,Av(Dy.bind(null,r,a,t),[t]),r.flags|=2048,Ku(9,Oy.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=Ri(),e=jr.identifierPrefix;if(In){var n=la,r=oa;n=(r&~(1<<32-yi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Zu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Rj++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Uj={readContext:ei,useCallback:Vy,useContext:ei,useEffect:L0,useImperativeHandle:Uy,useInsertionEffect:$y,useLayoutEffect:By,useMemo:Hy,useReducer:sp,useRef:Fy,useState:function(){return sp(Ju)},useDebugValue:T0,useDeferredValue:function(t){var e=ti();return Gy(e,mr.memoizedState,t)},useTransition:function(){var t=sp(Ju)[0],e=ti().memoizedState;return[t,e]},useMutableSource:Ly,useSyncExternalStore:Ty,useId:Wy,unstable_isNewReconciler:!1},Vj={readContext:ei,useCallback:Vy,useContext:ei,useEffect:L0,useImperativeHandle:Uy,useInsertionEffect:$y,useLayoutEffect:By,useMemo:Hy,useReducer:ip,useRef:Fy,useState:function(){return ip(Ju)},useDebugValue:T0,useDeferredValue:function(t){var e=ti();return mr===null?e.memoizedState=t:Gy(e,mr.memoizedState,t)},useTransition:function(){var t=ip(Ju)[0],e=ti().memoizedState;return[t,e]},useMutableSource:Ly,useSyncExternalStore:Ty,useId:Wy,unstable_isNewReconciler:!1};function mi(t,e){if(t&&t.defaultProps){e=Mn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function og(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Mn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Bf={isMounted:function(t){return(t=t._reactInternals)?Qo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ss(),i=to(t),a=ca(r,i);a.payload=e,n!=null&&(a.callback=n),e=Xa(t,a,i),e!==null&&(bi(e,t,i,r),Fh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ss(),i=to(t),a=ca(r,i);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=Xa(t,a,i),e!==null&&(bi(e,t,i,r),Fh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ss(),r=to(t),i=ca(n,r);i.tag=2,e!=null&&(i.callback=e),e=Xa(t,i,r),e!==null&&(bi(e,t,r,n),Fh(e,t,r))}};function Pv(t,e,n,r,i,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!qu(n,r)||!qu(i,a):!0}function Yy(t,e,n){var r=!1,i=so,a=e.contextType;return typeof a=="object"&&a!==null?a=ei(a):(i=ys(e)?qo:Zr.current,r=e.contextTypes,a=(r=r!=null)?dc(t,i):so),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Bf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function Iv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Bf.enqueueReplaceState(e,e.state,null)}function lg(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},_0(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=ei(a):(a=ys(e)?qo:Zr.current,i.context=dc(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(og(t,e,a,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Bf.enqueueReplaceState(i,i.state,null),mf(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function pc(t,e){try{var n="",r=e;do n+=xN(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function ap(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function cg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Hj=typeof WeakMap=="function"?WeakMap:Map;function Qy(t,e,n){n=ca(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){yf||(yf=!0,yg=r),cg(t,e)},n}function Xy(t,e,n){n=ca(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){cg(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){cg(t,e),typeof r!="function"&&(eo===null?eo=new Set([this]):eo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Ev(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Hj;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=i4.bind(null,t,e,n),e.then(t,t))}function Lv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Tv(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ca(-1,1),e.tag=2,Xa(n,e,1))),n.lanes|=1),t)}var Gj=ma.ReactCurrentOwner,vs=!1;function ns(t,e,n,r){e.child=t===null?Ay(e,null,n,r):fc(e,t.child,n,r)}function zv(t,e,n,r,i){n=n.render;var a=e.ref;return nc(e,i),r=I0(t,e,n,r,a,i),n=E0(),t!==null&&!vs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,fa(t,e,i)):(In&&n&&x0(e),e.flags|=1,ns(t,e,r,i),e.child)}function Ov(t,e,n,r,i){if(t===null){var a=n.type;return typeof a=="function"&&!B0(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,e5(t,e,a,r,i)):(t=Hh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:qu,n(o,r)&&t.ref===e.ref)return fa(t,e,i)}return e.flags|=1,t=no(a,r),t.ref=e.ref,t.return=e,e.child=t}function e5(t,e,n,r,i){if(t!==null){var a=t.memoizedProps;if(qu(a,r)&&t.ref===e.ref)if(vs=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(vs=!0);else return e.lanes=t.lanes,fa(t,e,i)}return ug(t,e,n,r,i)}function t5(t,e,n){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},jn(Jl,Is),Is|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,jn(Jl,Is),Is|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,jn(Jl,Is),Is|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,jn(Jl,Is),Is|=r;return ns(t,e,i,n),e.child}function n5(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ug(t,e,n,r,i){var a=ys(n)?qo:Zr.current;return a=dc(e,a),nc(e,i),n=I0(t,e,n,r,a,i),r=E0(),t!==null&&!vs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,fa(t,e,i)):(In&&r&&x0(e),e.flags|=1,ns(t,e,n,i),e.child)}function Dv(t,e,n,r,i){if(ys(n)){var a=!0;cf(e)}else a=!1;if(nc(e,i),e.stateNode===null)qh(t,e),Yy(e,n,r),lg(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=ei(d):(d=ys(n)?qo:Zr.current,d=dc(e,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Iv(e,o,r,d),$a=!1;var v=e.memoizedState;o.state=v,mf(e,r,o,i),c=e.memoizedState,l!==r||v!==c||xs.current||$a?(typeof f=="function"&&(og(e,n,f,r),c=e.memoizedState),(l=$a||Pv(e,n,l,r,v,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Iy(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:mi(e.type,l),o.props=d,p=e.pendingProps,v=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=ei(c):(c=ys(n)?qo:Zr.current,c=dc(e,c));var m=n.getDerivedStateFromProps;(f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||v!==c)&&Iv(e,o,r,c),$a=!1,v=e.memoizedState,o.state=v,mf(e,r,o,i);var N=e.memoizedState;l!==p||v!==N||xs.current||$a?(typeof m=="function"&&(og(e,n,m,r),N=e.memoizedState),(d=$a||Pv(e,n,d,r,v,N,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,N,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,N,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=N),o.props=r,o.state=N,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),r=!1)}return dg(t,e,n,r,a,i)}function dg(t,e,n,r,i,a){n5(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&wv(e,n,!1),fa(t,e,a);r=e.stateNode,Gj.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=fc(e,t.child,null,a),e.child=fc(e,null,l,a)):ns(t,e,l,a),e.memoizedState=r.state,i&&wv(e,n,!0),e.child}function r5(t){var e=t.stateNode;e.pendingContext?bv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&bv(t,e.context,!1),k0(t,e.containerInfo)}function Mv(t,e,n,r,i){return hc(),b0(i),e.flags|=256,ns(t,e,n,r),e.child}var hg={dehydrated:null,treeContext:null,retryLane:0};function fg(t){return{baseLanes:t,cachePool:null,transitions:null}}function s5(t,e,n){var r=e.pendingProps,i=On.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),jn(On,i&1),t===null)return ig(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Vf(o,r,0,null),t=$o(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=fg(n),e.memoizedState=hg,t):z0(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Wj(t,e,o,r,l,i,n);if(a){a=r.fallback,o=e.mode,i=t.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=no(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=no(l,a):(a=$o(a,o,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=t.child.memoizedState,o=o===null?fg(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~n,e.memoizedState=hg,r}return a=t.child,t=a.sibling,r=no(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function z0(t,e){return e=Vf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fh(t,e,n,r){return r!==null&&b0(r),fc(e,t.child,null,n),t=z0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Wj(t,e,n,r,i,a,o){if(n)return e.flags&256?(e.flags&=-257,r=ap(Error(nt(422))),fh(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=Vf({mode:"visible",children:r.children},i,0,null),a=$o(a,i,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&fc(e,t.child,null,o),e.child.memoizedState=fg(o),e.memoizedState=hg,a);if(!(e.mode&1))return fh(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(nt(419)),r=ap(a,r,void 0),fh(t,e,o,r)}if(l=(o&t.childLanes)!==0,vs||l){if(r=jr,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,ha(t,i),bi(r,t,i,-1))}return $0(),r=ap(Error(nt(421))),fh(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=a4.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,Es=Qa(i.nextSibling),Ts=e,In=!0,xi=null,t!==null&&(Hs[Gs++]=oa,Hs[Gs++]=la,Hs[Gs++]=Uo,oa=t.id,la=t.overflow,Uo=e),e=z0(e,r.children),e.flags|=4096,e)}function Rv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ag(t.return,e,n)}function op(t,e,n,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function i5(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(ns(t,e,r.children,n),r=On.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Rv(t,n,e);else if(t.tag===19)Rv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(jn(On,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&pf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),op(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&pf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}op(e,!0,n,null,a);break;case"together":op(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function qh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fa(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ho|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(nt(153));if(e.child!==null){for(t=e.child,n=no(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=no(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Zj(t,e,n){switch(e.tag){case 3:r5(e),hc();break;case 5:Ey(e);break;case 1:ys(e.type)&&cf(e);break;case 4:k0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;jn(hf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(jn(On,On.current&1),e.flags|=128,null):n&e.child.childLanes?s5(t,e,n):(jn(On,On.current&1),t=fa(t,e,n),t!==null?t.sibling:null);jn(On,On.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return i5(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),jn(On,On.current),r)break;return null;case 22:case 23:return e.lanes=0,t5(t,e,n)}return fa(t,e,n)}var a5,mg,o5,l5;a5=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};mg=function(){};o5=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ro(Ui.current);var a=null;switch(n){case"input":i=Dp(t,i),r=Dp(t,r),a=[];break;case"select":i=Mn({},i,{value:void 0}),r=Mn({},r,{value:void 0}),a=[];break;case"textarea":i=Fp(t,i),r=Fp(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=of)}Bp(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ou.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var c=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ou.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&_n("scroll",t),a||l===c||(a=[])):(a=a||[]).push(d,c))}n&&(a=a||[]).push("style",n);var d=a;(e.updateQueue=d)&&(e.flags|=4)}};l5=function(t,e,n,r){n!==r&&(e.flags|=4)};function ru(t,e){if(!In)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Fr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Jj(t,e,n){var r=e.pendingProps;switch(y0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(e),null;case 1:return ys(e.type)&&lf(),Fr(e),null;case 3:return r=e.stateNode,mc(),An(xs),An(Zr),A0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(dh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xi!==null&&(Ng(xi),xi=null))),mg(t,e),Fr(e),null;case 5:C0(e);var i=Ro(Wu.current);if(n=e.type,t!==null&&e.stateNode!=null)o5(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(nt(166));return Fr(e),null}if(t=Ro(Ui.current),dh(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[$i]=e,r[Hu]=a,t=(e.mode&1)!==0,n){case"dialog":_n("cancel",r),_n("close",r);break;case"iframe":case"object":case"embed":_n("load",r);break;case"video":case"audio":for(i=0;i<mu.length;i++)_n(mu[i],r);break;case"source":_n("error",r);break;case"img":case"image":case"link":_n("error",r),_n("load",r);break;case"details":_n("toggle",r);break;case"input":W1(r,a),_n("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},_n("invalid",r);break;case"textarea":J1(r,a),_n("invalid",r)}Bp(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&uh(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&uh(r.textContent,l,t),i=["children",""+l]):Ou.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&_n("scroll",r)}switch(n){case"input":nh(r),Z1(r,a,!0);break;case"textarea":nh(r),K1(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=of)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=D2(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[$i]=e,t[Hu]=r,a5(t,e,!1,!1),e.stateNode=t;e:{switch(o=qp(n,r),n){case"dialog":_n("cancel",t),_n("close",t),i=r;break;case"iframe":case"object":case"embed":_n("load",t),i=r;break;case"video":case"audio":for(i=0;i<mu.length;i++)_n(mu[i],t);i=r;break;case"source":_n("error",t),i=r;break;case"img":case"image":case"link":_n("error",t),_n("load",t),i=r;break;case"details":_n("toggle",t),i=r;break;case"input":W1(t,r),i=Dp(t,r),_n("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Mn({},r,{value:void 0}),_n("invalid",t);break;case"textarea":J1(t,r),i=Fp(t,r),_n("invalid",t);break;default:i=r}Bp(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?F2(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&M2(t,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Du(t,c):typeof c=="number"&&Du(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ou.hasOwnProperty(a)?c!=null&&a==="onScroll"&&_n("scroll",t):c!=null&&s0(t,a,c,o))}switch(n){case"input":nh(t),Z1(t,r,!1);break;case"textarea":nh(t),K1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ro(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?Ql(t,!!r.multiple,a,!1):r.defaultValue!=null&&Ql(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=of)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Fr(e),null;case 6:if(t&&e.stateNode!=null)l5(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(nt(166));if(n=Ro(Wu.current),Ro(Ui.current),dh(e)){if(r=e.stateNode,n=e.memoizedProps,r[$i]=e,(a=r.nodeValue!==n)&&(t=Ts,t!==null))switch(t.tag){case 3:uh(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&uh(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$i]=e,e.stateNode=r}return Fr(e),null;case 13:if(An(On),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(In&&Es!==null&&e.mode&1&&!(e.flags&128))ky(),hc(),e.flags|=98560,a=!1;else if(a=dh(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(nt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(nt(317));a[$i]=e}else hc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Fr(e),a=!1}else xi!==null&&(Ng(xi),xi=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||On.current&1?gr===0&&(gr=3):$0())),e.updateQueue!==null&&(e.flags|=4),Fr(e),null);case 4:return mc(),mg(t,e),t===null&&Uu(e.stateNode.containerInfo),Fr(e),null;case 10:return j0(e.type._context),Fr(e),null;case 17:return ys(e.type)&&lf(),Fr(e),null;case 19:if(An(On),a=e.memoizedState,a===null)return Fr(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)ru(a,!1);else{if(gr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=pf(t),o!==null){for(e.flags|=128,ru(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return jn(On,On.current&1|2),e.child}t=t.sibling}a.tail!==null&&Kn()>gc&&(e.flags|=128,r=!0,ru(a,!1),e.lanes=4194304)}else{if(!r)if(t=pf(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ru(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!In)return Fr(e),null}else 2*Kn()-a.renderingStartTime>gc&&n!==1073741824&&(e.flags|=128,r=!0,ru(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(n=a.last,n!==null?n.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Kn(),e.sibling=null,n=On.current,jn(On,r?n&1|2:n&1),e):(Fr(e),null);case 22:case 23:return F0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Is&1073741824&&(Fr(e),e.subtreeFlags&6&&(e.flags|=8192)):Fr(e),null;case 24:return null;case 25:return null}throw Error(nt(156,e.tag))}function Kj(t,e){switch(y0(e),e.tag){case 1:return ys(e.type)&&lf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mc(),An(xs),An(Zr),A0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return C0(e),null;case 13:if(An(On),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(nt(340));hc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return An(On),null;case 4:return mc(),null;case 10:return j0(e.type._context),null;case 22:case 23:return F0(),null;case 24:return null;default:return null}}var mh=!1,Hr=!1,Yj=typeof WeakSet=="function"?WeakSet:Set,mt=null;function Zl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Un(t,e,r)}else n.current=null}function pg(t,e,n){try{n()}catch(r){Un(t,e,r)}}var Fv=!1;function Qj(t,e){if(Qp=rf,t=fy(),v0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,p=t,v=null;t:for(;;){for(var m;p!==n||i!==0&&p.nodeType!==3||(l=o+i),p!==a||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(m=p.firstChild)!==null;)v=p,p=m;for(;;){if(p===t)break t;if(v===n&&++d===i&&(l=o),v===a&&++f===r&&(c=o),(m=p.nextSibling)!==null)break;p=v,v=p.parentNode}p=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xp={focusedElem:t,selectionRange:n},rf=!1,mt=e;mt!==null;)if(e=mt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,mt=t;else for(;mt!==null;){e=mt;try{var N=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var _=N.memoizedProps,k=N.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?_:mi(e.type,_),k);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var j=e.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(nt(163))}}catch(C){Un(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,mt=t;break}mt=e.return}return N=Fv,Fv=!1,N}function ku(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&pg(e,n,a)}i=i.next}while(i!==r)}}function qf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function c5(t){var e=t.alternate;e!==null&&(t.alternate=null,c5(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$i],delete e[Hu],delete e[ng],delete e[zj],delete e[Oj])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function u5(t){return t.tag===5||t.tag===3||t.tag===4}function $v(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||u5(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=of));else if(r!==4&&(t=t.child,t!==null))for(vg(t,e,n),t=t.sibling;t!==null;)vg(t,e,n),t=t.sibling}function xg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(xg(t,e,n),t=t.sibling;t!==null;)xg(t,e,n),t=t.sibling}var Ir=null,gi=!1;function Ta(t,e,n){for(n=n.child;n!==null;)d5(t,e,n),n=n.sibling}function d5(t,e,n){if(qi&&typeof qi.onCommitFiberUnmount=="function")try{qi.onCommitFiberUnmount(zf,n)}catch{}switch(n.tag){case 5:Hr||Zl(n,e);case 6:var r=Ir,i=gi;Ir=null,Ta(t,e,n),Ir=r,gi=i,Ir!==null&&(gi?(t=Ir,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ir.removeChild(n.stateNode));break;case 18:Ir!==null&&(gi?(t=Ir,n=n.stateNode,t.nodeType===8?ep(t.parentNode,n):t.nodeType===1&&ep(t,n),$u(t)):ep(Ir,n.stateNode));break;case 4:r=Ir,i=gi,Ir=n.stateNode.containerInfo,gi=!0,Ta(t,e,n),Ir=r,gi=i;break;case 0:case 11:case 14:case 15:if(!Hr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&pg(n,e,o),i=i.next}while(i!==r)}Ta(t,e,n);break;case 1:if(!Hr&&(Zl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Un(n,e,l)}Ta(t,e,n);break;case 21:Ta(t,e,n);break;case 22:n.mode&1?(Hr=(r=Hr)||n.memoizedState!==null,Ta(t,e,n),Hr=r):Ta(t,e,n);break;default:Ta(t,e,n)}}function Bv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Yj),e.forEach(function(r){var i=o4.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ui(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ir=l.stateNode,gi=!1;break e;case 3:Ir=l.stateNode.containerInfo,gi=!0;break e;case 4:Ir=l.stateNode.containerInfo,gi=!0;break e}l=l.return}if(Ir===null)throw Error(nt(160));d5(a,o,i),Ir=null,gi=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Un(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)h5(e,t),e=e.sibling}function h5(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ui(e,t),zi(t),r&4){try{ku(3,t,t.return),qf(3,t)}catch(_){Un(t,t.return,_)}try{ku(5,t,t.return)}catch(_){Un(t,t.return,_)}}break;case 1:ui(e,t),zi(t),r&512&&n!==null&&Zl(n,n.return);break;case 5:if(ui(e,t),zi(t),r&512&&n!==null&&Zl(n,n.return),t.flags&32){var i=t.stateNode;try{Du(i,"")}catch(_){Un(t,t.return,_)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,o=n!==null?n.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&z2(i,a),qp(l,o);var d=qp(l,a);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?F2(i,p):f==="dangerouslySetInnerHTML"?M2(i,p):f==="children"?Du(i,p):s0(i,f,p,d)}switch(l){case"input":Mp(i,a);break;case"textarea":O2(i,a);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Ql(i,!!a.multiple,m,!1):v!==!!a.multiple&&(a.defaultValue!=null?Ql(i,!!a.multiple,a.defaultValue,!0):Ql(i,!!a.multiple,a.multiple?[]:"",!1))}i[Hu]=a}catch(_){Un(t,t.return,_)}}break;case 6:if(ui(e,t),zi(t),r&4){if(t.stateNode===null)throw Error(nt(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(_){Un(t,t.return,_)}}break;case 3:if(ui(e,t),zi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$u(e.containerInfo)}catch(_){Un(t,t.return,_)}break;case 4:ui(e,t),zi(t);break;case 13:ui(e,t),zi(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(M0=Kn())),r&4&&Bv(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Hr=(d=Hr)||f,ui(e,t),Hr=d):ui(e,t),zi(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(mt=t,f=t.child;f!==null;){for(p=mt=f;mt!==null;){switch(v=mt,m=v.child,v.tag){case 0:case 11:case 14:case 15:ku(4,v,v.return);break;case 1:Zl(v,v.return);var N=v.stateNode;if(typeof N.componentWillUnmount=="function"){r=v,n=v.return;try{e=r,N.props=e.memoizedProps,N.state=e.memoizedState,N.componentWillUnmount()}catch(_){Un(r,n,_)}}break;case 5:Zl(v,v.return);break;case 22:if(v.memoizedState!==null){Uv(p);continue}}m!==null?(m.return=v,mt=m):Uv(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,d?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=R2("display",o))}catch(_){Un(t,t.return,_)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(_){Un(t,t.return,_)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ui(e,t),zi(t),r&4&&Bv(t);break;case 21:break;default:ui(e,t),zi(t)}}function zi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(u5(n)){var r=n;break e}n=n.return}throw Error(nt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Du(i,""),r.flags&=-33);var a=$v(t);xg(t,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=$v(t);vg(t,l,o);break;default:throw Error(nt(161))}}catch(c){Un(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Xj(t,e,n){mt=t,f5(t)}function f5(t,e,n){for(var r=(t.mode&1)!==0;mt!==null;){var i=mt,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||mh;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Hr;l=mh;var d=Hr;if(mh=o,(Hr=c)&&!d)for(mt=i;mt!==null;)o=mt,c=o.child,o.tag===22&&o.memoizedState!==null?Vv(i):c!==null?(c.return=o,mt=c):Vv(i);for(;a!==null;)mt=a,f5(a),a=a.sibling;mt=i,mh=l,Hr=d}qv(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,mt=a):qv(t)}}function qv(t){for(;mt!==null;){var e=mt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Hr||qf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Hr)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:mi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&kv(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}kv(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&$u(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(nt(163))}Hr||e.flags&512&&gg(e)}catch(v){Un(e,e.return,v)}}if(e===t){mt=null;break}if(n=e.sibling,n!==null){n.return=e.return,mt=n;break}mt=e.return}}function Uv(t){for(;mt!==null;){var e=mt;if(e===t){mt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,mt=n;break}mt=e.return}}function Vv(t){for(;mt!==null;){var e=mt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{qf(4,e)}catch(c){Un(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Un(e,i,c)}}var a=e.return;try{gg(e)}catch(c){Un(e,a,c)}break;case 5:var o=e.return;try{gg(e)}catch(c){Un(e,o,c)}}}catch(c){Un(e,e.return,c)}if(e===t){mt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,mt=l;break}mt=e.return}}var e4=Math.ceil,xf=ma.ReactCurrentDispatcher,O0=ma.ReactCurrentOwner,Ks=ma.ReactCurrentBatchConfig,nn=0,jr=null,or=null,Lr=0,Is=0,Jl=co(0),gr=0,Yu=null,Ho=0,Uf=0,D0=0,Cu=null,fs=null,M0=0,gc=1/0,sa=null,yf=!1,yg=null,eo=null,ph=!1,Ha=null,bf=0,Au=0,bg=null,Uh=-1,Vh=0;function ss(){return nn&6?Kn():Uh!==-1?Uh:Uh=Kn()}function to(t){return t.mode&1?nn&2&&Lr!==0?Lr&-Lr:Mj.transition!==null?(Vh===0&&(Vh=Y2()),Vh):(t=hn,t!==0||(t=window.event,t=t===void 0?16:sy(t.type)),t):1}function bi(t,e,n,r){if(50<Au)throw Au=0,bg=null,Error(nt(185));ld(t,n,r),(!(nn&2)||t!==jr)&&(t===jr&&(!(nn&2)&&(Uf|=n),gr===4&&qa(t,Lr)),bs(t,r),n===1&&nn===0&&!(e.mode&1)&&(gc=Kn()+500,Ff&&uo()))}function bs(t,e){var n=t.callbackNode;MN(t,e);var r=nf(t,t===jr?Lr:0);if(r===0)n!==null&&X1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&X1(n),e===1)t.tag===0?Dj(Hv.bind(null,t)):jy(Hv.bind(null,t)),Lj(function(){!(nn&6)&&uo()}),n=null;else{switch(Q2(r)){case 1:n=c0;break;case 4:n=J2;break;case 16:n=tf;break;case 536870912:n=K2;break;default:n=tf}n=w5(n,m5.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function m5(t,e){if(Uh=-1,Vh=0,nn&6)throw Error(nt(327));var n=t.callbackNode;if(rc()&&t.callbackNode!==n)return null;var r=nf(t,t===jr?Lr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=wf(t,r);else{e=r;var i=nn;nn|=2;var a=g5();(jr!==t||Lr!==e)&&(sa=null,gc=Kn()+500,Fo(t,e));do try{r4();break}catch(l){p5(t,l)}while(1);N0(),xf.current=a,nn=i,or!==null?e=0:(jr=null,Lr=0,e=gr)}if(e!==0){if(e===2&&(i=Wp(t),i!==0&&(r=i,e=wg(t,i))),e===1)throw n=Yu,Fo(t,0),qa(t,r),bs(t,Kn()),n;if(e===6)qa(t,r);else{if(i=t.current.alternate,!(r&30)&&!t4(i)&&(e=wf(t,r),e===2&&(a=Wp(t),a!==0&&(r=a,e=wg(t,a))),e===1))throw n=Yu,Fo(t,0),qa(t,r),bs(t,Kn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(nt(345));case 2:Eo(t,fs,sa);break;case 3:if(qa(t,r),(r&130023424)===r&&(e=M0+500-Kn(),10<e)){if(nf(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){ss(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=tg(Eo.bind(null,t,fs,sa),e);break}Eo(t,fs,sa);break;case 4:if(qa(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-yi(r);a=1<<o,o=e[o],o>i&&(i=o),r&=~a}if(r=i,r=Kn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*e4(r/1960))-r,10<r){t.timeoutHandle=tg(Eo.bind(null,t,fs,sa),r);break}Eo(t,fs,sa);break;case 5:Eo(t,fs,sa);break;default:throw Error(nt(329))}}}return bs(t,Kn()),t.callbackNode===n?m5.bind(null,t):null}function wg(t,e){var n=Cu;return t.current.memoizedState.isDehydrated&&(Fo(t,e).flags|=256),t=wf(t,e),t!==2&&(e=fs,fs=n,e!==null&&Ng(e)),t}function Ng(t){fs===null?fs=t:fs.push.apply(fs,t)}function t4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Ni(a(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qa(t,e){for(e&=~D0,e&=~Uf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-yi(e),r=1<<n;t[n]=-1,e&=~r}}function Hv(t){if(nn&6)throw Error(nt(327));rc();var e=nf(t,0);if(!(e&1))return bs(t,Kn()),null;var n=wf(t,e);if(t.tag!==0&&n===2){var r=Wp(t);r!==0&&(e=r,n=wg(t,r))}if(n===1)throw n=Yu,Fo(t,0),qa(t,e),bs(t,Kn()),n;if(n===6)throw Error(nt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Eo(t,fs,sa),bs(t,Kn()),null}function R0(t,e){var n=nn;nn|=1;try{return t(e)}finally{nn=n,nn===0&&(gc=Kn()+500,Ff&&uo())}}function Go(t){Ha!==null&&Ha.tag===0&&!(nn&6)&&rc();var e=nn;nn|=1;var n=Ks.transition,r=hn;try{if(Ks.transition=null,hn=1,t)return t()}finally{hn=r,Ks.transition=n,nn=e,!(nn&6)&&uo()}}function F0(){Is=Jl.current,An(Jl)}function Fo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ej(n)),or!==null)for(n=or.return;n!==null;){var r=n;switch(y0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&lf();break;case 3:mc(),An(xs),An(Zr),A0();break;case 5:C0(r);break;case 4:mc();break;case 13:An(On);break;case 19:An(On);break;case 10:j0(r.type._context);break;case 22:case 23:F0()}n=n.return}if(jr=t,or=t=no(t.current,null),Lr=Is=e,gr=0,Yu=null,D0=Uf=Ho=0,fs=Cu=null,Mo!==null){for(e=0;e<Mo.length;e++)if(n=Mo[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}Mo=null}return t}function p5(t,e){do{var n=or;try{if(N0(),$h.current=vf,gf){for(var r=Dn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}gf=!1}if(Vo=0,wr=mr=Dn=null,_u=!1,Zu=0,O0.current=null,n===null||n.return===null){gr=1,Yu=e,or=null;break}e:{var a=t,o=n.return,l=n,c=e;if(e=Lr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var v=f.alternate;v?(f.updateQueue=v.updateQueue,f.memoizedState=v.memoizedState,f.lanes=v.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Lv(o);if(m!==null){m.flags&=-257,Tv(m,o,l,a,e),m.mode&1&&Ev(a,d,e),e=m,c=d;var N=e.updateQueue;if(N===null){var _=new Set;_.add(c),e.updateQueue=_}else N.add(c);break e}else{if(!(e&1)){Ev(a,d,e),$0();break e}c=Error(nt(426))}}else if(In&&l.mode&1){var k=Lv(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Tv(k,o,l,a,e),b0(pc(c,l));break e}}a=c=pc(c,l),gr!==4&&(gr=2),Cu===null?Cu=[a]:Cu.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var y=Qy(a,c,e);_v(a,y);break e;case 1:l=c;var b=a.type,j=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(eo===null||!eo.has(j)))){a.flags|=65536,e&=-e,a.lanes|=e;var C=Xy(a,l,e);_v(a,C);break e}}a=a.return}while(a!==null)}x5(n)}catch(B){e=B,or===n&&n!==null&&(or=n=n.return);continue}break}while(1)}function g5(){var t=xf.current;return xf.current=vf,t===null?vf:t}function $0(){(gr===0||gr===3||gr===2)&&(gr=4),jr===null||!(Ho&268435455)&&!(Uf&268435455)||qa(jr,Lr)}function wf(t,e){var n=nn;nn|=2;var r=g5();(jr!==t||Lr!==e)&&(sa=null,Fo(t,e));do try{n4();break}catch(i){p5(t,i)}while(1);if(N0(),nn=n,xf.current=r,or!==null)throw Error(nt(261));return jr=null,Lr=0,gr}function n4(){for(;or!==null;)v5(or)}function r4(){for(;or!==null&&!AN();)v5(or)}function v5(t){var e=b5(t.alternate,t,Is);t.memoizedProps=t.pendingProps,e===null?x5(t):or=e,O0.current=null}function x5(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Kj(n,e),n!==null){n.flags&=32767,or=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{gr=6,or=null;return}}else if(n=Jj(n,e,Is),n!==null){or=n;return}if(e=e.sibling,e!==null){or=e;return}or=e=t}while(e!==null);gr===0&&(gr=5)}function Eo(t,e,n){var r=hn,i=Ks.transition;try{Ks.transition=null,hn=1,s4(t,e,n,r)}finally{Ks.transition=i,hn=r}return null}function s4(t,e,n,r){do rc();while(Ha!==null);if(nn&6)throw Error(nt(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(nt(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(RN(t,a),t===jr&&(or=jr=null,Lr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ph||(ph=!0,w5(tf,function(){return rc(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Ks.transition,Ks.transition=null;var o=hn;hn=1;var l=nn;nn|=4,O0.current=null,Qj(t,n),h5(n,t),Sj(Xp),rf=!!Qp,Xp=Qp=null,t.current=n,Xj(n),PN(),nn=l,hn=o,Ks.transition=a}else t.current=n;if(ph&&(ph=!1,Ha=t,bf=i),a=t.pendingLanes,a===0&&(eo=null),LN(n.stateNode),bs(t,Kn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(yf)throw yf=!1,t=yg,yg=null,t;return bf&1&&t.tag!==0&&rc(),a=t.pendingLanes,a&1?t===bg?Au++:(Au=0,bg=t):Au=0,uo(),null}function rc(){if(Ha!==null){var t=Q2(bf),e=Ks.transition,n=hn;try{if(Ks.transition=null,hn=16>t?16:t,Ha===null)var r=!1;else{if(t=Ha,Ha=null,bf=0,nn&6)throw Error(nt(331));var i=nn;for(nn|=4,mt=t.current;mt!==null;){var a=mt,o=a.child;if(mt.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(mt=d;mt!==null;){var f=mt;switch(f.tag){case 0:case 11:case 15:ku(8,f,a)}var p=f.child;if(p!==null)p.return=f,mt=p;else for(;mt!==null;){f=mt;var v=f.sibling,m=f.return;if(c5(f),f===d){mt=null;break}if(v!==null){v.return=m,mt=v;break}mt=m}}}var N=a.alternate;if(N!==null){var _=N.child;if(_!==null){N.child=null;do{var k=_.sibling;_.sibling=null,_=k}while(_!==null)}}mt=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,mt=o;else e:for(;mt!==null;){if(a=mt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ku(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,mt=y;break e}mt=a.return}}var b=t.current;for(mt=b;mt!==null;){o=mt;var j=o.child;if(o.subtreeFlags&2064&&j!==null)j.return=o,mt=j;else e:for(o=b;mt!==null;){if(l=mt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:qf(9,l)}}catch(B){Un(l,l.return,B)}if(l===o){mt=null;break e}var C=l.sibling;if(C!==null){C.return=l.return,mt=C;break e}mt=l.return}}if(nn=i,uo(),qi&&typeof qi.onPostCommitFiberRoot=="function")try{qi.onPostCommitFiberRoot(zf,t)}catch{}r=!0}return r}finally{hn=n,Ks.transition=e}}return!1}function Gv(t,e,n){e=pc(n,e),e=Qy(t,e,1),t=Xa(t,e,1),e=ss(),t!==null&&(ld(t,1,e),bs(t,e))}function Un(t,e,n){if(t.tag===3)Gv(t,t,n);else for(;e!==null;){if(e.tag===3){Gv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(eo===null||!eo.has(r))){t=pc(n,t),t=Xy(e,t,1),e=Xa(e,t,1),t=ss(),e!==null&&(ld(e,1,t),bs(e,t));break}}e=e.return}}function i4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ss(),t.pingedLanes|=t.suspendedLanes&n,jr===t&&(Lr&n)===n&&(gr===4||gr===3&&(Lr&130023424)===Lr&&500>Kn()-M0?Fo(t,0):D0|=n),bs(t,e)}function y5(t,e){e===0&&(t.mode&1?(e=ih,ih<<=1,!(ih&130023424)&&(ih=4194304)):e=1);var n=ss();t=ha(t,e),t!==null&&(ld(t,e,n),bs(t,n))}function a4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),y5(t,n)}function o4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(nt(314))}r!==null&&r.delete(e),y5(t,n)}var b5;b5=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||xs.current)vs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return vs=!1,Zj(t,e,n);vs=!!(t.flags&131072)}else vs=!1,In&&e.flags&1048576&&Sy(e,df,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;qh(t,e),t=e.pendingProps;var i=dc(e,Zr.current);nc(e,n),i=I0(null,e,r,t,i,n);var a=E0();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ys(r)?(a=!0,cf(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_0(e),i.updater=Bf,e.stateNode=i,i._reactInternals=e,lg(e,r,t,n),e=dg(null,e,r,!0,a,n)):(e.tag=0,In&&a&&x0(e),ns(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(qh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=c4(r),t=mi(r,t),i){case 0:e=ug(null,e,r,t,n);break e;case 1:e=Dv(null,e,r,t,n);break e;case 11:e=zv(null,e,r,t,n);break e;case 14:e=Ov(null,e,r,mi(r.type,t),n);break e}throw Error(nt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mi(r,i),ug(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mi(r,i),Dv(t,e,r,i,n);case 3:e:{if(r5(e),t===null)throw Error(nt(387));r=e.pendingProps,a=e.memoizedState,i=a.element,Iy(t,e),mf(e,r,null,n);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=pc(Error(nt(423)),e),e=Mv(t,e,r,n,i);break e}else if(r!==i){i=pc(Error(nt(424)),e),e=Mv(t,e,r,n,i);break e}else for(Es=Qa(e.stateNode.containerInfo.firstChild),Ts=e,In=!0,xi=null,n=Ay(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hc(),r===i){e=fa(t,e,n);break e}ns(t,e,r,n)}e=e.child}return e;case 5:return Ey(e),t===null&&ig(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,o=i.children,eg(r,i)?o=null:a!==null&&eg(r,a)&&(e.flags|=32),n5(t,e),ns(t,e,o,n),e.child;case 6:return t===null&&ig(e),null;case 13:return s5(t,e,n);case 4:return k0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=fc(e,null,r,n):ns(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mi(r,i),zv(t,e,r,i,n);case 7:return ns(t,e,e.pendingProps,n),e.child;case 8:return ns(t,e,e.pendingProps.children,n),e.child;case 12:return ns(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,o=i.value,jn(hf,r._currentValue),r._currentValue=o,a!==null)if(Ni(a.value,o)){if(a.children===i.children&&!xs.current){e=fa(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=ca(-1,n&-n),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),ag(a.return,n,e),l.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(nt(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ag(o,n,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}ns(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,nc(e,n),i=ei(i),r=r(i),e.flags|=1,ns(t,e,r,n),e.child;case 14:return r=e.type,i=mi(r,e.pendingProps),i=mi(r.type,i),Ov(t,e,r,i,n);case 15:return e5(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mi(r,i),qh(t,e),e.tag=1,ys(r)?(t=!0,cf(e)):t=!1,nc(e,n),Yy(e,r,i),lg(e,r,i,n),dg(null,e,r,!0,t,n);case 19:return i5(t,e,n);case 22:return t5(t,e,n)}throw Error(nt(156,e.tag))};function w5(t,e){return Z2(t,e)}function l4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Js(t,e,n,r){return new l4(t,e,n,r)}function B0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function c4(t){if(typeof t=="function")return B0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===a0)return 11;if(t===o0)return 14}return 2}function no(t,e){var n=t.alternate;return n===null?(n=Js(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Hh(t,e,n,r,i,a){var o=2;if(r=t,typeof t=="function")B0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Fl:return $o(n.children,i,a,e);case i0:o=8,i|=8;break;case Lp:return t=Js(12,n,e,i|2),t.elementType=Lp,t.lanes=a,t;case Tp:return t=Js(13,n,e,i),t.elementType=Tp,t.lanes=a,t;case zp:return t=Js(19,n,e,i),t.elementType=zp,t.lanes=a,t;case E2:return Vf(n,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case P2:o=10;break e;case I2:o=9;break e;case a0:o=11;break e;case o0:o=14;break e;case Fa:o=16,r=null;break e}throw Error(nt(130,t==null?t:typeof t,""))}return e=Js(o,n,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function $o(t,e,n,r){return t=Js(7,t,r,e),t.lanes=n,t}function Vf(t,e,n,r){return t=Js(22,t,r,e),t.elementType=E2,t.lanes=n,t.stateNode={isHidden:!1},t}function lp(t,e,n){return t=Js(6,t,null,e),t.lanes=n,t}function cp(t,e,n){return e=Js(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function u4(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Um(0),this.expirationTimes=Um(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Um(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function q0(t,e,n,r,i,a,o,l,c){return t=new u4(t,e,n,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Js(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_0(a),t}function d4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function N5(t){if(!t)return so;t=t._reactInternals;e:{if(Qo(t)!==t||t.tag!==1)throw Error(nt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ys(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(nt(171))}if(t.tag===1){var n=t.type;if(ys(n))return Ny(t,n,e)}return e}function j5(t,e,n,r,i,a,o,l,c){return t=q0(n,r,!0,t,i,a,o,l,c),t.context=N5(null),n=t.current,r=ss(),i=to(n),a=ca(r,i),a.callback=e??null,Xa(n,a,i),t.current.lanes=i,ld(t,i,r),bs(t,r),t}function Hf(t,e,n,r){var i=e.current,a=ss(),o=to(i);return n=N5(n),e.context===null?e.context=n:e.pendingContext=n,e=ca(a,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xa(i,e,o),t!==null&&(bi(t,i,o,a),Fh(t,i,o)),o}function Nf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Wv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function U0(t,e){Wv(t,e),(t=t.alternate)&&Wv(t,e)}function h4(){return null}var S5=typeof reportError=="function"?reportError:function(t){console.error(t)};function V0(t){this._internalRoot=t}Gf.prototype.render=V0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(nt(409));Hf(t,e,null,null)};Gf.prototype.unmount=V0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Go(function(){Hf(null,t,null,null)}),e[da]=null}};function Gf(t){this._internalRoot=t}Gf.prototype.unstable_scheduleHydration=function(t){if(t){var e=ty();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ba.length&&e!==0&&e<Ba[n].priority;n++);Ba.splice(n,0,t),n===0&&ry(t)}};function H0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Wf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Zv(){}function f4(t,e,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var d=Nf(o);a.call(d)}}var o=j5(e,r,t,0,null,!1,!1,"",Zv);return t._reactRootContainer=o,t[da]=o.current,Uu(t.nodeType===8?t.parentNode:t),Go(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=Nf(c);l.call(d)}}var c=q0(t,0,!1,null,null,!1,!1,"",Zv);return t._reactRootContainer=c,t[da]=c.current,Uu(t.nodeType===8?t.parentNode:t),Go(function(){Hf(e,c,n,r)}),c}function Zf(t,e,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var c=Nf(o);l.call(c)}}Hf(e,o,t,i)}else o=f4(n,e,t,i,r);return Nf(o)}X2=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=fu(e.pendingLanes);n!==0&&(u0(e,n|1),bs(e,Kn()),!(nn&6)&&(gc=Kn()+500,uo()))}break;case 13:Go(function(){var r=ha(t,1);if(r!==null){var i=ss();bi(r,t,1,i)}}),U0(t,1)}};d0=function(t){if(t.tag===13){var e=ha(t,134217728);if(e!==null){var n=ss();bi(e,t,134217728,n)}U0(t,134217728)}};ey=function(t){if(t.tag===13){var e=to(t),n=ha(t,e);if(n!==null){var r=ss();bi(n,t,e,r)}U0(t,e)}};ty=function(){return hn};ny=function(t,e){var n=hn;try{return hn=t,e()}finally{hn=n}};Vp=function(t,e,n){switch(e){case"input":if(Mp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Rf(r);if(!i)throw Error(nt(90));T2(r),Mp(r,i)}}}break;case"textarea":O2(t,n);break;case"select":e=n.value,e!=null&&Ql(t,!!n.multiple,e,!1)}};q2=R0;U2=Go;var m4={usingClientEntryPoint:!1,Events:[ud,Ul,Rf,$2,B2,R0]},su={findFiberByHostInstance:Do,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},p4={bundleType:su.bundleType,version:su.version,rendererPackageName:su.rendererPackageName,rendererConfig:su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ma.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=G2(t),t===null?null:t.stateNode},findFiberByHostInstance:su.findFiberByHostInstance||h4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gh.isDisabled&&gh.supportsFiber)try{zf=gh.inject(p4),qi=gh}catch{}}Os.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m4;Os.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!H0(e))throw Error(nt(200));return d4(t,e,null,n)};Os.createRoot=function(t,e){if(!H0(t))throw Error(nt(299));var n=!1,r="",i=S5;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=q0(t,1,!1,null,null,n,!1,r,i),t[da]=e.current,Uu(t.nodeType===8?t.parentNode:t),new V0(e)};Os.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(nt(188)):(t=Object.keys(t).join(","),Error(nt(268,t)));return t=G2(e),t=t===null?null:t.stateNode,t};Os.flushSync=function(t){return Go(t)};Os.hydrate=function(t,e,n){if(!Wf(e))throw Error(nt(200));return Zf(null,t,e,!0,n)};Os.hydrateRoot=function(t,e,n){if(!H0(t))throw Error(nt(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=S5;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=j5(e,null,t,1,n??null,i,!1,a,o),t[da]=e.current,Uu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Gf(e)};Os.render=function(t,e,n){if(!Wf(e))throw Error(nt(200));return Zf(null,t,e,!1,n)};Os.unmountComponentAtNode=function(t){if(!Wf(t))throw Error(nt(40));return t._reactRootContainer?(Go(function(){Zf(null,null,t,!1,function(){t._reactRootContainer=null,t[da]=null})}),!0):!1};Os.unstable_batchedUpdates=R0;Os.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Wf(n))throw Error(nt(200));if(t==null||t._reactInternals===void 0)throw Error(nt(38));return Zf(t,e,n,!1,r)};Os.version="18.3.1-next-f1338f8080-20240426";function _5(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_5)}catch(t){console.error(t)}}_5(),_2.exports=Os;var g4=_2.exports,Jv=g4;Ip.createRoot=Jv.createRoot,Ip.hydrateRoot=Jv.hydrateRoot;var v4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const x4=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),y4=(t,e)=>{const n=q.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,children:l,...c},d)=>q.createElement("svg",{ref:d,...v4,width:i,height:i,stroke:r,strokeWidth:o?Number(a)*24/Number(i):a,className:`lucide lucide-${x4(t)}`,...c},[...e.map(([f,p])=>q.createElement(f,p)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n};var lt=y4;const b4=lt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),w4=lt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),pn=lt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Kv=lt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]]),N4=lt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),j4=lt("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),k5=lt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Wo=lt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),jf=lt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Ga=lt("Bot",[["rect",{width:"18",height:"10",x:"3",y:"11",rx:"2",key:"1ofdy3"}],["circle",{cx:"12",cy:"5",r:"2",key:"f1ur92"}],["path",{d:"M12 7v4",key:"xawao1"}],["line",{x1:"8",x2:"8",y1:"16",y2:"16",key:"h6x27f"}],["line",{x1:"16",x2:"16",y1:"16",y2:"16",key:"5lty7f"}]]),Wa=lt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),S4=lt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),C5=lt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),kn=lt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Yv=lt("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),vh=lt("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),_4=lt("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]),G0=lt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),A5=lt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),P5=lt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),Qu=lt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),k4=lt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Ys=lt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),C4=lt("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),A4=lt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),jg=lt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),P4=lt("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),I4=lt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),I5=lt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Qv=lt("FolderPlus",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["line",{x1:"12",x2:"12",y1:"10",y2:"16",key:"3c25pp"}],["line",{x1:"9",x2:"15",y1:"13",y2:"13",key:"10hoct"}]]),Oi=lt("Folder",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}]]),E4=lt("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),pu=lt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),W0=lt("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ll=lt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Qs=lt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),L4=lt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),T4=lt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),z4=lt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),O4=lt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),D4=lt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),E5=lt("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),Sf=lt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),M4=lt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),R4=lt("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]),Vn=lt("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),F4=lt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),wi=lt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),$4=lt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),pr=lt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),gu=lt("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),Gh=lt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),L5=lt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),B4=lt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Xv=lt("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]),Tl=lt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),T5=lt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Wr=lt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ex=lt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),q4=lt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),U4=lt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),V4=lt("Snowflake",[["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"m20 16-4-4 4-4",key:"rquw4f"}],["path",{d:"m4 8 4 4-4 4",key:"12s3z9"}],["path",{d:"m16 4-4 4-4-4",key:"1tumq1"}],["path",{d:"m8 20 4-4 4 4",key:"9p200w"}]]),hd=lt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),tx=lt("StickyNote",[["path",{d:"M15.5 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V8.5L15.5 3Z",key:"1wis1t"}],["path",{d:"M15 3v6h6",key:"edgan2"}]]),xh=lt("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),ws=lt("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),H4=lt("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]),G4=lt("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),er=lt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Pu=lt("Truck",[["path",{d:"M10 17h4V5H2v12h3",key:"1jq12e"}],["path",{d:"M20 17h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5",key:"1xb3ft"}],["path",{d:"M14 17h1",key:"nufu4t"}],["circle",{cx:"7.5",cy:"17.5",r:"2.5",key:"a7aife"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),Iu=lt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),z5=lt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Er=lt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),nx=lt("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),O5=lt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),un=lt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),W4=lt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function ot({className:t,...e}){return s.jsx("div",{className:`rounded-lg border bg-white text-card-foreground shadow-sm ${t}`,...e})}function Ut({className:t,...e}){return s.jsx("div",{className:`flex flex-col space-y-1.5 p-6 ${t}`,...e})}function Gt({className:t,...e}){return s.jsx("h3",{className:`text-2xl font-semibold leading-none tracking-tight ${t}`,...e})}function et({className:t,...e}){return s.jsx("div",{className:`p-6 pt-0 ${t}`,...e})}const Z4={default:"bg-primary-500 text-white hover:bg-primary-600",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-gray-300 bg-white hover:bg-gray-50",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100",link:"text-primary-500 underline-offset-4 hover:underline"},J4={default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-8",icon:"h-10 w-10"};function le({className:t,variant:e="default",size:n="default",asChild:r=!1,...i}){const a=r?"span":"button";return s.jsx(a,{className:`
        inline-flex items-center justify-center rounded-md text-sm font-medium
        ring-offset-background transition-colors focus-visible:outline-none
        focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2
        disabled:pointer-events-none disabled:opacity-50
        ${Z4[e]}
        ${J4[n]}
        ${t}
      `,...i})}function an({title:t,icon:e,children:n,defaultExpanded:r=!1,className:i="",headerClassName:a="",contentClassName:o="",onToggle:l=null}){const[c,d]=q.useState(r),f=()=>{const p=!c;d(p),l&&l(p)};return s.jsxs(ot,{className:`transition-all duration-200 ${i}`,children:[s.jsx(Ut,{className:`cursor-pointer hover:bg-gray-50 transition-colors ${a}`,onClick:f,children:s.jsxs(Gt,{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[e&&s.jsx(e,{className:"h-5 w-5"}),s.jsx("span",{children:t})]}),s.jsx(le,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-gray-200",onClick:p=>{p.stopPropagation(),f()},children:c?s.jsx(A5,{className:"h-4 w-4"}):s.jsx(G0,{className:"h-4 w-4"})})]})}),c&&s.jsx(et,{className:`transition-all duration-200 ${o}`,children:n})]})}function K4({temperatures:t=[],cleaning:e=[],staff:n=[],products:r=[],currentUser:i}){const a=t.filter(c=>c.status==="ok").length,o=t.filter(c=>c.status==="danger").length,l=e.filter(c=>!c.completed).length;return s.jsxs("div",{className:"space-y-6",children:[s.jsx(an,{title:"Statistiche Principali",icon:Wo,defaultExpanded:!0,children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsx(ot,{children:s.jsx(et,{className:"p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(kn,{className:"h-8 w-8 text-green-600"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-2xl font-bold text-green-600",children:a}),s.jsx("p",{className:"text-sm text-gray-600",children:"Temperature OK"})]})]})})}),s.jsx(ot,{children:s.jsx(et,{className:"p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(pn,{className:"h-8 w-8 text-red-600"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-2xl font-bold text-red-600",children:o}),s.jsx("p",{className:"text-sm text-gray-600",children:"Problemi Temp."})]})]})})}),s.jsx(ot,{children:s.jsx(et,{className:"p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Vn,{className:"h-8 w-8 text-blue-600"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l}),s.jsx("p",{className:"text-sm text-gray-600",children:"Pulizie Pending"})]})]})})}),s.jsx(ot,{children:s.jsx(et,{className:"p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(S4,{className:"h-8 w-8 text-purple-600"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:r.length}),s.jsx("p",{className:"text-sm text-gray-600",children:"Prodotti"})]})]})})})]})}),s.jsxs(an,{title:`Benvenuto, ${i==null?void 0:i.name}!`,icon:z5,defaultExpanded:!0,children:[s.jsx("p",{className:"text-gray-600",children:"Dashboard Business HACCP Manager"}),s.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Ruolo: ",(i==null?void 0:i.role)==="admin"?"Amministratore":"Dipendente","  Reparto: ",i==null?void 0:i.department]}),(()=>{const c=localStorage.getItem("haccp-onboarding");if(!c||c==="[object Object]")return null;let d={};try{d=JSON.parse(c)}catch(f){return console.error("Errore parsing onboarding data:",f),null}return d.businessInfo?s.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Informazioni Azienda"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[d.businessInfo.businessName&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Nome Azienda:"}),s.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.businessName})]}),d.businessInfo.businessType&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Tipo Attivit:"}),s.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.businessType})]}),d.businessInfo.address&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Indirizzo:"}),s.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.address})]}),d.businessInfo.phone&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Telefono:"}),s.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.phone})]}),d.businessInfo.email&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"Email:"}),s.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.email})]}),d.businessInfo.vatNumber&&s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-700 font-medium",children:"P.IVA:"}),s.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.vatNumber})]})]})]}):null})()]}),s.jsx(an,{title:" Nuove Funzionalit HACCP",icon:hd,defaultExpanded:!1,children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Validazione Automatica Prodotti-Frigoriferi"}),s.jsx("p",{className:"text-sm text-blue-700",children:"L'applicazione ora verifica automaticamente la compatibilit tra categorie di prodotti e punti di conservazione, prevenendo errori di conservazione e migliorando la sicurezza alimentare."})]}),s.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Gestione Categorie Personalizzate"}),s.jsx("p",{className:"text-sm text-green-700",children:"Puoi creare nuove categorie di prodotti direttamente dall'interfaccia, rendendo il sistema pi flessibile e adattabile alle tue esigenze specifiche."})]}),s.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[s.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Prevenzione Contaminazioni"}),s.jsx("p",{className:"text-sm text-purple-700",children:"I frigoriferi possono essere dedicati a categorie specifiche, riducendo il rischio di contaminazioni incrociate e migliorando la tracciabilit."})]})]})})]})}function bt({className:t,type:e,...n}){return s.jsx("input",{type:e,className:`
        flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2
        text-sm ring-offset-background file:border-0 file:bg-transparent
        file:text-sm file:font-medium placeholder:text-gray-500
        focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500
        focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50
        ${t}
      `,...n})}function Je({className:t,...e}){return s.jsx("label",{className:`
        text-sm font-medium leading-none peer-disabled:cursor-not-allowed
        peer-disabled:opacity-70 ${t}
      `,...e})}function D5({label:t="Range Temperatura (C)",minValue:e,maxValue:n,onMinChange:r,onMaxChange:i,minPlaceholder:a="min",maxPlaceholder:o="max",required:l=!1,showValidation:c=!0,showSuggestions:d=!0,compactMode:f=!1,className:p="",id:v="temperature-range"}){const[m,N]=q.useState(!1),_=parseFloat(e),k=parseFloat(n),y=e&&n&&!isNaN(_)&&!isNaN(k),b=y&&_<k,j=(B,K)=>{const Z=(B+K)/2;return Z<=-13.5?"Surgelato":Z>=15?"Temperatura Ambiente":"Refrigerato"},C=(B,K)=>{const Z=(B+K)/2;return Z<0||Z>8?"danger":Z>=6&&Z<=8?"warning":"ok"};return f?s.jsxs("div",{className:p,children:[s.jsxs(Je,{htmlFor:v,children:[t," ",l&&"*"]}),s.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg border",children:[s.jsx("span",{className:"text-gray-700 font-medium text-xs whitespace-nowrap",children:"da"}),s.jsx(bt,{id:`${v}-min`,type:"number",step:"0.1",value:e||"",onChange:r,placeholder:a,className:"w-20 text-center font-medium text-sm",required:l}),s.jsx("span",{className:"text-gray-700 font-medium text-xs whitespace-nowrap",children:"C"}),s.jsx("span",{className:"text-gray-700 font-medium text-xs whitespace-nowrap",children:"a"}),s.jsx(bt,{id:`${v}-max`,type:"number",step:"0.1",value:n||"",onChange:i,placeholder:o,className:"w-20 text-center font-medium text-sm",required:l}),s.jsx("span",{className:"text-gray-700 font-medium text-xs whitespace-nowrap",children:"C"})]}),c&&y&&!b&&s.jsx("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-red-700 text-xs",children:" Min < Max"}),d&&s.jsx("div",{className:"mt-1 text-xs text-gray-500",children:" Carne (2-4C), Pesce (0-2C), Surgelati (-18C)"})]}):s.jsxs("div",{className:p,children:[s.jsxs(Je,{htmlFor:v,children:[t," ",l&&"*"]}),s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border",children:[s.jsx("span",{className:"text-gray-700 font-medium text-sm whitespace-nowrap",children:"da"}),s.jsx(bt,{id:`${v}-min`,type:"number",step:"0.1",value:e||"",onChange:r,placeholder:a,className:"w-24 text-center font-medium",required:l}),s.jsx("span",{className:"text-gray-700 font-medium text-sm whitespace-nowrap",children:"C"}),s.jsx("span",{className:"text-gray-700 font-medium text-sm whitespace-nowrap",children:"a"}),s.jsx(bt,{id:`${v}-max`,type:"number",step:"0.1",value:n||"",onChange:i,placeholder:o,className:"w-24 text-center font-medium",required:l}),s.jsx("span",{className:"text-gray-700 font-medium text-sm whitespace-nowrap",children:"C"})]}),c&&y&&s.jsxs("div",{className:"mt-2",children:[s.jsxs("button",{type:"button",onClick:()=>N(!m),className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 transition-colors",children:[m?s.jsx(A5,{className:"h-4 w-4"}):s.jsx(G0,{className:"h-4 w-4"}),s.jsx(Qs,{className:"h-4 w-4"}),"Dettagli temperatura"]}),m&&s.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"text-sm text-blue-700 space-y-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Tipo: "}),s.jsx("span",{children:j(_,k)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Stato: "}),s.jsx("span",{children:C(_,k)==="ok"?" Normale":C(_,k)==="warning"?" Attenzione":" Critica"})]}),!b&&s.jsx("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-red-700 text-xs",children:" La temperatura minima deve essere inferiore alla massima"})]})})]}),d&&s.jsx("div",{className:"mt-2 text-xs text-gray-500",children:" Suggerimenti: Carne fresca (2-4C), Pesce (0-2C), Surgelati (-18C), Ambiente (15-25C)"})]})}function Y4({cleaning:t,setCleaning:e,temperatures:n,setTemperatures:r,currentUser:i,refrigerators:a=[],setRefrigerators:o}){const l=t||[],c=n||[];q.useEffect(()=>{if(l.some(F=>!F.date||!F.frequency)){const F=l.map(ne=>({...ne,date:ne.date||new Date().toLocaleDateString("it-IT"),frequency:ne.frequency||"daily",completed:ne.completed||!1,completedAt:ne.completedAt||null,completedBy:ne.completedBy||null}));e(F)}},[]);const[d,f]=q.useState({task:"",assignee:"",frequency:""}),[p,v]=q.useState({location:"",temperatureMin:"",temperatureMax:""}),[m,N]=q.useState("daily");q.useEffect(()=>{localStorage.setItem("haccp-cleaning",JSON.stringify(l))},[l]),q.useEffect(()=>{localStorage.setItem("haccp-temperatures",JSON.stringify(c))},[c]);const _=(T,F)=>{const ne=(T+F)/2;return ne<0||ne>8?"danger":ne>=6&&ne<=8?"warning":"ok"},k=T=>{if(T.preventDefault(),!d.task||!d.assignee||!d.frequency){alert(` Attenzione: Per aggiungere una nuova attivit devi compilare tutti i campi richiesti.

 Attivit: descrivi cosa fare
 Assegnato a: chi  responsabile
 Frequenza: ogni quanto ripetere`);return}const F={id:Date.now().toString(),task:d.task,assignee:d.assignee,frequency:d.frequency,date:new Date().toLocaleDateString("it-IT"),completed:!1,completedAt:null,completedBy:null},ne=[...l,F];e(ne),localStorage.setItem("haccp-cleaning",JSON.stringify(ne)),f({task:"",assignee:"",frequency:""}),alert(` Perfetto! La nuova attivit  stata aggiunta con successo.

Ora apparir nella lista delle attivit da svolgere e potrai monitorarne il progresso.`)},y=T=>{if(T.preventDefault(),!p.location||!p.temperatureMin||!p.temperatureMax){alert(` Attenzione: Per registrare una temperatura devi compilare tutti i campi richiesti.

 Frigorifero/Freezer: seleziona il punto di conservazione
 Range Temperatura: inserisci i valori minimo e massimo`);return}const F=parseFloat(p.temperatureMin),ne=parseFloat(p.temperatureMax);if(isNaN(F)||isNaN(ne)){alert(` Errore: I valori delle temperature devono essere numeri validi.

Esempi corretti:
 Min: -2, Max: 4
 Min: 0, Max: 8
 Min: -18, Max: -15`);return}if(F>ne){alert(` Attenzione: La temperatura minima non pu essere maggiore della massima.

Correggi i valori:
 Min: deve essere inferiore o uguale a Max
 Esempio: Min: -2, Max: 4`);return}const W={id:Date.now().toString(),temperature:(F+ne)/2,temperatureMin:F,temperatureMax:ne,refrigeratorId:p.location,refrigeratorName:p.location,date:new Date().toLocaleString("it-IT"),status:_(F,ne),recordedBy:(i==null?void 0:i.name)||"Unknown"},ue=[...c,W];r(ue),localStorage.setItem("haccp-temperatures",JSON.stringify(ue)),v({location:"",temperatureMin:"",temperatureMax:""});const P=W.status==="ok"?" Temperatura nella norma":W.status==="warning"?" Attenzione: temperatura al limite":" Attenzione: temperatura critica";alert(` Temperatura registrata con successo!

${P}

 Frigorifero: ${W.refrigeratorName}
 Range: ${F}C - ${ne}C
 Data: ${W.date}`)},b=T=>{const F=l.map(ne=>ne.id===T?{...ne,completed:!ne.completed,completedAt:ne.completed?null:new Date().toLocaleString("it-IT"),completedBy:ne.completed?null:(i==null?void 0:i.name)||"Unknown"}:ne);e(F),localStorage.setItem("haccp-cleaning",JSON.stringify(F))},j=T=>{const F=l.filter(ne=>ne.id!==T);e(F),localStorage.setItem("haccp-cleaning",JSON.stringify(F))},C=l.filter(T=>!T.completed),B=l.filter(T=>T.completed),Z=(()=>{const T=new Date,F=new Date(T.getFullYear(),T.getMonth(),T.getDate());return l.filter(ne=>{if(ne.completed||!ne.date||typeof ne.date!="string")return!1;const W=new Date(ne.date.split("/").reverse().join("-"));switch(ne.frequency){case"daily":const ue=new Date(F);return ue.setDate(ue.getDate()-1),W<=ue;case"weekly":const P=new Date(F);return P.setDate(P.getDate()-7),W<=P;case"monthly":const Q=new Date(F);return Q.setMonth(Q.getMonth()-1),W<=Q;case"yearly":const G=new Date(F);return G.setFullYear(G.getFullYear()-1),W<=G;default:const de=new Date(F);return de.setDate(de.getDate()-7),W<=de}})})(),z=(C||[]).filter(T=>T.frequency==="daily"),J=(C||[]).filter(T=>T.frequency==="weekly"),te=(C||[]).filter(T=>T.frequency==="monthly"),I=(C||[]).filter(T=>T.frequency==="yearly"),A=(i==null?void 0:i.role)==="admin";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(an,{title:"Nuove Attivit / Mansioni",icon:hd,defaultExpanded:!0,children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:" Crea nuove attivit di pulizia e sanificazione per mantenere la conformit HACCP"}),s.jsx(et,{children:s.jsxs("form",{onSubmit:k,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Je,{htmlFor:"task",className:"flex items-center gap-2",children:["Attivit",s.jsx("span",{className:"text-xs text-gray-500",title:"Descrivi in modo chiaro e specifico l'attivit da svolgere",children:""})]}),s.jsx(bt,{id:"task",placeholder:"Es: Pulizia frigorifero, Sanificazione piano lavoro...",value:d.task,onChange:T=>f({...d,task:T.target.value}),required:!0}),s.jsx("p",{className:"text-xs text-gray-500",children:' Suggerimento: Sii specifico (es. "Pulizia mensile frigorifero principale" invece di solo "Pulizia")'})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Je,{htmlFor:"assignee",className:"flex items-center gap-2",children:["Assegnato a",s.jsx("span",{className:"text-xs text-gray-500",title:"Specifica chi  responsabile dell'esecuzione dell'attivit",children:""})]}),s.jsx(bt,{id:"assignee",placeholder:"Nome del responsabile",value:d.assignee,onChange:T=>f({...d,assignee:T.target.value}),required:!0}),s.jsx("p",{className:"text-xs text-gray-500",children:' Esempio: "Mario Rossi" o "Team Cucina"'})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Je,{htmlFor:"frequency",className:"flex items-center gap-2",children:["Frequenza",s.jsx("span",{className:"text-xs text-gray-500",title:"Seleziona con quale frequenza l'attivit deve essere ripetuta",children:""})]}),s.jsxs("select",{id:"frequency",value:d.frequency,onChange:T=>f({...d,frequency:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[s.jsx("option",{value:"",children:"-- Seleziona Frequenza --"}),s.jsx("option",{value:"daily",children:" Giornalmente"}),s.jsx("option",{value:"weekly",children:" Settimanalmente"}),s.jsx("option",{value:"monthly",children:" Mensilmente"}),s.jsx("option",{value:"yearly",children:" Annualmente"}),(i==null?void 0:i.role)==="admin"&&s.jsx("option",{value:"all",children:" Tutti"})]}),s.jsx("p",{className:"text-xs text-gray-500",children:" La frequenza aiuta a pianificare e monitorare le attivit"})]})]}),s.jsx(le,{type:"submit",className:"w-full",children:" Aggiungi Attivit"})]})})]}),s.jsxs(an,{title:`Attivit da Svolgere (${C.length})`,icon:Qu,defaultExpanded:!0,children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:" Organizza e monitora le attivit di pulizia e sanificazione per mantenere la conformit HACCP"}),s.jsx(et,{children:C.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(kn,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),s.jsx("p",{className:"text-lg font-medium",children:" Nessuna attivit da svolgere"}),s.jsx("p",{className:"text-sm",children:"Tutte le attivit sono completate! Ottimo lavoro nel mantenere la conformit HACCP."}),s.jsx("p",{className:"text-xs text-gray-400 mt-2",children:" Suggerimento: Crea nuove attivit per mantenere sempre aggiornato il piano di pulizia"})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>N("daily"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${m==="daily"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[" Giornaliere (",z.length,")"]}),s.jsxs("button",{onClick:()=>N("weekly"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${m==="weekly"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[" Settimanali (",J.length,")"]}),s.jsxs("button",{onClick:()=>N("monthly"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${m==="monthly"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[" Mensili (",te.length,")"]}),s.jsxs("button",{onClick:()=>N("yearly"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${m==="yearly"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[" Annuali (",I.length,")"]}),(i==null?void 0:i.role)==="admin"&&s.jsxs("button",{onClick:()=>N("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${m==="all"?"bg-white text-gray-700 border-2 border-blue-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[" Tutti (",C.length,")"]})]}),s.jsx("p",{className:"text-xs text-gray-500",children:" Clicca sulle schede per filtrare le attivit per frequenza e organizzare meglio il lavoro"}),s.jsx("div",{className:"space-y-3",children:(()=>{let T=[];switch(m){case"daily":T=z;break;case"weekly":T=J;break;case"monthly":T=te;break;case"yearly":T=I;break;case"all":T=C;break;default:T=z}return T.map(F=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-medium",children:F.task}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Assegnato a: ",F.assignee,"  ",F.date]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{size:"sm",onClick:()=>b(F.id),className:"bg-green-600 hover:bg-green-700 p-2 md:p-1",children:[s.jsx(kn,{className:"h-6 w-6 md:h-4 md:w-4 mr-1"}),s.jsx("span",{className:"hidden sm:inline",children:"Completata"})]}),A&&s.jsx(le,{size:"sm",variant:"outline",onClick:()=>j(F.id),className:"text-red-600 hover:text-red-700 p-2 md:p-1",children:s.jsx(er,{className:"h-6 w-6 md:h-4 md:w-4"})})]})]},F.id))})()})]})})]}),B.length>0&&s.jsxs(an,{title:`Attivit Completate (${B.length})`,icon:kn,defaultExpanded:!1,children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:" Storico delle attivit completate - Mantiene traccia di tutto il lavoro svolto per la conformit HACCP"}),A&&s.jsx("div",{className:"mb-4",children:s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>{confirm(` Attenzione: Sei sicuro di voler eliminare tutte le attivit completate?

Questa azione non pu essere annullata e rimuover la cronologia delle attivit svolte.`)&&e(l.filter(T=>!T.completed))},className:"text-red-600 hover:text-red-700",children:[s.jsx(er,{className:"h-4 w-4 mr-2"}),"Elimina Tutte"]})}),s.jsx(et,{children:s.jsx("div",{className:"space-y-3",children:B.map(T=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-green-50",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-medium line-through",children:T.task}),s.jsxs("p",{className:"text-sm text-gray-600",children:[" Assegnato a: ",T.assignee,"   Completata: ",T.completedAt,T.completedBy&&s.jsxs("span",{className:"ml-2 text-blue-600",children:["  Completata da: ",T.completedBy]})]})]}),A&&s.jsx(le,{size:"sm",variant:"outline",onClick:()=>j(T.id),className:"text-red-600 hover:text-red-700 p-2 md:p-1",children:s.jsx(er,{className:"h-6 w-6 md:h-4 md:w-4"})})]},T.id))})})]}),s.jsxs(an,{title:"Registra Temperatura Frigorifero/Freezer",icon:ws,defaultExpanded:!0,children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:" Monitora le temperature per garantire la sicurezza alimentare e la conformit HACCP"}),i&&s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:[" Registrando come: ",s.jsx("span",{className:"font-medium",children:i.name})," (",i.department,")"]}),s.jsx(et,{children:s.jsxs("form",{onSubmit:y,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs(Je,{htmlFor:"temp-location",className:"flex items-center gap-2",children:["Frigorifero / Freezer",s.jsx("span",{className:"text-xs text-gray-500",title:"Seleziona il punto di conservazione dove hai misurato la temperatura",children:""})]}),a.length===0?s.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsx("p",{className:"text-sm text-yellow-800",children:" Nessun punto di conservazione registrato."}),s.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:' Per registrare le temperature, devi prima aggiungere un frigorifero o freezer nella sezione "Punti di Conservazione".'})]}):s.jsxs("select",{id:"temp-location",value:p.location,onChange:T=>v({...p,location:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[s.jsx("option",{value:"",children:"-- Seleziona Frigorifero/Freezer --"}),a.map(T=>s.jsxs("option",{value:T.name,children:[T.name," (",T.location||"Posizione non specificata",")"]},T.id))]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:" Seleziona il frigorifero o freezer dove hai misurato la temperatura"})]}),s.jsxs("div",{children:[s.jsxs(Je,{htmlFor:"temp-temperature-range",className:"flex items-center gap-2",children:["Range Temperatura (C)",s.jsx("span",{className:"text-xs text-gray-500",title:"Inserisci la temperatura minima e massima rilevata nel punto di conservazione",children:""})]}),s.jsx(D5,{label:"Range Temperatura (C)",minValue:p.temperatureMin,maxValue:p.temperatureMax,onMinChange:T=>v({...p,temperatureMin:T.target.value}),onMaxChange:T=>v({...p,temperatureMax:T.target.value}),required:!0,showValidation:!0,showSuggestions:!0,className:"w-full",id:"temp-temperature-range"}),s.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-y-1",children:[s.jsxs("p",{children:[" ",s.jsx("strong",{children:"Frigoriferi:"})," 0C - 8C (ideale: 2C - 6C)"]}),s.jsxs("p",{children:[" ",s.jsx("strong",{children:"Freezer:"})," -18C o inferiore"]}),s.jsxs("p",{children:[" ",s.jsx("strong",{children:"Suggerimento:"})," Misura in diversi punti per avere un range completo"]})]})]})]}),s.jsxs(le,{type:"submit",className:"w-full md:w-auto",disabled:a.length===0,children:[s.jsx(ws,{className:"mr-2 h-4 w-4"})," Registra Temperatura"]})]})})]}),s.jsx(an,{title:"Statistiche",icon:Wo,defaultExpanded:!1,children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Mansioni da Svolgere"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:C.length}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:C.length===0?" Tutto sotto controllo!":" Richiedono la tua attenzione"})]}),s.jsx(Qu,{className:"h-10 w-10 md:h-8 md:w-8 text-yellow-500"})]})})}),s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Mansioni Completate"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:B.length}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:B.length===0?" Inizia con la prima attivit!":" Buon lavoro!"})]}),s.jsx(kn,{className:"h-10 w-10 md:h-8 md:w-8 text-green-500"})]})})}),s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Mansioni Mancate"}),s.jsx("p",{className:`text-2xl font-bold ${Z.length>0?"text-red-600":"text-green-600"}`,children:Z.length}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Z.length===0?" Perfetto! Nessuna scadenza mancata":" Richiedono attenzione immediata"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"(ultimi 7 giorni)"})]}),Z.length>0?s.jsx(pn,{className:"h-10 w-10 md:h-8 md:w-8 text-red-500"}):s.jsx(kn,{className:"h-10 w-10 md:h-8 md:w-8 text-green-500"})]})})}),s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Temperature da Monitorare"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:c.filter(T=>T.status==="danger"||T.status==="warning").length}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:c.filter(T=>T.status==="danger"||T.status==="warning").length===0?" Temperature nella norma":" Richiedono verifica"})]}),s.jsx(pn,{className:"h-10 w-10 md:h-8 md:w-8 text-red-500"})]})})})]})})]})}function vu({title:t,subtitle:e,icon:n,iconColor:r="text-blue-600",iconBgColor:i="bg-blue-100",count:a=0,children:o,testId:l,className:c="",defaultExpanded:d=!1,onToggle:f=null}){const[p,v]=q.useState(d),m=()=>{const N=!p;v(N),f&&f(N)};return s.jsxs(ot,{className:`border-2 border-blue-300 shadow-lg hover:shadow-xl transition-all duration-200 bg-white ${c}`,children:[s.jsx(Ut,{className:"cursor-pointer hover:bg-blue-50 transition-all duration-200 border-b border-blue-100",onClick:m,"data-testid":l?`${l}-header`:void 0,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[n&&s.jsx("div",{className:`p-3 rounded-xl ${i} shadow-sm`,children:s.jsx(n,{className:`h-6 w-6 ${r}`})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:t}),e&&s.jsx("p",{className:"text-sm text-gray-600",children:e})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[a>0&&s.jsx("span",{className:"bg-blue-500 text-white text-sm font-bold px-3 py-1 rounded-full shadow-sm",children:a}),s.jsx(G0,{className:`h-5 w-5 text-blue-600 transition-transform duration-200 ${p?"rotate-180":""}`})]})]})}),p&&s.jsx(et,{className:"pt-8 px-12 pb-12 animate-in slide-in-from-top-2 fade-in-50 duration-300","data-testid":l?`${l}-content`:void 0,children:o})]})}const Zo=(t,e="add-form")=>{const n=q.useRef(null),r=q.useCallback(()=>{t&&n.current&&setTimeout(()=>{var i;(i=n.current)==null||i.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},100)},[t]);return{formRef:n,scrollToForm:r}},rx=t=>{let e;const n=new Set,r=(d,f)=>{const p=typeof d=="function"?d(e):d;if(!Object.is(p,e)){const v=e;e=f??(typeof p!="object"||p===null)?p:Object.assign({},e,p),n.forEach(m=>m(e,v))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d))},c=e=t(r,i,l);return l},Q4=t=>t?rx(t):rx,X4=t=>t;function eS(t,e=X4){const n=Zs.useSyncExternalStore(t.subscribe,Zs.useCallback(()=>e(t.getState()),[t,e]),Zs.useCallback(()=>e(t.getInitialState()),[t,e]));return Zs.useDebugValue(n),n}const sx=t=>{const e=Q4(t),n=r=>eS(e,r);return Object.assign(n,e),n},tS=t=>t?sx(t):sx,nS={conservationPoints:{},staff:{},departments:{}},rS={schemaVersion:1,devMode:{mirrorOnboardingChanges:!1},forms:{},pending:!1,error:null},sc=tS((t,e)=>({onboarding:null,entities:nS,meta:rS,addEntity:(n,r)=>t(i=>({entities:{...i.entities,[n]:{...i.entities[n],[r.id]:r}}})),updateEntity:(n,r,i)=>t(a=>({entities:{...a.entities,[n]:{...a.entities[n],[r]:{...a.entities[n][r],...i}}}})),removeEntity:(n,r)=>t(i=>{const{[r]:a,...o}=i.entities[n];return{entities:{...i.entities,[n]:o}}}),openCreateForm:n=>t(r=>{const i=r.meta.forms[n];return i&&i.mode!=="idle"?r:{meta:{...r.meta,forms:{...r.meta.forms,[n]:{mode:"create"}}}}}),openEditForm:(n,r)=>t(i=>{const a=i.meta.forms[n];return a&&a.mode!=="idle"?i:{meta:{...i.meta,forms:{...i.meta.forms,[n]:{mode:"edit",editId:r}}}}}),closeForm:n=>t(r=>({meta:{...r.meta,forms:{...r.meta.forms,[n]:{mode:"idle"}}}})),updateDraft:(n,r)=>t(i=>({meta:{...i.meta,forms:{...i.meta.forms,[n]:{...i.meta.forms[n]??{mode:"create"},draft:r}}}})),setFormErrors:(n,r)=>t(i=>({meta:{...i.meta,forms:{...i.meta.forms,[n]:{...i.meta.forms[n]??{mode:"create"},errors:r}}}}))}));function Ve(t,e,n){function r(l,c){var d;Object.defineProperty(l,"_zod",{value:l._zod??{},enumerable:!1}),(d=l._zod).traits??(d.traits=new Set),l._zod.traits.add(t),e(l,c);for(const f in o.prototype)f in l||Object.defineProperty(l,f,{value:o.prototype[f].bind(l)});l._zod.constr=o,l._zod.def=c}const i=(n==null?void 0:n.Parent)??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function o(l){var c;const d=n!=null&&n.Parent?new a:this;r(d,l),(c=d._zod).deferred??(c.deferred=[]);for(const f of d._zod.deferred)f();return d}return Object.defineProperty(o,"init",{value:r}),Object.defineProperty(o,Symbol.hasInstance,{value:l=>{var c,d;return n!=null&&n.Parent&&l instanceof n.Parent?!0:(d=(c=l==null?void 0:l._zod)==null?void 0:c.traits)==null?void 0:d.has(t)}}),Object.defineProperty(o,"name",{value:t}),o}class ic extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class M5 extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const Sg={};function Jo(t){return t&&Object.assign(Sg,t),Sg}function sS(t){const e=Object.values(t).filter(r=>typeof r=="number");return Object.entries(t).filter(([r,i])=>e.indexOf(+r)===-1).map(([r,i])=>i)}function _g(t,e){return typeof e=="bigint"?e.toString():e}function Z0(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function J0(t){return t==null}function K0(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}function iS(t,e){const n=(t.toString().split(".")[1]||"").length,r=e.toString();let i=(r.split(".")[1]||"").length;if(i===0&&/\d?e-\d?/.test(r)){const c=r.match(/\d?e-(\d?)/);c!=null&&c[1]&&(i=Number.parseInt(c[1]))}const a=n>i?n:i,o=Number.parseInt(t.toFixed(a).replace(".","")),l=Number.parseInt(e.toFixed(a).replace(".",""));return o%l/10**a}const ix=Symbol("evaluating");function Sn(t,e,n){let r;Object.defineProperty(t,e,{get(){if(r!==ix)return r===void 0&&(r=ix,r=n()),r},set(i){Object.defineProperty(t,e,{value:i})},configurable:!0})}function aS(t){return Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t))}function ho(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function wc(...t){const e={};for(const n of t){const r=Object.getOwnPropertyDescriptors(n);Object.assign(e,r)}return Object.defineProperties({},e)}function ax(t){return JSON.stringify(t)}const R5="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function _f(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const oS=Z0(()=>{var t;if(typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)!=null&&t.includes("Cloudflare")))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function Xu(t){if(_f(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(_f(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function F5(t){return Xu(t)?{...t}:Array.isArray(t)?[...t]:t}const lS=new Set(["string","number","symbol"]);function Jf(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function fo(t,e,n){const r=new t._zod.constr(e??t._zod.def);return(!e||n!=null&&n.parent)&&(r._zod.parent=t),r}function _t(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if((e==null?void 0:e.message)!==void 0){if((e==null?void 0:e.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function cS(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const uS={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function dS(t,e){const n=t._zod.def,r=wc(t._zod.def,{get shape(){const i={};for(const a in e){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);e[a]&&(i[a]=n.shape[a])}return ho(this,"shape",i),i},checks:[]});return fo(t,r)}function hS(t,e){const n=t._zod.def,r=wc(t._zod.def,{get shape(){const i={...t._zod.def.shape};for(const a in e){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);e[a]&&delete i[a]}return ho(this,"shape",i),i},checks:[]});return fo(t,r)}function fS(t,e){if(!Xu(e))throw new Error("Invalid input to extend: expected a plain object");const n=t._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const i=wc(t._zod.def,{get shape(){const a={...t._zod.def.shape,...e};return ho(this,"shape",a),a},checks:[]});return fo(t,i)}function mS(t,e){if(!Xu(e))throw new Error("Invalid input to safeExtend: expected a plain object");const n={...t._zod.def,get shape(){const r={...t._zod.def.shape,...e};return ho(this,"shape",r),r},checks:t._zod.def.checks};return fo(t,n)}function pS(t,e){const n=wc(t._zod.def,{get shape(){const r={...t._zod.def.shape,...e._zod.def.shape};return ho(this,"shape",r),r},get catchall(){return e._zod.def.catchall},checks:[]});return fo(t,n)}function gS(t,e,n){const r=wc(e._zod.def,{get shape(){const i=e._zod.def.shape,a={...i};if(n)for(const o in n){if(!(o in i))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(a[o]=t?new t({type:"optional",innerType:i[o]}):i[o])}else for(const o in i)a[o]=t?new t({type:"optional",innerType:i[o]}):i[o];return ho(this,"shape",a),a},checks:[]});return fo(e,r)}function vS(t,e,n){const r=wc(e._zod.def,{get shape(){const i=e._zod.def.shape,a={...i};if(n)for(const o in n){if(!(o in a))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(a[o]=new t({type:"nonoptional",innerType:i[o]}))}else for(const o in i)a[o]=new t({type:"nonoptional",innerType:i[o]});return ho(this,"shape",a),a},checks:[]});return fo(e,r)}function Kl(t,e=0){var n;if(t.aborted===!0)return!0;for(let r=e;r<t.issues.length;r++)if(((n=t.issues[r])==null?void 0:n.continue)!==!0)return!0;return!1}function $5(t,e){return e.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(t),n})}function yh(t){return typeof t=="string"?t:t==null?void 0:t.message}function Ko(t,e,n){var i,a,o,l,c,d;const r={...t,path:t.path??[]};if(!t.message){const f=yh((o=(a=(i=t.inst)==null?void 0:i._zod.def)==null?void 0:a.error)==null?void 0:o.call(a,t))??yh((l=e==null?void 0:e.error)==null?void 0:l.call(e,t))??yh((c=n.customError)==null?void 0:c.call(n,t))??yh((d=n.localeError)==null?void 0:d.call(n,t))??"Invalid input";r.message=f}return delete r.inst,delete r.continue,e!=null&&e.reportInput||delete r.input,r}function Y0(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function ed(...t){const[e,n,r]=t;return typeof e=="string"?{message:e,code:"custom",input:n,inst:r}:{...e}}const B5=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,_g,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},q5=Ve("$ZodError",B5),U5=Ve("$ZodError",B5,{Parent:Error});function xS(t,e=n=>n.message){const n={},r=[];for(const i of t.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:n}}function yS(t,e){const n=e||function(a){return a.message},r={_errors:[]},i=a=>{for(const o of a.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(l=>i({issues:l}));else if(o.code==="invalid_key")i({issues:o.issues});else if(o.code==="invalid_element")i({issues:o.issues});else if(o.path.length===0)r._errors.push(n(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(n(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return i(t),r}const Q0=t=>(e,n,r,i)=>{const a=r?Object.assign(r,{async:!1}):{async:!1},o=e._zod.run({value:n,issues:[]},a);if(o instanceof Promise)throw new ic;if(o.issues.length){const l=new((i==null?void 0:i.Err)??t)(o.issues.map(c=>Ko(c,a,Jo())));throw R5(l,i==null?void 0:i.callee),l}return o.value},X0=t=>async(e,n,r,i)=>{const a=r?Object.assign(r,{async:!0}):{async:!0};let o=e._zod.run({value:n,issues:[]},a);if(o instanceof Promise&&(o=await o),o.issues.length){const l=new((i==null?void 0:i.Err)??t)(o.issues.map(c=>Ko(c,a,Jo())));throw R5(l,i==null?void 0:i.callee),l}return o.value},Kf=t=>(e,n,r)=>{const i=r?{...r,async:!1}:{async:!1},a=e._zod.run({value:n,issues:[]},i);if(a instanceof Promise)throw new ic;return a.issues.length?{success:!1,error:new(t??q5)(a.issues.map(o=>Ko(o,i,Jo())))}:{success:!0,data:a.value}},bS=Kf(U5),Yf=t=>async(e,n,r)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let a=e._zod.run({value:n,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(o=>Ko(o,i,Jo())))}:{success:!0,data:a.value}},wS=Yf(U5),NS=t=>(e,n,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Q0(t)(e,n,i)},jS=t=>(e,n,r)=>Q0(t)(e,n,r),SS=t=>async(e,n,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return X0(t)(e,n,i)},_S=t=>async(e,n,r)=>X0(t)(e,n,r),kS=t=>(e,n,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Kf(t)(e,n,i)},CS=t=>(e,n,r)=>Kf(t)(e,n,r),AS=t=>async(e,n,r)=>{const i=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Yf(t)(e,n,i)},PS=t=>async(e,n,r)=>Yf(t)(e,n,r),IS=/^[cC][^\s-]{8,}$/,ES=/^[0-9a-z]+$/,LS=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,TS=/^[0-9a-vA-V]{20}$/,zS=/^[A-Za-z0-9]{27}$/,OS=/^[a-zA-Z0-9_-]{21}$/,DS=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,MS=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,ox=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,RS=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,FS="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function $S(){return new RegExp(FS,"u")}const BS=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,qS=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,US=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,VS=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,HS=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,V5=/^[A-Za-z0-9_-]*$/,GS=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,WS=/^\+(?:[0-9]){6,14}[0-9]$/,H5="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",ZS=new RegExp(`^${H5}$`);function G5(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function JS(t){return new RegExp(`^${G5(t)}$`)}function KS(t){const e=G5({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${e}(?:${n.join("|")})`;return new RegExp(`^${H5}T(?:${r})$`)}const YS=t=>{const e=t?`[\\s\\S]{${(t==null?void 0:t.minimum)??0},${(t==null?void 0:t.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},QS=/^-?\d+$/,XS=/^-?\d+(?:\.\d+)?/,e_=/^(?:true|false)$/i,t_=/^[^A-Z]*$/,n_=/^[^a-z]*$/,Ns=Ve("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),W5={number:"number",bigint:"bigint",object:"date"},Z5=Ve("$ZodCheckLessThan",(t,e)=>{Ns.init(t,e);const n=W5[typeof e.value];t._zod.onattach.push(r=>{const i=r._zod.bag,a=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value<=e.value:r.value<e.value)||r.issues.push({origin:n,code:"too_big",maximum:e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),J5=Ve("$ZodCheckGreaterThan",(t,e)=>{Ns.init(t,e);const n=W5[typeof e.value];t._zod.onattach.push(r=>{const i=r._zod.bag,a=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value>=e.value:r.value>e.value)||r.issues.push({origin:n,code:"too_small",minimum:e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),r_=Ve("$ZodCheckMultipleOf",(t,e)=>{Ns.init(t,e),t._zod.onattach.push(n=>{var r;(r=n._zod.bag).multipleOf??(r.multipleOf=e.value)}),t._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):iS(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:e.value,input:n.value,inst:t,continue:!e.abort})}}),s_=Ve("$ZodCheckNumberFormat",(t,e)=>{var o;Ns.init(t,e),e.format=e.format||"float64";const n=(o=e.format)==null?void 0:o.includes("int"),r=n?"int":"number",[i,a]=uS[e.format];t._zod.onattach.push(l=>{const c=l._zod.bag;c.format=e.format,c.minimum=i,c.maximum=a,n&&(c.pattern=QS)}),t._zod.check=l=>{const c=l.value;if(n){if(!Number.isInteger(c)){l.issues.push({expected:r,format:e.format,code:"invalid_type",continue:!1,input:c,inst:t});return}if(!Number.isSafeInteger(c)){c>0?l.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!e.abort}):l.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!e.abort});return}}c<i&&l.issues.push({origin:"number",input:c,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!e.abort}),c>a&&l.issues.push({origin:"number",input:c,code:"too_big",maximum:a,inst:t})}}),i_=Ve("$ZodCheckMaxLength",(t,e)=>{var n;Ns.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!J0(i)&&i.length!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(r._zod.bag.maximum=e.maximum)}),t._zod.check=r=>{const i=r.value;if(i.length<=e.maximum)return;const o=Y0(i);r.issues.push({origin:o,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),a_=Ve("$ZodCheckMinLength",(t,e)=>{var n;Ns.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!J0(i)&&i.length!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(r._zod.bag.minimum=e.minimum)}),t._zod.check=r=>{const i=r.value;if(i.length>=e.minimum)return;const o=Y0(i);r.issues.push({origin:o,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),o_=Ve("$ZodCheckLengthEquals",(t,e)=>{var n;Ns.init(t,e),(n=t._zod.def).when??(n.when=r=>{const i=r.value;return!J0(i)&&i.length!==void 0}),t._zod.onattach.push(r=>{const i=r._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=r=>{const i=r.value,a=i.length;if(a===e.length)return;const o=Y0(i),l=a>e.length;r.issues.push({origin:o,...l?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:r.value,inst:t,continue:!e.abort})}}),Qf=Ve("$ZodCheckStringFormat",(t,e)=>{var n,r;Ns.init(t,e),t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,e.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(r=t._zod).check??(r.check=()=>{})}),l_=Ve("$ZodCheckRegex",(t,e)=>{Qf.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),c_=Ve("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=t_),Qf.init(t,e)}),u_=Ve("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=n_),Qf.init(t,e)}),d_=Ve("$ZodCheckIncludes",(t,e)=>{Ns.init(t,e);const n=Jf(e.includes),r=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=r,t._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),h_=Ve("$ZodCheckStartsWith",(t,e)=>{Ns.init(t,e);const n=new RegExp(`^${Jf(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(n)}),t._zod.check=r=>{r.value.startsWith(e.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:r.value,inst:t,continue:!e.abort})}}),f_=Ve("$ZodCheckEndsWith",(t,e)=>{Ns.init(t,e);const n=new RegExp(`.*${Jf(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(n)}),t._zod.check=r=>{r.value.endsWith(e.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:r.value,inst:t,continue:!e.abort})}}),m_=Ve("$ZodCheckOverwrite",(t,e)=>{Ns.init(t,e),t._zod.check=n=>{n.value=e.tx(n.value)}});class p_{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const r=e.split(`
`).filter(o=>o),i=Math.min(...r.map(o=>o.length-o.trimStart().length)),a=r.map(o=>o.slice(i)).map(o=>" ".repeat(this.indent*2)+o);for(const o of a)this.content.push(o)}compile(){const e=Function,n=this==null?void 0:this.args,i=[...((this==null?void 0:this.content)??[""]).map(a=>`  ${a}`)];return new e(...n,i.join(`
`))}}const g_={major:4,minor:1,patch:8},tr=Ve("$ZodType",(t,e)=>{var i;var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=g_;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const a of r)for(const o of a._zod.onattach)o(t);if(r.length===0)(n=t._zod).deferred??(n.deferred=[]),(i=t._zod.deferred)==null||i.push(()=>{t._zod.run=t._zod.parse});else{const a=(l,c,d)=>{let f=Kl(l),p;for(const v of c){if(v._zod.def.when){if(!v._zod.def.when(l))continue}else if(f)continue;const m=l.issues.length,N=v._zod.check(l);if(N instanceof Promise&&(d==null?void 0:d.async)===!1)throw new ic;if(p||N instanceof Promise)p=(p??Promise.resolve()).then(async()=>{await N,l.issues.length!==m&&(f||(f=Kl(l,m)))});else{if(l.issues.length===m)continue;f||(f=Kl(l,m))}}return p?p.then(()=>l):l},o=(l,c,d)=>{if(Kl(l))return l.aborted=!0,l;const f=a(c,r,d);if(f instanceof Promise){if(d.async===!1)throw new ic;return f.then(p=>t._zod.parse(p,d))}return t._zod.parse(f,d)};t._zod.run=(l,c)=>{if(c.skipChecks)return t._zod.parse(l,c);if(c.direction==="backward"){const f=t._zod.parse({value:l.value,issues:[]},{...c,skipChecks:!0});return f instanceof Promise?f.then(p=>o(p,l,c)):o(f,l,c)}const d=t._zod.parse(l,c);if(d instanceof Promise){if(c.async===!1)throw new ic;return d.then(f=>a(f,r,c))}return a(d,r,c)}}t["~standard"]={validate:a=>{var o;try{const l=bS(t,a);return l.success?{value:l.data}:{issues:(o=l.error)==null?void 0:o.issues}}catch{return wS(t,a).then(c=>{var d;return c.success?{value:c.data}:{issues:(d=c.error)==null?void 0:d.issues}})}},vendor:"zod",version:1}}),e1=Ve("$ZodString",(t,e)=>{var n;tr.init(t,e),t._zod.pattern=[...((n=t==null?void 0:t._zod.bag)==null?void 0:n.patterns)??[]].pop()??YS(t._zod.bag),t._zod.parse=(r,i)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),En=Ve("$ZodStringFormat",(t,e)=>{Qf.init(t,e),e1.init(t,e)}),v_=Ve("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=MS),En.init(t,e)}),x_=Ve("$ZodUUID",(t,e)=>{if(e.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(r===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=ox(r))}else e.pattern??(e.pattern=ox());En.init(t,e)}),y_=Ve("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=RS),En.init(t,e)}),b_=Ve("$ZodURL",(t,e)=>{En.init(t,e),t._zod.check=n=>{try{const r=n.value.trim(),i=new URL(r);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:GS.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),e.normalize?n.value=i.href:n.value=r;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),w_=Ve("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=$S()),En.init(t,e)}),N_=Ve("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=OS),En.init(t,e)}),j_=Ve("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=IS),En.init(t,e)}),S_=Ve("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=ES),En.init(t,e)}),__=Ve("$ZodULID",(t,e)=>{e.pattern??(e.pattern=LS),En.init(t,e)}),k_=Ve("$ZodXID",(t,e)=>{e.pattern??(e.pattern=TS),En.init(t,e)}),C_=Ve("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=zS),En.init(t,e)}),A_=Ve("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=KS(e)),En.init(t,e)}),P_=Ve("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=ZS),En.init(t,e)}),I_=Ve("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=JS(e)),En.init(t,e)}),E_=Ve("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=DS),En.init(t,e)}),L_=Ve("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=BS),En.init(t,e),t._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv4"})}),T_=Ve("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=qS),En.init(t,e),t._zod.onattach.push(n=>{const r=n._zod.bag;r.format="ipv6"}),t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),z_=Ve("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=US),En.init(t,e)}),O_=Ve("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=VS),En.init(t,e),t._zod.check=n=>{const r=n.value.split("/");try{if(r.length!==2)throw new Error;const[i,a]=r;if(!a)throw new Error;const o=Number(a);if(`${o}`!==a)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${i}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function K5(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const D_=Ve("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=HS),En.init(t,e),t._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64"}),t._zod.check=n=>{K5(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.abort})}});function M_(t){if(!V5.test(t))return!1;const e=t.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return K5(n)}const R_=Ve("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=V5),En.init(t,e),t._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64url"}),t._zod.check=n=>{M_(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),F_=Ve("$ZodE164",(t,e)=>{e.pattern??(e.pattern=WS),En.init(t,e)});function $_(t,e=null){try{const n=t.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const i=JSON.parse(atob(r));return!("typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const B_=Ve("$ZodJWT",(t,e)=>{En.init(t,e),t._zod.check=n=>{$_(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),Y5=Ve("$ZodNumber",(t,e)=>{tr.init(t,e),t._zod.pattern=t._zod.bag.pattern??XS,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}const i=n.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return n;const a=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...a?{received:a}:{}}),n}}),q_=Ve("$ZodNumber",(t,e)=>{s_.init(t,e),Y5.init(t,e)}),U_=Ve("$ZodBoolean",(t,e)=>{tr.init(t,e),t._zod.pattern=e_,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=!!n.value}catch{}const i=n.value;return typeof i=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),n}}),V_=Ve("$ZodUnknown",(t,e)=>{tr.init(t,e),t._zod.parse=n=>n}),H_=Ve("$ZodNever",(t,e)=>{tr.init(t,e),t._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)});function lx(t,e,n){t.issues.length&&e.issues.push(...$5(n,t.issues)),e.value[n]=t.value}const G_=Ve("$ZodArray",(t,e)=>{tr.init(t,e),t._zod.parse=(n,r)=>{const i=n.value;if(!Array.isArray(i))return n.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),n;n.value=Array(i.length);const a=[];for(let o=0;o<i.length;o++){const l=i[o],c=e.element._zod.run({value:l,issues:[]},r);c instanceof Promise?a.push(c.then(d=>lx(d,n,o))):lx(c,n,o)}return a.length?Promise.all(a).then(()=>n):n}});function kf(t,e,n,r){t.issues.length&&e.issues.push(...$5(n,t.issues)),t.value===void 0?n in r&&(e.value[n]=void 0):e.value[n]=t.value}function Q5(t){var r,i,a,o;const e=Object.keys(t.shape);for(const l of e)if(!((o=(a=(i=(r=t.shape)==null?void 0:r[l])==null?void 0:i._zod)==null?void 0:a.traits)!=null&&o.has("$ZodType")))throw new Error(`Invalid element at key "${l}": expected a Zod schema`);const n=cS(t.shape);return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}}function X5(t,e,n,r,i,a){const o=[],l=i.keySet,c=i.catchall._zod,d=c.def.type;for(const f of Object.keys(e)){if(l.has(f))continue;if(d==="never"){o.push(f);continue}const p=c.run({value:e[f],issues:[]},r);p instanceof Promise?t.push(p.then(v=>kf(v,n,f,e))):kf(p,n,f,e)}return o.length&&n.issues.push({code:"unrecognized_keys",keys:o,input:e,inst:a}),t.length?Promise.all(t).then(()=>n):n}const W_=Ve("$ZodObject",(t,e)=>{tr.init(t,e);const n=Z0(()=>Q5(e));Sn(t._zod,"propValues",()=>{const o=e.shape,l={};for(const c in o){const d=o[c]._zod;if(d.values){l[c]??(l[c]=new Set);for(const f of d.values)l[c].add(f)}}return l});const r=_f,i=e.catchall;let a;t._zod.parse=(o,l)=>{a??(a=n.value);const c=o.value;if(!r(c))return o.issues.push({expected:"object",code:"invalid_type",input:c,inst:t}),o;o.value={};const d=[],f=a.shape;for(const p of a.keys){const m=f[p]._zod.run({value:c[p],issues:[]},l);m instanceof Promise?d.push(m.then(N=>kf(N,o,p,c))):kf(m,o,p,c)}return i?X5(d,c,o,l,n.value,t):d.length?Promise.all(d).then(()=>o):o}}),Z_=Ve("$ZodObjectJIT",(t,e)=>{W_.init(t,e);const n=t._zod.parse,r=Z0(()=>Q5(e)),i=v=>{const m=new p_(["shape","payload","ctx"]),N=r.value,_=j=>{const C=ax(j);return`shape[${C}]._zod.run({ value: input[${C}], issues: [] }, ctx)`};m.write("const input = payload.value;");const k=Object.create(null);let y=0;for(const j of N.keys)k[j]=`key_${y++}`;m.write("const newResult = {};");for(const j of N.keys){const C=k[j],B=ax(j);m.write(`const ${C} = ${_(j)};`),m.write(`
        if (${C}.issues.length) {
          payload.issues = payload.issues.concat(${C}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${B}, ...iss.path] : [${B}]
          })));
        }
        
        
        if (${C}.value === undefined) {
          if (${B} in input) {
            newResult[${B}] = undefined;
          }
        } else {
          newResult[${B}] = ${C}.value;
        }
        
      `)}m.write("payload.value = newResult;"),m.write("return payload;");const b=m.compile();return(j,C)=>b(v,j,C)};let a;const o=_f,l=!Sg.jitless,d=l&&oS.value,f=e.catchall;let p;t._zod.parse=(v,m)=>{p??(p=r.value);const N=v.value;return o(N)?l&&d&&(m==null?void 0:m.async)===!1&&m.jitless!==!0?(a||(a=i(e.shape)),v=a(v,m),f?X5([],N,v,m,p,t):v):n(v,m):(v.issues.push({expected:"object",code:"invalid_type",input:N,inst:t}),v)}});function cx(t,e,n,r){for(const a of t)if(a.issues.length===0)return e.value=a.value,e;const i=t.filter(a=>!Kl(a));return i.length===1?(e.value=i[0].value,i[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(a=>a.issues.map(o=>Ko(o,r,Jo())))}),e)}const J_=Ve("$ZodUnion",(t,e)=>{tr.init(t,e),Sn(t._zod,"optin",()=>e.options.some(i=>i._zod.optin==="optional")?"optional":void 0),Sn(t._zod,"optout",()=>e.options.some(i=>i._zod.optout==="optional")?"optional":void 0),Sn(t._zod,"values",()=>{if(e.options.every(i=>i._zod.values))return new Set(e.options.flatMap(i=>Array.from(i._zod.values)))}),Sn(t._zod,"pattern",()=>{if(e.options.every(i=>i._zod.pattern)){const i=e.options.map(a=>a._zod.pattern);return new RegExp(`^(${i.map(a=>K0(a.source)).join("|")})$`)}});const n=e.options.length===1,r=e.options[0]._zod.run;t._zod.parse=(i,a)=>{if(n)return r(i,a);let o=!1;const l=[];for(const c of e.options){const d=c._zod.run({value:i.value,issues:[]},a);if(d instanceof Promise)l.push(d),o=!0;else{if(d.issues.length===0)return d;l.push(d)}}return o?Promise.all(l).then(c=>cx(c,i,t,a)):cx(l,i,t,a)}}),K_=Ve("$ZodIntersection",(t,e)=>{tr.init(t,e),t._zod.parse=(n,r)=>{const i=n.value,a=e.left._zod.run({value:i,issues:[]},r),o=e.right._zod.run({value:i,issues:[]},r);return a instanceof Promise||o instanceof Promise?Promise.all([a,o]).then(([c,d])=>ux(n,c,d)):ux(n,a,o)}});function kg(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Xu(t)&&Xu(e)){const n=Object.keys(e),r=Object.keys(t).filter(a=>n.indexOf(a)!==-1),i={...t,...e};for(const a of r){const o=kg(t[a],e[a]);if(!o.valid)return{valid:!1,mergeErrorPath:[a,...o.mergeErrorPath]};i[a]=o.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<t.length;r++){const i=t[r],a=e[r],o=kg(i,a);if(!o.valid)return{valid:!1,mergeErrorPath:[r,...o.mergeErrorPath]};n.push(o.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function ux(t,e,n){if(e.issues.length&&t.issues.push(...e.issues),n.issues.length&&t.issues.push(...n.issues),Kl(t))return t;const r=kg(e.value,n.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return t.value=r.data,t}const Y_=Ve("$ZodEnum",(t,e)=>{tr.init(t,e);const n=sS(e.entries),r=new Set(n);t._zod.values=r,t._zod.pattern=new RegExp(`^(${n.filter(i=>lS.has(typeof i)).map(i=>typeof i=="string"?Jf(i):i.toString()).join("|")})$`),t._zod.parse=(i,a)=>{const o=i.value;return r.has(o)||i.issues.push({code:"invalid_value",values:n,input:o,inst:t}),i}}),Q_=Ve("$ZodTransform",(t,e)=>{tr.init(t,e),t._zod.parse=(n,r)=>{if(r.direction==="backward")throw new M5(t.constructor.name);const i=e.transform(n.value,n);if(r.async)return(i instanceof Promise?i:Promise.resolve(i)).then(o=>(n.value=o,n));if(i instanceof Promise)throw new ic;return n.value=i,n}});function dx(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}const X_=Ve("$ZodOptional",(t,e)=>{tr.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Sn(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Sn(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${K0(n.source)})?$`):void 0}),t._zod.parse=(n,r)=>{if(e.innerType._zod.optin==="optional"){const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(a=>dx(a,n.value)):dx(i,n.value)}return n.value===void 0?n:e.innerType._zod.run(n,r)}}),e3=Ve("$ZodNullable",(t,e)=>{tr.init(t,e),Sn(t._zod,"optin",()=>e.innerType._zod.optin),Sn(t._zod,"optout",()=>e.innerType._zod.optout),Sn(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${K0(n.source)}|null)$`):void 0}),Sn(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(n,r)=>n.value===null?n:e.innerType._zod.run(n,r)}),t3=Ve("$ZodDefault",(t,e)=>{tr.init(t,e),t._zod.optin="optional",Sn(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{if(r.direction==="backward")return e.innerType._zod.run(n,r);if(n.value===void 0)return n.value=e.defaultValue,n;const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(a=>hx(a,e)):hx(i,e)}});function hx(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const n3=Ve("$ZodPrefault",(t,e)=>{tr.init(t,e),t._zod.optin="optional",Sn(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>(r.direction==="backward"||n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,r))}),r3=Ve("$ZodNonOptional",(t,e)=>{tr.init(t,e),Sn(t._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),t._zod.parse=(n,r)=>{const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(a=>fx(a,t)):fx(i,t)}});function fx(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const s3=Ve("$ZodCatch",(t,e)=>{tr.init(t,e),Sn(t._zod,"optin",()=>e.innerType._zod.optin),Sn(t._zod,"optout",()=>e.innerType._zod.optout),Sn(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{if(r.direction==="backward")return e.innerType._zod.run(n,r);const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(a=>(n.value=a.value,a.issues.length&&(n.value=e.catchValue({...n,error:{issues:a.issues.map(o=>Ko(o,r,Jo()))},input:n.value}),n.issues=[]),n)):(n.value=i.value,i.issues.length&&(n.value=e.catchValue({...n,error:{issues:i.issues.map(a=>Ko(a,r,Jo()))},input:n.value}),n.issues=[]),n)}}),i3=Ve("$ZodPipe",(t,e)=>{tr.init(t,e),Sn(t._zod,"values",()=>e.in._zod.values),Sn(t._zod,"optin",()=>e.in._zod.optin),Sn(t._zod,"optout",()=>e.out._zod.optout),Sn(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(n,r)=>{if(r.direction==="backward"){const a=e.out._zod.run(n,r);return a instanceof Promise?a.then(o=>bh(o,e.in,r)):bh(a,e.in,r)}const i=e.in._zod.run(n,r);return i instanceof Promise?i.then(a=>bh(a,e.out,r)):bh(i,e.out,r)}});function bh(t,e,n){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},n)}const a3=Ve("$ZodReadonly",(t,e)=>{tr.init(t,e),Sn(t._zod,"propValues",()=>e.innerType._zod.propValues),Sn(t._zod,"values",()=>e.innerType._zod.values),Sn(t._zod,"optin",()=>e.innerType._zod.optin),Sn(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(n,r)=>{if(r.direction==="backward")return e.innerType._zod.run(n,r);const i=e.innerType._zod.run(n,r);return i instanceof Promise?i.then(mx):mx(i)}});function mx(t){return t.value=Object.freeze(t.value),t}const o3=Ve("$ZodCustom",(t,e)=>{Ns.init(t,e),tr.init(t,e),t._zod.parse=(n,r)=>n,t._zod.check=n=>{const r=n.value,i=e.fn(r);if(i instanceof Promise)return i.then(a=>px(a,n,r,t));px(i,n,r,t)}});function px(t,e,n,r){if(!t){const i={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(i.params=r._zod.def.params),e.issues.push(ed(i))}}class l3{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...n){const r=n[0];if(this._map.set(e,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const r={...this.get(n)??{}};delete r.id;const i={...r,...this._map.get(e)};return Object.keys(i).length?i:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function c3(){return new l3}const wh=c3();function u3(t,e){return new t({type:"string",..._t(e)})}function d3(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,..._t(e)})}function gx(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,..._t(e)})}function h3(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,..._t(e)})}function f3(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",..._t(e)})}function m3(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",..._t(e)})}function p3(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",..._t(e)})}function g3(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,..._t(e)})}function v3(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,..._t(e)})}function x3(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,..._t(e)})}function y3(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,..._t(e)})}function b3(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,..._t(e)})}function w3(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,..._t(e)})}function N3(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,..._t(e)})}function j3(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,..._t(e)})}function S3(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,..._t(e)})}function _3(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,..._t(e)})}function k3(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,..._t(e)})}function C3(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,..._t(e)})}function A3(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,..._t(e)})}function P3(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,..._t(e)})}function I3(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,..._t(e)})}function E3(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,..._t(e)})}function L3(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,..._t(e)})}function T3(t,e){return new t({type:"string",format:"date",check:"string_format",..._t(e)})}function z3(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,..._t(e)})}function O3(t,e){return new t({type:"string",format:"duration",check:"string_format",..._t(e)})}function D3(t,e){return new t({type:"number",checks:[],..._t(e)})}function M3(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",..._t(e)})}function R3(t,e){return new t({type:"boolean",..._t(e)})}function F3(t){return new t({type:"unknown"})}function $3(t,e){return new t({type:"never",..._t(e)})}function vx(t,e){return new Z5({check:"less_than",..._t(e),value:t,inclusive:!1})}function up(t,e){return new Z5({check:"less_than",..._t(e),value:t,inclusive:!0})}function xx(t,e){return new J5({check:"greater_than",..._t(e),value:t,inclusive:!1})}function dp(t,e){return new J5({check:"greater_than",..._t(e),value:t,inclusive:!0})}function yx(t,e){return new r_({check:"multiple_of",..._t(e),value:t})}function eb(t,e){return new i_({check:"max_length",..._t(e),maximum:t})}function Cf(t,e){return new a_({check:"min_length",..._t(e),minimum:t})}function tb(t,e){return new o_({check:"length_equals",..._t(e),length:t})}function B3(t,e){return new l_({check:"string_format",format:"regex",..._t(e),pattern:t})}function q3(t){return new c_({check:"string_format",format:"lowercase",..._t(t)})}function U3(t){return new u_({check:"string_format",format:"uppercase",..._t(t)})}function V3(t,e){return new d_({check:"string_format",format:"includes",..._t(e),includes:t})}function H3(t,e){return new h_({check:"string_format",format:"starts_with",..._t(e),prefix:t})}function G3(t,e){return new f_({check:"string_format",format:"ends_with",..._t(e),suffix:t})}function fd(t){return new m_({check:"overwrite",tx:t})}function W3(t){return fd(e=>e.normalize(t))}function Z3(){return fd(t=>t.trim())}function J3(){return fd(t=>t.toLowerCase())}function K3(){return fd(t=>t.toUpperCase())}function Y3(t,e,n){return new t({type:"array",element:e,..._t(n)})}function Q3(t,e,n){return new t({type:"custom",check:"custom",fn:e,..._t(n)})}function X3(t){const e=ek(n=>(n.addIssue=r=>{if(typeof r=="string")n.issues.push(ed(r,n.value,e._zod.def));else{const i=r;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=n.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),n.issues.push(ed(i))}},t(n.value,n)));return e}function ek(t,e){const n=new Ns({check:"custom",..._t(e)});return n._zod.check=t,n}const tk=Ve("ZodISODateTime",(t,e)=>{A_.init(t,e),Rn.init(t,e)});function nk(t){return L3(tk,t)}const rk=Ve("ZodISODate",(t,e)=>{P_.init(t,e),Rn.init(t,e)});function sk(t){return T3(rk,t)}const ik=Ve("ZodISOTime",(t,e)=>{I_.init(t,e),Rn.init(t,e)});function ak(t){return z3(ik,t)}const ok=Ve("ZodISODuration",(t,e)=>{E_.init(t,e),Rn.init(t,e)});function lk(t){return O3(ok,t)}const ck=(t,e)=>{q5.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:n=>yS(t,n)},flatten:{value:n=>xS(t,n)},addIssue:{value:n=>{t.issues.push(n),t.message=JSON.stringify(t.issues,_g,2)}},addIssues:{value:n=>{t.issues.push(...n),t.message=JSON.stringify(t.issues,_g,2)}},isEmpty:{get(){return t.issues.length===0}}})},ni=Ve("ZodError",ck,{Parent:Error}),uk=Q0(ni),dk=X0(ni),hk=Kf(ni),fk=Yf(ni),mk=NS(ni),pk=jS(ni),gk=SS(ni),vk=_S(ni),xk=kS(ni),yk=CS(ni),bk=AS(ni),wk=PS(ni),lr=Ve("ZodType",(t,e)=>(tr.init(t,e),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone({...e,checks:[...e.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),t.clone=(n,r)=>fo(t,n,r),t.brand=()=>t,t.register=(n,r)=>(n.add(t,r),t),t.parse=(n,r)=>uk(t,n,r,{callee:t.parse}),t.safeParse=(n,r)=>hk(t,n,r),t.parseAsync=async(n,r)=>dk(t,n,r,{callee:t.parseAsync}),t.safeParseAsync=async(n,r)=>fk(t,n,r),t.spa=t.safeParseAsync,t.encode=(n,r)=>mk(t,n,r),t.decode=(n,r)=>pk(t,n,r),t.encodeAsync=async(n,r)=>gk(t,n,r),t.decodeAsync=async(n,r)=>vk(t,n,r),t.safeEncode=(n,r)=>xk(t,n,r),t.safeDecode=(n,r)=>yk(t,n,r),t.safeEncodeAsync=async(n,r)=>bk(t,n,r),t.safeDecodeAsync=async(n,r)=>wk(t,n,r),t.refine=(n,r)=>t.check(m6(n,r)),t.superRefine=n=>t.check(p6(n)),t.overwrite=n=>t.check(fd(n)),t.optional=()=>jx(t),t.nullable=()=>Sx(t),t.nullish=()=>jx(Sx(t)),t.nonoptional=n=>o6(t,n),t.array=()=>Wk(t),t.or=n=>Kk([t,n]),t.and=n=>Qk(t,n),t.transform=n=>_x(t,t6(n)),t.default=n=>s6(t,n),t.prefault=n=>a6(t,n),t.catch=n=>c6(t,n),t.pipe=n=>_x(t,n),t.readonly=()=>h6(t),t.describe=n=>{const r=t.clone();return wh.add(r,{description:n}),r},Object.defineProperty(t,"description",{get(){var n;return(n=wh.get(t))==null?void 0:n.description},configurable:!0}),t.meta=(...n)=>{if(n.length===0)return wh.get(t);const r=t.clone();return wh.add(r,n[0]),r},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),nb=Ve("_ZodString",(t,e)=>{e1.init(t,e),lr.init(t,e);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...r)=>t.check(B3(...r)),t.includes=(...r)=>t.check(V3(...r)),t.startsWith=(...r)=>t.check(H3(...r)),t.endsWith=(...r)=>t.check(G3(...r)),t.min=(...r)=>t.check(Cf(...r)),t.max=(...r)=>t.check(eb(...r)),t.length=(...r)=>t.check(tb(...r)),t.nonempty=(...r)=>t.check(Cf(1,...r)),t.lowercase=r=>t.check(q3(r)),t.uppercase=r=>t.check(U3(r)),t.trim=()=>t.check(Z3()),t.normalize=(...r)=>t.check(W3(...r)),t.toLowerCase=()=>t.check(J3()),t.toUpperCase=()=>t.check(K3())}),Nk=Ve("ZodString",(t,e)=>{e1.init(t,e),nb.init(t,e),t.email=n=>t.check(d3(jk,n)),t.url=n=>t.check(g3(Sk,n)),t.jwt=n=>t.check(E3(Fk,n)),t.emoji=n=>t.check(v3(_k,n)),t.guid=n=>t.check(gx(bx,n)),t.uuid=n=>t.check(h3(Nh,n)),t.uuidv4=n=>t.check(f3(Nh,n)),t.uuidv6=n=>t.check(m3(Nh,n)),t.uuidv7=n=>t.check(p3(Nh,n)),t.nanoid=n=>t.check(x3(kk,n)),t.guid=n=>t.check(gx(bx,n)),t.cuid=n=>t.check(y3(Ck,n)),t.cuid2=n=>t.check(b3(Ak,n)),t.ulid=n=>t.check(w3(Pk,n)),t.base64=n=>t.check(A3(Dk,n)),t.base64url=n=>t.check(P3(Mk,n)),t.xid=n=>t.check(N3(Ik,n)),t.ksuid=n=>t.check(j3(Ek,n)),t.ipv4=n=>t.check(S3(Lk,n)),t.ipv6=n=>t.check(_3(Tk,n)),t.cidrv4=n=>t.check(k3(zk,n)),t.cidrv6=n=>t.check(C3(Ok,n)),t.e164=n=>t.check(I3(Rk,n)),t.datetime=n=>t.check(nk(n)),t.date=n=>t.check(sk(n)),t.time=n=>t.check(ak(n)),t.duration=n=>t.check(lk(n))});function td(t){return u3(Nk,t)}const Rn=Ve("ZodStringFormat",(t,e)=>{En.init(t,e),nb.init(t,e)}),jk=Ve("ZodEmail",(t,e)=>{y_.init(t,e),Rn.init(t,e)}),bx=Ve("ZodGUID",(t,e)=>{v_.init(t,e),Rn.init(t,e)}),Nh=Ve("ZodUUID",(t,e)=>{x_.init(t,e),Rn.init(t,e)}),Sk=Ve("ZodURL",(t,e)=>{b_.init(t,e),Rn.init(t,e)}),_k=Ve("ZodEmoji",(t,e)=>{w_.init(t,e),Rn.init(t,e)}),kk=Ve("ZodNanoID",(t,e)=>{N_.init(t,e),Rn.init(t,e)}),Ck=Ve("ZodCUID",(t,e)=>{j_.init(t,e),Rn.init(t,e)}),Ak=Ve("ZodCUID2",(t,e)=>{S_.init(t,e),Rn.init(t,e)}),Pk=Ve("ZodULID",(t,e)=>{__.init(t,e),Rn.init(t,e)}),Ik=Ve("ZodXID",(t,e)=>{k_.init(t,e),Rn.init(t,e)}),Ek=Ve("ZodKSUID",(t,e)=>{C_.init(t,e),Rn.init(t,e)}),Lk=Ve("ZodIPv4",(t,e)=>{L_.init(t,e),Rn.init(t,e)}),Tk=Ve("ZodIPv6",(t,e)=>{T_.init(t,e),Rn.init(t,e)}),zk=Ve("ZodCIDRv4",(t,e)=>{z_.init(t,e),Rn.init(t,e)}),Ok=Ve("ZodCIDRv6",(t,e)=>{O_.init(t,e),Rn.init(t,e)}),Dk=Ve("ZodBase64",(t,e)=>{D_.init(t,e),Rn.init(t,e)}),Mk=Ve("ZodBase64URL",(t,e)=>{R_.init(t,e),Rn.init(t,e)}),Rk=Ve("ZodE164",(t,e)=>{F_.init(t,e),Rn.init(t,e)}),Fk=Ve("ZodJWT",(t,e)=>{B_.init(t,e),Rn.init(t,e)}),rb=Ve("ZodNumber",(t,e)=>{Y5.init(t,e),lr.init(t,e),t.gt=(r,i)=>t.check(xx(r,i)),t.gte=(r,i)=>t.check(dp(r,i)),t.min=(r,i)=>t.check(dp(r,i)),t.lt=(r,i)=>t.check(vx(r,i)),t.lte=(r,i)=>t.check(up(r,i)),t.max=(r,i)=>t.check(up(r,i)),t.int=r=>t.check(wx(r)),t.safe=r=>t.check(wx(r)),t.positive=r=>t.check(xx(0,r)),t.nonnegative=r=>t.check(dp(0,r)),t.negative=r=>t.check(vx(0,r)),t.nonpositive=r=>t.check(up(0,r)),t.multipleOf=(r,i)=>t.check(yx(r,i)),t.step=(r,i)=>t.check(yx(r,i)),t.finite=()=>t;const n=t._zod.bag;t.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),t.isFinite=!0,t.format=n.format??null});function Cg(t){return D3(rb,t)}const $k=Ve("ZodNumberFormat",(t,e)=>{q_.init(t,e),rb.init(t,e)});function wx(t){return M3($k,t)}const Bk=Ve("ZodBoolean",(t,e)=>{U_.init(t,e),lr.init(t,e)});function qk(t){return R3(Bk,t)}const Uk=Ve("ZodUnknown",(t,e)=>{V_.init(t,e),lr.init(t,e)});function Nx(){return F3(Uk)}const Vk=Ve("ZodNever",(t,e)=>{H_.init(t,e),lr.init(t,e)});function Hk(t){return $3(Vk,t)}const Gk=Ve("ZodArray",(t,e)=>{G_.init(t,e),lr.init(t,e),t.element=e.element,t.min=(n,r)=>t.check(Cf(n,r)),t.nonempty=n=>t.check(Cf(1,n)),t.max=(n,r)=>t.check(eb(n,r)),t.length=(n,r)=>t.check(tb(n,r)),t.unwrap=()=>t.element});function Wk(t,e){return Y3(Gk,t,e)}const Zk=Ve("ZodObject",(t,e)=>{Z_.init(t,e),lr.init(t,e),Sn(t,"shape",()=>e.shape),t.keyof=()=>Xk(Object.keys(t._zod.def.shape)),t.catchall=n=>t.clone({...t._zod.def,catchall:n}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Nx()}),t.loose=()=>t.clone({...t._zod.def,catchall:Nx()}),t.strict=()=>t.clone({...t._zod.def,catchall:Hk()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=n=>fS(t,n),t.safeExtend=n=>mS(t,n),t.merge=n=>pS(t,n),t.pick=n=>dS(t,n),t.omit=n=>hS(t,n),t.partial=(...n)=>gS(sb,t,n[0]),t.required=(...n)=>vS(ib,t,n[0])});function nd(t,e){const n={type:"object",get shape(){return ho(this,"shape",t?aS(t):{}),this.shape},..._t(e)};return new Zk(n)}const Jk=Ve("ZodUnion",(t,e)=>{J_.init(t,e),lr.init(t,e),t.options=e.options});function Kk(t,e){return new Jk({type:"union",options:t,..._t(e)})}const Yk=Ve("ZodIntersection",(t,e)=>{K_.init(t,e),lr.init(t,e)});function Qk(t,e){return new Yk({type:"intersection",left:t,right:e})}const Ag=Ve("ZodEnum",(t,e)=>{Y_.init(t,e),lr.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(r,i)=>{const a={};for(const o of r)if(n.has(o))a[o]=e.entries[o];else throw new Error(`Key ${o} not found in enum`);return new Ag({...e,checks:[],..._t(i),entries:a})},t.exclude=(r,i)=>{const a={...e.entries};for(const o of r)if(n.has(o))delete a[o];else throw new Error(`Key ${o} not found in enum`);return new Ag({...e,checks:[],..._t(i),entries:a})}});function Xk(t,e){const n=Array.isArray(t)?Object.fromEntries(t.map(r=>[r,r])):t;return new Ag({type:"enum",entries:n,..._t(e)})}const e6=Ve("ZodTransform",(t,e)=>{Q_.init(t,e),lr.init(t,e),t._zod.parse=(n,r)=>{if(r.direction==="backward")throw new M5(t.constructor.name);n.addIssue=a=>{if(typeof a=="string")n.issues.push(ed(a,n.value,e));else{const o=a;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=n.value),o.inst??(o.inst=t),n.issues.push(ed(o))}};const i=e.transform(n.value,n);return i instanceof Promise?i.then(a=>(n.value=a,n)):(n.value=i,n)}});function t6(t){return new e6({type:"transform",transform:t})}const sb=Ve("ZodOptional",(t,e)=>{X_.init(t,e),lr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function jx(t){return new sb({type:"optional",innerType:t})}const n6=Ve("ZodNullable",(t,e)=>{e3.init(t,e),lr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Sx(t){return new n6({type:"nullable",innerType:t})}const r6=Ve("ZodDefault",(t,e)=>{t3.init(t,e),lr.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function s6(t,e){return new r6({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():F5(e)}})}const i6=Ve("ZodPrefault",(t,e)=>{n3.init(t,e),lr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function a6(t,e){return new i6({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():F5(e)}})}const ib=Ve("ZodNonOptional",(t,e)=>{r3.init(t,e),lr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function o6(t,e){return new ib({type:"nonoptional",innerType:t,..._t(e)})}const l6=Ve("ZodCatch",(t,e)=>{s3.init(t,e),lr.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function c6(t,e){return new l6({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const u6=Ve("ZodPipe",(t,e)=>{i3.init(t,e),lr.init(t,e),t.in=e.in,t.out=e.out});function _x(t,e){return new u6({type:"pipe",in:t,out:e})}const d6=Ve("ZodReadonly",(t,e)=>{a3.init(t,e),lr.init(t,e),t.unwrap=()=>t._zod.def.innerType});function h6(t){return new d6({type:"readonly",innerType:t})}const f6=Ve("ZodCustom",(t,e)=>{o3.init(t,e),lr.init(t,e)});function m6(t,e={}){return Q3(f6,t,e)}function p6(t){return X3(t)}const Af=td().min(1),g6=nd({min:Cg(),max:Cg()}).refine(t=>t.min<t.max,{message:"validation.range_min_lt_max"}),v6=nd({id:Af,label:td().min(1,{message:"validation.required_label"}),range:g6,alarm:nd({enabled:qk(),threshold:Cg().optional()}).optional(),type:td().optional()}),x6=nd({id:Af,name:td().min(1,{message:"validation.required_name"}),departmentId:Af.optional()}),y6=nd({id:Af,name:td().min(1,{message:"validation.required_name"})});function ab(t){return v6.safeParse(t)}function ob(t){return x6.safeParse(t)}function lb(t){return y6.safeParse(t)}const b6={validateForm:(t,e,n)=>{switch(t){case"refrigerators":case"conservationPoints":return ab(e);case"staff":return ob(e);case"departments":return lb(e);default:return{success:!1,error:new Error(`Unknown entity type: ${t}`)}}}};let jh="warn";const t1={setLevel:t=>{jh=t},child:t=>({debug:(...e)=>jh==="debug"&&console.debug(`[${t}]`,...e),info:(...e)=>(jh==="debug"||jh==="info")&&console.info(`[${t}]`,...e),warn:(...e)=>console.warn(`[${t}]`,...e),error:(...e)=>console.error(`[${t}]`,...e)})},iu=t1.child("FORM"),Co=t1.child("HACCP"),Zn=t1.child("FormManager"),w6=(t,e,n)=>{var i,a;let r;switch(t){case"conservationPoints":r=ab(e);break;case"staff":r=ob(e);break;case"departments":r=lb(e);break;default:return{isValid:!1,errors:{general:"Tipo di entit non supportato"},fieldErrors:{}}}return r.success?{isValid:!0,errors:{},fieldErrors:{}}:{isValid:!1,errors:{general:"Dati non validi"},fieldErrors:((a=(i=r.error)==null?void 0:i.issues)==null?void 0:a.reduce((o,l)=>(o[l.path.join(".")]=l.message,o),{}))||{}}},cb=q.createContext(null),ub=()=>{const t=q.useContext(cb);if(!t)throw new Error("useFormManager deve essere usato dentro FormManagerProvider");return t},N6=({children:t})=>{var k,y;const e=sc();if(!e||!e.meta)return console.warn("[FormManager] Store non inizializzato, rendering fallback"),s.jsx(s.Fragment,{children:t});const n=q.useCallback(b=>{if(!e.meta||!e.meta.forms)return!1;const j=e.meta.forms[b];return j?j.mode!=="idle":!1},[(k=e.meta)==null?void 0:k.forms]),r=q.useCallback(b=>!e.meta||!e.meta.forms?{mode:"idle",draft:{},errors:{}}:e.meta.forms[b]||{mode:"idle",draft:{},errors:{}},[(y=e.meta)==null?void 0:y.forms]),i=q.useCallback(b=>r(b).draft||{},[r]),a=q.useCallback(b=>r(b).errors||{},[r]),o=q.useCallback(b=>(Zn.debug(`Tentativo apertura form create per ${b}`),n(b)?(Zn.warn(`Form ${b} gi aperto, bloccando apertura`),!1):(e.openCreateForm(b),Zn.info(`Form create aperto per ${b}`),!0)),[e,n]),l=q.useCallback((b,j)=>(Zn.debug(`Tentativo apertura form edit per ${b} con id ${j}`),n(b)?(Zn.warn(`Form ${b} gi aperto, bloccando apertura`),!1):(e.openEditForm(b,j),Zn.info(`Form edit aperto per ${b} con id ${j}`),!0)),[e,n]),c=q.useCallback(b=>{Zn.debug(`Chiusura form per ${b}`),e.closeForm(b)},[e]),d=q.useCallback((b,j)=>{Zn.debug(`Aggiornamento draft per ${b}`,j),e.updateDraft(b,j)},[e]),f=q.useCallback((b,j)=>{Zn.debug(`Impostazione errori per ${b}`,j),e.setFormErrors(b,j)},[e]),p=q.useCallback((b,j,C)=>{Zn.debug(`Validazione form ${b} in modalit ${C}`);const B=w6(b,j);return B.isValid?(f(b,{}),Zn.info(`Validazione passata per ${b}`),!0):(Zn.warn(`Validazione fallita per ${b}`,B.errors),f(b,B.fieldErrors),!1)},[f]),v=q.useCallback(async(b,j)=>{Zn.debug(`Commit form ${b} in modalit ${j}`);const C=r(b);if(C.mode==="idle")return Zn.warn(`Nessun form attivo per ${b}`),!1;const B=C.draft;if(!B||Object.keys(B).length===0)return Zn.warn(`Draft vuoto per ${b}`),!1;if(!p(b,B,j))return Zn.error(`Validazione fallita per ${b}`),!1;try{if(j==="create"){const K=`${b}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Z={...B,id:K};e.addEntity(b,Z),Zn.info(`Entit ${b} creata con id ${K}`)}else{const K=C.editId;if(!K)return Zn.error(`ID mancante per aggiornamento ${b}`),!1;e.updateEntity(b,K,B),Zn.info(`Entit ${b} aggiornata con id ${K}`)}return c(b),Zn.info(`Form ${b} committato con successo`),!0}catch(K){return Zn.error(`Errore nel commit form ${b}`,K),!1}},[r,p,e,c]),m=q.useCallback(b=>n(b),[n]),N=q.useCallback(b=>`Un form per ${{refrigerators:"frigorifero",temperatures:"temperatura",cleaning:"pulizia",staff:"membro dello staff",inventory:"prodotto",departments:"reparto",suppliers:"fornitore"}[b]||b}  gi aperto. Chiudilo prima di aprirne un altro.`,[]),_={isFormOpen:n,getFormState:r,getFormDraft:i,getFormErrors:a,openCreateForm:o,openEditForm:l,closeForm:c,updateDraft:d,setFormErrors:f,validateForm:p,commitForm:v,hasFormConflict:m,getFormConflictMessage:N};return s.jsx(cb.Provider,{value:_,children:t})},j6=({entityType:t,children:e,fallback:n})=>{const{isFormOpen:r,getFormConflictMessage:i}=ub();return r(t)?s.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),s.jsx("div",{className:"ml-3",children:s.jsx("p",{className:"text-sm text-yellow-700",children:i(t)})})]}),n]}):s.jsx(s.Fragment,{children:e})},S6=t=>{const e=t.entities.refrigerators,n=t.entities.temperatures,r=e.length,i=e.filter(l=>{const c=n.filter(v=>v.refrigeratorId===l.id).sort((v,m)=>new Date(m.timestamp).toISOString().localeCompare(v.timestamp))[0];if(!c)return!1;const d=parseFloat(c.temperature.toString()),f=parseFloat(l.targetTemp.toString()),p=2;return Math.abs(d-f)<=p}).length,a=n.filter(l=>l.status==="danger").length,o=n.filter(l=>{const c=new Date(l.timestamp),d=new Date(Date.now()-24*60*60*1e3);return c>d}).length;return{total:r,compliant:i,critical:a,recent:o}},_6=t=>{const e=parseFloat(t.targetTemp);return t.isAbbattitore?"abbattitore":e<=-15?"freezer":e>0?"ambiente":"frigorifero"},k6=t=>{const e=t.entities.refrigerators,n={frigorifero:[],freezer:[],abbattitore:[],ambiente:[]};return e.forEach(r=>{const i=_6(r);n[i].push(r)}),n},C6=t=>{const e={frigorifero:{label:"Frigoriferi",textColor:"text-blue-600",bgColor:"bg-blue-100",borderColor:"border-blue-300",emptyBg:"bg-blue-50",emptyTextColor:"text-blue-600",emptyMessage:"Nessun frigorifero configurato"},freezer:{label:"Freezer",textColor:"text-cyan-600",bgColor:"bg-cyan-100",borderColor:"border-cyan-300",emptyBg:"bg-cyan-50",emptyTextColor:"text-cyan-600",emptyMessage:"Nessun freezer configurato"},abbattitore:{label:"Abbattitori",textColor:"text-orange-600",bgColor:"bg-orange-100",borderColor:"border-orange-300",emptyBg:"bg-orange-50",emptyTextColor:"text-orange-600",emptyMessage:"Nessun abbattitore configurato"},ambiente:{label:"Ambiente",textColor:"text-green-600",bgColor:"bg-green-100",borderColor:"border-green-300",emptyBg:"bg-green-50",emptyTextColor:"text-green-600",emptyMessage:"Nessun punto ambiente configurato"}};return e[t]||e.frigorifero};function A6({temperatures:t=[],setTemperatures:e,currentUser:n,refrigerators:r=[],setRefrigerators:i,departments:a=[],setDepartments:o}){var te,I,A,T,F,ne,W,ue;const{openCreateForm:l,openEditForm:c,closeForm:d,updateDraft:f,commitForm:p,isFormOpen:v}=ub(),m=sc(),{formRef:N,scrollToForm:_}=Zo(v("refrigerators"),"conservation-point-form"),k=sc(S6),y=sc(k6),b=[{id:"fresh_dairy",name:"Latticini Freschi",tempRange:[2,4]},{id:"fresh_meat",name:"Carni Fresche",tempRange:[0,2]},{id:"fresh_produce",name:"Prodotti Freschi",tempRange:[2,4]},{id:"fresh_beverages",name:"Bevande Fresche",tempRange:[4,6]},{id:"chilled_ready",name:"Pronti al Consumo",tempRange:[2,4]},{id:"frozen",name:"Congelati",tempRange:[-18,-15]},{id:"deep_frozen",name:"Surgelati",tempRange:[-22,-18]}],j=()=>{iu.debug("Tentativo apertura form creazione frigorifero"),l("refrigerators")&&(f("refrigerators",{name:"",location:"",targetTemp:4,selectedCategories:[],isAbbattitore:!1}),setTimeout(()=>_(),100))},C=P=>{iu.debug(`Tentativo apertura form modifica frigorifero ${P.id}`),c("refrigerators",P.id)&&(f("refrigerators",{name:P.name,location:P.location,targetTemp:P.targetTemp,selectedCategories:P.selectedCategories||[],isAbbattitore:P.isAbbattitore||!1}),setTimeout(()=>_(),100))},B=()=>{iu.debug("Chiusura form frigorifero"),d("refrigerators")},K=(P,Q)=>{iu.debug(`Aggiornamento draft: ${P} = ${Q}`),f("refrigerators",{[P]:Q})},Z=P=>{var w;const G=(((w=m.meta.forms.refrigerators)==null?void 0:w.draft)||{}).selectedCategories||[];if(G.includes(P)){const O=G.filter(R=>R!==P);K("selectedCategories",O)}else if(G.length<5){const O=[...G,P];K("selectedCategories",O)}else Co.warn("Limite massimo di 5 categorie raggiunto")},z=async()=>{iu.debug("Tentativo submit form frigorifero");const P=m.meta.forms.refrigerators;if(!P||P.mode==="idle"){Co.warn("Nessun form attivo per il submit");return}const Q=P.draft,G=P.mode==="create"?"create":"update",de=b6.validateForm("refrigerators",Q,G);if(!de.isValid){Co.warn("Validazione fallita",de.errors);return}await p("refrigerators",G)?Co.info("Frigorifero salvato con successo"):Co.error("Errore nel salvataggio del frigorifero")},J=P=>{confirm("Sei sicuro di voler eliminare questo frigorifero?")&&(Co.info(`Eliminazione frigorifero ${P}`),i(r.filter(Q=>Q.id!==P)),e(t.filter(Q=>Q.refrigeratorId!==P)),Co.info("Frigorifero eliminato con successo"))};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(vu,{title:"Punti di Conservazione",subtitle:"Gestione frigoriferi e temperature",icon:ws,iconColor:"text-blue-600",iconBgColor:"bg-blue-100",count:k.total,testId:"pc-list",defaultExpanded:!0,children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:Object.entries(y).map(([P,Q])=>{const G=C6(P);return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-center",children:s.jsx("h3",{className:`text-lg font-semibold ${G.textColor}`,children:G.label})}),s.jsx("div",{className:`space-y-3 p-4 rounded-lg border-2 ${G.borderColor} ${G.bgColor}`,children:Q.length===0?s.jsx("div",{className:`text-center p-4 rounded-lg ${G.emptyBg}`,children:s.jsx("p",{className:`text-sm ${G.emptyTextColor}`,children:G.emptyMessage})}):Q.map(de=>{const w=t.filter(R=>R.refrigeratorId===de.id).sort((R,H)=>new Date(H.timestamp)-new Date(R.timestamp))[0],O=w?Math.abs(parseFloat(w.temperature)-parseFloat(de.targetTemp))<=2:!1;return s.jsx(ot,{className:"border border-gray-200 rounded-lg shadow-sm",children:s.jsxs(et,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:de.name}),s.jsx("p",{className:"text-sm text-gray-500",children:w?`${w.temperature}C`:"Nessun dato"})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(le,{variant:"outline",size:"sm",onClick:()=>C(de),className:"h-8 w-8 p-0",children:s.jsx(wi,{className:"h-4 w-4"})}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>J(de.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:s.jsx(er,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:"text-sm text-gray-600",children:[" ",de.location]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ws,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[de.targetTemp,"C"]}),w&&(O?s.jsx(kn,{className:"h-4 w-4 text-green-500"}):s.jsx(pn,{className:"h-4 w-4 text-red-500"}))]}),de.selectedCategories&&de.selectedCategories.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:de.selectedCategories.map(R=>{const H=b.find(re=>re.id===R);return H?s.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:H.name},R):null})})]})]})},de.id)})})]},P)})}),s.jsx("div",{className:"mt-6",children:s.jsx(j6,{entityType:"refrigerators",children:s.jsxs(le,{onClick:j,className:"w-full",variant:"outline",children:[s.jsx(pr,{className:"h-4 w-4 mr-2"}),"Aggiungi Frigorifero"]})})})]}),s.jsx(vu,{title:"Attivit Registro Temperature",subtitle:"Monitoraggio e registrazione temperature",icon:b4,iconColor:"text-green-600",iconBgColor:"bg-green-100",count:k.recent,testId:"pc-registro",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Registra le temperature dei frigoriferi per mantenere la compliance HACCP."}),s.jsx("div",{className:"space-y-2",children:t.slice(0,5).map(P=>{const Q=r.find(G=>G.id===P.refrigeratorId);return s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:(Q==null?void 0:Q.name)||"Frigorifero sconosciuto"}),s.jsx("p",{className:"text-sm text-gray-600",children:new Date(P.timestamp).toLocaleString("it-IT")})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:`font-bold ${P.status==="danger"?"text-red-600":P.status==="warning"?"text-yellow-600":"text-green-600"}`,children:[P.temperature,"C"]}),s.jsx("p",{className:"text-xs text-gray-500",children:P.status})]})]},P.id)})})]})}),s.jsx(vu,{title:"Stato Punti di Conservazione",subtitle:"Overview compliance e statistiche",icon:Wo,iconColor:"text-purple-600",iconBgColor:"bg-purple-100",count:k.compliant,testId:"pc-stato",children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:k.total}),s.jsx("p",{className:"text-sm text-blue-700",children:"Totale Frigoriferi"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("p",{className:"text-2xl font-bold text-green-600",children:k.compliant}),s.jsx("p",{className:"text-sm text-green-700",children:"Compliant"})]}),s.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[s.jsx("p",{className:"text-2xl font-bold text-red-600",children:k.critical}),s.jsx("p",{className:"text-sm text-red-700",children:"Critici"})]}),s.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:k.recent}),s.jsx("p",{className:"text-sm text-yellow-700",children:"Ultime 24h"})]})]})}),s.jsx(vu,{title:"Riferimenti Normativi EU/ASL",subtitle:"Normative europee e linee guida ASL",icon:pn,iconColor:"text-orange-600",iconBgColor:"bg-orange-100",count:3,testId:"pc-normative",children:s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"grid gap-4",children:[s.jsx(ot,{className:"border-l-4 border-l-orange-500",children:s.jsxs(et,{className:"p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Regolamento UE 852/2004"}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Normativa europea per l'igiene dei prodotti alimentari"}),s.jsxs("div",{className:"text-xs text-gray-500",children:[s.jsx("p",{children:" Requisiti generali per l'igiene alimentare"}),s.jsx("p",{children:" Obblighi per gli operatori del settore alimentare"}),s.jsx("p",{children:" Procedure basate sui principi HACCP"})]})]})}),s.jsx(ot,{className:"border-l-4 border-l-orange-500",children:s.jsxs(et,{className:"p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Regolamento UE 853/2004"}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Norme specifiche per prodotti di origine animale"}),s.jsxs("div",{className:"text-xs text-gray-500",children:[s.jsx("p",{children:" Requisiti specifici per carni e prodotti derivati"}),s.jsx("p",{children:" Temperature di conservazione obbligatorie"}),s.jsx("p",{children:" Tracciabilit e etichettatura"})]})]})}),s.jsx(ot,{className:"border-l-4 border-l-orange-500",children:s.jsxs(et,{className:"p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Linee Guida ASL"}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Indicazioni operative per il controllo ufficiale"}),s.jsxs("div",{className:"text-xs text-gray-500",children:[s.jsx("p",{children:" Controlli ispettivi programmati"}),s.jsx("p",{children:" Verifica documentazione HACCP"}),s.jsx("p",{children:" Sanzioni e provvedimenti"})]})]})})]})})}),v("refrigerators")&&s.jsxs(ot,{ref:N,id:"conservation-point-form",className:"border-2 border-blue-200",children:[s.jsx(Ut,{children:s.jsx(Gt,{children:((te=m.meta.forms.refrigerators)==null?void 0:te.mode)==="create"?"Aggiungi Nuovo Frigorifero":"Modifica Frigorifero"})}),s.jsx(et,{children:s.jsxs("form",{onSubmit:P=>{P.preventDefault(),z()},className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Frigorifero"}),s.jsx("input",{type:"text",value:((A=(I=m.meta.forms.refrigerators)==null?void 0:I.draft)==null?void 0:A.name)||"",onChange:P=>K("name",P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posizione"}),s.jsx("input",{type:"text",value:((F=(T=m.meta.forms.refrigerators)==null?void 0:T.draft)==null?void 0:F.location)||"",onChange:P=>K("location",P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Temperatura Target (C)"}),s.jsx("input",{type:"number",step:"0.1",value:((W=(ne=m.meta.forms.refrigerators)==null?void 0:ne.draft)==null?void 0:W.targetTemp)||4,onChange:P=>K("targetTemp",parseFloat(P.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categorie di Prodotti Supportate"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:b.map(P=>{var Q,G,de;return s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",checked:((de=(G=(Q=m.meta.forms.refrigerators)==null?void 0:Q.draft)==null?void 0:G.selectedCategories)==null?void 0:de.includes(P.id))||!1,onChange:()=>Z(P.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:P.name})]},P.id)})})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsxs(le,{type:"submit",className:"flex-1",children:[((ue=m.meta.forms.refrigerators)==null?void 0:ue.mode)==="create"?"Aggiungi":"Aggiorna"," Frigorifero"]}),s.jsx(le,{type:"button",variant:"outline",onClick:B,children:"Annulla"})]})]})})]})]})}function n1({value:t,onValueChange:e,children:n}){return s.jsx("div",{className:"w-full",children:Zs.Children.map(n,r=>!r||!r.type?r:r.type===Xf?Zs.cloneElement(r,{value:t,onValueChange:e}):r.type===ps?Zs.cloneElement(r,{currentValue:t}):r)})}function Xf({value:t,onValueChange:e,children:n,className:r=""}){return s.jsx("div",{className:`flex p-1 bg-gray-100 rounded-xl shadow-sm ${r}`,children:Zs.Children.map(n,i=>!i||!i.type?i:i.type===ms?Zs.cloneElement(i,{currentValue:t,onValueChange:e,isActive:t===i.props.value}):i)})}function ms({value:t,currentValue:e,onValueChange:n,isActive:r,children:i,className:a=""}){return s.jsx("button",{onClick:()=>n(t),className:`
        flex-1 px-4 py-3 text-sm font-medium rounded-lg transition-all duration-200 ease-in-out
        ${r?"bg-white text-blue-600 shadow-md transform scale-[1.02]":"text-gray-600 hover:text-gray-900 hover:bg-white/60 active:scale-[0.98]"}
        ${a}
      `,children:i})}function ps({value:t,currentValue:e,children:n}){return e!==t?null:s.jsx("div",{className:"mt-6 animate-in fade-in-50 duration-200",children:n})}const md=()=>{const[t,e]=q.useState({isOpen:!1,title:"",message:"",type:"info",confirmText:"OK",onConfirm:null}),[n,r]=q.useState({isOpen:!1,title:"",message:"",confirmText:"Conferma",cancelText:"Annulla",type:"warning",onConfirm:null,onCancel:null}),[i,a]=q.useState({isOpen:!1,title:"",message:"",placeholder:"",defaultValue:"",type:"text",confirmText:"Conferma",cancelText:"Annulla",validation:null,onConfirm:null,onCancel:null}),o=q.useCallback(C=>{e({isOpen:!0,title:C.title||"",message:C.message||"",type:C.type||"info",confirmText:C.confirmText||"OK",onConfirm:C.onConfirm||null})},[]),l=q.useCallback(C=>{r({isOpen:!0,title:C.title||"",message:C.message||"",confirmText:C.confirmText||"Conferma",cancelText:C.cancelText||"Annulla",type:C.type||"warning",onConfirm:C.onConfirm||null,onCancel:C.onCancel||null})},[]),c=q.useCallback(C=>{a({isOpen:!0,title:C.title||"",message:C.message||"",placeholder:C.placeholder||"",defaultValue:C.defaultValue||"",type:C.type||"text",confirmText:C.confirmText||"Conferma",cancelText:C.cancelText||"Annulla",validation:C.validation||null,onConfirm:C.onConfirm||null,onCancel:C.onCancel||null})},[]),d=q.useCallback(()=>{e(C=>({...C,isOpen:!1}))},[]),f=q.useCallback(()=>{r(C=>({...C,isOpen:!1}))},[]),p=q.useCallback(()=>{a(C=>({...C,isOpen:!1}))},[]),v=q.useCallback((C,B="Successo")=>{o({title:B,message:C,type:"success"})},[o]),m=q.useCallback((C,B="Errore")=>{o({title:B,message:C,type:"error"})},[o]),N=q.useCallback((C,B="Attenzione")=>{o({title:B,message:C,type:"warning"})},[o]),_=q.useCallback((C,B="Informazione")=>{o({title:B,message:C,type:"info"})},[o]),k=q.useCallback((C,B,K="Conferma eliminazione")=>{l({title:K,message:C,type:"danger",confirmText:"Elimina",cancelText:"Annulla",onConfirm:B})},[l]),y=q.useCallback((C,B,K="Conferma azione")=>{l({title:K,message:C,type:"warning",confirmText:"Conferma",cancelText:"Annulla",onConfirm:B})},[l]),b=q.useCallback((C,B,K={})=>{c({title:K.title||"Inserisci testo",message:C,type:"text",placeholder:K.placeholder||"",defaultValue:K.defaultValue||"",validation:K.validation||null,onConfirm:B})},[c]),j=q.useCallback((C,B,K={})=>{c({title:K.title||"Inserisci numero",message:C,type:"number",placeholder:K.placeholder||"",defaultValue:K.defaultValue||"",validation:K.validation||null,onConfirm:B})},[c]);return{alertModal:t,confirmModal:n,promptModal:i,showAlert:o,showConfirm:l,showPrompt:c,closeAlert:d,closeConfirm:f,closePrompt:p,alertSuccess:v,alertError:m,alertWarning:N,alertInfo:_,confirmDelete:k,confirmAction:y,promptText:b,promptNumber:j}},r1=({isOpen:t,onClose:e,title:n,children:r,size:i="md",showCloseButton:a=!0,className:o=""})=>{if(!t)return null;const l={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-6xl"};return s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:e}),s.jsx("div",{className:`relative w-full ${l[i]} ${o}`,children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl",children:[n&&s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n}),a&&s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(un,{className:"h-6 w-6"})})]}),s.jsx("div",{className:"p-6",children:r})]})})]})})},pd=({isOpen:t,onClose:e,title:n,message:r,type:i="info",confirmText:a="OK",onConfirm:o=null})=>{const l=()=>{o&&o(),e()},c=()=>{switch(i){case"success":return s.jsx(kn,{className:"h-6 w-6 text-green-600"});case"warning":return s.jsx(pn,{className:"h-6 w-6 text-yellow-600"});case"error":return s.jsx(O5,{className:"h-6 w-6 text-red-600"});default:return s.jsx(Qs,{className:"h-6 w-6 text-blue-600"})}},d=()=>{switch(i){case"success":return"text-green-600";case"warning":return"text-yellow-600";case"error":return"text-red-600";default:return"text-blue-600"}};return s.jsxs(r1,{isOpen:t,onClose:e,size:"sm",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:`flex-shrink-0 ${d()}`,children:c()}),s.jsxs("div",{className:"flex-1",children:[n&&s.jsx("h3",{className:`text-lg font-semibold ${d()} mb-2`,children:n}),s.jsx("div",{className:"text-gray-700 whitespace-pre-line",children:r})]})]}),s.jsx("div",{className:"flex justify-end mt-6",children:s.jsx(le,{onClick:l,variant:"primary",children:a})})]})},gd=({isOpen:t,onClose:e,title:n,message:r,confirmText:i="Conferma",cancelText:a="Annulla",type:o="warning",onConfirm:l=null,onCancel:c=null})=>{const d=()=>{l&&l(),e()},f=()=>{c&&c(),e()},p=()=>{switch(o){case"warning":return s.jsx(pn,{className:"h-6 w-6 text-yellow-600"});case"danger":return s.jsx(pn,{className:"h-6 w-6 text-red-600"});default:return s.jsx(W0,{className:"h-6 w-6 text-blue-600"})}},v=()=>{switch(o){case"warning":return"text-yellow-600";case"danger":return"text-red-600";default:return"text-blue-600"}};return s.jsxs(r1,{isOpen:t,onClose:e,size:"sm",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:`flex-shrink-0 ${v()}`,children:p()}),s.jsxs("div",{className:"flex-1",children:[n&&s.jsx("h3",{className:`text-lg font-semibold ${v()} mb-2`,children:n}),s.jsx("div",{className:"text-gray-700 whitespace-pre-line",children:r})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[s.jsx(le,{onClick:f,variant:"secondary",children:a}),s.jsx(le,{onClick:d,variant:o==="danger"?"danger":"primary",children:i})]})]})},vd=({isOpen:t,onClose:e,title:n,message:r,placeholder:i="",defaultValue:a="",type:o="text",confirmText:l="Conferma",cancelText:c="Annulla",onConfirm:d=null,onCancel:f=null,validation:p=null})=>{const[v,m]=q.useState(a),[N,_]=q.useState("");q.useEffect(()=>{t&&(m(a),_(""))},[t,a]);const k=()=>{if(p){const j=p(v);if(!j.isValid){_(j.error);return}}d&&d(v),e()},y=()=>{f&&f(),e()},b=j=>{j.key==="Enter"&&k()};return s.jsxs(r1,{isOpen:t,onClose:e,size:"sm",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0 text-blue-600",children:s.jsx(W0,{className:"h-6 w-6"})}),s.jsxs("div",{className:"flex-1",children:[n&&s.jsx("h3",{className:"text-lg font-semibold text-blue-600 mb-2",children:n}),s.jsx("div",{className:"text-gray-700 whitespace-pre-line mb-4",children:r}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"prompt-input",className:"text-sm font-medium text-gray-700",children:"Inserisci il valore:"}),s.jsx(bt,{id:"prompt-input",type:o,value:v,onChange:j=>m(j.target.value),onKeyPress:b,placeholder:i,className:`mt-1 ${N?"border-red-500 focus:border-red-500 focus:ring-red-500":""}`,autoFocus:!0}),N&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:N})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[s.jsx(le,{onClick:y,variant:"secondary",children:c}),s.jsx(le,{onClick:k,variant:"primary",children:l})]})]})},em=localStorage.getItem("haccp:debug")==="true"||window.location.search.includes("debug=true"),P6=localStorage.getItem("haccp:ai-assistant-verbose")==="true",De=(...t)=>{em&&console.log(...t)},Di=(...t)=>{em&&P6&&console.log(...t)},rs=(...t)=>{console.error(...t)},rd=(...t)=>{console.warn(...t)},I6=(t,e=null)=>{em&&console.log(` HACCP: ${t}`,e||"")},au=(t,e=null)=>{em&&console.log(` MAINT: ${t}`,e||"")},E6=()=>[{id:"cucina",name:"Cucina",description:"Area di preparazione e cottura",location:"",manager:"",notes:"",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"bancone",name:"Bancone",description:"Area di servizio e preparazione",location:"",manager:"",notes:"",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"sala",name:"Sala",description:"Area di servizio clienti",location:"",manager:"",notes:"",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"magazzino",name:"Magazzino",description:"Area di stoccaggio e conservazione",location:"",manager:"",notes:"",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"}];function L6({currentUser:t,departments:e,setDepartments:n}){const[r,i]=q.useState(!1),[a,o]=q.useState(null),[l,c]=q.useState({name:"",description:"",location:"",manager:"",notes:""}),{alertModal:d,confirmModal:f,promptModal:p,closeAlert:v,closeConfirm:m,closePrompt:N,alertSuccess:_,alertError:k,alertWarning:y,confirmDelete:b,confirmAction:j}=md();q.useEffect(()=>{const te=localStorage.getItem("haccp-onboarding");let I=!1;if(te)try{const A=JSON.parse(te);I=A&&A.completed===!0}catch(A){rd("Errore nel parsing dati onboarding:",A),I=!1}I?(De(" Onboarding completato, caricamento reparti..."),C()):(De(" Onboarding in corso, sezione reparti vuota"),n([]))},[]);const C=()=>{var I;const te=localStorage.getItem("haccp-onboarding");if(te)try{const A=JSON.parse(te);if((I=A.departments)!=null&&I.list){const T=A.departments.list.filter(F=>F&&F.enabled).map(F=>({id:F.id||Date.now()+Math.random(),name:F.name||"Reparto non disponibile",description:F.description||"",location:F.location||"",manager:F.manager||"",notes:F.notes||"",enabled:!0,isCustom:F.isCustom||!1,createdAt:new Date().toISOString(),createdBy:"Onboarding"}));if(T.length>0){I6(" Reparti caricati dall'onboarding:",T),n(T),localStorage.setItem("haccp-departments",JSON.stringify(T));return}}}catch(A){rd("Errore nel caricamento reparti dall'onboarding:",A)}De(" Nessun reparto dall'onboarding, creando reparti standard"),n(E6())},B=()=>{De(" Pulizia reparti corrotti..."),localStorage.removeItem("haccp-departments"),C()};q.useEffect(()=>{localStorage.setItem("haccp-departments",JSON.stringify(e))},[e]);const K=()=>{c({name:"",description:"",location:"",manager:"",notes:""}),o(null)},Z=te=>{if(te.preventDefault(),!l.name.trim()){k("Il nome del reparto  obbligatorio");return}const I=e.find(A=>A.name.toLowerCase()===l.name.trim().toLowerCase());if(I&&(!a||I.id!==a.id)){k("Un reparto con questo nome esiste gi");return}if(a){const A=e.map(T=>T.id===a.id?{...T,name:l.name.trim(),updatedAt:new Date().toISOString(),updatedBy:(t==null?void 0:t.name)||"Unknown"}:T);n(A)}else{const A={id:`dept_${Date.now()}`,name:l.name.trim(),description:"",location:"",manager:"",notes:"",enabled:!0,isCustom:!0,createdAt:new Date().toISOString(),createdBy:(t==null?void 0:t.name)||"Unknown"};n([...e,A])}K(),i(!1)},z=te=>{o(te),c({name:te.name,description:te.description||"",location:te.location||"",manager:te.manager||"",notes:te.notes||""}),i(!0)},J=te=>{b("Sei sicuro di voler eliminare questo reparto? Questa azione non pu essere annullata.",()=>{n(e.filter(I=>I.id!==te))})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Wa,{className:"h-6 w-6 text-blue-600"}),"Gestione Reparti"]}),s.jsx("p",{className:"text-gray-600",children:"Visualizza e gestisci i reparti configurati durante l'onboarding"})]}),s.jsxs(le,{onClick:()=>{K(),i(!0)},className:"flex items-center gap-2",children:[s.jsx(pr,{className:"h-4 w-4"}),"Aggiungi Reparto"]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Reparti Attivi (",e.length,")"]}),s.jsxs(le,{onClick:B,variant:"outline",size:"sm",className:"flex items-center gap-2 text-orange-600 border-orange-300 hover:bg-orange-50",children:[s.jsx(w4,{className:"h-4 w-4"}),"Ricarica dall'Onboarding"]})]}),e.length===0?s.jsx(ot,{children:s.jsxs(et,{className:"p-8 text-center",children:[s.jsx(Wa,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nessun reparto configurato"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"I reparti vengono configurati durante l'onboarding dell'applicazione."})]})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.filter(te=>te&&te.id&&te.name&&typeof te.name=="string").map(te=>s.jsx(ot,{className:"hover:shadow-md transition-shadow",children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Wa,{className:"h-5 w-5 text-blue-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:te.name||"Nome non disponibile"}),s.jsx("p",{className:"text-lg font-bold text-gray-900",children:"Attivo"})]})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>z(te),className:"h-8 w-8 p-0",children:s.jsx(wi,{className:"h-3 w-3"})}),s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>J(te.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx(er,{className:"h-3 w-3"})})]})]})})},te.id))})]}),r&&s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Wa,{className:"h-5 w-5"}),a?"Modifica Reparto":"Nuovo Reparto"]})}),s.jsx(et,{children:s.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"name",children:"Nome Reparto *"}),s.jsx(bt,{id:"name",value:l.name,onChange:te=>c({...l,name:te.target.value}),placeholder:"es. Cucina, Sala, Magazzino...",required:!0})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{type:"submit",className:"flex-1",children:a?"Aggiorna Reparto":"Aggiungi Reparto"}),s.jsx(le,{type:"button",variant:"outline",onClick:()=>{i(!1),K()},className:"flex-1",children:"Annulla"})]})]})})]}),s.jsx(pd,{isOpen:d.isOpen,onClose:v,title:d.title,message:d.message,type:d.type,confirmText:d.confirmText,onConfirm:d.onConfirm}),s.jsx(gd,{isOpen:f.isOpen,onClose:m,title:f.title,message:f.message,type:f.type,confirmText:f.confirmText,cancelText:f.cancelText,onConfirm:f.onConfirm,onCancel:f.onCancel}),s.jsx(vd,{isOpen:p.isOpen,onClose:N,title:p.title,message:p.message,placeholder:p.placeholder,defaultValue:p.defaultValue,type:p.type,confirmText:p.confirmText,cancelText:p.cancelText,validation:p.validation,onConfirm:p.onConfirm,onCancel:p.onCancel})]})}function T6({productLabels:t=[],setProductLabels:e,products:n=[],currentUser:r}){var Ai,ii,tl,ls,Wi,Cr,va,go;const[i,a]=q.useState("scanner"),[o,l]=q.useState(!1),[c,d]=q.useState("");q.useState(null);const[f,p]=q.useState(""),[v,m]=q.useState(!1),[N,_]=q.useState(!1),[k,y]=q.useState(null),[b,j]=q.useState(!1),[C,B]=q.useState(null),[K,Z]=q.useState(!1),[z,J]=q.useState([]),[te,I]=q.useState(!1),[A,T]=q.useState([]),[F,ne]=q.useState(!1),[W,ue]=q.useState(""),[P,Q]=q.useState([]),[G,de]=q.useState(null),[w,O]=q.useState(!1),[R,H]=q.useState([]),[re,oe]=q.useState(""),[fe,be]=q.useState(""),[ze,Le]=q.useState(""),[Fe,Me]=q.useState(1),[tt,Ce]=q.useState(20),[ie,pt]=q.useState(new Set),[dt,Ge]=q.useState("medium"),[Qe,st]=q.useState(!1),[ae,Ae]=q.useState([]),[Re,he]=q.useState([]),[Ne,He]=q.useState(""),[ce,pe]=q.useState(!1),[ke,ye]=q.useState(null),[Ze,Be]=q.useState(""),[ut,it]=q.useState(null);q.useState(null),q.useState(!1);const[gt,Vt]=q.useState(!1),[vt,Yt]=q.useState(!1);q.useState("");const[Bt,wt]=q.useState(!1),[Qt,Et]=q.useState(""),[rt,yt]=q.useState({productName:"",barcode:"",expiryDate:"",lotNumber:"",category:"",location:"",notes:"",photo:null,allergens:[]});q.useEffect(()=>{pa(),fn()},[t]);const fn=()=>{const Y=localStorage.getItem("haccp-label-groups");Y&&Q(JSON.parse(Y))},Ht=Y=>{Q(Y),localStorage.setItem("haccp-label-groups",JSON.stringify(Y))},nr=()=>{I(!te),T([])},Sr=Y=>{T(Ie=>Ie.includes(Y)?Ie.filter(Ye=>Ye!==Y):[...Ie,Y])},Nt=()=>{const Y=jt.map(Ie=>Ie.id);T(Y)},rr=()=>{T([])},Jr=()=>{if(A.length===0){alert("Seleziona almeno una etichetta");return}ne(!0)},cr=()=>{if(!W.trim()){alert("Inserisci un nome per il gruppo");return}const Ie=t.filter(kt=>A.includes(kt.id)).reduce((kt,Lt)=>{const Wt=new Date(Lt.createdAt);return Wt>kt?Wt:kt},new Date(0)),Ye={id:`group_${Date.now()}`,name:W,labelIds:A,labelCount:A.length,createdAt:new Date().toISOString(),createdBy:r.name,lastUpdate:Ie.toISOString()},zt=[...P,Ye];Ht(zt),T([]),I(!1),ne(!1),ue("")},Ln=()=>{const Y=prompt("Nome del nuovo gruppo:");if(!Y)return;const Ie={id:`group_${Date.now()}`,name:Y,labelIds:[],labelCount:0,createdAt:new Date().toISOString(),createdBy:r.name,lastUpdate:new Date().toISOString()},Ye=[...P,Ie];Ht(Ye)},xn=Y=>P.find(Ie=>Ie.labelIds.includes(Y)),_r=()=>{if(!G)return;const Y=t.filter(Ie=>!G.labelIds.includes(Ie.id));Ae(Y),he([]),He(""),st(!0)},_i=()=>{if(!G||Re.length===0)return;const Y=[],Ie=[];if(Re.forEach(kt=>{var Wt;const Lt=xn(kt);Lt&&Ie.push({labelId:kt,labelName:(Wt=t.find(Tn=>Tn.id===kt))==null?void 0:Wt.productName,fromGroup:Lt.name}),Y.push(kt)}),Ie.length>0){const kt=Ie.map(Wt=>` "${Wt.labelName}" verr spostata da "${Wt.fromGroup}"`).join(`
`);if(!confirm(`ATTENZIONE: Le seguenti etichette verranno spostate:

${kt}

Continuare?`))return}const Ye=P.map(kt=>{if(kt.id===G.id){const Lt=[...kt.labelIds,...Y],Wt=[...new Set(Lt)];return{...kt,labelIds:Wt,labelCount:Wt.length,lastUpdate:new Date().toISOString()}}else{const Lt=kt.labelIds.filter(Wt=>!Y.includes(Wt));return{...kt,labelIds:Lt,labelCount:Lt.length,lastUpdate:Lt.length!==kt.labelIds.length?new Date().toISOString():kt.lastUpdate}}});Ht(Ye);const zt=Ye.find(kt=>kt.id===G.id);de(zt),st(!1),he([])},os=Y=>{he(Ie=>Ie.includes(Y)?Ie.filter(Ye=>Ye!==Y):[...Ie,Y])},zr=()=>{const Y=ae.filter(Ie=>Ie.productName.toLowerCase().includes(Ne.toLowerCase())||Ie.barcode.includes(Ne)||Ie.lotNumber.toLowerCase().includes(Ne.toLowerCase())).map(Ie=>Ie.id);he(Y)},Pn=()=>{G&&(ye(G),Be(G.name),pe(!0))},kr=()=>{if(!Ze.trim()||!ke)return;const Y=P.map(Ie=>Ie.id===ke.id?{...Ie,name:Ze.trim(),lastUpdate:new Date().toISOString()}:Ie);Ht(Y),G&&G.id===ke.id&&de({...G,name:Ze.trim(),lastUpdate:new Date().toISOString()}),pe(!1),ye(null),Be("")},ur=Y=>{ye(Y),Be(Y.name),pe(!0)},Or=Y=>{const Ie=t.find(Lt=>Lt.id===Y);if(!Ie||!confirm(`Eliminare l'etichetta "${Ie.productName}"?

Questa azione non pu essere annullata.`))return;const zt=t.filter(Lt=>Lt.id!==Y);e(zt),localStorage.setItem("haccp-product-labels",JSON.stringify(zt));const kt=P.map(Lt=>({...Lt,labelIds:Lt.labelIds.filter(Wt=>Wt!==Y),labelCount:Lt.labelIds.filter(Wt=>Wt!==Y).length,lastUpdate:Lt.labelIds.includes(Y)?new Date().toISOString():Lt.lastUpdate}));if(Ht(kt),G&&G.labelIds.includes(Y)){const Lt=kt.find(Wt=>Wt.id===G.id);de(Lt)}},Hn=[{id:"latticini",name:"Latticini e Formaggi",color:"bg-blue-100 text-blue-800",emoji:""},{id:"carni",name:"Carni e Salumi",color:"bg-red-100 text-red-800",emoji:""},{id:"verdure",name:"Verdure e Ortaggi",color:"bg-green-100 text-green-800",emoji:""},{id:"frutta",name:"Frutta Fresca",color:"bg-orange-100 text-orange-800",emoji:""},{id:"pesce",name:"Pesce e Frutti di Mare",color:"bg-cyan-100 text-cyan-800",emoji:""},{id:"surgelati",name:"Surgelati",color:"bg-indigo-100 text-indigo-800",emoji:""},{id:"dispensa",name:"Dispensa Secca",color:"bg-yellow-100 text-yellow-800",emoji:""},{id:"condimenti",name:"Oli e Condimenti",color:"bg-amber-100 text-amber-800",emoji:""}],Ss=Y=>{ut===Y?it(null):(it(Y),de(null))},ri=()=>{O(!w),H([])},si=Y=>{H(Ie=>Ie.includes(Y)?Ie.filter(Ye=>Ye!==Y):[...Ie,Y])},ki=()=>{const Y=At.map(Ie=>Ie.id);H(Y)},Ci=()=>{H([])},pa=()=>{const Y=new Date,Ie=t.filter(Ye=>new Date(Ye.expiryDate)<Y&&Ye.photo);Ie.length>0&&(J(Ie),Z(!0))},po=()=>{m(!0),setTimeout(()=>{const Y=["8001234567890","8001234567891","8001234567892","8001234567893","8001234567894"],Ie=Y[Math.floor(Math.random()*Y.length)];p(Ie),yt(Ye=>({...Ye,barcode:Ie})),m(!1),l(!0)},2e3)},ga=()=>{if(!rt.productName||!rt.expiryDate){alert("Nome prodotto e data scadenza sono obbligatori");return}Yt(!0)},U=()=>{const Y={id:`label_${Date.now()}`,...rt,createdAt:new Date().toISOString(),createdBy:r.name,status:"active"},Ie=[...t,Y];e(Ie),localStorage.setItem("haccp-product-labels",JSON.stringify(Ie));const Ye={id:`prod_${Date.now()}`,name:rt.productName,category:rt.category.startsWith("group_")?"latticini":rt.category,expiryDate:rt.expiryDate,location:rt.location||"Posizione da definire",allergens:rt.allergens||[],notes:`${rt.notes?rt.notes+" - ":""}Generato automaticamente da etichetta. Lotto: ${rt.lotNumber||"N/A"}`,addedBy:r==null?void 0:r.id,addedByName:r==null?void 0:r.name,createdAt:new Date().toISOString(),status:"active",fromLabel:!0,labelId:Y.id,barcode:rt.barcode,lotNumber:rt.lotNumber||"",batchDeliveryDate:"",associatedOrderId:"",supplierName:""},kt=[...JSON.parse(localStorage.getItem("haccp-products")||"[]"),Ye];if(localStorage.setItem("haccp-products",JSON.stringify(kt)),rt.category&&rt.category.startsWith("group_")){const Lt=rt.category.replace("group_",""),Wt=P.map(Tn=>Tn.id===Lt?{...Tn,labelIds:[...Tn.labelIds,Y.id],labelCount:Tn.labelCount+1,lastUpdate:new Date().toISOString()}:Tn);Ht(Wt)}yt({productName:"",barcode:"",expiryDate:"",lotNumber:"",category:"",location:"",notes:"",photo:null,allergens:[]}),l(!1),p(""),Yt(!1)},Pe=Y=>{const Ie=Y.target.files[0];if(Ie){const Ye=new FileReader;Ye.onload=zt=>{const kt=new Image;kt.onload=()=>{const Lt=document.createElement("canvas"),Wt=Lt.getContext("2d"),Tn=800,Pi=600;let{width:en,height:Yr}=kt;en>Yr?en>Tn&&(Yr=Yr*Tn/en,en=Tn):Yr>Pi&&(en=en*Pi/Yr,Yr=Pi),Lt.width=en,Lt.height=Yr,Wt.drawImage(kt,0,0,en,Yr);const xa=Lt.toDataURL("image/jpeg",.7);yt(nl=>({...nl,photo:xa}))},kt.src=zt.target.result},Ye.readAsDataURL(Ie)}},Te=Y=>{y(Y),_(!0)},Xe=()=>{const Y=t.map(Ie=>z.some(Ye=>Ye.id===Ie.id)?{...Ie,photo:null,cleanedAt:new Date().toISOString()}:Ie);e(Y),localStorage.setItem("haccp-product-labels",JSON.stringify(Y)),Z(!1),J([])},jt=t.filter(Y=>{if(G)return G.labelIds.includes(Y.id);if(ut){const Ie=Y.category===ut,Ye=Y.productName.toLowerCase().includes(c.toLowerCase())||Y.barcode.includes(c)||Y.lotNumber.toLowerCase().includes(c.toLowerCase());return Ie&&Ye}return Y.productName.toLowerCase().includes(c.toLowerCase())||Y.barcode.includes(c)||Y.lotNumber.toLowerCase().includes(c.toLowerCase())}),At=t.filter(Y=>{if(!Y.photo)return!1;const Ie=!re||Y.productName.toLowerCase().includes(re.toLowerCase())||Y.barcode.includes(re)||Y.lotNumber.toLowerCase().includes(re.toLowerCase()),Ye=!fe||new Date(Y.createdAt).toDateString()===new Date(fe).toDateString(),zt=!ze||(()=>{const kt=new Date(Y.expiryDate),Wt=Math.ceil((kt-new Date)/(1e3*60*60*24));switch(ze){case"expired":return Wt<0;case"expiring":return Wt>=0&&Wt<=7;case"fresh":return Wt>7;default:return!0}})();return Ie&&Ye&&zt}),qt=Math.ceil(At.length/tt),on=At.slice((Fe-1)*tt,Fe*tt),Kr=(Y,Ie=dt)=>{if(!Y)return"";if(Y.startsWith("data:image/")&&Ie==="low"&&Y.length>5e4){const Ye=document.createElement("canvas"),zt=Ye.getContext("2d"),kt=new Image;return new Promise(Lt=>{kt.onload=()=>{Ye.width=Math.min(kt.width,200),Ye.height=Math.min(kt.height,200),zt.drawImage(kt,0,0,Ye.width,Ye.height),Lt(Ye.toDataURL("image/jpeg",.5))},kt.src=Y})}return Y};q.useEffect(()=>{const Y=t.filter(Ie=>Ie.photo).map(Ie=>Ie.id);pt(new Set(Y))},[t]),q.useEffect(()=>{Me(1)},[re,fe,ze]);const rn=()=>{const Y=on.map(Ie=>Ie.id);H(Ie=>[...new Set([...Ie,...Y])])},Gi=()=>{const Y=t.filter(zt=>zt.photo).length,Ie=Y>100,Ye=Y>500;return{totalPhotos:Y,isLargeDataset:Ie,isVeryLargeDataset:Ye,recommendedPhotosPerPage:Ye?12:Ie?20:50}},Ms={total:t.length,withPhotos:t.filter(Y=>Y.photo).length,expiringSoon:t.filter(Y=>{const Ie=new Date(Y.expiryDate),zt=Math.ceil((Ie-new Date)/(1e3*60*60*24));return zt<=7&&zt>=0}).length,expired:t.filter(Y=>new Date(Y.expiryDate)<new Date).length};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(gu,{className:"h-5 w-5"}),"Gestione Etichette Prodotti"]})}),s.jsx(et,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Ms.total}),s.jsx("div",{className:"text-sm text-blue-700",children:"Etichette Totali"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:Ms.withPhotos}),s.jsx("div",{className:"text-sm text-green-700",children:"Con Foto"})]}),s.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Ms.expiringSoon}),s.jsx("div",{className:"text-sm text-yellow-700",children:"In Scadenza"})]}),s.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:Ms.expired}),s.jsx("div",{className:"text-sm text-red-700",children:"Scaduti"})]})]})})]}),s.jsxs("div",{className:"flex gap-2 overflow-x-auto",children:[s.jsxs(le,{variant:i==="scanner"?"default":"outline",onClick:()=>a("scanner"),className:"flex items-center gap-2 whitespace-nowrap",children:[s.jsx(Xv,{className:"h-4 w-4"}),"Scanner"]}),s.jsxs(le,{variant:i==="labels"?"default":"outline",onClick:()=>a("labels"),className:"flex items-center gap-2 whitespace-nowrap",children:[s.jsx(xh,{className:"h-4 w-4"}),"Le Mie Etichette"]}),s.jsxs(le,{variant:i==="photos"?"default":"outline",onClick:()=>a("photos"),className:"flex items-center gap-2 whitespace-nowrap",children:[s.jsx(Ll,{className:"h-4 w-4"}),"Foto Prodotti"]})]}),i==="scanner"&&s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(C5,{className:"h-5 w-5"}),"Scanner Codici a Barre"]})}),s.jsx(et,{className:"space-y-4",children:s.jsx("div",{className:"text-center",children:v?s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"animate-pulse",children:s.jsx(gu,{className:"h-20 w-20 text-blue-500"})}),s.jsx("p",{className:"text-blue-600",children:"Scansione in corso..."})]}):s.jsxs("div",{className:"space-y-4",children:[f?s.jsx("div",{className:"p-4 bg-green-50 rounded-lg",children:s.jsxs("p",{className:"text-green-700",children:["Codice scansionato: ",s.jsx("strong",{children:f})]})}):s.jsxs("div",{className:"p-8 border-2 border-dashed border-gray-300 rounded-lg",children:[s.jsx(gu,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:'Clicca "Avvia Scanner" per leggere un codice a barre'})]}),s.jsxs(le,{onClick:po,disabled:v,className:"w-full",children:[s.jsx(Xv,{className:"h-4 w-4 mr-2"}),"Avvia Scanner"]}),f&&s.jsxs(le,{onClick:()=>l(!0),variant:"outline",className:"w-full",children:[s.jsx(pr,{className:"h-4 w-4 mr-2"}),"Crea Etichetta per questo Prodotto"]})]})})})]}),i==="labels"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(Tl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx(bt,{placeholder:G?`Cerca in "${G.name}"...`:ut?`Cerca in "${(Ai=Hn.find(Y=>Y.id===ut))==null?void 0:Ai.name}"...`:"Cerca per nome, codice, lotto...",value:c,onChange:Y=>d(Y.target.value),className:"pl-10"})]})}),s.jsxs(le,{onClick:()=>l(!0),className:"flex items-center gap-2",children:[s.jsx(pr,{className:"h-4 w-4"}),"Nuova Etichetta"]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs(le,{onClick:nr,variant:te?"default":"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(Yv,{className:"h-4 w-4"}),te?"Annulla Selezione":"Seleziona Etichette"]}),te&&s.jsxs(s.Fragment,{children:[s.jsxs(le,{onClick:Nt,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(vh,{className:"h-4 w-4"}),"Seleziona Tutto"]}),s.jsxs(le,{onClick:rr,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(un,{className:"h-4 w-4"}),"Deseleziona Tutto"]}),s.jsxs(le,{onClick:Jr,variant:"default",size:"sm",className:"flex items-center gap-2",disabled:A.length===0,children:[s.jsx(R4,{className:"h-4 w-4"}),"Crea Gruppo (",A.length,")"]})]}),!G&&!te&&s.jsxs(le,{onClick:Ln,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(Qv,{className:"h-4 w-4"}),"Crea Gruppo di Etichette"]}),!G&&te&&A.length>0&&s.jsxs(le,{onClick:()=>wt(!0),variant:"default",size:"sm",className:"flex items-center gap-2",children:[s.jsx(Oi,{className:"h-4 w-4"}),"Sposta Etichette nel Gruppo..."]}),G&&s.jsxs(s.Fragment,{children:[s.jsxs(le,{onClick:_r,variant:"default",size:"sm",className:"flex items-center gap-2",children:[s.jsx(pr,{className:"h-4 w-4"}),"Aggiungi Etichette al Gruppo"]}),s.jsxs(le,{onClick:Pn,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(Wr,{className:"h-4 w-4"}),"Modifica Gruppo"]}),s.jsxs(le,{onClick:()=>de(null),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(un,{className:"h-4 w-4"}),'Esci da "',G.name,'"']})]}),ut&&s.jsxs(le,{onClick:()=>it(null),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(un,{className:"h-4 w-4"}),'Esci da "',(ii=Hn.find(Y=>Y.id===ut))==null?void 0:ii.name,'"']})]}),te&&A.length>0&&s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-blue-700 text-sm",children:[A.length," etichett",A.length===1?"a selezionata":"e selezionate"]})})]})})}),!G&&!ut&&s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Oi,{className:"h-5 w-5"}),"I Miei Gruppi di Etichette"]}),P.length>0&&s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("div",{className:"relative",children:[s.jsx(Tl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx(bt,{placeholder:"Cerca gruppi ed etichette...",value:Qt,onChange:Y=>Et(Y.target.value),className:"pl-10 w-64"})]})})]})}),s.jsxs(et,{children:[Qt&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(Tl,{className:"h-4 w-4"}),'Risultati Ricerca: "',Qt,'"']}),(()=>{const Y=P.filter(Ye=>Ye.name.toLowerCase().includes(Qt.toLowerCase())),Ie=t.filter(Ye=>Ye.productName.toLowerCase().includes(Qt.toLowerCase())||Ye.barcode.includes(Qt)||Ye.lotNumber.toLowerCase().includes(Qt.toLowerCase()));return Y.length===0&&Ie.length===0?s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-sm text-gray-500",children:"Nessun risultato trovato"})}):s.jsxs("div",{className:"space-y-4",children:[Y.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-medium text-gray-500 mb-2 flex items-center gap-1",children:[s.jsx(Oi,{className:"h-3 w-3"}),"GRUPPI (",Y.length,")"]}),s.jsx("div",{className:"grid gap-2",children:Y.map(Ye=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors bg-blue-50 border-blue-200",onClick:()=>{de(Ye),Et("")},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:[s.jsx(Oi,{className:"h-3 w-3"}),"GRUPPO"]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:Ye.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[Ye.labelIds.length," etichette"]})]})]}),s.jsx("div",{className:"text-xs text-gray-400",children:"Click per aprire"})]},Ye.id))})]}),Ie.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"text-xs font-medium text-gray-500 mb-2 flex items-center gap-1",children:[s.jsx(Vn,{className:"h-3 w-3"}),"ETICHETTE (",Ie.length,")"]}),s.jsxs("div",{className:"grid gap-2",children:[Ie.slice(0,5).map(Ye=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors bg-green-50 border-green-200",onClick:()=>{y(Ye),_(!0),Et("")},children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:[s.jsx(Vn,{className:"h-3 w-3"}),"ETICHETTA"]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:Ye.productName}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Scadenza: ",Ye.expiryDate,"  Lotto: ",Ye.lotNumber]})]})]}),s.jsx("div",{className:"text-xs text-gray-400",children:"Click per visualizzare"})]},Ye.id)),Ie.length>5&&s.jsx("div",{className:"text-center py-2",children:s.jsxs("p",{className:"text-xs text-gray-500",children:["... e altre ",Ie.length-5," etichette"]})})]})]})]})})(),s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>Et(""),className:"w-full",children:[s.jsx(un,{className:"h-4 w-4 mr-2"}),"Chiudi Ricerca"]})})]}),!Qt&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(xh,{className:"h-4 w-4"}),"Categorie Ingredienti (Scelte Rapide)"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Hn.map(Y=>{const Ye=t.filter(zt=>zt.category===Y.id).length;return s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>Ss(Y.id),className:`flex items-center gap-2 ${Ye>0?"hover:shadow-md":"opacity-50 cursor-not-allowed"}`,disabled:Ye===0,children:[s.jsx("span",{className:"text-lg",children:Y.emoji}),s.jsx("span",{className:"hidden sm:inline",children:Y.name}),s.jsx("span",{className:"sm:hidden",children:Y.name.split(" ")[0]}),Ye>0&&s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Y.color} ml-1`,children:Ye})]},Y.id)})}),s.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Clicca su una categoria per vedere le relative etichette"})]}),P.length>0&&s.jsx("div",{className:"border-t border-gray-200 my-4"}),P.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(xh,{className:"h-4 w-4"}),"Gruppi Personalizzati (Scelte Rapide)"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(Y=>{const Ie=Y.labelIds.length;return s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>de(Y),className:`flex items-center gap-2 ${Ie>0?"hover:shadow-md":"opacity-50 cursor-not-allowed"}`,disabled:Ie===0,children:[s.jsx(Oi,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:Y.name}),s.jsx("span",{className:"sm:hidden",children:Y.name.split(" ")[0]}),Ie>0&&s.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800 ml-1",children:Ie})]},Y.id)})}),s.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Clicca su un gruppo per vedere le relative etichette"})]}),!Qt&&s.jsx("div",{className:"border-t border-gray-200 my-4"}),!Qt&&s.jsx("div",{children:s.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(Wr,{className:"h-4 w-4"}),"Gestione Gruppi Personalizzati"]})}),!Qt&&s.jsx("div",{className:"grid gap-3",children:P.map(Y=>s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 hover:shadow-md cursor-pointer transition-all",onClick:()=>de(Y),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Oi,{className:"h-5 w-5 text-blue-500"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold",children:Y.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:[Y.labelCount," etichett",Y.labelCount===1?"a":"e","  Ultimo aggiornamento: ",new Date(Y.lastUpdate).toLocaleDateString("it-IT")]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{variant:"outline",size:"sm",onClick:Ie=>{Ie.stopPropagation(),ur(Y)},title:"Modifica gruppo",children:s.jsx(Wr,{className:"h-4 w-4"})}),s.jsx(le,{variant:"outline",size:"sm",onClick:Ie=>{if(Ie.stopPropagation(),confirm(`Eliminare il gruppo "${Y.name}"? Le etichette non verranno eliminate.`)){const Ye=P.filter(zt=>zt.id!==Y.id);Ht(Ye)}},title:"Elimina gruppo",children:s.jsx(er,{className:"h-4 w-4"})})]})]},Y.id))}),!Qt&&P.length===0&&s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Nessun gruppo personalizzato creato ancora."}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'Usa "Seleziona Etichette" per creare gruppi dalle etichette esistenti'})]})]})]}),s.jsxs(s.Fragment,{children:[G&&s.jsx(ot,{children:s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2 text-lg",children:[s.jsx(Oi,{className:"h-5 w-5 text-blue-600"}),"Gruppo: ",s.jsx("span",{className:"text-blue-600",children:G.name}),s.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",G.labelIds.length," etichette)"]})]})})}),ut&&s.jsx(ot,{children:s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2 text-lg",children:[s.jsx(xh,{className:"h-5 w-5 text-green-600"}),"Categoria: ",s.jsx("span",{className:"text-green-600",children:(tl=Hn.find(Y=>Y.id===ut))==null?void 0:tl.name}),s.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",jt.length," etichette)"]})]})})}),s.jsx(ot,{children:s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Vn,{className:"h-5 w-5"}),"Etichette Registrate",s.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",jt.length," totali)"]})]})})})]}),s.jsxs("div",{className:"grid gap-4",children:[jt.map(Y=>{var Tn,Pi;const Ie=new Date(Y.expiryDate),Ye=new Date,zt=Math.ceil((Ie-Ye)/(1e3*60*60*24)),kt=Ie<Ye,Lt=zt<=7&&zt>=0,Wt=A.includes(Y.id);return s.jsx(ot,{className:`${kt?"border-red-200 bg-red-50":Lt?"border-yellow-200 bg-yellow-50":""} ${Wt?"ring-2 ring-blue-500":""} ${te?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>te&&Sr(Y.id),children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex justify-between items-start",children:[te&&s.jsx("div",{className:"mr-3 mt-1",children:s.jsx("input",{type:"checkbox",checked:Wt,onChange:()=>Sr(Y.id),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 pointer-events-none"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-semibold text-lg",children:Y.productName}),Y.photo&&s.jsx(Ll,{className:"h-4 w-4 text-blue-500"}),kt&&s.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"SCADUTO"}),Lt&&!kt&&s.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:"IN SCADENZA"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Codice:"})," ",Y.barcode]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Lotto:"})," ",Y.lotNumber]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Scadenza:"})," ",new Date(Y.expiryDate).toLocaleDateString("it-IT")]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Categoria:"})," ",((Tn=Hn.find(en=>en.id===Y.category))==null?void 0:Tn.name)||((Pi=P.find(en=>en.id===Y.category))==null?void 0:Pi.name)||Y.category||"Non specificata"]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("strong",{children:"Gruppo:"})," ",(()=>{const en=xn(Y.id);return en?s.jsxs("span",{className:"inline-flex items-center gap-1 ml-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:[s.jsx(Oi,{className:"h-3 w-3"}),en.name]}):s.jsx("span",{className:"text-gray-400 ml-2",children:"Nessun gruppo"})})()]})]}),Y.location&&s.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[s.jsx("strong",{children:"Posizione:"})," ",Y.location]}),Y.notes&&s.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[s.jsx("strong",{children:"Note:"})," ",Y.notes]}),s.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Creata da ",Y.createdBy," il ",new Date(Y.createdAt).toLocaleDateString("it-IT")]})]}),s.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[s.jsxs(le,{size:"sm",variant:"outline",onClick:en=>{en.stopPropagation(),y(Y),_(!0)},className:"flex items-center gap-1",children:[s.jsx(jg,{className:"h-3 w-3"}),"Visualizza"]}),s.jsxs(le,{size:"sm",onClick:en=>{en.stopPropagation(),Te(Y)},className:"flex items-center gap-1",children:[s.jsx(Ys,{className:"h-3 w-3"}),"Download"]}),Y.photo&&s.jsxs(le,{size:"sm",variant:"outline",onClick:en=>{en.stopPropagation(),B(Y.photo),j(!0)},className:"flex items-center gap-1",children:[s.jsx(Ll,{className:"h-3 w-3"}),"Foto"]}),s.jsxs(le,{size:"sm",variant:"destructive",onClick:en=>{en.stopPropagation(),Or(Y.id)},className:"flex items-center gap-1",children:[s.jsx(er,{className:"h-3 w-3"}),"Elimina"]})]})]})})},Y.id)}),jt.length===0&&s.jsx(ot,{children:s.jsxs(et,{className:"pt-6 text-center",children:[s.jsx(Vn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:G?`Nessuna etichetta nel gruppo "${G.name}"`:ut?`Nessuna etichetta nella categoria "${(ls=Hn.find(Y=>Y.id===ut))==null?void 0:ls.name}"`:c?"Nessuna etichetta trovata":"Nessuna etichetta creata ancora"})]})})]})]}),i==="photos"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Tl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx(bt,{placeholder:"Cerca per nome, codice, lotto...",value:re,onChange:Y=>oe(Y.target.value),className:"pl-10"})]}),s.jsx(bt,{type:"date",placeholder:"Filtra per data creazione",value:fe,onChange:Y=>be(Y.target.value)}),s.jsxs("select",{value:ze,onChange:Y=>Le(Y.target.value),className:"p-2 border border-gray-300 rounded-md",children:[s.jsx("option",{value:"",children:"Tutte le scadenze"}),s.jsx("option",{value:"fresh",children:"Prodotti freschi (>7 giorni)"}),s.jsx("option",{value:"expiring",children:"In scadenza (7 giorni)"}),s.jsx("option",{value:"expired",children:"Scaduti"})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs(le,{onClick:ri,variant:w?"default":"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(Yv,{className:"h-4 w-4"}),w?"Annulla Selezione":"Seleziona Foto"]}),w&&s.jsxs(s.Fragment,{children:[s.jsxs(le,{onClick:ki,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(vh,{className:"h-4 w-4"}),"Seleziona Tutte (",At.length,")"]}),s.jsxs(le,{onClick:rn,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(vh,{className:"h-4 w-4"}),"Solo Pagina Corrente (",on.length,")"]}),s.jsxs(le,{onClick:Ci,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(un,{className:"h-4 w-4"}),"Deseleziona Tutto"]}),s.jsxs(le,{variant:"destructive",size:"sm",className:"flex items-center gap-2",disabled:R.length===0,onClick:()=>{if(confirm(`Eliminare ${R.length} foto selezionate?`)){const Y=t.map(Ie=>R.includes(Ie.id)?{...Ie,photo:null}:Ie);e(Y),localStorage.setItem("haccp-product-labels",JSON.stringify(Y)),H([]),O(!1)}},children:[s.jsx(er,{className:"h-4 w-4"}),"Elimina Selezionate (",R.length,")"]})]}),(re||fe||ze)&&s.jsxs(le,{onClick:()=>{oe(""),be(""),Le("")},variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(un,{className:"h-4 w-4"}),"Cancella Filtri"]})]}),w&&R.length>0&&s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-blue-700 text-sm",children:[R.length," foto selezionat",R.length===1?"a":"e"]})}),(re||fe||ze)&&s.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg",children:s.jsxs("p",{className:"text-yellow-700 text-sm",children:["Filtri attivi: ",At.length," foto di ",t.filter(Y=>Y.photo).length]})}),(()=>{const Y=Gi();return Y.isLargeDataset?s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-blue-700 text-sm font-semibold",children:["Dataset grande: ",Y.totalPhotos," foto"]}),s.jsxs("p",{className:"text-blue-600 text-xs",children:["Modalit ottimizzata attiva  Pagina ",Fe," di ",qt]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("select",{value:tt,onChange:Ie=>{Ce(Number(Ie.target.value)),Me(1)},className:"text-xs p-1 border rounded",children:[s.jsx("option",{value:12,children:"12 foto/pagina"}),s.jsx("option",{value:20,children:"20 foto/pagina"}),s.jsx("option",{value:50,children:"50 foto/pagina"}),s.jsx("option",{value:100,children:"100 foto/pagina"})]}),s.jsxs("select",{value:dt,onChange:Ie=>Ge(Ie.target.value),className:"text-xs p-1 border rounded",children:[s.jsx("option",{value:"low",children:"Qualit Bassa"}),s.jsx("option",{value:"medium",children:"Qualit Media"}),s.jsx("option",{value:"high",children:"Qualit Alta"})]})]})]})}):null})()]})})}),qt>1&&s.jsx(ot,{children:s.jsxs(et,{className:"pt-6",children:[s.jsxs("div",{className:"flex justify-center items-center gap-4",children:[s.jsx(le,{onClick:()=>Me(Y=>Math.max(1,Y-1)),disabled:Fe===1,variant:"outline",size:"sm",children:" Precedente"}),s.jsx("div",{className:"flex gap-1",children:[...Array(Math.min(5,qt))].map((Y,Ie)=>{let Ye;return qt<=5?Ye=Ie+1:(Ye=Math.max(1,Fe-2)+Ie,Ye>qt&&(Ye=qt-(4-Ie))),s.jsx(le,{onClick:()=>Me(Ye),variant:Fe===Ye?"default":"outline",size:"sm",className:"w-8 h-8 p-0",children:Ye},Ye)})}),s.jsx(le,{onClick:()=>Me(Y=>Math.min(qt,Y+1)),disabled:Fe===qt,variant:"outline",size:"sm",children:"Successiva "})]}),s.jsx("div",{className:"text-center mt-2",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Pagina ",Fe," di ",qt,"  Mostrando ",on.length," di ",At.length," foto"]})})]})}),s.jsx("div",{className:`grid gap-4 ${tt<=12?"grid-cols-2 md:grid-cols-3 lg:grid-cols-4":tt<=20?"grid-cols-2 md:grid-cols-4 lg:grid-cols-5":"grid-cols-3 md:grid-cols-5 lg:grid-cols-6"}`,children:on.map(Y=>{const Ie=R.includes(Y.id),Ye=new Date(Y.expiryDate),zt=new Date,kt=Math.ceil((Ye-zt)/(1e3*60*60*24)),Lt=Ye<zt,Wt=kt<=7&&kt>=0;return s.jsxs(ot,{className:`overflow-hidden ${Ie?"ring-2 ring-blue-500":""} ${w?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>w&&si(Y.id),children:[s.jsxs("div",{className:"relative",children:[w&&s.jsx("div",{className:"absolute top-2 left-2 z-10",children:s.jsx("input",{type:"checkbox",checked:Ie,onChange:()=>si(Y.id),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 pointer-events-none"})}),(Lt||Wt)&&s.jsx("div",{className:"absolute top-2 right-2 z-10",children:s.jsx("span",{className:`px-2 py-1 text-xs rounded ${Lt?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:Lt?"SCADUTO":"SCADENZA"})}),s.jsxs("div",{className:"aspect-square bg-gray-100 cursor-pointer overflow-hidden",onClick:Tn=>{w||(Tn.stopPropagation(),B(Y.photo),j(!0))},children:[s.jsx("img",{src:Kr(Y.photo),alt:Y.productName,className:"w-full h-full object-cover transition-opacity duration-200",loading:"lazy",onError:Tn=>{Tn.target.style.display="none",Tn.target.nextSibling.style.display="flex"}}),s.jsx("div",{className:"w-full h-full hidden items-center justify-center bg-red-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx(pn,{className:"h-6 w-6 text-red-400 mx-auto mb-1"}),s.jsx("p",{className:"text-xs text-red-600",children:"Errore caricamento"})]})})]})]}),s.jsxs(et,{className:"pt-4",children:[s.jsx("h4",{className:"font-semibold text-sm truncate",children:Y.productName}),s.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[s.jsxs("p",{children:["Scad: ",new Date(Y.expiryDate).toLocaleDateString("it-IT")]}),s.jsxs("p",{children:["Creata: ",new Date(Y.createdAt).toLocaleDateString("it-IT")]}),Y.lotNumber&&s.jsxs("p",{children:["Lotto: ",Y.lotNumber]})]})]})]},Y.id)})}),qt>1&&on.length>0&&s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex justify-center items-center gap-2",children:[s.jsx(le,{onClick:()=>Me(1),disabled:Fe===1,variant:"outline",size:"sm",children:"Prima"}),s.jsx(le,{onClick:()=>Me(Y=>Math.max(1,Y-1)),disabled:Fe===1,variant:"outline",size:"sm",children:""}),s.jsxs("span",{className:"px-4 py-2 text-sm bg-gray-100 rounded",children:[Fe," / ",qt]}),s.jsx(le,{onClick:()=>Me(Y=>Math.min(qt,Y+1)),disabled:Fe===qt,variant:"outline",size:"sm",children:""}),s.jsx(le,{onClick:()=>Me(qt),disabled:Fe===qt,variant:"outline",size:"sm",children:"Ultima"})]})})}),At.length===0&&t.filter(Y=>Y.photo).length>0&&s.jsx(ot,{children:s.jsxs(et,{className:"pt-6 text-center",children:[s.jsx(I5,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Nessuna foto trovata con i filtri attuali"})]})}),t.filter(Y=>Y.photo).length===0&&s.jsx(ot,{children:s.jsxs(et,{className:"pt-6 text-center",children:[s.jsx(Ll,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Nessuna foto caricata ancora"})]})})]}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs(ot,{className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Nuova Etichetta Prodotto"}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>{l(!1),yt({productName:"",barcode:"",expiryDate:"",lotNumber:"",category:"",location:"",notes:"",photo:null,allergens:[]})},children:s.jsx(un,{className:"h-4 w-4"})})]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"productName",children:"Nome Prodotto *"}),s.jsx(bt,{id:"productName",value:rt.productName,onChange:Y=>yt(Ie=>({...Ie,productName:Y.target.value})),placeholder:"es. Mozzarella di Bufala"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"barcode",children:"Codice a Barre"}),s.jsx(bt,{id:"barcode",value:rt.barcode,onChange:Y=>yt(Ie=>({...Ie,barcode:Y.target.value})),placeholder:"Scansiona o inserisci manualmente"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"expiryDate",children:"Data Scadenza *"}),s.jsx(bt,{id:"expiryDate",type:"date",value:rt.expiryDate,onChange:Y=>yt(Ie=>({...Ie,expiryDate:Y.target.value}))})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"lotNumber",children:"Numero Lotto"}),s.jsx(bt,{id:"lotNumber",value:rt.lotNumber,onChange:Y=>yt(Ie=>({...Ie,lotNumber:Y.target.value})),placeholder:"es. L240315A"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"category",children:"Categoria"}),s.jsxs("select",{id:"category",value:rt.category,onChange:Y=>yt(Ie=>({...Ie,category:Y.target.value})),className:"w-full p-2 border border-gray-300 rounded-md",children:[s.jsx("option",{value:"",children:"Seleziona categoria"}),s.jsxs("optgroup",{label:" Categorie Standard",children:[s.jsx("option",{value:"latticini",children:"Latticini e Formaggi"}),s.jsx("option",{value:"carni",children:"Carni e Salumi"}),s.jsx("option",{value:"verdure",children:"Verdure e Ortaggi"}),s.jsx("option",{value:"frutta",children:"Frutta Fresca"}),s.jsx("option",{value:"pesce",children:"Pesce e Frutti di Mare"}),s.jsx("option",{value:"surgelati",children:"Surgelati"}),s.jsx("option",{value:"dispensa",children:"Dispensa Secca"}),s.jsx("option",{value:"condimenti",children:"Oli e Condimenti"})]}),P.length>0&&s.jsx("optgroup",{label:" I Miei Gruppi di Etichette",children:P.map(Y=>s.jsxs("option",{value:`group_${Y.id}`,children:[Y.name," (",Y.labelCount," etichett",Y.labelCount===1?"a":"e",")"]},Y.id))})]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"location",children:"Posizione"}),s.jsx(bt,{id:"location",value:rt.location,onChange:Y=>yt(Ie=>({...Ie,location:Y.target.value})),placeholder:"es. Frigo A - Ripiano intermedio"})]}),s.jsxs("div",{children:[s.jsx(Je,{children:"Allergeni"}),s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-7 gap-2 mt-2",children:ALLERGENS.map(Y=>s.jsx("button",{type:"button",onClick:()=>{const Ie=rt.allergens.includes(Y.id);yt(Ye=>({...Ye,allergens:Ie?Ye.allergens.filter(zt=>zt!==Y.id):[...Ye.allergens,Y.id]}))},className:`px-2 py-1 text-xs rounded transition-colors ${rt.allergens.includes(Y.id)?Y.color:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:Y.name},Y.id))})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"notes",children:"Note"}),s.jsx("textarea",{id:"notes",value:rt.notes,onChange:Y=>yt(Ie=>({...Ie,notes:Y.target.value})),placeholder:"Note aggiuntive...",className:"w-full p-2 border border-gray-300 rounded-md h-20 resize-none"})]}),s.jsxs("div",{children:[s.jsx(Je,{children:"Foto Prodotto"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:Pe,className:"w-full p-2 border border-gray-300 rounded-md"}),rt.photo&&s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:rt.photo,alt:"Preview",className:"w-full h-32 object-cover rounded-md border"}),s.jsx(le,{size:"sm",variant:"outline",onClick:()=>yt(Y=>({...Y,photo:null})),className:"absolute top-2 right-2",children:s.jsx(un,{className:"h-3 w-3"})})]})]})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsxs(le,{onClick:ga,className:"flex-1",children:[s.jsx(kn,{className:"h-4 w-4 mr-2"}),"Salva Etichetta"]}),s.jsx(le,{variant:"outline",onClick:()=>{l(!1),yt({productName:"",barcode:"",expiryDate:"",lotNumber:"",category:"",location:"",notes:"",photo:null,allergens:[]})},children:"Annulla"})]})]})]})}),N&&k&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs(ot,{className:"w-full max-w-md",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Anteprima Etichetta"}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>_(!1),children:s.jsx(un,{className:"h-4 w-4"})})]})}),s.jsxs(et,{children:[s.jsx("div",{className:"border-2 border-dashed border-gray-300 p-4 rounded-lg bg-white",children:s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-lg font-bold",children:k.productName}),s.jsxs("div",{className:"text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Codice:"})," ",k.barcode]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Lotto:"})," ",k.lotNumber]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Scadenza:"})," ",new Date(k.expiryDate).toLocaleDateString("it-IT")]}),k.location&&s.jsxs("div",{children:[s.jsx("strong",{children:"Posizione:"})," ",k.location]})]}),s.jsx("div",{className:"flex justify-center my-4",children:s.jsx("div",{className:"w-16 h-16 bg-black border-2 border-gray-300 flex items-center justify-center",children:s.jsx(gu,{className:"h-12 w-12 text-white"})})}),s.jsxs("div",{className:"text-xs text-gray-600",children:["Creata il ",new Date(k.createdAt).toLocaleDateString("it-IT")]})]})}),s.jsx("div",{className:"mt-4 text-center",children:s.jsxs(le,{onClick:()=>alert("Funzione stampa in sviluppo"),children:[s.jsx(Ys,{className:"h-4 w-4 mr-2"}),"Scarica Etichetta PDF"]})})]})]})}),b&&C&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"relative max-w-4xl max-h-[90vh]",children:[s.jsx(le,{variant:"outline",size:"sm",onClick:()=>j(!1),className:"absolute top-4 right-4 z-10",children:s.jsx(un,{className:"h-4 w-4"})}),s.jsx("img",{src:C,alt:"Foto prodotto",className:"max-w-full max-h-full object-contain rounded-lg"})]})}),K&&z.length>0&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs(ot,{className:"w-full max-w-md",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(pn,{className:"h-5 w-5 text-orange-500"}),"Pulizia Automatica"]})}),s.jsxs(et,{children:[s.jsxs("p",{className:"mb-4",children:["Trovati ",s.jsx("strong",{children:z.length})," prodotti scaduti con foto. Vuoi eliminare le foto per liberare spazio in memoria?"]}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto mb-4",children:z.map(Y=>s.jsxs("div",{className:"flex justify-between items-center p-2 bg-red-50 rounded",children:[s.jsx("span",{className:"text-sm",children:Y.productName}),s.jsxs("span",{className:"text-xs text-red-600",children:["Scad: ",new Date(Y.expiryDate).toLocaleDateString("it-IT")]})]},Y.id))}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{onClick:Xe,className:"flex-1",variant:"destructive",children:[s.jsx(er,{className:"h-4 w-4 mr-2"}),"Elimina Foto"]}),s.jsx(le,{variant:"outline",onClick:()=>Z(!1),children:"Mantieni"})]})]})]})}),F&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs(ot,{className:"w-full max-w-md",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Crea Nuovo Gruppo"}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>{ne(!1),ue("")},children:s.jsx(un,{className:"h-4 w-4"})})]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"groupName",children:"Nome del Gruppo"}),s.jsx(bt,{id:"groupName",value:W,onChange:Y=>ue(Y.target.value),placeholder:"es. Etichette Salumi",onKeyPress:Y=>Y.key==="Enter"&&cr()})]}),s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-blue-700 text-sm",children:["Il gruppo conterr ",A.length," etichett",A.length===1?"a":"e"," selezionat",A.length===1?"a":"e"]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{onClick:cr,className:"flex-1",disabled:!W.trim(),children:[s.jsx(Qv,{className:"h-4 w-4 mr-2"}),"Crea Gruppo"]}),s.jsx(le,{variant:"outline",onClick:()=>{ne(!1),ue("")},children:"Annulla"})]})]})]})}),Qe&&G&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs(ot,{className:"w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center justify-between",children:[s.jsxs("span",{children:['Aggiungi Etichette al Gruppo "',G.name,'"']}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>{st(!1),he([]),He("")},children:s.jsx(un,{className:"h-4 w-4"})})]})}),s.jsxs(et,{className:"space-y-4 overflow-y-auto",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(Tl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx(bt,{placeholder:"Cerca etichette da aggiungere...",value:Ne,onChange:Y=>He(Y.target.value),className:"pl-10"})]})}),s.jsxs(le,{onClick:zr,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(vh,{className:"h-4 w-4"}),"Seleziona Tutte"]}),s.jsxs(le,{onClick:()=>he([]),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(un,{className:"h-4 w-4"}),"Deseleziona"]})]}),Re.length>0&&s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-blue-700 text-sm",children:[Re.length," etichett",Re.length===1?"a selezionata":"e selezionate"]})}),s.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:s.jsxs("p",{className:"text-gray-700 text-sm",children:["Etichette disponibili: ",ae.filter(Y=>Y.productName.toLowerCase().includes(Ne.toLowerCase())||Y.barcode.includes(Ne)||Y.lotNumber.toLowerCase().includes(Ne.toLowerCase())).length," di ",ae.length]})})]}),s.jsxs("div",{className:"max-h-96 overflow-y-auto space-y-2",children:[ae.filter(Y=>Y.productName.toLowerCase().includes(Ne.toLowerCase())||Y.barcode.includes(Ne)||Y.lotNumber.toLowerCase().includes(Ne.toLowerCase())).map(Y=>{const Ie=Re.includes(Y.id),Ye=xn(Y.id);return s.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors hover:shadow-md ${Ie?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-gray-400"}`,onClick:()=>os(Y.id),children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",checked:Ie,onChange:()=>os(Y.id),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 pointer-events-none"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h4",{className:"font-semibold",children:Y.productName}),Y.photo&&s.jsx(Ll,{className:"h-4 w-4 text-blue-500"}),Ye&&s.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:['In "',Ye.name,'"']})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Codice:"})," ",Y.barcode]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Lotto:"})," ",Y.lotNumber]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Scadenza:"})," ",new Date(Y.expiryDate).toLocaleDateString("it-IT")]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Categoria:"})," ",Y.category]})]})]})]})},Y.id)}),ae.length===0&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Vn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Tutte le etichette sono gi in questo gruppo"})]})]}),s.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[s.jsxs(le,{onClick:_i,className:"flex-1",disabled:Re.length===0,children:[s.jsx(pr,{className:"h-4 w-4 mr-2"}),"Aggiungi ",Re.length," Etichett",Re.length===1?"a":"e"]}),s.jsx(le,{variant:"outline",onClick:()=>{st(!1),he([]),He("")},children:"Annulla"})]})]})]})}),ce&&ke&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs(ot,{className:"w-full max-w-md",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Modifica Gruppo"}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>{pe(!1),ye(null),Be("")},children:s.jsx(un,{className:"h-4 w-4"})})]})}),s.jsxs(et,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"editGroupName",children:"Nome del Gruppo"}),s.jsx(bt,{id:"editGroupName",value:Ze,onChange:Y=>Be(Y.target.value),placeholder:"es. Etichette Salumi",onKeyPress:Y=>Y.key==="Enter"&&kr()})]}),s.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[s.jsxs("p",{className:"text-blue-700 text-sm",children:["Il gruppo contiene ",ke.labelCount," etichett",ke.labelCount===1?"a":"e"]}),s.jsxs("p",{className:"text-blue-600 text-xs mt-1",children:["Creato da ",ke.createdBy," il ",new Date(ke.createdAt).toLocaleDateString("it-IT")]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{onClick:kr,className:"flex-1",disabled:!Ze.trim()||Ze.trim()===ke.name,children:[s.jsx(Wr,{className:"h-4 w-4 mr-2"}),"Salva Modifiche"]}),s.jsx(le,{variant:"outline",onClick:()=>{pe(!1),ye(null),Be("")},children:"Annulla"})]})]})]})}),vt&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(ot,{className:"w-full max-w-md mx-4",children:[s.jsx(Ut,{children:s.jsx(Gt,{className:"text-center text-orange-600",children:" Conferma Salvataggio Etichetta"})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"Stai per salvare l'etichetta con questi dati:"}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-left space-y-2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Prodotto:"})," ",rt.productName]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Scadenza:"})," ",rt.expiryDate]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Lotto:"})," ",rt.lotNumber||"Non specificato"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Categoria:"})," ",((Wi=Hn.find(Y=>Y.id===rt.category))==null?void 0:Wi.name)||((Cr=P.find(Y=>Y.id===rt.category))==null?void 0:Cr.name)||"Non specificata"]}),rt.photo&&s.jsxs("p",{children:[s.jsx("strong",{children:"Foto:"}),"  Allegata"]})]}),s.jsxs("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[s.jsxs("p",{className:"text-sm text-red-700",children:[s.jsx("strong",{children:" ATTENZIONE:"}),s.jsx("br",{}),"Una volta salvata, l'etichetta ",s.jsx("strong",{children:"NON potr essere modificata"}),". In caso di errore sar necessario:"]}),s.jsxs("ul",{className:"text-xs text-red-600 mt-2 text-left",children:[s.jsx("li",{children:" Caricare una nuova foto"}),s.jsx("li",{children:" Rifare completamente la registrazione"})]}),s.jsx("p",{className:"text-sm text-red-700 mt-2",children:s.jsx("strong",{children:"Ricontrolla attentamente tutte le informazioni!"})})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{variant:"outline",onClick:()=>Yt(!1),className:"flex-1",children:" Modifica Dati"}),s.jsx(le,{onClick:U,className:"flex-1 bg-green-600 hover:bg-green-700",children:" Conferma e Salva"})]})]})})]})}),N&&k&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(ot,{className:"w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(jg,{className:"h-5 w-5"}),"Visualizzazione Etichetta"]}),s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>{_(!1),y(null)},children:s.jsx(un,{className:"h-4 w-4"})})]})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[k.photo&&s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-sm font-medium mb-2",children:"Foto Prodotto"}),s.jsxs("div",{className:"relative inline-block",children:[s.jsx("img",{src:k.photo,alt:"Foto prodotto",className:"w-32 h-32 object-cover rounded-lg border cursor-pointer hover:opacity-75 transition-opacity",onClick:()=>Vt(!0)}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity bg-black bg-opacity-50 rounded-lg",children:s.jsx("span",{className:"text-white text-xs",children:"Clicca per ingrandire"})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{className:"text-sm font-medium",children:"Nome Prodotto"}),s.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.productName})]}),s.jsxs("div",{children:[s.jsx(Je,{className:"text-sm font-medium",children:"Codice/Barcode"}),s.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.barcode||"Non specificato"})]}),s.jsxs("div",{children:[s.jsx(Je,{className:"text-sm font-medium",children:"Data Scadenza"}),s.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.expiryDate})]}),s.jsxs("div",{children:[s.jsx(Je,{className:"text-sm font-medium",children:"Numero Lotto"}),s.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.lotNumber||"Non specificato"})]}),s.jsxs("div",{children:[s.jsx(Je,{className:"text-sm font-medium",children:"Categoria"}),s.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:((va=Hn.find(Y=>Y.id===k.category))==null?void 0:va.name)||((go=P.find(Y=>Y.id===k.category))==null?void 0:go.name)||"Non specificata"})]}),s.jsxs("div",{children:[s.jsx(Je,{className:"text-sm font-medium",children:"Posizione"}),s.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.location||"Non specificata"})]})]}),k.notes&&s.jsxs("div",{children:[s.jsx(Je,{className:"text-sm font-medium",children:"Note"}),s.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.notes})]}),s.jsx("div",{className:"border-t pt-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-gray-500",children:[s.jsxs("div",{children:[s.jsx(Je,{className:"text-xs font-medium",children:"Creata da"}),s.jsx("p",{children:k.createdBy})]}),s.jsxs("div",{children:[s.jsx(Je,{className:"text-xs font-medium",children:"Data Creazione"}),s.jsx("p",{children:new Date(k.createdAt).toLocaleString()})]})]})}),s.jsx("div",{className:"border-t pt-4 flex justify-center",children:s.jsx(le,{variant:"outline",onClick:()=>{_(!1),y(null)},className:"px-8",children:"Chiudi"})})]})})]})}),gt&&(k==null?void 0:k.photo)&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:()=>Vt(!1),children:s.jsxs("div",{className:"relative max-w-4xl max-h-4xl p-4",children:[s.jsx(le,{variant:"ghost",size:"sm",className:"absolute top-2 right-2 text-white hover:bg-white hover:bg-opacity-20",onClick:()=>Vt(!1),children:s.jsx(un,{className:"h-6 w-6"})}),s.jsx("img",{src:k.photo,alt:"Foto prodotto ingrandita",className:"max-w-full max-h-full object-contain rounded-lg",onClick:Y=>Y.stopPropagation()})]})}),Bt&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(ot,{className:"w-full max-w-md mx-4",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Oi,{className:"h-5 w-5"}),"Sposta Etichette nel Gruppo"]})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:["Seleziona il gruppo dove spostare le ",A.length," etichette selezionate:"]}),s.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:P.length===0?s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Nessun gruppo disponibile."}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Crea prima un gruppo per spostare le etichette."})]}):P.map(Y=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>{const Ie=P.map(Ye=>{if(Ye.id===Y.id){const zt=[...new Set([...Ye.labelIds,...A])];return{...Ye,labelIds:zt,labelCount:zt.length,lastUpdate:new Date().toISOString()}}else{const zt=Ye.labelIds.filter(kt=>!A.includes(kt));return{...Ye,labelIds:zt,labelCount:zt.length,lastUpdate:zt.length!==Ye.labelIds.length?new Date().toISOString():Ye.lastUpdate}}});Ht(Ie),T([]),I(!1),wt(!1)},children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:Y.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[Y.labelIds.length," etichette"]})]}),s.jsx(Oi,{className:"h-4 w-4 text-gray-400"})]},Y.id))}),s.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[s.jsx(le,{variant:"outline",onClick:()=>{wt(!1)},className:"flex-1",children:"Annulla"}),s.jsxs(le,{onClick:()=>{wt(!1),ne(!0)},variant:"default",className:"flex-1",children:[s.jsx(pr,{className:"h-4 w-4 mr-2"}),"Nuovo Gruppo"]})]})]})})]})})]})}function z6({currentUser:t,products:e=[],temperatures:n=[],cleaning:r=[],staff:i=[],onAction:a}){const[o,l]=q.useState([]),[c,d]=q.useState(""),[f,p]=q.useState(!1),[v,m]=q.useState(!1),[N,_]=q.useState(null),[k,y]=q.useState(!1),[b,j]=q.useState([{id:1,name:"Alert Scadenze",enabled:!0,description:"Avvisa sui prodotti in scadenza"},{id:2,name:"Suggerimenti Ricette",enabled:!0,description:"Genera ricette per ingredienti in scadenza"},{id:3,name:"Ordini Settimanali",enabled:!1,description:"Crea ordini automatici ogni luned"},{id:4,name:"Alert Temperature",enabled:!0,description:"Avvisa su temperature critiche"}]),[C,B]=q.useState(()=>{const T=localStorage.getItem("haccp-show-chat-icon");return T!==null?JSON.parse(T):!0});q.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const T=window.SpeechRecognition||window.webkitSpeechRecognition,F=new T;F.continuous=!1,F.interimResults=!1,F.lang="it-IT",F.onstart=()=>{m(!0),K("assistant"," Ti sto ascoltando... Parla ora!","system")},F.onresult=ne=>{const W=ne.results[0][0].transcript;d(W),K("assistant",` Ho sentito: "${W}"`,"system")},F.onerror=ne=>{rs("Speech recognition error:",ne.error),m(!1),K("assistant"," Errore nel riconoscimento vocale. Riprova!","system")},F.onend=()=>{m(!1)},_(F)}},[]),q.useEffect(()=>{o.length===0&&K("assistant",`Ciao ${(t==null?void 0:t.name)||"utente"}!  Sono il tuo assistente IA per il sistema HACCP.

** Cosa posso fare:**
 **Gestione inventario** - Aggiungere prodotti, controllare scadenze
 **Controlli temperatura** - Registrare e monitorare temperature
 **Attivit di pulizia** - Gestire mansioni e frequenze
 **Automatizzazioni** - Alert intelligenti e suggerimenti
 ** Riconoscimento vocale** - Parla invece di scrivere!

** Automatizzazioni attive:**
${b.filter(T=>T.enabled).map(T=>` ${T.name}`).join(`
`)}

Dimmi cosa ti serve!`)},[]);const K=(T,F,ne="text",W=null)=>{const ue={id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sender:T,content:F,type:ne,data:W,timestamp:new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"})};l(P=>[...P,ue])},Z=async()=>{if(!c.trim())return;const T=c.trim();d(""),K("user",T),p(!0),setTimeout(()=>{const F=z(T);K("assistant",F.content,F.type,F.data),p(!1)},1e3)},z=T=>{const F=T.toLowerCase();if(F.includes("aiuto")||F.includes("help"))return{content:` **Come posso aiutarti:**

** Inventario:**
 "Aggiungi un nuovo prodotto"
 "Controlla le scadenze"
 "Mostra i prodotti in scadenza"

** Temperature:**
 "Registra una temperatura"
 "Mostra le ultime temperature"
 "Controlla i frigoriferi"

** Pulizia:**
 "Mostra le attivit da svolgere"
 "Aggiungi una nuova attivit"
 "Controlla le mansioni"

** Automatizzazioni:**
 "Attiva alert scadenze"
 "Genera ricette"
 "Configura automatizzazioni"

** Comandi vocali:**
 Parla chiaramente in italiano
 Usa frasi semplici e dirette
 Clicca il microfono per iniziare`,type:"text"};if(F.includes("scadenza")||F.includes("scaduti")){const ne=e.filter(W=>{const ue=Math.ceil((new Date(W.expiryDate)-new Date)/864e5);return ue<=7&&ue>0});return ne.length>0?{content:` **Prodotti in scadenza** (${ne.length} prodotti):

${ne.map(W=>` ${W.name} - Scade il ${W.expiryDate}`).join(`
`)}

**Suggerimento**: Vuoi che generi delle ricette per utilizzare questi ingredienti?`,type:"alert",data:{products:ne}}:{content:" Nessun prodotto in scadenza nei prossimi 7 giorni!",type:"text"}}if(F.includes("attivit")||F.includes("mansioni")){const ne=r.filter(W=>!W.completed);return{content:` **Attivit da svolgere** (${ne.length} totali):

${ne.slice(0,5).map(W=>` ${W.task} - Assegnato a: ${W.assignee}`).join(`
`)}
${ne.length>5?`
... e altre ${ne.length-5} attivit`:""}

**Suggerimento**: Usa le schede per filtrare per frequenza!`,type:"text"}}return F.includes("temperatura")||F.includes("frigo")?{content:` **Ultime temperature registrate**:

${n.slice(-3).map(W=>` ${W.location}: ${W.temperature}C (${W.status})`).join(`
`)}

**Suggerimento**: Registra temperature regolarmente per monitorare la sicurezza alimentare!`,type:"text"}:{content:'Non sono sicuro di aver capito. Prova a dire "aiuto" per vedere tutti i comandi disponibili!',type:"text"}},J=()=>{if(!N){K("assistant"," Riconoscimento vocale non supportato dal tuo browser. Usa Chrome o Edge!","system");return}v?N.stop():N.start()},te=T=>{j(F=>F.map(ne=>ne.id===T?{...ne,enabled:!ne.enabled}:ne))},I=()=>{const T=!C;B(T),localStorage.setItem("haccp-show-chat-icon",JSON.stringify(T))};q.useEffect(()=>{localStorage.setItem("haccp-show-chat-icon",JSON.stringify(C))},[C]);const A=T=>{T.key==="Enter"&&!T.shiftKey&&(T.preventDefault(),Z())};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"IA Assistant"}),s.jsx("p",{className:"text-gray-600",children:"Il tuo assistente intelligente per la gestione HACCP"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(le,{onClick:J,disabled:f,className:`${v?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`,children:[v?s.jsx(E5,{className:"h-4 w-4 mr-2"}):s.jsx(Sf,{className:"h-4 w-4 mr-2"}),v?"Ferma Ascolto":"Parla"]}),s.jsxs(le,{variant:"outline",onClick:()=>y(!k),children:[s.jsx(Wr,{className:"h-4 w-4 mr-2"}),"Impostazioni"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2",children:s.jsxs(ot,{className:"h-96 mb-6",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Ga,{className:"h-5 w-5 text-blue-600"}),"Chat con l'IA",v&&s.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[s.jsx(Sf,{className:"h-3 w-3 animate-pulse"}),s.jsx("span",{className:"text-xs",children:"Ascoltando..."})]})]})}),s.jsxs(et,{className:"flex flex-col h-full p-6",children:[s.jsxs("div",{className:"flex-1 overflow-y-auto space-y-3 mb-4",children:[o.map(T=>s.jsx("div",{className:`flex ${T.sender==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${T.sender==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:s.jsxs("div",{className:"flex items-start gap-2",children:[T.sender==="assistant"&&s.jsx(Ga,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm whitespace-pre-wrap",children:T.content}),s.jsx("div",{className:`text-xs mt-1 ${T.sender==="user"?"text-blue-100":"text-gray-500"}`,children:T.timestamp})]})]})})},T.id)),f&&s.jsx("div",{className:"flex justify-start",children:s.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ga,{className:"h-4 w-4 text-blue-600"}),s.jsxs("div",{className:"flex space-x-1",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(bt,{value:c,onChange:T=>d(T.target.value),onKeyPress:A,placeholder:"Scrivi un messaggio o parla...",className:"flex-1"}),s.jsx(le,{onClick:Z,disabled:!c.trim()||f,children:s.jsx(T5,{className:"h-4 w-4"})})]})]})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs(ot,{className:"mb-6",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(W4,{className:"h-5 w-5 text-yellow-600"}),"Automatizzazioni"]})}),s.jsx(et,{className:"p-6",children:s.jsx("div",{className:"space-y-4",children:b.map(T=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-sm",children:T.name}),s.jsx("p",{className:"text-xs text-gray-600",children:T.description})]}),s.jsx(le,{size:"sm",variant:T.enabled?"default":"outline",onClick:()=>te(T.id),children:T.enabled?"Attiva":"Disattiva"})]},T.id))})})]}),s.jsxs(ot,{className:"mb-6",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(hd,{className:"h-5 w-5 text-purple-600"}),"Azioni Rapide"]})}),s.jsx(et,{className:"p-6",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs(le,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>d("Controlla le scadenze"),children:[s.jsx(Vn,{className:"h-4 w-4 mr-2"}),"Controlla Scadenze"]}),s.jsxs(le,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>d("Mostra le attivit da svolgere"),children:[s.jsx(kn,{className:"h-4 w-4 mr-2"}),"Attivit da Svolgere"]}),s.jsxs(le,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>d("Mostra le ultime temperature"),children:[s.jsx(ws,{className:"h-4 w-4 mr-2"}),"Ultime Temperature"]}),s.jsxs(le,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>d("Aiuto"),children:[s.jsx(W0,{className:"h-4 w-4 mr-2"}),"Aiuto"]})]})})]}),k&&s.jsxs(ot,{className:"mb-6",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Wr,{className:"h-5 w-5 text-gray-600"}),"Impostazioni Chat IA"]})}),s.jsx(et,{className:"p-6",children:s.jsxs("div",{className:"space-y-5",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-sm",children:"Mostra Icona Chat"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Visualizza l'icona della chat IA nell'app"})]}),s.jsx(le,{size:"sm",variant:C?"default":"outline",onClick:I,children:C?"Attiva":"Disattiva"})]}),s.jsxs("div",{className:"text-xs text-blue-600 bg-blue-50 p-3 rounded-lg",children:[" ",s.jsx("strong",{children:"Suggerimento:"}),` Se disattivi l'icona della chat, potrai sempre accedere all'IA dalla sezione "Assistente IA" nel menu principale.`]})]})})]})]})]})]})}function O6({staff:t,setStaff:e,users:n,setUsers:r,currentUser:i,isAdmin:a,departments:o,setDepartments:l,productLabels:c,setProductLabels:d,products:f,temperatures:p,cleaning:v,onAction:m}){const[N,_]=q.useState({name:"",roles:[""],certification:"",notes:""}),[k,y]=q.useState(!1),[b,j]=q.useState(null),[C,B]=q.useState({name:"",description:"",members:[],assignedTasks:[]}),[K,Z]=q.useState(null),[z,J]=q.useState(!1),[te,I]=q.useState("staff"),[A,T]=q.useState({}),[F,ne]=q.useState(!1),[W,ue]=q.useState(null),[P,Q]=q.useState(""),[G,de]=q.useState(!1);q.useEffect(()=>{localStorage.setItem("haccp-staff",JSON.stringify(t))},[t]),q.useEffect(()=>{const ae=localStorage.getItem("haccp-departments"),Ae=localStorage.getItem("haccp-departments-version"),Re=[{id:"amministratori",name:"Amministratori",description:"Gestione e supervisione completa",members:[],assignedTasks:[]},{id:"responsabili",name:"Responsabili",description:"Responsabili di reparto e coordinamento",members:[],assignedTasks:[]},{id:"dipendenti",name:"Dipendenti",description:"Staff fisso e personale regolare",members:[],assignedTasks:[]},{id:"collaboratori",name:"Collaboratore Occasionale",description:"Personale temporaneo e collaborazioni esterne",members:[],assignedTasks:[]}];if(Ae!=="2.0"||!ae)l(Re),localStorage.setItem("haccp-departments",JSON.stringify(Re)),localStorage.setItem("haccp-departments-version","2.0");else{const he=JSON.parse(ae),Ne=[...Re];he.forEach(He=>{Re.find(ce=>ce.id===He.id)||Ne.push(He)}),l(Ne)}},[]),q.useEffect(()=>{localStorage.setItem("haccp-departments",JSON.stringify(o))},[o]),q.useEffect(()=>{if(o.length>0&&t&&Array.isArray(t)&&t.length>=0){const ae=o.map(Re=>({...Re,members:t.filter(he=>he&&(he.roles&&he.roles.includes(Re.name)||he.role===Re.name||he.primaryRole===Re.name)).map(he=>he.id)}));ae.some((Re,he)=>{var Ne;return JSON.stringify(Re.members)!==JSON.stringify(((Ne=o[he])==null?void 0:Ne.members)||[])})&&l(ae)}},[t]);const w=ae=>{if(ae.preventDefault(),!N.name.trim()||N.roles.every(Ne=>!Ne.trim()))return;if(t&&Array.isArray(t)?t.some(Ne=>Ne&&Ne.name&&Ne.name.toLowerCase().trim()===N.name.toLowerCase().trim()):!1){alert(` Attenzione: Esiste gi un utente con questo nome.
Scegli un nome diverso per procedere con la registrazione.`);return}const Re=[...new Set(N.roles.filter(Ne=>Ne.trim()))],he={id:Date.now(),name:N.name.trim(),roles:Re,primaryRole:Re[0],certification:N.certification.trim(),notes:N.notes.trim(),addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")};e([...t,he]),_({name:"",roles:[""],certification:"",notes:""})},O=ae=>{confirm("Sei sicuro di voler rimuovere questo membro del personale?")&&e(t&&Array.isArray(t)?t.filter(Ae=>Ae&&Ae.id!==ae):[])},R=()=>{_(ae=>({...ae,roles:[...ae.roles,""]}))},H=ae=>{N.roles.length>1&&_(Ae=>({...Ae,roles:Ae.roles.filter((Re,he)=>he!==ae)}))},re=(ae,Ae)=>{_(Re=>({...Re,roles:Re.roles.map((he,Ne)=>Ne===ae?Ae:he)}))};t&&Array.isArray(t)&&[...new Set(t.map(ae=>ae==null?void 0:ae.role).filter(Boolean))],t&&Array.isArray(t)&&t.filter(ae=>ae&&ae.certification&&ae.certification.trim()!=="");const oe={Amministratori:"bg-red-100 text-red-800",Responsabili:"bg-purple-100 text-purple-800",Dipendenti:"bg-blue-100 text-blue-800","Collaboratore Occasionale":"bg-yellow-100 text-yellow-800",Cuoco:"bg-blue-100 text-blue-800","Sous Chef":"bg-purple-100 text-purple-800",Chef:"bg-red-100 text-red-800",Cameriere:"bg-green-100 text-green-800","Addetto cucina":"bg-yellow-100 text-yellow-800",Manager:"bg-gray-100 text-gray-800",default:"bg-gray-100 text-gray-800"},fe=ae=>{if(!ae||typeof ae!="string")return"bg-gray-100 text-gray-800";if(oe[ae])return oe[ae];const Ae=["bg-indigo-100 text-indigo-800","bg-pink-100 text-pink-800","bg-teal-100 text-teal-800","bg-orange-100 text-orange-800","bg-emerald-100 text-emerald-800","bg-violet-100 text-violet-800","bg-cyan-100 text-cyan-800","bg-rose-100 text-rose-800","bg-lime-100 text-lime-800","bg-amber-100 text-amber-800","bg-sky-100 text-sky-800","bg-fuchsia-100 text-fuchsia-800","bg-slate-100 text-slate-800","bg-stone-100 text-stone-800","bg-zinc-100 text-zinc-800","bg-neutral-100 text-neutral-800","bg-red-200 text-red-900","bg-blue-200 text-blue-900","bg-green-200 text-green-900","bg-purple-200 text-purple-900","bg-yellow-200 text-yellow-900","bg-indigo-200 text-indigo-900","bg-pink-200 text-pink-900","bg-teal-200 text-teal-900"],Re=ae.split("").reduce((he,Ne)=>(he=(he<<5)-he+Ne.charCodeAt(0),he&he),0);return Ae[Math.abs(Re)%Ae.length]},be=ae=>{const Ae=fe(ae);return Ae.includes("text-red-800")?"bg-red-50 border-red-200":Ae.includes("text-purple-800")?"bg-purple-50 border-purple-200":Ae.includes("text-blue-800")?"bg-blue-50 border-blue-200":Ae.includes("text-yellow-800")?"bg-yellow-50 border-yellow-200":Ae.includes("text-green-800")?"bg-green-50 border-green-200":Ae.includes("text-indigo-800")?"bg-indigo-50 border-indigo-200":Ae.includes("text-pink-800")?"bg-pink-50 border-pink-200":Ae.includes("text-teal-800")?"bg-teal-50 border-teal-200":Ae.includes("text-orange-800")?"bg-orange-50 border-orange-200":Ae.includes("text-emerald-800")?"bg-emerald-50 border-emerald-200":Ae.includes("text-violet-800")?"bg-violet-50 border-violet-200":Ae.includes("text-cyan-800")?"bg-cyan-50 border-cyan-200":Ae.includes("text-rose-800")?"bg-rose-50 border-rose-200":Ae.includes("text-lime-800")?"bg-lime-50 border-lime-200":Ae.includes("text-amber-800")?"bg-amber-50 border-amber-200":Ae.includes("text-sky-800")?"bg-sky-50 border-sky-200":Ae.includes("text-fuchsia-800")?"bg-fuchsia-50 border-fuchsia-200":Ae.includes("text-slate-800")?"bg-slate-50 border-slate-200":Ae.includes("text-stone-800")?"bg-stone-50 border-stone-200":Ae.includes("text-zinc-800")?"bg-zinc-50 border-zinc-200":Ae.includes("text-neutral-800")?"bg-neutral-50 border-neutral-200":Ae.includes("text-red-900")?"bg-red-100 border-red-300":Ae.includes("text-blue-900")?"bg-blue-100 border-blue-300":Ae.includes("text-green-900")?"bg-green-100 border-green-300":Ae.includes("text-purple-900")?"bg-purple-100 border-purple-300":Ae.includes("text-yellow-900")?"bg-yellow-100 border-yellow-300":Ae.includes("text-indigo-900")?"bg-indigo-100 border-indigo-300":Ae.includes("text-pink-900")?"bg-pink-100 border-pink-300":Ae.includes("text-teal-900")?"bg-teal-100 border-teal-300":"bg-gray-50 border-gray-200"},ze=ae=>{if(ae.preventDefault(),!C.name.trim())return;const Ae={id:Date.now(),name:C.name.trim(),description:C.description.trim(),members:[],assignedTasks:[],createdAt:new Date().toISOString()};l([...o,Ae]),B({name:"",description:"",members:[],assignedTasks:[]}),y(!1)},Le=ae=>{j(ae),B({name:ae.name,description:ae.description,members:ae.members||[],assignedTasks:ae.assignedTasks||[]}),y(!0)},Fe=ae=>{if(ae.preventDefault(),!C.name.trim())return;const Ae=o.map(Re=>Re.id===b.id?{...Re,name:C.name.trim(),description:C.description.trim()}:Re);l(Ae),B({name:"",description:"",members:[],assignedTasks:[]}),j(null),y(!1)},Me=ae=>{confirm("Sei sicuro di voler eliminare questa categoria?")&&l(o.filter(Ae=>Ae.id!==ae))},tt=ae=>{Z(ae),_({name:ae.name,roles:ae.roles&&ae.roles.length>0?ae.roles:[ae.role||""],certification:ae.certification||"",notes:ae.notes||""}),J(!0)},Ce=ae=>{if(ae.preventDefault(),!N.name.trim()||N.roles.every(Ne=>!Ne.trim()))return;if(t.some(Ne=>Ne.id!==K.id&&Ne.name.toLowerCase().trim()===N.name.toLowerCase().trim())){alert(` Attenzione: Esiste gi un utente con questo nome.
Scegli un nome diverso per procedere con la modifica.`);return}const Re=[...new Set(N.roles.filter(Ne=>Ne.trim()))],he=t.map(Ne=>Ne.id===K.id?{...Ne,name:N.name.trim(),roles:Re,primaryRole:Re[0],certification:N.certification.trim(),notes:N.notes.trim(),lastModified:new Date().toLocaleString("it-IT")}:Ne);e(he),_({name:"",roles:[""],certification:"",notes:""}),Z(null),J(!1)},ie=()=>{Z(null),J(!1),_({name:"",roles:[""],certification:"",notes:""})},pt=ae=>{ue(ae),Q(""),ne(!0)},dt=()=>{if(W&&P){const ae=t.map(Ae=>Ae.id===W.id?{...Ae,role:P,lastModified:new Date().toLocaleString("it-IT")}:Ae);e(ae),ne(!1),ue(null),Q("")}},Ge=()=>{de(!0)},Qe=()=>{W&&(e(t&&Array.isArray(t)?t.filter(ae=>ae&&ae.id!==W.id):[]),ne(!1),de(!1),ue(null),Q(""))},st=()=>{ne(!1),de(!1),ue(null),Q("")};return s.jsx("div",{className:"space-y-6",children:s.jsxs(n1,{value:te,onValueChange:I,children:[s.jsxs(Xf,{className:"grid w-full grid-cols-4",children:[s.jsxs(ms,{value:"staff",className:"flex items-center gap-2",children:[s.jsx(Er,{className:"h-4 w-4"}),"Staff"]}),s.jsxs(ms,{value:"departments",className:"flex items-center gap-2",children:[s.jsx(Wa,{className:"h-4 w-4"}),"Reparti"]}),s.jsxs(ms,{value:"labels",className:"flex items-center gap-2",children:[s.jsx(gu,{className:"h-4 w-4"}),"Etichette"]}),s.jsxs(ms,{value:"ai-assistant",className:"flex items-center gap-2",children:[s.jsx(Ga,{className:"h-4 w-4"}),"IA Assistant"]})]}),s.jsxs(ps,{value:"staff",className:"space-y-6",children:[i&&i.role==="admin"&&s.jsx(an,{title:"Gestione Categorie Ruoli",icon:Er,defaultExpanded:!0,children:s.jsxs(et,{children:[k&&s.jsxs("form",{onSubmit:b?Fe:ze,className:"space-y-4 mb-6 p-4 bg-blue-50 rounded-lg border",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"categoryName",children:"Nome Categoria"}),s.jsx(bt,{id:"categoryName",value:C.name,onChange:ae=>B({...C,name:ae.target.value}),placeholder:"es. Cucina, Sala, Amministrazione",required:!0})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"categoryDescription",children:"Descrizione"}),s.jsx(bt,{id:"categoryDescription",value:C.description,onChange:ae=>B({...C,description:ae.target.value}),placeholder:"Descrizione della categoria"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{type:"submit",size:"sm",children:b?"Aggiorna Categoria":"Aggiungi Categoria"}),s.jsx(le,{type:"button",variant:"outline",size:"sm",onClick:()=>{y(!1),j(null),B({name:"",description:"",members:[],assignedTasks:[]})},children:"Annulla"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h4",{className:"font-medium",children:["Categorie Disponibili (",o.length,")"]}),s.jsx(le,{onClick:()=>y(!0),size:"sm",variant:"outline",children:"Nuova Categoria"})]}),o.length===0?s.jsxs("div",{className:"text-center py-6 text-gray-500",children:[s.jsx(Er,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),s.jsx("p",{children:"Nessuna categoria creata"}),s.jsx("p",{className:"text-sm",children:"Crea la prima categoria per organizzare i ruoli"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.filter(ae=>ae&&ae.id&&ae.name&&typeof ae.name=="string").map(ae=>{var Ae;return s.jsxs("div",{className:`p-4 border rounded-lg ${be(ae.name)}`,children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h5",{className:"font-medium text-lg",children:ae.name||"Nome non disponibile"}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${fe(ae.name||"")}`,children:ae.name||"Nome non disponibile"})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(le,{onClick:()=>Le(ae),size:"sm",variant:"ghost",className:"h-8 w-8 p-0",children:""}),s.jsx(le,{onClick:()=>Me(ae.id),size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700",children:""})]})]}),ae.description&&s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:ae.description}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[s.jsxs("span",{children:[" ",t&&Array.isArray(t)?t.filter(Re=>Re&&(Re.roles&&Re.roles.includes(ae.name)||Re.role===ae.name||Re.primaryRole===ae.name)).length:0," membri"]}),s.jsxs("span",{children:[" ",((Ae=ae.assignedTasks)==null?void 0:Ae.length)||0," compiti"]})]})]},ae.id)})})]})]})}),s.jsx(an,{title:K?"Modifica Membro del Personale":"Aggiungi Membro del Personale",icon:Er,defaultExpanded:!0,children:s.jsxs(et,{children:[z&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Stai modificando:"})," ",K==null?void 0:K.name]})}),s.jsxs("form",{onSubmit:K?Ce:w,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Je,{htmlFor:"name",children:"Nome Completo"}),s.jsx(bt,{id:"name",placeholder:"Es: Mario Rossi",value:N.name,onChange:ae=>_({...N,name:ae.target.value}),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Je,{htmlFor:"roles",children:"Ruoli"}),s.jsxs("div",{className:"space-y-2",children:[N.roles.map((ae,Ae)=>s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsxs("select",{value:ae,onChange:Re=>re(Ae,Re.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:Ae===0,children:[s.jsx("option",{value:"",children:"Seleziona un ruolo..."}),o.filter(Re=>Re&&Re.id&&Re.name&&typeof Re.name=="string").map(Re=>s.jsx("option",{value:Re.name,children:Re.name},Re.id))]}),N.roles.length>1&&s.jsx(le,{type:"button",onClick:()=>H(Ae),variant:"outline",size:"sm",className:"h-10 w-10 p-0 text-red-600 hover:text-red-800",children:""})]},Ae)),s.jsx(le,{type:"button",onClick:R,variant:"outline",size:"sm",className:"w-full",children:"+ Aggiungi Ruolo"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Je,{htmlFor:"certification",children:"Certificazioni HACCP (opzionale)"}),s.jsx(bt,{id:"certification",placeholder:"Es: Certificato HACCP livello 2, Corso sicurezza alimentare...",value:N.certification,onChange:ae=>_({...N,certification:ae.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Je,{htmlFor:"notes",children:"Note (opzionale)"}),s.jsx(bt,{id:"notes",placeholder:"Es: Turno preferito, competenze particolari...",value:N.notes,onChange:ae=>_({...N,notes:ae.target.value})})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{type:"submit",className:"flex-1",children:K?"Salva Modifiche":"Aggiungi al Team"}),K&&s.jsx(le,{type:"button",variant:"outline",onClick:ie,className:"flex-1",children:"Annulla"})]})]})]})}),s.jsx(an,{title:"Statistiche",icon:Wo,defaultExpanded:!1,children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Totale Personale"}),s.jsx("p",{className:"text-2xl font-bold",children:t.length})]}),s.jsx(Er,{className:"h-8 w-8 text-blue-500"})]})})})})}),o.length>0&&s.jsx(an,{title:"Categorie Personale",icon:Er,defaultExpanded:!0,children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:o.filter(ae=>ae&&ae.id&&ae.name&&typeof ae.name=="string").slice().sort((ae,Ae)=>{const Re=ae&&ae.name?String(ae.name):"",he=Ae&&Ae.name?String(Ae.name):"";return Re.localeCompare(he)}).map(ae=>{const Ae=t&&Array.isArray(t)?t.filter(Ne=>Ne&&(Ne.roles&&Ne.roles.includes(ae.name)||Ne.role===ae.name||Ne.primaryRole===ae.name)):[],Re=Ae.length,he=A[ae.name];return s.jsxs("div",{children:[s.jsx(ot,{className:"cursor-pointer hover:shadow-md transition-shadow",children:s.jsx(et,{className:"pt-6",children:s.jsxs("button",{onClick:()=>T(Ne=>({...Ne,[ae.name]:!Ne[ae.name]})),className:"w-full text-left",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:ae.name||"Nome non disponibile"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Re})]}),s.jsx(Er,{className:"h-8 w-8 text-blue-500"})]}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center justify-between",children:[s.jsx("span",{children:Re===1?"utente":"utenti"}),s.jsx("span",{children:he?"":""})]})]})})}),he&&s.jsx(ot,{className:"mt-2",children:s.jsx(et,{className:"pt-4",children:Re===0?s.jsxs("div",{className:"text-center py-4 text-gray-500",children:[s.jsx(Er,{className:"h-6 w-6 mx-auto mb-2 text-gray-400"}),s.jsx("p",{className:"text-sm",children:"Nessun dipendente in questa categoria"}),s.jsxs("p",{className:"text-xs",children:['Aggiungi membri selezionando "',ae.name||"questo reparto",'" nel form sopra']})]}):s.jsx("div",{className:"space-y-2",children:Ae.map(Ne=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:Ne.fullName||Ne.name}),s.jsx("div",{className:"text-xs text-gray-600",children:s.jsx("div",{className:"flex flex-wrap gap-1",children:(Ne.roles&&Ne.roles.length>0?Ne.roles:[Ne.role||"Non assegnato"]).map((He,ce)=>s.jsx("span",{className:`px-1 py-0.5 rounded text-xs ${fe(He)}`,children:He},ce))})}),Ne.certification&&s.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[s.jsx(E4,{className:"h-3 w-3"}),Ne.certification]}),Ne.notes&&s.jsxs("div",{className:"text-xs text-blue-600 flex items-center gap-1",children:[s.jsx(tx,{className:"h-3 w-3"}),Ne.notes]})]}),s.jsx("div",{className:"flex justify-center",children:s.jsx(le,{onClick:()=>pt(Ne),variant:"outline",size:"sm",className:"h-8 w-8 p-0 text-orange-700 border-orange-300 hover:bg-orange-100 hover:border-orange-400 bg-white shadow-sm",title:"Rimuovi da questo ruolo o riassegna",children:s.jsx(j4,{className:"h-7.5 w-7.5 stroke-1.5"})})})]},Ne.id))})})})]},ae.id)})})}),s.jsx(an,{title:`Elenco Staff Completo (${t.length})`,icon:Er,defaultExpanded:!0,children:t.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Er,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 mb-2",children:"Nessun membro del personale registrato"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Aggiungi il primo membro del team per iniziare la gestione del personale HACCP"})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"grid grid-cols-12 gap-2 px-3 py-2 bg-gray-100 rounded text-xs font-medium text-gray-600",children:[s.jsx("div",{className:"col-span-3",children:"Nome"}),s.jsx("div",{className:"col-span-2",children:"Ruolo"}),s.jsx("div",{className:"col-span-2",children:"Categoria"}),s.jsx("div",{className:"col-span-2",children:"Data Registrazione"}),s.jsx("div",{className:"col-span-2",children:"Note"}),s.jsx("div",{className:"col-span-1",children:"Azioni"})]}),t.map(ae=>s.jsxs("div",{className:`grid grid-cols-12 gap-2 px-3 py-2 rounded border transition-colors text-sm ${ae.isRegisteredUser?"bg-blue-50 border-blue-200 hover:bg-blue-100":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:[s.jsx("div",{className:"col-span-3 flex items-center",children:s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium flex items-center gap-2",children:[ae.name||"Nome non disponibile",ae.isRegisteredUser&&s.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 text-xs rounded-full",children:"Utente"})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[ae.addedDate,ae.lastModified&&"  Mod."]})]})}),s.jsx("div",{className:"col-span-2 flex items-center",children:s.jsx("div",{className:"flex flex-wrap gap-1",children:(ae.roles&&ae.roles.length>0?ae.roles:[ae.role||"Non assegnato"]).map((Ae,Re)=>s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${fe(Ae)}`,children:Ae},Re))})}),s.jsx("div",{className:"col-span-2 flex items-center",children:s.jsx("span",{className:"text-xs text-gray-600",children:ae.roles&&ae.roles.length>1?`${ae.roles.length} ruoli`:"1 ruolo"})}),s.jsx("div",{className:"col-span-2 flex items-center",children:s.jsxs("div",{className:"text-xs text-gray-600",children:[ae.addedDate,ae.addedTime&&s.jsx("div",{className:"text-xs text-gray-400",children:ae.addedTime.split(" ")[1]})]})}),s.jsx("div",{className:"col-span-2 flex items-center",children:ae.notes?s.jsxs("div",{className:"flex items-center gap-1 text-blue-700",children:[s.jsx(tx,{className:"h-3 w-3"}),s.jsx("span",{className:"truncate text-xs",children:ae.notes})]}):s.jsx("span",{className:"text-gray-400 text-xs",children:"-"})}),s.jsx("div",{className:"col-span-1 flex items-center justify-center",children:s.jsxs("div",{className:"flex gap-1",children:[s.jsx(le,{onClick:()=>tt(ae),variant:"outline",size:"sm",className:"h-7 w-7 p-0 text-blue-700 border-blue-300 hover:bg-blue-100 hover:text-blue-800 hover:border-blue-400 bg-white shadow-sm",title:"Modifica dipendente",children:s.jsx(F4,{className:"h-4 w-4"})}),s.jsx(le,{onClick:()=>O(ae.id),variant:"outline",size:"sm",className:"h-7 w-7 p-0 text-red-700 border-red-300 hover:bg-red-100 hover:text-red-800 hover:border-red-400 bg-white shadow-sm",title:"Elimina dipendente",children:s.jsx(er,{className:"h-4 w-4"})})]})})]},ae.id))]})}),t.length===0&&s.jsxs(an,{title:"Suggerimenti Ruoli Comuni",icon:Er,defaultExpanded:!0,className:"border-blue-200 bg-blue-50",children:[s.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Ecco alcuni ruoli comuni nella ristorazione che potresti voler aggiungere:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Chef","Sous Chef","Cuoco","Addetto cucina","Cameriere","Barista","Manager"].map(ae=>s.jsx("button",{onClick:()=>_({...N,role:ae}),className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm hover:bg-blue-200 transition-colors",children:ae},ae))})]}),F&&W&&!G&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4",children:['Rimuovi "',W.name,'" da "',W.role,'"']}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Scegliere ",s.jsx("strong",{children:"obbligatoriamente"})," un altro ruolo per questo dipendente, oppure rimuovi dipendente dall'applicazione."]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Nuovo ruolo per ",W.name,":"]}),s.jsxs("select",{value:P,onChange:ae=>Q(ae.target.value),className:"w-full h-10 rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"-- Seleziona nuovo ruolo --"}),o.filter(ae=>ae&&ae.id&&ae.name&&typeof ae.name=="string"&&ae.name!==W.role).map(ae=>s.jsx("option",{value:ae.name,children:ae.name},ae.id))]})]}),P&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded p-3",children:s.jsxs("p",{className:"text-sm text-green-800",children:[s.jsx("strong",{children:" Confermato:"})," ",W.name,' verr spostato da "',W.role,'" a "',s.jsx("strong",{children:P}),'".']})})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx(le,{onClick:dt,className:"flex-1",disabled:!P,variant:P?"default":"outline",children:P?"Conferma":"Seleziona un ruolo"}),s.jsx(le,{onClick:Ge,variant:"destructive",className:"flex-1",children:"Rimuovi Dipendente"})]}),s.jsx("div",{className:"mt-3",children:s.jsx(le,{onClick:st,variant:"outline",className:"w-full",size:"sm",children:"Annulla"})})]})}),G&&W&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4 text-red-600",children:" Conferma Eliminazione"}),s.jsxs("p",{className:"text-sm text-gray-700 mb-4",children:["Sei sicuro di voler ",s.jsx("strong",{children:"eliminare definitivamente"})," il dipendente",s.jsxs("strong",{className:"text-red-600",children:[' "',W.name,'"']})," dall'applicazione?"]}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-4",children:s.jsxs("p",{className:"text-sm text-red-800",children:[s.jsx("strong",{children:" Attenzione:"})," Questa azione  ",s.jsx("strong",{children:"irreversibile"}),". Tutti i dati associati a questo dipendente verranno persi permanentemente."]})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(le,{onClick:()=>de(!1),variant:"outline",className:"flex-1",children:"Annulla"}),s.jsx(le,{onClick:Qe,variant:"destructive",className:"flex-1",children:"Elimina Definitivamente"})]})]})})]}),s.jsx(ps,{value:"departments",children:s.jsx(L6,{currentUser:i,departments:o,setDepartments:l})}),s.jsx(ps,{value:"labels",children:s.jsx(T6,{productLabels:c,setProductLabels:d,products:f,currentUser:i})}),s.jsx(ps,{value:"ai-assistant",children:s.jsx(z6,{currentUser:i,products:f,temperatures:p,cleaning:v,staff:t,onAction:m})})]})})}function D6({customCategories:t=[],setCustomCategories:e,currentUser:n,showCustomCategoryManager:r,setShowCustomCategoryManager:i}){const[a,o]=q.useState(!1),[l,c]=q.useState(null),[d,f]=q.useState({name:"",description:"",temperatureMin:"",temperatureMax:"",storageLocation:"",color:"bg-blue-100 text-blue-800",isAmbiente:!1}),p=["bg-blue-100 text-blue-800","bg-red-100 text-red-800","bg-green-100 text-green-800","bg-yellow-100 text-yellow-800","bg-purple-100 text-purple-800","bg-pink-100 text-pink-800","bg-indigo-100 text-indigo-800","bg-orange-100 text-orange-800","bg-teal-100 text-teal-800","bg-cyan-100 text-cyan-800"];q.useEffect(()=>{localStorage.setItem("haccp-custom-categories",JSON.stringify(t))},[t]);const v=()=>{f({name:"",description:"",temperatureMin:"",temperatureMax:"",storageLocation:"",color:"bg-blue-100 text-blue-800",isAmbiente:!1}),c(null)},m=y=>{if(y.preventDefault(),!d.name.trim()){alert("Compila il nome della categoria");return}let b,j;if(d.isAmbiente)b=15,j=25;else{if(!d.temperatureMin.trim()||!d.temperatureMax.trim()){alert('Compila i campi temperatura o seleziona "Temperatura ambiente"');return}if(b=parseFloat(d.temperatureMin),j=parseFloat(d.temperatureMax),isNaN(b)||isNaN(j)){alert("Inserisci temperature valide");return}if(b>=j){alert("La temperatura minima deve essere inferiore alla temperatura massima");return}}if(l){const C=t.map(B=>B.id===l.id?{...B,name:d.name.trim(),description:d.description.trim(),temperatureMin:b,temperatureMax:j,temperature:d.isAmbiente?"15-25C (Ambiente)":`${b}-${j}C`,storageLocation:d.storageLocation.trim(),color:d.color,isAmbiente:d.isAmbiente,updatedAt:new Date().toISOString(),updatedBy:n==null?void 0:n.id,updatedByName:n==null?void 0:n.name}:B);e(C)}else{const C={id:Date.now().toString(),name:d.name.trim(),description:d.description.trim(),temperatureMin:b,temperatureMax:j,temperature:d.isAmbiente?"15-25C (Ambiente)":`${b}-${j}C`,storageLocation:d.storageLocation.trim(),color:d.color,isAmbiente:d.isAmbiente,createdAt:new Date().toISOString(),createdBy:n==null?void 0:n.id,createdByName:n==null?void 0:n.name,updatedAt:new Date().toISOString(),updatedBy:n==null?void 0:n.id,updatedByName:n==null?void 0:n.name};e([...t,C])}v(),o(!1)},N=y=>{c(y),f({name:y.name,description:y.description||"",temperatureMin:y.temperatureMin.toString(),temperatureMax:y.temperatureMax.toString(),storageLocation:y.storageLocation||"",color:y.color,isAmbiente:y.isAmbiente||!1}),o(!0)},_=y=>{confirm("Sei sicuro di voler eliminare questa categoria? Questa azione non pu essere annullata.")&&e(t.filter(b=>b.id!==y))},k=(y,b)=>{const j=(y+b)/2;return j<=-13.5?"Surgelato":j>=15?"Temperatura Ambiente":"Refrigerato"};return s.jsxs(ot,{children:[s.jsxs(Ut,{children:[s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Vn,{className:"h-5 w-5"}),"Categorie Personalizzate"]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Crea nuove categorie di prodotti specifiche per la tua attivit"})]}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs(le,{onClick:()=>{v(),o(!0)},className:"bg-blue-600 hover:bg-blue-700",children:[s.jsx(pr,{className:"mr-2 h-4 w-4"}),"Nuova Categoria"]})}),a&&s.jsxs(ot,{children:[s.jsxs(Ut,{children:[s.jsx(Gt,{children:l?"Modifica Categoria":"Nuova Categoria Personalizzata"}),n&&s.jsxs("p",{className:"text-sm text-gray-600",children:[l?"Modificando come: ":"Creando come: ",s.jsx("span",{className:"font-medium",children:n.name})," (",n.department,")"]})]}),s.jsx(et,{children:s.jsxs("form",{onSubmit:m,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"name",children:"Nome Categoria *"}),s.jsx(bt,{id:"name",type:"text",value:d.name,onChange:y=>f({...d,name:y.target.value}),placeholder:"es. Prodotti Freschi, Specialit Regionali...",required:!0})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"color",children:"Colore Identificativo"}),s.jsx("select",{value:d.color,onChange:y=>f({...d,color:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:p.map((y,b)=>s.jsx("option",{value:y,children:y.replace("bg-","").replace("-100 text-"," - ").replace("-800","")},b))})]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"description",children:"Descrizione"}),s.jsx(bt,{id:"description",type:"text",value:d.description,onChange:y=>f({...d,description:y.target.value}),placeholder:"es. Prodotti freschi di produzione locale..."})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx("input",{type:"checkbox",id:"isAmbiente",checked:d.isAmbiente,onChange:y=>f({...d,isAmbiente:y.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsx(Je,{htmlFor:"isAmbiente",className:"text-sm font-medium text-gray-700",children:"Temperatura ambiente (15-25C)"})]}),!d.isAmbiente&&s.jsx(D5,{label:"Range Temperatura (C) *",minValue:d.temperatureMin,maxValue:d.temperatureMax,onMinChange:y=>f({...d,temperatureMin:y.target.value}),onMaxChange:y=>f({...d,temperatureMax:y.target.value}),required:!0,showValidation:!0,showSuggestions:!0,className:"w-full",id:"temperature-range"}),d.isAmbiente&&s.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ws,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:"text-sm text-blue-800 font-medium",children:"Temperatura ambiente: 15-25C"})]}),s.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Questa categoria utilizzer automaticamente il range di temperatura ambiente per il monitoraggio HACCP."})]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"storageLocation",children:"Posizione di Conservazione Suggerita"}),s.jsx(bt,{id:"storageLocation",type:"text",value:d.storageLocation,onChange:y=>f({...d,storageLocation:y.target.value}),placeholder:"es. Ripiano superiore frigo, Scaffale dispensa..."})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsxs(le,{type:"submit",className:"flex-1",children:[l?"Aggiorna":"Crea"," Categoria"]}),s.jsx(le,{type:"button",variant:"outline",onClick:()=>{o(!1),v()},className:"flex-1",children:"Annulla"})]})]})})]}),t.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(y=>s.jsx(ot,{className:"hover:shadow-md transition-shadow",children:s.jsxs(et,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${y.color}`,children:y.name}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>N(y),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-100",children:s.jsx(wi,{className:"h-3 w-3"})}),s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>_(y.id),className:"text-red-600 hover:text-red-700 hover:bg-red-100",children:s.jsx(er,{className:"h-3 w-3"})})]})]}),y.description&&s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:y.description}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ws,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-600",children:"Temperatura:"}),s.jsx("span",{className:"font-medium",children:y.temperature}),y.isAmbiente&&s.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Ambiente"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(kn,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-600",children:"Tipo:"}),s.jsx("span",{className:"font-medium",children:k(y.temperatureMin,y.temperatureMax)})]}),y.storageLocation&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(pn,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-600",children:"Posizione:"}),s.jsx("span",{className:"font-medium",children:y.storageLocation})]})]}),s.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 text-xs text-gray-500",children:[s.jsxs("p",{children:["Creata da: ",y.createdByName||"N/A"]}),s.jsxs("p",{children:["Aggiornata: ",new Date(y.updatedAt).toLocaleDateString("it-IT")]})]})]})},y.id))}):s.jsx(ot,{children:s.jsxs(et,{className:"p-8 text-center text-gray-500",children:[s.jsx(ws,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),s.jsx("p",{className:"text-lg font-medium mb-2",children:"Nessuna categoria personalizzata"}),s.jsx("p",{className:"text-sm",children:"Crea la tua prima categoria personalizzata per gestire prodotti specifici"})]})})]})})]})}const M6="modulepreload",R6=function(t,e){return new URL(t,e).href},kx={},io=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(a=>{if(a=R6(a,r),a in kx)return;kx[a]=!0;const o=a.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let f=i.length-1;f>=0;f--){const p=i[f];if(p.href===a&&(!o||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":M6,o||(d.as="script",d.crossOrigin=""),d.href=a,document.head.appendChild(d),o)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})};function dn(t){"@babel/helpers - typeof";return dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(t)}var Gr=Uint8Array,Ls=Uint16Array,s1=Int32Array,tm=new Gr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nm=new Gr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Pg=new Gr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),db=function(t,e){for(var n=new Ls(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new s1(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return{b:n,r:i}},hb=db(tm,2),fb=hb.b,Ig=hb.r;fb[28]=258,Ig[258]=28;var mb=db(nm,0),F6=mb.b,Cx=mb.r,Eg=new Ls(32768);for(var Cn=0;Cn<32768;++Cn){var za=(Cn&43690)>>1|(Cn&21845)<<1;za=(za&52428)>>2|(za&13107)<<2,za=(za&61680)>>4|(za&3855)<<4,Eg[Cn]=((za&65280)>>8|(za&255)<<8)>>1}var Vi=function(t,e,n){for(var r=t.length,i=0,a=new Ls(e);i<r;++i)t[i]&&++a[t[i]-1];var o=new Ls(e);for(i=1;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var l;if(n){l=new Ls(1<<e);var c=15-e;for(i=0;i<r;++i)if(t[i])for(var d=i<<4|t[i],f=e-t[i],p=o[t[i]-1]++<<f,v=p|(1<<f)-1;p<=v;++p)l[Eg[p]>>c]=d}else for(l=new Ls(r),i=0;i<r;++i)t[i]&&(l[i]=Eg[o[t[i]-1]++]>>15-t[i]);return l},ao=new Gr(288);for(var Cn=0;Cn<144;++Cn)ao[Cn]=8;for(var Cn=144;Cn<256;++Cn)ao[Cn]=9;for(var Cn=256;Cn<280;++Cn)ao[Cn]=7;for(var Cn=280;Cn<288;++Cn)ao[Cn]=8;var sd=new Gr(32);for(var Cn=0;Cn<32;++Cn)sd[Cn]=5;var $6=Vi(ao,9,0),B6=Vi(ao,9,1),q6=Vi(sd,5,0),U6=Vi(sd,5,1),hp=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},di=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},fp=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},i1=function(t){return(t+7)/8|0},pb=function(t,e,n){return(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length),new Gr(t.subarray(e,n))},V6=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],pi=function(t,e,n){var r=new Error(e||V6[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,pi),!n)throw r;return r},H6=function(t,e,n,r){var i=t.length,a=r?r.length:0;if(!i||e.f&&!e.l)return n||new Gr(0);var o=!n,l=o||e.i!=2,c=e.i;o&&(n=new Gr(i*3));var d=function(Le){var Fe=n.length;if(Le>Fe){var Me=new Gr(Math.max(Fe*2,Le));Me.set(n),n=Me}},f=e.f||0,p=e.p||0,v=e.b||0,m=e.l,N=e.d,_=e.m,k=e.n,y=i*8;do{if(!m){f=di(t,p,1);var b=di(t,p+1,3);if(p+=3,b)if(b==1)m=B6,N=U6,_=9,k=5;else if(b==2){var K=di(t,p,31)+257,Z=di(t,p+10,15)+4,z=K+di(t,p+5,31)+1;p+=14;for(var J=new Gr(z),te=new Gr(19),I=0;I<Z;++I)te[Pg[I]]=di(t,p+I*3,7);p+=Z*3;for(var A=hp(te),T=(1<<A)-1,F=Vi(te,A,1),I=0;I<z;){var ne=F[di(t,p,T)];p+=ne&15;var j=ne>>4;if(j<16)J[I++]=j;else{var W=0,ue=0;for(j==16?(ue=3+di(t,p,3),p+=2,W=J[I-1]):j==17?(ue=3+di(t,p,7),p+=3):j==18&&(ue=11+di(t,p,127),p+=7);ue--;)J[I++]=W}}var P=J.subarray(0,K),Q=J.subarray(K);_=hp(P),k=hp(Q),m=Vi(P,_,1),N=Vi(Q,k,1)}else pi(1);else{var j=i1(p)+4,C=t[j-4]|t[j-3]<<8,B=j+C;if(B>i){c&&pi(0);break}l&&d(v+C),n.set(t.subarray(j,B),v),e.b=v+=C,e.p=p=B*8,e.f=f;continue}if(p>y){c&&pi(0);break}}l&&d(v+131072);for(var G=(1<<_)-1,de=(1<<k)-1,w=p;;w=p){var W=m[fp(t,p)&G],O=W>>4;if(p+=W&15,p>y){c&&pi(0);break}if(W||pi(2),O<256)n[v++]=O;else if(O==256){w=p,m=null;break}else{var R=O-254;if(O>264){var I=O-257,H=tm[I];R=di(t,p,(1<<H)-1)+fb[I],p+=H}var re=N[fp(t,p)&de],oe=re>>4;re||pi(3),p+=re&15;var Q=F6[oe];if(oe>3){var H=nm[oe];Q+=fp(t,p)&(1<<H)-1,p+=H}if(p>y){c&&pi(0);break}l&&d(v+131072);var fe=v+R;if(v<Q){var be=a-Q,ze=Math.min(Q,fe);for(be+v<0&&pi(3);v<ze;++v)n[v]=r[be+v]}for(;v<fe;++v)n[v]=n[v-Q]}}e.l=m,e.p=w,e.b=v,e.f=f,m&&(f=1,e.m=_,e.d=N,e.n=k)}while(!f);return v!=n.length&&o?pb(n,0,v):n.subarray(0,v)},na=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8},ou=function(t,e,n){n<<=e&7;var r=e/8|0;t[r]|=n,t[r+1]|=n>>8,t[r+2]|=n>>16},mp=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,a=n.slice();if(!i)return{t:vb,l:0};if(i==1){var o=new Gr(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(B,K){return B.f-K.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],d=0,f=1,p=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};f!=i-1;)l=n[n[d].f<n[p].f?d++:p++],c=n[d!=f&&n[d].f<n[p].f?d++:p++],n[f++]={s:-1,f:l.f+c.f,l,r:c};for(var v=a[0].s,r=1;r<i;++r)a[r].s>v&&(v=a[r].s);var m=new Ls(v+1),N=Lg(n[f-1],m,0);if(N>e){var r=0,_=0,k=N-e,y=1<<k;for(a.sort(function(K,Z){return m[Z.s]-m[K.s]||K.f-Z.f});r<i;++r){var b=a[r].s;if(m[b]>e)_+=y-(1<<N-m[b]),m[b]=e;else break}for(_>>=k;_>0;){var j=a[r].s;m[j]<e?_-=1<<e-m[j]++-1:++r}for(;r>=0&&_;--r){var C=a[r].s;m[C]==e&&(--m[C],++_)}N=e}return{t:new Gr(m),l:N}},Lg=function(t,e,n){return t.s==-1?Math.max(Lg(t.l,e,n+1),Lg(t.r,e,n+1)):e[t.s]=n},Ax=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Ls(++e),r=0,i=t[0],a=1,o=function(c){n[r++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=t[l]}return{c:n.subarray(0,r),n:e}},lu=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},gb=function(t,e,n){var r=n.length,i=i1(e+2);t[i]=r&255,t[i+1]=r>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<r;++a)t[i+a+4]=n[a];return(i+4+r)*8},Px=function(t,e,n,r,i,a,o,l,c,d,f){na(e,f++,n),++i[256];for(var p=mp(i,15),v=p.t,m=p.l,N=mp(a,15),_=N.t,k=N.l,y=Ax(v),b=y.c,j=y.n,C=Ax(_),B=C.c,K=C.n,Z=new Ls(19),z=0;z<b.length;++z)++Z[b[z]&31];for(var z=0;z<B.length;++z)++Z[B[z]&31];for(var J=mp(Z,7),te=J.t,I=J.l,A=19;A>4&&!te[Pg[A-1]];--A);var T=d+5<<3,F=lu(i,ao)+lu(a,sd)+o,ne=lu(i,v)+lu(a,_)+o+14+3*A+lu(Z,te)+2*Z[16]+3*Z[17]+7*Z[18];if(c>=0&&T<=F&&T<=ne)return gb(e,f,t.subarray(c,c+d));var W,ue,P,Q;if(na(e,f,1+(ne<F)),f+=2,ne<F){W=Vi(v,m,0),ue=v,P=Vi(_,k,0),Q=_;var G=Vi(te,I,0);na(e,f,j-257),na(e,f+5,K-1),na(e,f+10,A-4),f+=14;for(var z=0;z<A;++z)na(e,f+3*z,te[Pg[z]]);f+=3*A;for(var de=[b,B],w=0;w<2;++w)for(var O=de[w],z=0;z<O.length;++z){var R=O[z]&31;na(e,f,G[R]),f+=te[R],R>15&&(na(e,f,O[z]>>5&127),f+=O[z]>>12)}}else W=$6,ue=ao,P=q6,Q=sd;for(var z=0;z<l;++z){var H=r[z];if(H>255){var R=H>>18&31;ou(e,f,W[R+257]),f+=ue[R+257],R>7&&(na(e,f,H>>23&31),f+=tm[R]);var re=H&31;ou(e,f,P[re]),f+=Q[re],re>3&&(ou(e,f,H>>5&8191),f+=nm[re])}else ou(e,f,W[H]),f+=ue[H]}return ou(e,f,W[256]),f+ue[256]},G6=new s1([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),vb=new Gr(0),W6=function(t,e,n,r,i,a){var o=a.z||t.length,l=new Gr(r+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(r,l.length-i),d=a.l,f=(a.r||0)&7;if(e){f&&(c[0]=a.r>>3);for(var p=G6[e-1],v=p>>13,m=p&8191,N=(1<<n)-1,_=a.p||new Ls(32768),k=a.h||new Ls(N+1),y=Math.ceil(n/3),b=2*y,j=function(tt){return(t[tt]^t[tt+1]<<y^t[tt+2]<<b)&N},C=new s1(25e3),B=new Ls(288),K=new Ls(32),Z=0,z=0,J=a.i||0,te=0,I=a.w||0,A=0;J+2<o;++J){var T=j(J),F=J&32767,ne=k[T];if(_[F]=ne,k[T]=F,I<=J){var W=o-J;if((Z>7e3||te>24576)&&(W>423||!d)){f=Px(t,c,0,C,B,K,z,te,A,J-A,f),te=Z=z=0,A=J;for(var ue=0;ue<286;++ue)B[ue]=0;for(var ue=0;ue<30;++ue)K[ue]=0}var P=2,Q=0,G=m,de=F-ne&32767;if(W>2&&T==j(J-de))for(var w=Math.min(v,W)-1,O=Math.min(32767,J),R=Math.min(258,W);de<=O&&--G&&F!=ne;){if(t[J+P]==t[J+P-de]){for(var H=0;H<R&&t[J+H]==t[J+H-de];++H);if(H>P){if(P=H,Q=de,H>w)break;for(var re=Math.min(de,H-2),oe=0,ue=0;ue<re;++ue){var fe=J-de+ue&32767,be=_[fe],ze=fe-be&32767;ze>oe&&(oe=ze,ne=fe)}}}F=ne,ne=_[F],de+=F-ne&32767}if(Q){C[te++]=268435456|Ig[P]<<18|Cx[Q];var Le=Ig[P]&31,Fe=Cx[Q]&31;z+=tm[Le]+nm[Fe],++B[257+Le],++K[Fe],I=J+P,++Z}else C[te++]=t[J],++B[t[J]]}}for(J=Math.max(J,I);J<o;++J)C[te++]=t[J],++B[t[J]];f=Px(t,c,d,C,B,K,z,te,A,J-A,f),d||(a.r=f&7|c[f/8|0]<<3,f-=7,a.h=k,a.p=_,a.i=J,a.w=I)}else{for(var J=a.w||0;J<o+d;J+=65535){var Me=J+65535;Me>=o&&(c[f/8|0]=d,Me=o),f=gb(c,f+1,t.subarray(J,Me))}a.i=o}return pb(l,0,r+i1(f)+i)},xb=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,a=n.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)i+=r+=n[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}t=r,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},Z6=function(t,e,n,r,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new Gr(a.length+t.length);o.set(a),o.set(t,a.length),t=o,i.w=a.length}return W6(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,r,i)},yb=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},J6=function(t,e){var n=e.level,r=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=r<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=xb();i.p(e.dictionary),yb(t,2,i.d())}},K6=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&pi(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&pi(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Tg(t,e){e||(e={});var n=xb();n.p(t);var r=Z6(t,e,e.dictionary?6:2,4);return J6(r,e),yb(r,r.length-4,n.d()),r}function Y6(t,e){return H6(t.subarray(K6(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}var Q6=typeof TextDecoder<"u"&&new TextDecoder,X6=0;try{Q6.decode(vb,{stream:!0}),X6=1}catch{}var It=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function pp(){It.console&&typeof It.console.log=="function"&&It.console.log.apply(It.console,arguments)}var vn={log:pp,warn:function(t){It.console&&(typeof It.console.warn=="function"?It.console.warn.apply(It.console,arguments):pp.call(null,arguments))},error:function(t){It.console&&(typeof It.console.error=="function"?It.console.error.apply(It.console,arguments):pp(t))}};function gp(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Lo(r.response,e,n)},r.onerror=function(){vn.error("could not download file")},r.send()}function Ix(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Sh(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Eu,zg,Lo=It.saveAs||((typeof window>"u"?"undefined":dn(window))!=="object"||window!==It?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var r=It.URL||It.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?Ix(i.href)?gp(t,e,n):Sh(i,i.target="_blank"):Sh(i)):(i.href=r.createObjectURL(t),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){Sh(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(Ix(t))gp(t,e,n);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){Sh(r)})}else navigator.msSaveOrOpenBlob(function(i,a){return a===void 0?a={autoBom:!1}:dn(a)!=="object"&&(vn.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob([String.fromCharCode(65279),i],{type:i.type}):i}(t,n),e)}:function(t,e,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof t=="string")return gp(t,e,n);var i=t.type==="application/octet-stream",a=/constructor/i.test(It.HTMLElement)||It.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&a)&&(typeof FileReader>"u"?"undefined":dn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=f:location=f,r=null},l.readAsDataURL(t)}else{var c=It.URL||It.webkitURL,d=c.createObjectURL(t);r?r.location=d:location.href=d,r=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function bb(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,a=n[r].process,o=i.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function vp(t,e){var n=t[0],r=t[1],i=t[2],a=t[3];n=$r(n,r,i,a,e[0],7,-680876936),a=$r(a,n,r,i,e[1],12,-389564586),i=$r(i,a,n,r,e[2],17,606105819),r=$r(r,i,a,n,e[3],22,-1044525330),n=$r(n,r,i,a,e[4],7,-176418897),a=$r(a,n,r,i,e[5],12,1200080426),i=$r(i,a,n,r,e[6],17,-1473231341),r=$r(r,i,a,n,e[7],22,-45705983),n=$r(n,r,i,a,e[8],7,1770035416),a=$r(a,n,r,i,e[9],12,-1958414417),i=$r(i,a,n,r,e[10],17,-42063),r=$r(r,i,a,n,e[11],22,-1990404162),n=$r(n,r,i,a,e[12],7,1804603682),a=$r(a,n,r,i,e[13],12,-40341101),i=$r(i,a,n,r,e[14],17,-1502002290),n=Br(n,r=$r(r,i,a,n,e[15],22,1236535329),i,a,e[1],5,-165796510),a=Br(a,n,r,i,e[6],9,-1069501632),i=Br(i,a,n,r,e[11],14,643717713),r=Br(r,i,a,n,e[0],20,-373897302),n=Br(n,r,i,a,e[5],5,-701558691),a=Br(a,n,r,i,e[10],9,38016083),i=Br(i,a,n,r,e[15],14,-660478335),r=Br(r,i,a,n,e[4],20,-405537848),n=Br(n,r,i,a,e[9],5,568446438),a=Br(a,n,r,i,e[14],9,-1019803690),i=Br(i,a,n,r,e[3],14,-187363961),r=Br(r,i,a,n,e[8],20,1163531501),n=Br(n,r,i,a,e[13],5,-1444681467),a=Br(a,n,r,i,e[2],9,-51403784),i=Br(i,a,n,r,e[7],14,1735328473),n=qr(n,r=Br(r,i,a,n,e[12],20,-1926607734),i,a,e[5],4,-378558),a=qr(a,n,r,i,e[8],11,-2022574463),i=qr(i,a,n,r,e[11],16,1839030562),r=qr(r,i,a,n,e[14],23,-35309556),n=qr(n,r,i,a,e[1],4,-1530992060),a=qr(a,n,r,i,e[4],11,1272893353),i=qr(i,a,n,r,e[7],16,-155497632),r=qr(r,i,a,n,e[10],23,-1094730640),n=qr(n,r,i,a,e[13],4,681279174),a=qr(a,n,r,i,e[0],11,-358537222),i=qr(i,a,n,r,e[3],16,-722521979),r=qr(r,i,a,n,e[6],23,76029189),n=qr(n,r,i,a,e[9],4,-640364487),a=qr(a,n,r,i,e[12],11,-421815835),i=qr(i,a,n,r,e[15],16,530742520),n=Ur(n,r=qr(r,i,a,n,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Ur(a,n,r,i,e[7],10,1126891415),i=Ur(i,a,n,r,e[14],15,-1416354905),r=Ur(r,i,a,n,e[5],21,-57434055),n=Ur(n,r,i,a,e[12],6,1700485571),a=Ur(a,n,r,i,e[3],10,-1894986606),i=Ur(i,a,n,r,e[10],15,-1051523),r=Ur(r,i,a,n,e[1],21,-2054922799),n=Ur(n,r,i,a,e[8],6,1873313359),a=Ur(a,n,r,i,e[15],10,-30611744),i=Ur(i,a,n,r,e[6],15,-1560198380),r=Ur(r,i,a,n,e[13],21,1309151649),n=Ur(n,r,i,a,e[4],6,-145523070),a=Ur(a,n,r,i,e[11],10,-1120210379),i=Ur(i,a,n,r,e[2],15,718787259),r=Ur(r,i,a,n,e[9],21,-343485551),t[0]=Za(n,t[0]),t[1]=Za(r,t[1]),t[2]=Za(i,t[2]),t[3]=Za(a,t[3])}function rm(t,e,n,r,i,a){return e=Za(Za(e,t),Za(r,a)),Za(e<<i|e>>>32-i,n)}function $r(t,e,n,r,i,a,o){return rm(e&n|~e&r,t,e,i,a,o)}function Br(t,e,n,r,i,a,o){return rm(e&r|n&~r,t,e,i,a,o)}function qr(t,e,n,r,i,a,o){return rm(e^n^r,t,e,i,a,o)}function Ur(t,e,n,r,i,a,o){return rm(n^(e|~r),t,e,i,a,o)}function wb(t){var e,n=t.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)vp(r,eC(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(vp(r,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,vp(r,i),r}function eC(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}Eu=It.atob.bind(It),zg=It.btoa.bind(It);var Ex="0123456789abcdef".split("");function tC(t){for(var e="",n=0;n<4;n++)e+=Ex[t>>8*n+4&15]+Ex[t>>8*n&15];return e}function nC(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Og(t){return wb(t).map(nC).join("")}var rC=function(t){for(var e=0;e<t.length;e++)t[e]=tC(t[e]);return t.join("")}(wb("hello"))!="5d41402abc4b2a76b9719d911017c592";function Za(t,e){if(rC){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Dg(t,e){var n,r,i,a;if(t!==n){for(var o=(i=t,a=1+(256/t.length>>0),new Array(a+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var f=l[c];d=(d+f+o.charCodeAt(c))%256,l[c]=l[d],l[d]=f}n=t,r=l}else l=r;var p=e.length,v=0,m=0,N="";for(c=0;c<p;c++)m=(m+(f=l[v=(v+1)%256]))%256,l[v]=l[m],l[m]=f,o=l[(l[v]+l[m])%256],N+=String.fromCharCode(e.charCodeAt(c)^o);return N}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Lx={print:4,modify:8,copy:16,"annot-forms":32};function zl(t,e,n,r){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(Lx.perm!==void 0)throw new Error("Invalid permission: "+l);i+=Lx[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^i)),this.encryptionKey=Og(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Dg(this.encryptionKey,this.padding)}function Ol(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[r]}return e}function Tx(t){if(dn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var a=Math.random().toString(35);return e[n][a]=[r,!!i],a},this.unsubscribe=function(n){for(var r in e)if(e[r][n])return delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[n]){var o=e[n][a];try{o[0].apply(t,r)}catch(l){It.console&&vn.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Pf(t){if(!(this instanceof Pf))return new Pf(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function Nb(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function zo(t,e,n,r,i){if(!(this instanceof zo))return new zo(t,e,n,r,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,Nb.call(this,r,i)}function Yl(t,e,n,r,i){if(!(this instanceof Yl))return new Yl(t,e,n,r,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,Nb.call(this,r,i)}function Pt(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],a=arguments[3],o=[],l=1,c=16,d="S",f=null;dn(t=t||{})==="object"&&(n=t.orientation,r=t.unit||r,i=t.format||i,a=t.compress||t.compressPdf||a,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var p=t.putOnlyUsedFonts||!1,v={},m={internal:{},__private__:{}};m.__private__.PubSub=Tx;var N="1.3",_=m.__private__.getPdfVersion=function(){return N};m.__private__.setPdfVersion=function(g){N=g};var k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return k};var y=m.__private__.getPageFormat=function(g){return k[g]};i=i||"a4";var b={COMPAT:"compat",ADVANCED:"advanced"},j=b.COMPAT;function C(){this.saveGraphicsState(),ie(new Nt(ye,0,0,-ye,0,wa()*ye).toString()+" cm"),this.setFontSize(this.getFontSize()/ye),d="n",j=b.ADVANCED}function B(){this.restoreGraphicsState(),d="S",j=b.COMPAT}var K=m.__private__.combineFontStyleAndFontWeight=function(g,L){if(g=="bold"&&L=="normal"||g=="bold"&&L==400||g=="normal"&&L=="italic"||g=="bold"&&L=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return L&&(g=L==400||L==="normal"?g==="italic"?"italic":"normal":L!=700&&L!=="bold"||g!=="normal"?(L==700?"bold":L)+""+g:"bold"),g};m.advancedAPI=function(g){var L=j===b.COMPAT;return L&&C.call(this),typeof g!="function"||(g(this),L&&B.call(this)),this},m.compatAPI=function(g){var L=j===b.ADVANCED;return L&&B.call(this),typeof g!="function"||(g(this),L&&C.call(this)),this},m.isAdvancedAPI=function(){return j===b.ADVANCED};var Z,z=function(g){if(j!==b.ADVANCED)throw new Error(g+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},J=m.roundToPrecision=m.__private__.roundToPrecision=function(g,L){var se=e||L;if(isNaN(g)||isNaN(se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return g.toFixed(se).replace(/0+$/,"")};Z=m.hpf=m.__private__.hpf=typeof c=="number"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return J(g,c)}:c==="smart"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return J(g,g>-1&&g<1?16:5)}:function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return J(g,16)};var te=m.f2=m.__private__.f2=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f2");return J(g,2)},I=m.__private__.f3=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f3");return J(g,3)},A=m.scale=m.__private__.scale=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.scale");return j===b.COMPAT?g*ye:j===b.ADVANCED?g:void 0},T=function(g){return j===b.COMPAT?wa()-g:j===b.ADVANCED?g:void 0},F=function(g){return A(T(g))};m.__private__.setPrecision=m.setPrecision=function(g){typeof parseInt(g,10)=="number"&&(e=parseInt(g,10))};var ne,W="00000000000000000000000000000000",ue=m.__private__.getFileId=function(){return W},P=m.__private__.setFileId=function(g){return W=g!==void 0&&/^[a-fA-F0-9]{32}$/.test(g)?g.toUpperCase():W.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Dr=new zl(f.userPermissions,f.userPassword,f.ownerPassword,W)),W};m.setFileId=function(g){return P(g),this},m.getFileId=function(){return ue()};var Q=m.__private__.convertDateToPDFDate=function(g){var L=g.getTimezoneOffset(),se=L<0?"+":"-",me=Math.floor(Math.abs(L/60)),je=Math.abs(L%60),Oe=[se,R(me),"'",R(je),"'"].join("");return["D:",g.getFullYear(),R(g.getMonth()+1),R(g.getDate()),R(g.getHours()),R(g.getMinutes()),R(g.getSeconds()),Oe].join("")},G=m.__private__.convertPDFDateToDate=function(g){var L=parseInt(g.substr(2,4),10),se=parseInt(g.substr(6,2),10)-1,me=parseInt(g.substr(8,2),10),je=parseInt(g.substr(10,2),10),Oe=parseInt(g.substr(12,2),10),Ke=parseInt(g.substr(14,2),10);return new Date(L,se,me,je,Oe,Ke,0)},de=m.__private__.setCreationDate=function(g){var L;if(g===void 0&&(g=new Date),g instanceof Date)L=Q(g);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(g))throw new Error("Invalid argument passed to jsPDF.setCreationDate");L=g}return ne=L},w=m.__private__.getCreationDate=function(g){var L=ne;return g==="jsDate"&&(L=G(ne)),L};m.setCreationDate=function(g){return de(g),this},m.getCreationDate=function(g){return w(g)};var O,R=m.__private__.padd2=function(g){return("0"+parseInt(g)).slice(-2)},H=m.__private__.padd2Hex=function(g){return("00"+(g=g.toString())).substr(g.length)},re=0,oe=[],fe=[],be=0,ze=[],Le=[],Fe=!1,Me=fe,tt=function(){re=0,be=0,fe=[],oe=[],ze=[],os=xn(),zr=xn()};m.__private__.setCustomOutputDestination=function(g){Fe=!0,Me=g};var Ce=function(g){Fe||(Me=g)};m.__private__.resetCustomOutputDestination=function(){Fe=!1,Me=fe};var ie=m.__private__.out=function(g){return g=g.toString(),be+=g.length+1,Me.push(g),Me},pt=m.__private__.write=function(g){return ie(arguments.length===1?g.toString():Array.prototype.join.call(arguments," "))},dt=m.__private__.getArrayBuffer=function(g){for(var L=g.length,se=new ArrayBuffer(L),me=new Uint8Array(se);L--;)me[L]=g.charCodeAt(L);return se},Ge=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return Ge};var Qe=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(g){return Qe=j===b.ADVANCED?g/ye:g,this};var st,ae=m.__private__.getFontSize=m.getFontSize=function(){return j===b.COMPAT?Qe:Qe*ye},Ae=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(g){return Ae=g,this},m.__private__.getR2L=m.getR2L=function(){return Ae};var Re,he=m.__private__.setZoomMode=function(g){var L=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(g))st=g;else if(isNaN(g)){if(L.indexOf(g)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+g+'" is not recognized.');st=g}else st=parseInt(g,10)};m.__private__.getZoomMode=function(){return st};var Ne,He=m.__private__.setPageMode=function(g){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(g)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+g+'" is not recognized.');Re=g};m.__private__.getPageMode=function(){return Re};var ce=m.__private__.setLayoutMode=function(g){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(g)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+g+'" is not recognized.');Ne=g};m.__private__.getLayoutMode=function(){return Ne},m.__private__.setDisplayMode=m.setDisplayMode=function(g,L,se){return he(g),ce(L),He(se),this};var pe={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(g){if(Object.keys(pe).indexOf(g)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return pe[g]},m.__private__.getDocumentProperties=function(){return pe},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(g){for(var L in pe)pe.hasOwnProperty(L)&&g[L]&&(pe[L]=g[L]);return this},m.__private__.setDocumentProperty=function(g,L){if(Object.keys(pe).indexOf(g)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return pe[g]=L};var ke,ye,Ze,Be,ut,it={},gt={},Vt=[],vt={},Yt={},Bt={},wt={},Qt=null,Et=0,rt=[],yt=new Tx(m),fn=t.hotfixes||[],Ht={},nr={},Sr=[],Nt=function g(L,se,me,je,Oe,Ke){if(!(this instanceof g))return new g(L,se,me,je,Oe,Ke);isNaN(L)&&(L=1),isNaN(se)&&(se=0),isNaN(me)&&(me=0),isNaN(je)&&(je=1),isNaN(Oe)&&(Oe=0),isNaN(Ke)&&(Ke=0),this._matrix=[L,se,me,je,Oe,Ke]};Object.defineProperty(Nt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(Nt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(Nt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(Nt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(Nt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(Nt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(Nt.prototype,"a",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(Nt.prototype,"b",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(Nt.prototype,"c",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(Nt.prototype,"d",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(Nt.prototype,"e",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(Nt.prototype,"f",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(Nt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Nt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Nt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Nt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Nt.prototype.join=function(g){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Z).join(g)},Nt.prototype.multiply=function(g){var L=g.sx*this.sx+g.shy*this.shx,se=g.sx*this.shy+g.shy*this.sy,me=g.shx*this.sx+g.sy*this.shx,je=g.shx*this.shy+g.sy*this.sy,Oe=g.tx*this.sx+g.ty*this.shx+this.tx,Ke=g.tx*this.shy+g.ty*this.sy+this.ty;return new Nt(L,se,me,je,Oe,Ke)},Nt.prototype.decompose=function(){var g=this.sx,L=this.shy,se=this.shx,me=this.sy,je=this.tx,Oe=this.ty,Ke=Math.sqrt(g*g+L*L),ht=(g/=Ke)*se+(L/=Ke)*me;se-=g*ht,me-=L*ht;var St=Math.sqrt(se*se+me*me);return ht/=St,g*(me/=St)<L*(se/=St)&&(g=-g,L=-L,ht=-ht,Ke=-Ke),{scale:new Nt(Ke,0,0,St,0,0),translate:new Nt(1,0,0,1,je,Oe),rotate:new Nt(g,L,-L,g,0,0),skew:new Nt(1,0,ht,1,0,0)}},Nt.prototype.toString=function(g){return this.join(" ")},Nt.prototype.inversed=function(){var g=this.sx,L=this.shy,se=this.shx,me=this.sy,je=this.tx,Oe=this.ty,Ke=1/(g*me-L*se),ht=me*Ke,St=-L*Ke,Mt=-se*Ke,Ot=g*Ke;return new Nt(ht,St,Mt,Ot,-ht*je-Mt*Oe,-St*je-Ot*Oe)},Nt.prototype.applyToPoint=function(g){var L=g.x*this.sx+g.y*this.shx+this.tx,se=g.x*this.shy+g.y*this.sy+this.ty;return new al(L,se)},Nt.prototype.applyToRectangle=function(g){var L=this.applyToPoint(g),se=this.applyToPoint(new al(g.x+g.w,g.y+g.h));return new Ec(L.x,L.y,se.x-L.x,se.y-L.y)},Nt.prototype.clone=function(){var g=this.sx,L=this.shy,se=this.shx,me=this.sy,je=this.tx,Oe=this.ty;return new Nt(g,L,se,me,je,Oe)},m.Matrix=Nt;var rr=m.matrixMult=function(g,L){return L.multiply(g)},Jr=new Nt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=Jr;var cr=function(g,L){if(!Yt[g]){var se=(L instanceof zo?"Sh":"P")+(Object.keys(vt).length+1).toString(10);L.id=se,Yt[g]=se,vt[se]=L,yt.publish("addPattern",L)}};m.ShadingPattern=zo,m.TilingPattern=Yl,m.addShadingPattern=function(g,L){return z("addShadingPattern()"),cr(g,L),this},m.beginTilingPattern=function(g){z("beginTilingPattern()"),Ad(g.boundingBox[0],g.boundingBox[1],g.boundingBox[2]-g.boundingBox[0],g.boundingBox[3]-g.boundingBox[1],g.matrix)},m.endTilingPattern=function(g,L){z("endTilingPattern()"),L.stream=Le[O].join(`
`),cr(g,L),yt.publish("endTilingPattern",L),Sr.pop().restore()};var Ln=m.__private__.newObject=function(){var g=xn();return _r(g,!0),g},xn=m.__private__.newObjectDeferred=function(){return re++,oe[re]=function(){return be},re},_r=function(g,L){return L=typeof L=="boolean"&&L,oe[g]=be,L&&ie(g+" 0 obj"),g},_i=m.__private__.newAdditionalObject=function(){var g={objId:xn(),content:""};return ze.push(g),g},os=xn(),zr=xn(),Pn=m.__private__.decodeColorString=function(g){var L=g.split(" ");if(L.length!==2||L[1]!=="g"&&L[1]!=="G")L.length===5&&(L[4]==="k"||L[4]==="K")&&(L=[(1-L[0])*(1-L[3]),(1-L[1])*(1-L[3]),(1-L[2])*(1-L[3]),"r"]);else{var se=parseFloat(L[0]);L=[se,se,se,"r"]}for(var me="#",je=0;je<3;je++)me+=("0"+Math.floor(255*parseFloat(L[je])).toString(16)).slice(-2);return me},kr=m.__private__.encodeColorString=function(g){var L;typeof g=="string"&&(g={ch1:g});var se=g.ch1,me=g.ch2,je=g.ch3,Oe=g.ch4,Ke=g.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof se=="string"&&se.charAt(0)!=="#"){var ht=new bb(se);if(ht.ok)se=ht.toHex();else if(!/^\d*\.?\d*$/.test(se))throw new Error('Invalid color "'+se+'" passed to jsPDF.encodeColorString.')}if(typeof se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(se)&&(se="#"+se[1]+se[1]+se[2]+se[2]+se[3]+se[3]),typeof se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(se)){var St=parseInt(se.substr(1),16);se=St>>16&255,me=St>>8&255,je=255&St}if(me===void 0||Oe===void 0&&se===me&&me===je)if(typeof se=="string")L=se+" "+Ke[0];else switch(g.precision){case 2:L=te(se/255)+" "+Ke[0];break;case 3:default:L=I(se/255)+" "+Ke[0]}else if(Oe===void 0||dn(Oe)==="object"){if(Oe&&!isNaN(Oe.a)&&Oe.a===0)return L=["1.","1.","1.",Ke[1]].join(" ");if(typeof se=="string")L=[se,me,je,Ke[1]].join(" ");else switch(g.precision){case 2:L=[te(se/255),te(me/255),te(je/255),Ke[1]].join(" ");break;default:case 3:L=[I(se/255),I(me/255),I(je/255),Ke[1]].join(" ")}}else if(typeof se=="string")L=[se,me,je,Oe,Ke[2]].join(" ");else switch(g.precision){case 2:L=[te(se),te(me),te(je),te(Oe),Ke[2]].join(" ");break;case 3:default:L=[I(se),I(me),I(je),I(Oe),Ke[2]].join(" ")}return L},ur=m.__private__.getFilters=function(){return o},Or=m.__private__.putStream=function(g){var L=(g=g||{}).data||"",se=g.filters||ur(),me=g.alreadyAppliedFilters||[],je=g.addLength1||!1,Oe=L.length,Ke=g.objectId,ht=function(Mr){return Mr};if(f!==null&&Ke===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(ht=Dr.encryptor(Ke,0));var St={};se===!0&&(se=["FlateEncode"]);var Mt=g.additionalKeyValues||[],Ot=(St=Pt.API.processDataByFilters!==void 0?Pt.API.processDataByFilters(L,se):{data:L,reverseChain:[]}).reverseChain+(Array.isArray(me)?me.join(" "):me.toString());if(St.data.length!==0&&(Mt.push({key:"Length",value:St.data.length}),je===!0&&Mt.push({key:"Length1",value:Oe})),Ot.length!=0)if(Ot.split("/").length-1==1)Mt.push({key:"Filter",value:Ot});else{Mt.push({key:"Filter",value:"["+Ot+"]"});for(var Xt=0;Xt<Mt.length;Xt+=1)if(Mt[Xt].key==="DecodeParms"){for(var zn=[],Fn=0;Fn<St.reverseChain.split("/").length-1;Fn+=1)zn.push("null");zn.push(Mt[Xt].value),Mt[Xt].value="["+zn.join(" ")+"]"}}ie("<<");for(var sr=0;sr<Mt.length;sr++)ie("/"+Mt[sr].key+" "+Mt[sr].value);ie(">>"),St.data.length!==0&&(ie("stream"),ie(ht(St.data)),ie("endstream"))},Hn=m.__private__.putPage=function(g){var L=g.number,se=g.data,me=g.objId,je=g.contentsObjId;_r(me,!0),ie("<</Type /Page"),ie("/Parent "+g.rootDictionaryObjId+" 0 R"),ie("/Resources "+g.resourceDictionaryObjId+" 0 R"),ie("/MediaBox ["+parseFloat(Z(g.mediaBox.bottomLeftX))+" "+parseFloat(Z(g.mediaBox.bottomLeftY))+" "+Z(g.mediaBox.topRightX)+" "+Z(g.mediaBox.topRightY)+"]"),g.cropBox!==null&&ie("/CropBox ["+Z(g.cropBox.bottomLeftX)+" "+Z(g.cropBox.bottomLeftY)+" "+Z(g.cropBox.topRightX)+" "+Z(g.cropBox.topRightY)+"]"),g.bleedBox!==null&&ie("/BleedBox ["+Z(g.bleedBox.bottomLeftX)+" "+Z(g.bleedBox.bottomLeftY)+" "+Z(g.bleedBox.topRightX)+" "+Z(g.bleedBox.topRightY)+"]"),g.trimBox!==null&&ie("/TrimBox ["+Z(g.trimBox.bottomLeftX)+" "+Z(g.trimBox.bottomLeftY)+" "+Z(g.trimBox.topRightX)+" "+Z(g.trimBox.topRightY)+"]"),g.artBox!==null&&ie("/ArtBox ["+Z(g.artBox.bottomLeftX)+" "+Z(g.artBox.bottomLeftY)+" "+Z(g.artBox.topRightX)+" "+Z(g.artBox.topRightY)+"]"),typeof g.userUnit=="number"&&g.userUnit!==1&&ie("/UserUnit "+g.userUnit),yt.publish("putPage",{objId:me,pageContext:rt[L],pageNumber:L,page:se}),ie("/Contents "+je+" 0 R"),ie(">>"),ie("endobj");var Oe=se.join(`
`);return j===b.ADVANCED&&(Oe+=`
Q`),_r(je,!0),Or({data:Oe,filters:ur(),objectId:je}),ie("endobj"),me},Ss=m.__private__.putPages=function(){var g,L,se=[];for(g=1;g<=Et;g++)rt[g].objId=xn(),rt[g].contentsObjId=xn();for(g=1;g<=Et;g++)se.push(Hn({number:g,data:Le[g],objId:rt[g].objId,contentsObjId:rt[g].contentsObjId,mediaBox:rt[g].mediaBox,cropBox:rt[g].cropBox,bleedBox:rt[g].bleedBox,trimBox:rt[g].trimBox,artBox:rt[g].artBox,userUnit:rt[g].userUnit,rootDictionaryObjId:os,resourceDictionaryObjId:zr}));_r(os,!0),ie("<</Type /Pages");var me="/Kids [";for(L=0;L<Et;L++)me+=se[L]+" 0 R ";ie(me+"]"),ie("/Count "+Et),ie(">>"),ie("endobj"),yt.publish("postPutPages")},ri=function(g){yt.publish("putFont",{font:g,out:ie,newObject:Ln,putStream:Or}),g.isAlreadyPutted!==!0&&(g.objectNumber=Ln(),ie("<<"),ie("/Type /Font"),ie("/BaseFont /"+Ol(g.postScriptName)),ie("/Subtype /Type1"),typeof g.encoding=="string"&&ie("/Encoding /"+g.encoding),ie("/FirstChar 32"),ie("/LastChar 255"),ie(">>"),ie("endobj"))},si=function(){for(var g in it)it.hasOwnProperty(g)&&(p===!1||p===!0&&v.hasOwnProperty(g))&&ri(it[g])},ki=function(g){g.objectNumber=Ln();var L=[];L.push({key:"Type",value:"/XObject"}),L.push({key:"Subtype",value:"/Form"}),L.push({key:"BBox",value:"["+[Z(g.x),Z(g.y),Z(g.x+g.width),Z(g.y+g.height)].join(" ")+"]"}),L.push({key:"Matrix",value:"["+g.matrix.toString()+"]"});var se=g.pages[1].join(`
`);Or({data:se,additionalKeyValues:L,objectId:g.objectNumber}),ie("endobj")},Ci=function(){for(var g in Ht)Ht.hasOwnProperty(g)&&ki(Ht[g])},pa=function(g,L){var se,me=[],je=1/(L-1);for(se=0;se<1;se+=je)me.push(se);if(me.push(1),g[0].offset!=0){var Oe={offset:0,color:g[0].color};g.unshift(Oe)}if(g[g.length-1].offset!=1){var Ke={offset:1,color:g[g.length-1].color};g.push(Ke)}for(var ht="",St=0,Mt=0;Mt<me.length;Mt++){for(se=me[Mt];se>g[St+1].offset;)St++;var Ot=g[St].offset,Xt=(se-Ot)/(g[St+1].offset-Ot),zn=g[St].color,Fn=g[St+1].color;ht+=H(Math.round((1-Xt)*zn[0]+Xt*Fn[0]).toString(16))+H(Math.round((1-Xt)*zn[1]+Xt*Fn[1]).toString(16))+H(Math.round((1-Xt)*zn[2]+Xt*Fn[2]).toString(16))}return ht.trim()},po=function(g,L){L||(L=21);var se=Ln(),me=pa(g.colors,L),je=[];je.push({key:"FunctionType",value:"0"}),je.push({key:"Domain",value:"[0.0 1.0]"}),je.push({key:"Size",value:"["+L+"]"}),je.push({key:"BitsPerSample",value:"8"}),je.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),je.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Or({data:me,additionalKeyValues:je,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:se}),ie("endobj"),g.objectNumber=Ln(),ie("<< /ShadingType "+g.type),ie("/ColorSpace /DeviceRGB");var Oe="/Coords ["+Z(parseFloat(g.coords[0]))+" "+Z(parseFloat(g.coords[1]))+" ";g.type===2?Oe+=Z(parseFloat(g.coords[2]))+" "+Z(parseFloat(g.coords[3])):Oe+=Z(parseFloat(g.coords[2]))+" "+Z(parseFloat(g.coords[3]))+" "+Z(parseFloat(g.coords[4]))+" "+Z(parseFloat(g.coords[5])),ie(Oe+="]"),g.matrix&&ie("/Matrix ["+g.matrix.toString()+"]"),ie("/Function "+se+" 0 R"),ie("/Extend [true true]"),ie(">>"),ie("endobj")},ga=function(g,L){var se=xn(),me=Ln();L.push({resourcesOid:se,objectOid:me}),g.objectNumber=me;var je=[];je.push({key:"Type",value:"/Pattern"}),je.push({key:"PatternType",value:"1"}),je.push({key:"PaintType",value:"1"}),je.push({key:"TilingType",value:"1"}),je.push({key:"BBox",value:"["+g.boundingBox.map(Z).join(" ")+"]"}),je.push({key:"XStep",value:Z(g.xStep)}),je.push({key:"YStep",value:Z(g.yStep)}),je.push({key:"Resources",value:se+" 0 R"}),g.matrix&&je.push({key:"Matrix",value:"["+g.matrix.toString()+"]"}),Or({data:g.stream,additionalKeyValues:je,objectId:g.objectNumber}),ie("endobj")},U=function(g){var L;for(L in vt)vt.hasOwnProperty(L)&&(vt[L]instanceof zo?po(vt[L]):vt[L]instanceof Yl&&ga(vt[L],g))},Pe=function(g){for(var L in g.objectNumber=Ln(),ie("<<"),g)switch(L){case"opacity":ie("/ca "+te(g[L]));break;case"stroke-opacity":ie("/CA "+te(g[L]))}ie(">>"),ie("endobj")},Te=function(){var g;for(g in Bt)Bt.hasOwnProperty(g)&&Pe(Bt[g])},Xe=function(){for(var g in ie("/XObject <<"),Ht)Ht.hasOwnProperty(g)&&Ht[g].objectNumber>=0&&ie("/"+g+" "+Ht[g].objectNumber+" 0 R");yt.publish("putXobjectDict"),ie(">>")},jt=function(){Dr.oid=Ln(),ie("<<"),ie("/Filter /Standard"),ie("/V "+Dr.v),ie("/R "+Dr.r),ie("/U <"+Dr.toHexString(Dr.U)+">"),ie("/O <"+Dr.toHexString(Dr.O)+">"),ie("/P "+Dr.P),ie(">>"),ie("endobj")},At=function(){for(var g in ie("/Font <<"),it)it.hasOwnProperty(g)&&(p===!1||p===!0&&v.hasOwnProperty(g))&&ie("/"+g+" "+it[g].objectNumber+" 0 R");ie(">>")},qt=function(){if(Object.keys(vt).length>0){for(var g in ie("/Shading <<"),vt)vt.hasOwnProperty(g)&&vt[g]instanceof zo&&vt[g].objectNumber>=0&&ie("/"+g+" "+vt[g].objectNumber+" 0 R");yt.publish("putShadingPatternDict"),ie(">>")}},on=function(g){if(Object.keys(vt).length>0){for(var L in ie("/Pattern <<"),vt)vt.hasOwnProperty(L)&&vt[L]instanceof m.TilingPattern&&vt[L].objectNumber>=0&&vt[L].objectNumber<g&&ie("/"+L+" "+vt[L].objectNumber+" 0 R");yt.publish("putTilingPatternDict"),ie(">>")}},Kr=function(){if(Object.keys(Bt).length>0){var g;for(g in ie("/ExtGState <<"),Bt)Bt.hasOwnProperty(g)&&Bt[g].objectNumber>=0&&ie("/"+g+" "+Bt[g].objectNumber+" 0 R");yt.publish("putGStateDict"),ie(">>")}},rn=function(g){_r(g.resourcesOid,!0),ie("<<"),ie("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),At(),qt(),on(g.objectOid),Kr(),Xe(),ie(">>"),ie("endobj")},Gi=function(){var g=[];si(),Te(),Ci(),U(g),yt.publish("putResources"),g.forEach(rn),rn({resourcesOid:zr,objectOid:Number.MAX_SAFE_INTEGER}),yt.publish("postPutResources")},Ms=function(){yt.publish("putAdditionalObjects");for(var g=0;g<ze.length;g++){var L=ze[g];_r(L.objId,!0),ie(L.content),ie("endobj")}yt.publish("postPutAdditionalObjects")},Ai=function(g){gt[g.fontName]=gt[g.fontName]||{},gt[g.fontName][g.fontStyle]=g.id},ii=function(g,L,se,me,je){var Oe={id:"F"+(Object.keys(it).length+1).toString(10),postScriptName:g,fontName:L,fontStyle:se,encoding:me,isStandardFont:je||!1,metadata:{}};return yt.publish("addFont",{font:Oe,instance:this}),it[Oe.id]=Oe,Ai(Oe),Oe.id},tl=function(g){for(var L=0,se=Ge.length;L<se;L++){var me=ii.call(this,g[L][0],g[L][1],g[L][2],Ge[L][3],!0);p===!1&&(v[me]=!0);var je=g[L][0].split("-");Ai({id:me,fontName:je[0],fontStyle:je[1]||""})}yt.publish("addFonts",{fonts:it,dictionary:gt})},ls=function(g){return g.foo=function(){try{return g.apply(this,arguments)}catch(me){var L=me.stack||"";~L.indexOf(" at ")&&(L=L.split(" at ")[1]);var se="Error in function "+L.split(`
`)[0].split("<")[0]+": "+me.message;if(!It.console)throw new Error(se);It.console.error(se,me),It.alert&&alert(se)}},g.foo.bar=g,g.foo},Wi=function(g,L){var se,me,je,Oe,Ke,ht,St,Mt,Ot;if(je=(L=L||{}).sourceEncoding||"Unicode",Ke=L.outputEncoding,(L.autoencode||Ke)&&it[ke].metadata&&it[ke].metadata[je]&&it[ke].metadata[je].encoding&&(Oe=it[ke].metadata[je].encoding,!Ke&&it[ke].encoding&&(Ke=it[ke].encoding),!Ke&&Oe.codePages&&(Ke=Oe.codePages[0]),typeof Ke=="string"&&(Ke=Oe[Ke]),Ke)){for(St=!1,ht=[],se=0,me=g.length;se<me;se++)(Mt=Ke[g.charCodeAt(se)])?ht.push(String.fromCharCode(Mt)):ht.push(g[se]),ht[se].charCodeAt(0)>>8&&(St=!0);g=ht.join("")}for(se=g.length;St===void 0&&se!==0;)g.charCodeAt(se-1)>>8&&(St=!0),se--;if(!St)return g;for(ht=L.noBOM?[]:[254,255],se=0,me=g.length;se<me;se++){if((Ot=(Mt=g.charCodeAt(se))>>8)>>8)throw new Error("Character at position "+se+" of string '"+g+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ht.push(Ot),ht.push(Mt-(Ot<<8))}return String.fromCharCode.apply(void 0,ht)},Cr=m.__private__.pdfEscape=m.pdfEscape=function(g,L){return Wi(g,L).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},va=m.__private__.beginPage=function(g){Le[++Et]=[],rt[Et]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(g[0]),topRightY:Number(g[1])}},Ie(Et),Ce(Le[O])},go=function(g,L){var se,me,je;switch(n=L||n,typeof g=="string"&&(se=y(g.toLowerCase()),Array.isArray(se)&&(me=se[0],je=se[1])),Array.isArray(g)&&(me=g[0]*ye,je=g[1]*ye),isNaN(me)&&(me=i[0],je=i[1]),(me>14400||je>14400)&&(vn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),me=Math.min(14400,me),je=Math.min(14400,je)),i=[me,je],n.substr(0,1)){case"l":je>me&&(i=[je,me]);break;case"p":me>je&&(i=[je,me])}va(i),jd(Cc),ie(ai),Pc!==0&&ie(Pc+" J"),Ic!==0&&ie(Ic+" j"),yt.publish("addPage",{pageNumber:Et})},Y=function(g){g>0&&g<=Et&&(Le.splice(g,1),rt.splice(g,1),Et--,O>Et&&(O=Et),this.setPage(O))},Ie=function(g){g>0&&g<=Et&&(O=g)},Ye=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Le.length-1},zt=function(g,L,se){var me,je=void 0;return se=se||{},g=g!==void 0?g:it[ke].fontName,L=L!==void 0?L:it[ke].fontStyle,me=g.toLowerCase(),gt[me]!==void 0&&gt[me][L]!==void 0?je=gt[me][L]:gt[g]!==void 0&&gt[g][L]!==void 0?je=gt[g][L]:se.disableWarning===!1&&vn.warn("Unable to look up font label for font '"+g+"', '"+L+"'. Refer to getFontList() for available fonts."),je||se.noFallback||(je=gt.times[L])==null&&(je=gt.times.normal),je},kt=m.__private__.putInfo=function(){var g=Ln(),L=function(me){return me};for(var se in f!==null&&(L=Dr.encryptor(g,0)),ie("<<"),ie("/Producer ("+Cr(L("jsPDF "+Pt.version))+")"),pe)pe.hasOwnProperty(se)&&pe[se]&&ie("/"+se.substr(0,1).toUpperCase()+se.substr(1)+" ("+Cr(L(pe[se]))+")");ie("/CreationDate ("+Cr(L(ne))+")"),ie(">>"),ie("endobj")},Lt=m.__private__.putCatalog=function(g){var L=(g=g||{}).rootDictionaryObjId||os;switch(Ln(),ie("<<"),ie("/Type /Catalog"),ie("/Pages "+L+" 0 R"),st||(st="fullwidth"),st){case"fullwidth":ie("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ie("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ie("/OpenAction [3 0 R /Fit]");break;case"original":ie("/OpenAction [3 0 R /XYZ null null 1]");break;default:var se=""+st;se.substr(se.length-1)==="%"&&(st=parseInt(st)/100),typeof st=="number"&&ie("/OpenAction [3 0 R /XYZ null null "+te(st)+"]")}switch(Ne||(Ne="continuous"),Ne){case"continuous":ie("/PageLayout /OneColumn");break;case"single":ie("/PageLayout /SinglePage");break;case"two":case"twoleft":ie("/PageLayout /TwoColumnLeft");break;case"tworight":ie("/PageLayout /TwoColumnRight")}Re&&ie("/PageMode /"+Re),yt.publish("putCatalog"),ie(">>"),ie("endobj")},Wt=m.__private__.putTrailer=function(){ie("trailer"),ie("<<"),ie("/Size "+(re+1)),ie("/Root "+re+" 0 R"),ie("/Info "+(re-1)+" 0 R"),f!==null&&ie("/Encrypt "+Dr.oid+" 0 R"),ie("/ID [ <"+W+"> <"+W+"> ]"),ie(">>")},Tn=m.__private__.putHeader=function(){ie("%PDF-"+N),ie("%")},Pi=m.__private__.putXRef=function(){var g="0000000000";ie("xref"),ie("0 "+(re+1)),ie("0000000000 65535 f ");for(var L=1;L<=re;L++)typeof oe[L]=="function"?ie((g+oe[L]()).slice(-10)+" 00000 n "):oe[L]!==void 0?ie((g+oe[L]).slice(-10)+" 00000 n "):ie("0000000000 00000 n ")},en=m.__private__.buildDocument=function(){tt(),Ce(fe),yt.publish("buildDocument"),Tn(),Ss(),Ms(),Gi(),f!==null&&jt(),kt(),Lt();var g=be;return Pi(),Wt(),ie("startxref"),ie(""+g),ie("%%EOF"),Ce(Le[O]),fe.join(`
`)},Yr=m.__private__.getBlob=function(g){return new Blob([dt(g)],{type:"application/pdf"})},xa=m.output=m.__private__.output=ls(function(g,L){switch(typeof(L=L||{})=="string"?L={filename:L}:L.filename=L.filename||"generated.pdf",g){case void 0:return en();case"save":m.save(L.filename);break;case"arraybuffer":return dt(en());case"blob":return Yr(en());case"bloburi":case"bloburl":if(It.URL!==void 0&&typeof It.URL.createObjectURL=="function")return It.URL&&It.URL.createObjectURL(Yr(en()))||void 0;vn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var se="",me=en();try{se=zg(me)}catch{se=zg(unescape(encodeURIComponent(me)))}return"data:application/pdf;filename="+L.filename+";base64,"+se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(It)==="[object Window]"){var je="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Oe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';L.pdfObjectUrl&&(je=L.pdfObjectUrl,Oe="");var Ke='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+je+'"'+Oe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(L)+");<\/script></body></html>",ht=It.open();return ht!==null&&ht.document.write(Ke),ht}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(It)==="[object Window]"){var St='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(L.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+L.filename+'" width="500px" height="400px" /></body></html>',Mt=It.open();if(Mt!==null){Mt.document.write(St);var Ot=this;Mt.document.documentElement.querySelector("#pdfViewer").onload=function(){Mt.document.title=L.filename,Mt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ot.output("bloburl"))}}return Mt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(It)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",L)+'"></iframe></body></html>',zn=It.open();if(zn!==null&&(zn.document.write(Xt),zn.document.title=L.filename),zn||typeof safari>"u")return zn;break;case"datauri":case"dataurl":return It.document.location.href=this.output("datauristring",L);default:return null}}),nl=function(g){return Array.isArray(fn)===!0&&fn.indexOf(g)>-1};switch(r){case"pt":ye=1;break;case"mm":ye=72/25.4;break;case"cm":ye=72/2.54;break;case"in":ye=72;break;case"px":ye=nl("px_scaling")==1?.75:96/72;break;case"pc":case"em":ye=12;break;case"ex":ye=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);ye=r}var Dr=null;de(),P();var cm=function(g){return f!==null?Dr.encryptor(g,0):function(L){return L}},bd=m.__private__.getPageInfo=m.getPageInfo=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:rt[g].objId,pageNumber:g,pageContext:rt[g]}},Tt=m.__private__.getPageInfoByObjId=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var L in rt)if(rt[L].objId===g)break;return bd(L)},um=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:rt[O].objId,pageNumber:O,pageContext:rt[O]}};m.addPage=function(){return go.apply(this,arguments),this},m.setPage=function(){return Ie.apply(this,arguments),Ce.call(this,Le[O]),this},m.insertPage=function(g){return this.addPage(),this.movePage(O,g),this},m.movePage=function(g,L){var se,me;if(g>L){se=Le[g],me=rt[g];for(var je=g;je>L;je--)Le[je]=Le[je-1],rt[je]=rt[je-1];Le[L]=se,rt[L]=me,this.setPage(L)}else if(g<L){se=Le[g],me=rt[g];for(var Oe=g;Oe<L;Oe++)Le[Oe]=Le[Oe+1],rt[Oe]=rt[Oe+1];Le[L]=se,rt[L]=me,this.setPage(L)}return this},m.deletePage=function(){return Y.apply(this,arguments),this},m.__private__.text=m.text=function(g,L,se,me,je){var Oe,Ke,ht,St,Mt,Ot,Xt,zn,Fn,sr=(me=me||{}).scope||this;if(typeof g=="number"&&typeof L=="number"&&(typeof se=="string"||Array.isArray(se))){var Mr=se;se=L,L=g,g=Mr}if(arguments[3]instanceof Nt?(z("The transform parameter of text() with a Matrix value"),Fn=je):(ht=arguments[4],St=arguments[5],dn(Xt=arguments[3])==="object"&&Xt!==null||(typeof ht=="string"&&(St=ht,ht=null),typeof Xt=="string"&&(St=Xt,Xt=null),typeof Xt=="number"&&(ht=Xt,Xt=null),me={flags:Xt,angle:ht,align:St})),isNaN(L)||isNaN(se)||g==null)throw new Error("Invalid arguments passed to jsPDF.text");if(g.length===0)return sr;var vr="",oi=!1,_s=typeof me.lineHeightFactor=="number"?me.lineHeightFactor:xo,Li=sr.internal.scaleFactor;function Pd(yn){return yn=yn.split("	").join(Array(me.TabLen||9).join(" ")),Cr(yn,Xt)}function Oc(yn){for(var bn,Wn=yn.concat(),dr=[],Qi=Wn.length;Qi--;)typeof(bn=Wn.shift())=="string"?dr.push(bn):Array.isArray(yn)&&(bn.length===1||bn[1]===void 0&&bn[2]===void 0)?dr.push(bn[0]):dr.push([bn[0],bn[1],bn[2]]);return dr}function Dc(yn,bn){var Wn;if(typeof yn=="string")Wn=bn(yn)[0];else if(Array.isArray(yn)){for(var dr,Qi,Vc=yn.concat(),vl=[],zd=Vc.length;zd--;)typeof(dr=Vc.shift())=="string"?vl.push(bn(dr)[0]):Array.isArray(dr)&&typeof dr[0]=="string"&&(Qi=bn(dr[0],dr[1],dr[2]),vl.push([Qi[0],Qi[1],Qi[2]]));Wn=vl}return Wn}var ll=!1,Mc=!0;if(typeof g=="string")ll=!0;else if(Array.isArray(g)){var Rc=g.concat();Ke=[];for(var cl,Ar=Rc.length;Ar--;)(typeof(cl=Rc.shift())!="string"||Array.isArray(cl)&&typeof cl[0]!="string")&&(Mc=!1);ll=Mc}if(ll===!1)throw new Error('Type of text must be string or Array. "'+g+'" is not recognized.');typeof g=="string"&&(g=g.match(/[\r?\n]/)?g.split(/\r\n|\r|\n/g):[g]);var ul=Qe/sr.internal.scaleFactor,dl=ul*(_s-1);switch(me.baseline){case"bottom":se-=dl;break;case"top":se+=ul-dl;break;case"hanging":se+=ul-2*dl;break;case"middle":se+=ul/2-dl}if((Ot=me.maxWidth||0)>0&&(typeof g=="string"?g=sr.splitTextToSize(g,Ot):Object.prototype.toString.call(g)==="[object Array]"&&(g=g.reduce(function(yn,bn){return yn.concat(sr.splitTextToSize(bn,Ot))},[]))),Oe={text:g,x:L,y:se,options:me,mutex:{pdfEscape:Cr,activeFontKey:ke,fonts:it,activeFontSize:Qe}},yt.publish("preProcessText",Oe),g=Oe.text,ht=(me=Oe.options).angle,!(Fn instanceof Nt)&&ht&&typeof ht=="number"){ht*=Math.PI/180,me.rotationDirection===0&&(ht=-ht),j===b.ADVANCED&&(ht=-ht);var hl=Math.cos(ht),Fc=Math.sin(ht);Fn=new Nt(hl,Fc,-Fc,hl,0,0)}else ht&&ht instanceof Nt&&(Fn=ht);j!==b.ADVANCED||Fn||(Fn=Jr),(Mt=me.charSpace||il)!==void 0&&(vr+=Z(A(Mt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(zn=me.horizontalScale)!==void 0&&(vr+=Z(100*zn)+` Tz
`),me.lang;var cs=-1,bm=me.renderingMode!==void 0?me.renderingMode:me.stroke,$c=sr.internal.getCurrentPageInfo().pageContext;switch(bm){case 0:case!1:case"fill":cs=0;break;case 1:case!0:case"stroke":cs=1;break;case 2:case"fillThenStroke":cs=2;break;case 3:case"invisible":cs=3;break;case 4:case"fillAndAddForClipping":cs=4;break;case 5:case"strokeAndAddPathForClipping":cs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":cs=6;break;case 7:case"addToPathForClipping":cs=7}var Id=$c.usedRenderingMode!==void 0?$c.usedRenderingMode:-1;cs!==-1?vr+=cs+` Tr
`:Id!==-1&&(vr+=`0 Tr
`),cs!==-1&&($c.usedRenderingMode=cs),St=me.align||"left";var Rs,fl=Qe*_s,Ed=sr.internal.pageSize.getWidth(),Ld=it[ke];Mt=me.charSpace||il,Ot=me.maxWidth||0,Xt=Object.assign({autoencode:!0,noBOM:!0},me.flags);var Na=[],wo=function(yn){return sr.getStringUnitWidth(yn,{font:Ld,charSpace:Mt,fontSize:Qe,doKerning:!1})*Qe/Li};if(Object.prototype.toString.call(g)==="[object Array]"){var us;Ke=Oc(g),St!=="left"&&(Rs=Ke.map(wo));var Qr,ja=0;if(St==="right"){L-=Rs[0],g=[],Ar=Ke.length;for(var Ji=0;Ji<Ar;Ji++)Ji===0?(Qr=Ei(L),us=Zi(se)):(Qr=A(ja-Rs[Ji]),us=-fl),g.push([Ke[Ji],Qr,us]),ja=Rs[Ji]}else if(St==="center"){L-=Rs[0]/2,g=[],Ar=Ke.length;for(var Ki=0;Ki<Ar;Ki++)Ki===0?(Qr=Ei(L),us=Zi(se)):(Qr=A((ja-Rs[Ki])/2),us=-fl),g.push([Ke[Ki],Qr,us]),ja=Rs[Ki]}else if(St==="left"){g=[],Ar=Ke.length;for(var ml=0;ml<Ar;ml++)g.push(Ke[ml])}else if(St==="justify"&&Ld.encoding==="Identity-H"){g=[],Ar=Ke.length,Ot=Ot!==0?Ot:Ed;for(var Yi=0,Gn=0;Gn<Ar;Gn++)if(us=Gn===0?Zi(se):-fl,Qr=Gn===0?Ei(L):Yi,Gn<Ar-1){var Bc=A((Ot-Rs[Gn])/(Ke[Gn].split(" ").length-1)),Xr=Ke[Gn].split(" ");g.push([Xr[0]+" ",Qr,us]),Yi=0;for(var Fs=1;Fs<Xr.length;Fs++){var pl=(wo(Xr[Fs-1]+" "+Xr[Fs])-wo(Xr[Fs]))*Li+Bc;Fs==Xr.length-1?g.push([Xr[Fs],pl,0]):g.push([Xr[Fs]+" ",pl,0]),Yi-=pl}}else g.push([Ke[Gn],Qr,us]);g.push(["",Yi,0])}else{if(St!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(g=[],Ar=Ke.length,Ot=Ot!==0?Ot:Ed,Gn=0;Gn<Ar;Gn++)us=Gn===0?Zi(se):-fl,Qr=Gn===0?Ei(L):0,Gn<Ar-1?Na.push(Z(A((Ot-Rs[Gn])/(Ke[Gn].split(" ").length-1)))):Na.push(0),g.push([Ke[Gn],Qr,us])}}var Td=typeof me.R2L=="boolean"?me.R2L:Ae;Td===!0&&(g=Dc(g,function(yn,bn,Wn){return[yn.split("").reverse().join(""),bn,Wn]})),Oe={text:g,x:L,y:se,options:me,mutex:{pdfEscape:Cr,activeFontKey:ke,fonts:it,activeFontSize:Qe}},yt.publish("postProcessText",Oe),g=Oe.text,oi=Oe.mutex.isHex||!1;var qc=it[ke].encoding;qc!=="WinAnsiEncoding"&&qc!=="StandardEncoding"||(g=Dc(g,function(yn,bn,Wn){return[Pd(yn),bn,Wn]})),Ke=Oc(g),g=[];for(var No,jo,Sa,So=0,gl=1,_o=Array.isArray(Ke[0])?gl:So,_a="",Uc=function(yn,bn,Wn){var dr="";return Wn instanceof Nt?(Wn=typeof me.angle=="number"?rr(Wn,new Nt(1,0,0,1,yn,bn)):rr(new Nt(1,0,0,1,yn,bn),Wn),j===b.ADVANCED&&(Wn=rr(new Nt(1,0,0,-1,0,0),Wn)),dr=Wn.join(" ")+` Tm
`):dr=Z(yn)+" "+Z(bn)+` Td
`,dr},$s=0;$s<Ke.length;$s++){switch(_a="",_o){case gl:Sa=(oi?"<":"(")+Ke[$s][0]+(oi?">":")"),No=parseFloat(Ke[$s][1]),jo=parseFloat(Ke[$s][2]);break;case So:Sa=(oi?"<":"(")+Ke[$s]+(oi?">":")"),No=Ei(L),jo=Zi(se)}Na!==void 0&&Na[$s]!==void 0&&(_a=Na[$s]+` Tw
`),$s===0?g.push(_a+Uc(No,jo,Fn)+Sa):_o===So?g.push(_a+Sa):_o===gl&&g.push(_a+Uc(No,jo,Fn)+Sa)}g=_o===So?g.join(` Tj
T* `):g.join(` Tj
`),g+=` Tj
`;var Bs=`BT
/`;return Bs+=ke+" "+Qe+` Tf
`,Bs+=Z(Qe*_s)+` TL
`,Bs+=yo+`
`,Bs+=vr,Bs+=g,ie(Bs+="ET"),v[ke]=!0,sr};var dm=m.__private__.clip=m.clip=function(g){return ie(g==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return dm("evenodd")},m.__private__.discardPath=m.discardPath=function(){return ie("n"),this};var Ii=m.__private__.isValidStyle=function(g){var L=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(g)!==-1&&(L=!0),L};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(g){return Ii(g)&&(d=g),this};var wd=m.__private__.getStyle=m.getStyle=function(g){var L=d;switch(g){case"D":case"S":L="S";break;case"F":L="f";break;case"FD":case"DF":L="B";break;case"f":case"f*":case"B":case"B*":L=g}return L},Nd=m.close=function(){return ie("h"),this};m.stroke=function(){return ie("S"),this},m.fill=function(g){return rl("f",g),this},m.fillEvenOdd=function(g){return rl("f*",g),this},m.fillStroke=function(g){return rl("B",g),this},m.fillStrokeEvenOdd=function(g){return rl("B*",g),this};var rl=function(g,L){dn(L)==="object"?fm(L,g):ie(g)},_c=function(g){g===null||j===b.ADVANCED&&g===void 0||(g=wd(g),ie(g))};function hm(g,L,se,me,je){var Oe=new Yl(L||this.boundingBox,se||this.xStep,me||this.yStep,this.gState,je||this.matrix);Oe.stream=this.stream;var Ke=g+"$$"+this.cloneIndex+++"$$";return cr(Ke,Oe),Oe}var fm=function(g,L){var se=Yt[g.key],me=vt[se];if(me instanceof zo)ie("q"),ie(mm(L)),me.gState&&m.setGState(me.gState),ie(g.matrix.toString()+" cm"),ie("/"+se+" sh"),ie("Q");else if(me instanceof Yl){var je=new Nt(1,0,0,-1,0,wa());g.matrix&&(je=je.multiply(g.matrix||Jr),se=hm.call(me,g.key,g.boundingBox,g.xStep,g.yStep,je).id),ie("q"),ie("/Pattern cs"),ie("/"+se+" scn"),me.gState&&m.setGState(me.gState),ie(L),ie("Q")}},mm=function(g){switch(g){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},kc=m.moveTo=function(g,L){return ie(Z(A(g))+" "+Z(F(L))+" m"),this},vo=m.lineTo=function(g,L){return ie(Z(A(g))+" "+Z(F(L))+" l"),this},ya=m.curveTo=function(g,L,se,me,je,Oe){return ie([Z(A(g)),Z(F(L)),Z(A(se)),Z(F(me)),Z(A(je)),Z(F(Oe)),"c"].join(" ")),this};m.__private__.line=m.line=function(g,L,se,me,je){if(isNaN(g)||isNaN(L)||isNaN(se)||isNaN(me)||!Ii(je))throw new Error("Invalid arguments passed to jsPDF.line");return j===b.COMPAT?this.lines([[se-g,me-L]],g,L,[1,1],je||"S"):this.lines([[se-g,me-L]],g,L,[1,1]).stroke()},m.__private__.lines=m.lines=function(g,L,se,me,je,Oe){var Ke,ht,St,Mt,Ot,Xt,zn,Fn,sr,Mr,vr,oi;if(typeof g=="number"&&(oi=se,se=L,L=g,g=oi),me=me||[1,1],Oe=Oe||!1,isNaN(L)||isNaN(se)||!Array.isArray(g)||!Array.isArray(me)||!Ii(je)||typeof Oe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(kc(L,se),Ke=me[0],ht=me[1],Mt=g.length,Mr=L,vr=se,St=0;St<Mt;St++)(Ot=g[St]).length===2?(Mr=Ot[0]*Ke+Mr,vr=Ot[1]*ht+vr,vo(Mr,vr)):(Xt=Ot[0]*Ke+Mr,zn=Ot[1]*ht+vr,Fn=Ot[2]*Ke+Mr,sr=Ot[3]*ht+vr,Mr=Ot[4]*Ke+Mr,vr=Ot[5]*ht+vr,ya(Xt,zn,Fn,sr,Mr,vr));return Oe&&Nd(),_c(je),this},m.path=function(g){for(var L=0;L<g.length;L++){var se=g[L],me=se.c;switch(se.op){case"m":kc(me[0],me[1]);break;case"l":vo(me[0],me[1]);break;case"c":ya.apply(this,me);break;case"h":Nd()}}return this},m.__private__.rect=m.rect=function(g,L,se,me,je){if(isNaN(g)||isNaN(L)||isNaN(se)||isNaN(me)||!Ii(je))throw new Error("Invalid arguments passed to jsPDF.rect");return j===b.COMPAT&&(me=-me),ie([Z(A(g)),Z(F(L)),Z(A(se)),Z(A(me)),"re"].join(" ")),_c(je),this},m.__private__.triangle=m.triangle=function(g,L,se,me,je,Oe,Ke){if(isNaN(g)||isNaN(L)||isNaN(se)||isNaN(me)||isNaN(je)||isNaN(Oe)||!Ii(Ke))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[se-g,me-L],[je-se,Oe-me],[g-je,L-Oe]],g,L,[1,1],Ke,!0),this},m.__private__.roundedRect=m.roundedRect=function(g,L,se,me,je,Oe,Ke){if(isNaN(g)||isNaN(L)||isNaN(se)||isNaN(me)||isNaN(je)||isNaN(Oe)||!Ii(Ke))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ht=4/3*(Math.SQRT2-1);return je=Math.min(je,.5*se),Oe=Math.min(Oe,.5*me),this.lines([[se-2*je,0],[je*ht,0,je,Oe-Oe*ht,je,Oe],[0,me-2*Oe],[0,Oe*ht,-je*ht,Oe,-je,Oe],[2*je-se,0],[-je*ht,0,-je,-Oe*ht,-je,-Oe],[0,2*Oe-me],[0,-Oe*ht,je*ht,-Oe,je,-Oe]],g+je,L,[1,1],Ke,!0),this},m.__private__.ellipse=m.ellipse=function(g,L,se,me,je){if(isNaN(g)||isNaN(L)||isNaN(se)||isNaN(me)||!Ii(je))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Oe=4/3*(Math.SQRT2-1)*se,Ke=4/3*(Math.SQRT2-1)*me;return kc(g+se,L),ya(g+se,L-Ke,g+Oe,L-me,g,L-me),ya(g-Oe,L-me,g-se,L-Ke,g-se,L),ya(g-se,L+Ke,g-Oe,L+me,g,L+me),ya(g+Oe,L+me,g+se,L+Ke,g+se,L),_c(je),this},m.__private__.circle=m.circle=function(g,L,se,me){if(isNaN(g)||isNaN(L)||isNaN(se)||!Ii(me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(g,L,se,se,me)},m.setFont=function(g,L,se){return se&&(L=K(L,se)),ke=zt(g,L,{disableWarning:!1}),this};var pm=m.__private__.getFont=m.getFont=function(){return it[zt.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var g,L,se={};for(g in gt)if(gt.hasOwnProperty(g))for(L in se[g]=[],gt[g])gt[g].hasOwnProperty(L)&&se[g].push(L);return se},m.addFont=function(g,L,se,me,je){var Oe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Oe.indexOf(arguments[3])!==-1?je=arguments[3]:arguments[3]&&Oe.indexOf(arguments[3])==-1&&(se=K(se,me)),je=je||"Identity-H",ii.call(this,g,L,se,je)};var xo,Cc=t.lineWidth||.200025,sl=m.__private__.getLineWidth=m.getLineWidth=function(){return Cc},jd=m.__private__.setLineWidth=m.setLineWidth=function(g){return Cc=g,ie(Z(A(g))+" w"),this};m.__private__.setLineDash=Pt.API.setLineDash=Pt.API.setLineDashPattern=function(g,L){if(g=g||[],L=L||0,isNaN(L)||!Array.isArray(g))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return g=g.map(function(se){return Z(A(se))}).join(" "),L=Z(A(L)),ie("["+g+"] "+L+" d"),this};var Sd=m.__private__.getLineHeight=m.getLineHeight=function(){return Qe*xo};m.__private__.getLineHeight=m.getLineHeight=function(){return Qe*xo};var _d=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(g){return typeof(g=g||1.15)=="number"&&(xo=g),this},kd=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return xo};_d(t.lineHeight);var Ei=m.__private__.getHorizontalCoordinate=function(g){return A(g)},Zi=m.__private__.getVerticalCoordinate=function(g){return j===b.ADVANCED?g:rt[O].mediaBox.topRightY-rt[O].mediaBox.bottomLeftY-A(g)},gm=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(g){return Z(Ei(g))},ba=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(g){return Z(Zi(g))},ai=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Pn(ai)},m.__private__.setStrokeColor=m.setDrawColor=function(g,L,se,me){return ai=kr({ch1:g,ch2:L,ch3:se,ch4:me,pdfColorType:"draw",precision:2}),ie(ai),this};var Ac=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Pn(Ac)},m.__private__.setFillColor=m.setFillColor=function(g,L,se,me){return Ac=kr({ch1:g,ch2:L,ch3:se,ch4:me,pdfColorType:"fill",precision:2}),ie(Ac),this};var yo=t.textColor||"0 g",vm=m.__private__.getTextColor=m.getTextColor=function(){return Pn(yo)};m.__private__.setTextColor=m.setTextColor=function(g,L,se,me){return yo=kr({ch1:g,ch2:L,ch3:se,ch4:me,pdfColorType:"text",precision:3}),this};var il=t.charSpace,xm=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(il||0)};m.__private__.setCharSpace=m.setCharSpace=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return il=g,this};var Pc=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(g){var L=m.CapJoinStyles[g];if(L===void 0)throw new Error("Line cap style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Pc=L,ie(L+" J"),this};var Ic=0;m.__private__.setLineJoin=m.setLineJoin=function(g){var L=m.CapJoinStyles[g];if(L===void 0)throw new Error("Line join style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ic=L,ie(L+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(g){if(g=g||0,isNaN(g))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ie(Z(A(g))+" M"),this},m.GState=Pf,m.setGState=function(g){(g=typeof g=="string"?Bt[wt[g]]:Cd(null,g)).equals(Qt)||(ie("/"+g.id+" gs"),Qt=g)};var Cd=function(g,L){if(!g||!wt[g]){var se=!1;for(var me in Bt)if(Bt.hasOwnProperty(me)&&Bt[me].equals(L)){se=!0;break}if(se)L=Bt[me];else{var je="GS"+(Object.keys(Bt).length+1).toString(10);Bt[je]=L,L.id=je}return g&&(wt[g]=L.id),yt.publish("addGState",L),L}};m.addGState=function(g,L){return Cd(g,L),this},m.saveGraphicsState=function(){return ie("q"),Vt.push({key:ke,size:Qe,color:yo}),this},m.restoreGraphicsState=function(){ie("Q");var g=Vt.pop();return ke=g.key,Qe=g.size,yo=g.color,Qt=null,this},m.setCurrentTransformationMatrix=function(g){return ie(g.toString()+" cm"),this},m.comment=function(g){return ie("#"+g),this};var al=function(g,L){var se=g||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return se},set:function(Oe){isNaN(Oe)||(se=parseFloat(Oe))}});var me=L||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return me},set:function(Oe){isNaN(Oe)||(me=parseFloat(Oe))}});var je="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return je},set:function(Oe){je=Oe.toString()}}),this},Ec=function(g,L,se,me){al.call(this,g,L),this.type="rect";var je=se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return je},set:function(Ke){isNaN(Ke)||(je=parseFloat(Ke))}});var Oe=me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Oe},set:function(Ke){isNaN(Ke)||(Oe=parseFloat(Ke))}}),this},Lc=function(){this.page=Et,this.currentPage=O,this.pages=Le.slice(0),this.pagesContext=rt.slice(0),this.x=Ze,this.y=Be,this.matrix=ut,this.width=bo(O),this.height=wa(O),this.outputDestination=Me,this.id="",this.objectNumber=-1};Lc.prototype.restore=function(){Et=this.page,O=this.currentPage,rt=this.pagesContext,Le=this.pages,Ze=this.x,Be=this.y,ut=this.matrix,Tc(O,this.width),zc(O,this.height),Me=this.outputDestination};var Ad=function(g,L,se,me,je){Sr.push(new Lc),Et=O=0,Le=[],Ze=g,Be=L,ut=je,va([se,me])},ym=function(g){if(nr[g])Sr.pop().restore();else{var L=new Lc,se="Xo"+(Object.keys(Ht).length+1).toString(10);L.id=se,nr[g]=se,Ht[se]=L,yt.publish("addFormObject",L),Sr.pop().restore()}};for(var ol in m.beginFormObject=function(g,L,se,me,je){return Ad(g,L,se,me,je),this},m.endFormObject=function(g){return ym(g),this},m.doFormObject=function(g,L){var se=Ht[nr[g]];return ie("q"),ie(L.toString()+" cm"),ie("/"+se.id+" Do"),ie("Q"),this},m.getFormObject=function(g){var L=Ht[nr[g]];return{x:L.x,y:L.y,width:L.width,height:L.height,matrix:L.matrix}},m.save=function(g,L){return g=g||"generated.pdf",(L=L||{}).returnPromise=L.returnPromise||!1,L.returnPromise===!1?(Lo(Yr(en()),g),typeof Lo.unload=="function"&&It.setTimeout&&setTimeout(Lo.unload,911),this):new Promise(function(se,me){try{var je=Lo(Yr(en()),g);typeof Lo.unload=="function"&&It.setTimeout&&setTimeout(Lo.unload,911),se(je)}catch(Oe){me(Oe.message)}})},Pt.API)Pt.API.hasOwnProperty(ol)&&(ol==="events"&&Pt.API.events.length?function(g,L){var se,me,je;for(je=L.length-1;je!==-1;je--)se=L[je][0],me=L[je][1],g.subscribe.apply(g,[se].concat(typeof me=="function"?[me]:me))}(yt,Pt.API.events):m[ol]=Pt.API[ol]);var bo=m.getPageWidth=function(g){return(rt[g=g||O].mediaBox.topRightX-rt[g].mediaBox.bottomLeftX)/ye},Tc=m.setPageWidth=function(g,L){rt[g].mediaBox.topRightX=L*ye+rt[g].mediaBox.bottomLeftX},wa=m.getPageHeight=function(g){return(rt[g=g||O].mediaBox.topRightY-rt[g].mediaBox.bottomLeftY)/ye},zc=m.setPageHeight=function(g,L){rt[g].mediaBox.topRightY=L*ye+rt[g].mediaBox.bottomLeftY};return m.internal={pdfEscape:Cr,getStyle:wd,getFont:pm,getFontSize:ae,getCharSpace:xm,getTextColor:vm,getLineHeight:Sd,getLineHeightFactor:kd,getLineWidth:sl,write:pt,getHorizontalCoordinate:Ei,getVerticalCoordinate:Zi,getCoordinateString:gm,getVerticalCoordinateString:ba,collections:{},newObject:Ln,newAdditionalObject:_i,newObjectDeferred:xn,newObjectDeferredBegin:_r,getFilters:ur,putStream:Or,events:yt,scaleFactor:ye,pageSize:{getWidth:function(){return bo(O)},setWidth:function(g){Tc(O,g)},getHeight:function(){return wa(O)},setHeight:function(g){zc(O,g)}},encryptionOptions:f,encryption:Dr,getEncryptor:cm,output:xa,getNumberOfPages:Ye,pages:Le,out:ie,f2:te,f3:I,getPageInfo:bd,getPageInfoByObjId:Tt,getCurrentPageInfo:um,getPDFVersion:_,Point:al,Rectangle:Ec,Matrix:Nt,hasHotfix:nl},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return bo(O)},set:function(g){Tc(O,g)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return wa(O)},set:function(g){zc(O,g)},enumerable:!0,configurable:!0}),tl.call(m,Ge),ke="F1",go(i,n),yt.publish("initialized"),m}zl.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},zl.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},zl.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},zl.prototype.processOwnerPassword=function(t,e){return Dg(Og(e).substr(0,5),t)},zl.prototype.encryptor=function(t,e){var n=Og(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Dg(n,r)}},Pf.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||dn(t)!==dn(this))return!1;var r=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;r++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&r--;return r===0},Pt.API={events:[]},Pt.version="3.0.1";var qn=Pt.API,a1=1,Xo=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jl=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Dt=function(t){return t.toFixed(2)},Oa=function(t){return t.toFixed(5)};qn.__acroform__={};var js=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},zx=function(t){return t*a1},Mi=function(t){var e=new Sb,n=xt.internal.getHeight(t)||0,r=xt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Dt(r)),Number(Dt(n))],e},sC=qn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},iC=qn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},aC=qn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Yn=qn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return aC(t,e-1)},Qn=qn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return sC(t,e-1)},Xn=qn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return iC(t,e-1)},oC=qn.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i=t[0],a=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=n(i)||0,c.lowerLeft_Y=r(a+l)||0,c.upperRight_X=n(i+o)||0,c.upperRight_Y=r(a)||0,[Number(Dt(c.lowerLeft_X)),Number(Dt(c.lowerLeft_Y)),Number(Dt(c.upperRight_X)),Number(Dt(c.upperRight_Y))]},lC=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,r=Mg(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+Dt(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=Mi(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},Mg=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,r={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(I){return I.split(`
`)}):i.map(function(I){return[I]});var a=n,o=xt.internal.getHeight(t)||0;o=o<0?-o:o;var l=xt.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(I,A,T){if(I+1<i.length){var F=A+" "+i[I+1][0];return _h(F,t,T).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var d,f,p=_h("3",t,a).height,v=t.multiline?o-a:(o-p)/2,m=v+=2,N=0,_=0,k=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+_h(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var y="",b=0,j=0;j<i.length;j++)if(i.hasOwnProperty(j)){var C=!1;if(i[j].length!==1&&k!==i[j].length-1){if((p+2)*(b+2)+2>o)continue e;y+=i[j][k],C=!0,_=j,j--}else{y=(y+=i[j][k]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var B=parseInt(j),K=c(B,y,a),Z=j>=i.length-1;if(K&&!Z){y+=" ",k=0;continue}if(K||Z){if(Z)_=B;else if(t.multiline&&(p+2)*(b+2)+2>o)continue e}else{if(!t.multiline||(p+2)*(b+2)+2>o)continue e;_=B}}for(var z="",J=N;J<=_;J++){var te=i[J];if(t.multiline){if(J===_){z+=te[k]+" ",k=(k+1)%te.length;continue}if(J===N){z+=te[te.length-1]+" ";continue}}z+=te[0]+" "}switch(z=z.substr(z.length-1)==" "?z.substr(0,z.length-1):z,f=_h(z,t,a).width,t.textAlign){case"right":d=l-f-2;break;case"center":d=(l-f)/2;break;case"left":default:d=2}e+=Dt(d)+" "+Dt(m)+` Td
`,e+="("+Xo(z)+`) Tj
`,e+=-Dt(d)+` 0 Td
`,m=-(a+2),f=0,N=C?_:_+1,b++,y=""}break}return r.text=e,r.fontSize=a,r},_h=function(t,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},cC={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},uC=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},dC=function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var r=n,i=t[n];e.internal.newObjectDeferredBegin(i.objId,!0),dn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[r]}},hC=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(ji.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(cC)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");a1=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new _b,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var a=r[i];a.objId=void 0,a.hasAnnotation&&uC(a,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(r,i){var a=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var l=r[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=oC(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=xt.createDefaultAppearanceStream(l),dn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=lC(l);c.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var p="";for(var v in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(v)){var m=l.appearanceStreamContent[v];if(p+="/"+v+" ",p+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var N=m[o];typeof N=="function"&&(N=N.call(i,l)),p+="/"+o+" "+N+" ",i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N)}}else typeof(N=m)=="function"&&(N=N.call(i,l)),p+="/"+o+" "+N,i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}a&&dC(i.internal.acroformPlugin.xForms,i)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},jb=qn.__acroform__.arrayToPdfArray=function(t,e,n){var r=function(o){return o};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),dn(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&n&&(r=n.internal.getEncryptor(e)),i+="("+Xo(r(t[a].toString()))+")"):i+=t[a].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},xp=function(t,e,n){var r=function(i){return i};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Xo(r(t))+")"},Bi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Bi.prototype.toString=function(){return this.objId+" 0 R"},Bi.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Bi.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],i=this[r];i&&(Array.isArray(i)?t.push({key:r,value:jb(i,this.objId,this.scope)}):i instanceof Bi?(i.scope=this.scope,t.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:r,value:i}))}return t};var Sb=function(){Bi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};js(Sb,Bi);var _b=function(){Bi.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Xo(n(t))+")"}},set:function(n){t=n}})};js(_b,Bi);var ji=function t(){Bi.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');e=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Yn(e,3)},set:function(y){y?this.F=Qn(e,3):this.F=Xn(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');n=y}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(y){r=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(y){r[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(y){r[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(y){r[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(y){r[3]=y}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof If)return;a="FieldObject"+t.FieldNum++}var y=function(b){return b};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+Xo(y(a))+")"},set:function(y){a=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(y){a=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/a1:d},set:function(y){d=y}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(y){f=y}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof If||this instanceof Bo))return xp(p,this.objId,this.scope)},set:function(y){y=y.toString(),p=y}});var v=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof Nr?v:xp(v,this.objId,this.scope)},set:function(y){y=y.toString(),v=this instanceof Nr?y:y.substr(0,1)==="("?jl(y.substr(1,y.length-2)):jl(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Nr?jl(v.substr(1,v.length-1)):v},set:function(y){y=y.toString(),v=this instanceof Nr?"/"+y:y}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Nr?m:xp(m,this.objId,this.scope)},set:function(y){y=y.toString(),m=this instanceof Nr?y:y.substr(0,1)==="("?jl(y.substr(1,y.length-2)):jl(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Nr?jl(m.substr(1,m.length-1)):m},set:function(y){y=y.toString(),m=this instanceof Nr?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var N,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(y){y=!!y,_=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(N)return N},set:function(y){N=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,1)},set:function(y){y?this.Ff=Qn(this.Ff,1):this.Ff=Xn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,2)},set:function(y){y?this.Ff=Qn(this.Ff,2):this.Ff=Xn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,3)},set:function(y){y?this.Ff=Qn(this.Ff,3):this.Ff=Xn(this.Ff,3)}});var k=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(k!==null)return k},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');k=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(k){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:k=2;break;case"center":case 1:k=1;break;case"left":case 0:default:k=0}}})};js(ji,Bi);var ac=function(){ji.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return jb(e,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=function(a,o,l){l||(l=1);for(var c,d=[];c=o.exec(a);)d.push(c[l]);return d}(r,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,18)},set:function(n){n?this.Ff=Qn(this.Ff,18):this.Ff=Xn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Qn(this.Ff,19):this.Ff=Xn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,20)},set:function(n){n?(this.Ff=Qn(this.Ff,20),e.sort()):this.Ff=Xn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,22)},set:function(n){n?this.Ff=Qn(this.Ff,22):this.Ff=Xn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,23)},set:function(n){n?this.Ff=Qn(this.Ff,23):this.Ff=Xn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,27)},set:function(n){n?this.Ff=Qn(this.Ff,27):this.Ff=Xn(this.Ff,27)}}),this.hasAppearanceStream=!1};js(ac,ji);var oc=function(){ac.call(this),this.fontName="helvetica",this.combo=!1};js(oc,ac);var lc=function(){oc.call(this),this.combo=!0};js(lc,oc);var Wh=function(){lc.call(this),this.edit=!0};js(Wh,lc);var Nr=function(){ji.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,15)},set:function(n){n?this.Ff=Qn(this.Ff,15):this.Ff=Xn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,16)},set:function(n){n?this.Ff=Qn(this.Ff,16):this.Ff=Xn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,17)},set:function(n){n?this.Ff=Qn(this.Ff,17):this.Ff=Xn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,26)},set:function(n){n?this.Ff=Qn(this.Ff,26):this.Ff=Xn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,i=[];for(r in i.push("<<"),e)i.push("/"+r+" ("+Xo(n(e[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){dn(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};js(Nr,ji);var Zh=function(){Nr.call(this),this.pushButton=!0};js(Zh,Nr);var cc=function(){Nr.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};js(cc,Nr);var If=function(){var t,e;ji.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),r)o.push("/"+a+" ("+Xo(i(r[a]))+")");return o.push(">>"),o.join(`
`)},set:function(i){dn(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=xt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};js(If,ji),cc.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},cc.prototype.createOption=function(t){var e=new If;return e.Parent=this,e.optionName=t,this.Kids.push(e),fC.call(this.scope,e),e};var Jh=function(){Nr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=xt.CheckBox.createAppearanceStream()};js(Jh,Nr);var Bo=function(){ji.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,13)},set:function(e){e?this.Ff=Qn(this.Ff,13):this.Ff=Xn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,21)},set:function(e){e?this.Ff=Qn(this.Ff,21):this.Ff=Xn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,23)},set:function(e){e?this.Ff=Qn(this.Ff,23):this.Ff=Xn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,24)},set:function(e){e?this.Ff=Qn(this.Ff,24):this.Ff=Xn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,25)},set:function(e){e?this.Ff=Qn(this.Ff,25):this.Ff=Xn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,26)},set:function(e){e?this.Ff=Qn(this.Ff,26):this.Ff=Xn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};js(Bo,ji);var Kh=function(){Bo.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Yn(this.Ff,14)},set:function(t){t?this.Ff=Qn(this.Ff,14):this.Ff=Xn(this.Ff,14)}}),this.password=!0};js(Kh,Bo);var xt={CheckBox:{createAppearanceStream:function(){return{N:{On:xt.CheckBox.YesNormal},D:{On:xt.CheckBox.YesPushDown,Off:xt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Mi(t);e.scope=t.scope;var n=[],r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=Mg(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+Dt(xt.internal.getWidth(t))+" "+Dt(xt.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+Dt(a.fontSize)+" Tf "+i),n.push("BT"),n.push(a.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=Mi(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),i=[],a=xt.internal.getHeight(t),o=xt.internal.getWidth(t),l=Mg(t,t.caption);return i.push("1 g"),i.push("0 0 "+Dt(o)+" "+Dt(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Dt(o-1)+" "+Dt(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+Dt(l.fontSize)+" Tf "+r),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Mi(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Dt(xt.internal.getWidth(t))+" "+Dt(xt.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:xt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=xt.RadioButton.Circle.YesNormal,e.D[t]=xt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Mi(t);e.scope=t.scope;var n=[],r=xt.internal.getWidth(t)<=xt.internal.getHeight(t)?xt.internal.getWidth(t)/4:xt.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=xt.internal.Bezier_C,a=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Oa(xt.internal.getWidth(t)/2)+" "+Oa(xt.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),n.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),n.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),n.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Mi(t);e.scope=t.scope;var n=[],r=xt.internal.getWidth(t)<=xt.internal.getHeight(t)?xt.internal.getWidth(t)/4:xt.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),a=Number((i*xt.internal.Bezier_C).toFixed(5)),o=Number((r*xt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Oa(xt.internal.getWidth(t)/2)+" "+Oa(xt.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Oa(xt.internal.getWidth(t)/2)+" "+Oa(xt.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Mi(t);e.scope=t.scope;var n=[],r=xt.internal.getWidth(t)<=xt.internal.getHeight(t)?xt.internal.getWidth(t)/4:xt.internal.getHeight(t)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),a=Number((i*xt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Oa(xt.internal.getWidth(t)/2)+" "+Oa(xt.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:xt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=xt.RadioButton.Cross.YesNormal,e.D[t]=xt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Mi(t);e.scope=t.scope;var n=[],r=xt.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+Dt(xt.internal.getWidth(t)-2)+" "+Dt(xt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Dt(r.x1.x)+" "+Dt(r.x1.y)+" m"),n.push(Dt(r.x2.x)+" "+Dt(r.x2.y)+" l"),n.push(Dt(r.x4.x)+" "+Dt(r.x4.y)+" m"),n.push(Dt(r.x3.x)+" "+Dt(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Mi(t);e.scope=t.scope;var n=xt.internal.calculateCross(t),r=[];return r.push("0.749023 g"),r.push("0 0 "+Dt(xt.internal.getWidth(t))+" "+Dt(xt.internal.getHeight(t))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Dt(xt.internal.getWidth(t)-2)+" "+Dt(xt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Dt(n.x1.x)+" "+Dt(n.x1.y)+" m"),r.push(Dt(n.x2.x)+" "+Dt(n.x2.y)+" l"),r.push(Dt(n.x4.x)+" "+Dt(n.x4.y)+" m"),r.push(Dt(n.x3.x)+" "+Dt(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Mi(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Dt(xt.internal.getWidth(t))+" "+Dt(xt.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};xt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=xt.internal.getWidth(t),n=xt.internal.getHeight(t),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},xt.internal.getWidth=function(t){var e=0;return dn(t)==="object"&&(e=zx(t.Rect[2])),e},xt.internal.getHeight=function(t){var e=0;return dn(t)==="object"&&(e=zx(t.Rect[3])),e};var fC=qn.addField=function(t){if(hC(this,t),!(t instanceof ji))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};qn.AcroFormChoiceField=ac,qn.AcroFormListBox=oc,qn.AcroFormComboBox=lc,qn.AcroFormEditBox=Wh,qn.AcroFormButton=Nr,qn.AcroFormPushButton=Zh,qn.AcroFormRadioButton=cc,qn.AcroFormCheckBox=Jh,qn.AcroFormTextField=Bo,qn.AcroFormPasswordField=Kh,qn.AcroFormAppearance=xt,qn.AcroForm={ChoiceField:ac,ListBox:oc,ComboBox:lc,EditBox:Wh,Button:Nr,PushButton:Zh,RadioButton:cc,CheckBox:Jh,TextField:Bo,PasswordField:Kh,Appearance:xt},Pt.AcroForm={ChoiceField:ac,ListBox:oc,ComboBox:lc,EditBox:Wh,Button:Nr,PushButton:Zh,RadioButton:cc,CheckBox:Jh,TextField:Bo,PasswordField:Kh,Appearance:xt};function kb(t){return t.reduce(function(e,n,r){return e[n]=r,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.__addimage__.getImageFileTypeByImageData=function(I,A){var T,F,ne,W,ue,P=e;if((A=A||e)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(K(I))for(ue in n)for(ne=n[ue],T=0;T<ne.length;T+=1){for(W=!0,F=0;F<ne[T].length;F+=1)if(ne[T][F]!==void 0&&ne[T][F]!==I[F]){W=!1;break}if(W===!0){P=ue;break}}else for(ue in n)for(ne=n[ue],T=0;T<ne.length;T+=1){for(W=!0,F=0;F<ne[T].length;F+=1)if(ne[T][F]!==void 0&&ne[T][F]!==I.charCodeAt(F)){W=!1;break}if(W===!0){P=ue;break}}return P===e&&A!==e&&(P=A),P},i=function I(A){for(var T=this.internal.write,F=this.internal.putStream,ne=(0,this.internal.getFilters)();ne.indexOf("FlateEncode")!==-1;)ne.splice(ne.indexOf("FlateEncode"),1);A.objectId=this.internal.newObject();var W=[];if(W.push({key:"Type",value:"/XObject"}),W.push({key:"Subtype",value:"/Image"}),W.push({key:"Width",value:A.width}),W.push({key:"Height",value:A.height}),A.colorSpace===k.INDEXED?W.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(A.palette.length/3-1)+" "+("sMask"in A&&A.sMask!==void 0?A.objectId+2:A.objectId+1)+" 0 R]"}):(W.push({key:"ColorSpace",value:"/"+A.colorSpace}),A.colorSpace===k.DEVICE_CMYK&&W.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),W.push({key:"BitsPerComponent",value:A.bitsPerComponent}),"decodeParameters"in A&&A.decodeParameters!==void 0&&W.push({key:"DecodeParms",value:"<<"+A.decodeParameters+">>"}),"transparency"in A&&Array.isArray(A.transparency)){for(var ue="",P=0,Q=A.transparency.length;P<Q;P++)ue+=A.transparency[P]+" "+A.transparency[P]+" ";W.push({key:"Mask",value:"["+ue+"]"})}A.sMask!==void 0&&W.push({key:"SMask",value:A.objectId+1+" 0 R"});var G=A.filter!==void 0?["/"+A.filter]:void 0;if(F({data:A.data,additionalKeyValues:W,alreadyAppliedFilters:G,objectId:A.objectId}),T("endobj"),"sMask"in A&&A.sMask!==void 0){var de="/Predictor "+A.predictor+" /Colors 1 /BitsPerComponent "+A.bitsPerComponent+" /Columns "+A.width,w={width:A.width,height:A.height,colorSpace:"DeviceGray",bitsPerComponent:A.bitsPerComponent,decodeParameters:de,data:A.sMask};"filter"in A&&(w.filter=A.filter),I.call(this,w)}if(A.colorSpace===k.INDEXED){var O=this.internal.newObject();F({data:z(new Uint8Array(A.palette)),objectId:O}),T("endobj")}},a=function(){var I=this.internal.collections.addImage_images;for(var A in I)i.call(this,I[A])},o=function(){var I,A=this.internal.collections.addImage_images,T=this.internal.write;for(var F in A)T("/I"+(I=A[F]).index,I.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var I=this.internal.collections.addImage_images;return l.call(this),I},d=function(){return Object.keys(this.internal.collections.addImage_images).length},f=function(I){return typeof t["process"+I.toUpperCase()]=="function"},p=function(I){return dn(I)==="object"&&I.nodeType===1},v=function(I,A){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var T=""+I.getAttribute("src");if(T.indexOf("data:image/")===0)return Eu(unescape(T).split("base64,").pop());var F=t.loadFile(T,!0);if(F!==void 0)return F}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var ne;switch(A){case"PNG":ne="image/png";break;case"WEBP":ne="image/webp";break;case"JPEG":case"JPG":default:ne="image/jpeg"}return Eu(I.toDataURL(ne,1).split("base64,").pop())}},m=function(I){var A=this.internal.collections.addImage_images;if(A){for(var T in A)if(I===A[T].alias)return A[T]}},N=function(I,A,T){return I||A||(I=-96,A=-96),I<0&&(I=-1*T.width*72/I/this.internal.scaleFactor),A<0&&(A=-1*T.height*72/A/this.internal.scaleFactor),I===0&&(I=A*T.width/T.height),A===0&&(A=I*T.height/T.width),[I,A]},_=function(I,A,T,F,ne,W){var ue=N.call(this,T,F,ne),P=this.internal.getCoordinateString,Q=this.internal.getVerticalCoordinateString,G=c.call(this);if(T=ue[0],F=ue[1],G[ne.index]=ne,W){W*=Math.PI/180;var de=Math.cos(W),w=Math.sin(W),O=function(H){return H.toFixed(4)},R=[O(de),O(w),O(-1*w),O(de),0,0,"cm"]}this.internal.write("q"),W?(this.internal.write([1,"0","0",1,P(I),Q(A+F),"cm"].join(" ")),this.internal.write(R.join(" ")),this.internal.write([P(T),"0","0",P(F),"0","0","cm"].join(" "))):this.internal.write([P(T),"0","0",P(F),P(I),Q(A+F),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ne.index+" Do"),this.internal.write("Q")},k=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(I){var A,T,F=0;if(typeof I=="string")for(T=I.length,A=0;A<T;A++)F=(F<<5)-F+I.charCodeAt(A),F|=0;else if(K(I))for(T=I.byteLength/2,A=0;A<T;A++)F=(F<<5)-F+I[A],F|=0;return F},j=t.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var A=!0;return I.length===0&&(A=!1),I.length%4!=0&&(A=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(A=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(A=!1),A},C=t.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var A=I.indexOf(",");return A<0?null:I.substring(0,A).trim().endsWith("base64")?I.substring(A+1):null},B=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(I){return B()&&I instanceof ArrayBuffer};var K=t.__addimage__.isArrayBufferView=function(I){return B()&&typeof Uint32Array<"u"&&(I instanceof Int8Array||I instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array)},Z=t.__addimage__.binaryStringToUint8Array=function(I){for(var A=I.length,T=new Uint8Array(A),F=0;F<A;F++)T[F]=I.charCodeAt(F);return T},z=t.__addimage__.arrayBufferToBinaryString=function(I){for(var A="",T=K(I)?I:new Uint8Array(I),F=0;F<T.length;F+=8192)A+=String.fromCharCode.apply(null,T.subarray(F,F+8192));return A};t.addImage=function(){var I,A,T,F,ne,W,ue,P,Q;if(typeof arguments[1]=="number"?(A=e,T=arguments[1],F=arguments[2],ne=arguments[3],W=arguments[4],ue=arguments[5],P=arguments[6],Q=arguments[7]):(A=arguments[1],T=arguments[2],F=arguments[3],ne=arguments[4],W=arguments[5],ue=arguments[6],P=arguments[7],Q=arguments[8]),dn(I=arguments[0])==="object"&&!p(I)&&"imageData"in I){var G=I;I=G.imageData,A=G.format||A||e,T=G.x||T||0,F=G.y||F||0,ne=G.w||G.width||ne,W=G.h||G.height||W,ue=G.alias||ue,P=G.compression||P,Q=G.rotation||G.angle||Q}var de=this.internal.getFilters();if(P===void 0&&de.indexOf("FlateEncode")!==-1&&(P="SLOW"),isNaN(T)||isNaN(F))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var w=J.call(this,I,A,ue,P);return _.call(this,T,F,ne,W,w,Q),this};var J=function(I,A,T,F){var ne,W,ue;if(typeof I=="string"&&r(I)===e){I=unescape(I);var P=te(I,!1);(P!==""||(P=t.loadFile(I,!0))!==void 0)&&(I=P)}if(p(I)&&(I=v(I,A)),A=r(I,A),!f(A))throw new Error("addImage does not support files of type '"+A+"', please ensure that a plugin for '"+A+"' support is added.");if(((ue=T)==null||ue.length===0)&&(T=function(Q){return typeof Q=="string"||K(Q)?b(Q):K(Q.data)?b(Q.data):null}(I)),(ne=m.call(this,T))||(B()&&(I instanceof Uint8Array||A==="RGBA"||(W=I,I=Z(I))),ne=this["process"+A.toUpperCase()](I,d.call(this),T,function(Q){return Q&&typeof Q=="string"&&(Q=Q.toUpperCase()),Q in t.image_compression?Q:y.NONE}(F),W)),!ne)throw new Error("An unknown error occurred whilst processing the image.");return ne},te=t.__addimage__.convertBase64ToBinaryString=function(I,A){A=typeof A!="boolean"||A;var T,F="";if(typeof I=="string"){var ne;T=(ne=C(I))!==null&&ne!==void 0?ne:I;try{F=Eu(T)}catch(W){if(A)throw j(T)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+W.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return F};t.getImageProperties=function(I){var A,T,F="";if(p(I)&&(I=v(I)),typeof I=="string"&&r(I)===e&&((F=te(I,!1))===""&&(F=t.loadFile(I)||""),I=F),T=r(I),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(!B()||I instanceof Uint8Array||(I=Z(I)),!(A=this["process"+T.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return A.fileType=T,A}})(Pt.API),function(t){var e=function(n){if(n!==void 0&&n!="")return!0};Pt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var r,i,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),d=n.pageContext.annotations,f=!1,p=0;p<d.length&&!f;p++)switch((r=d[p]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var v=0;v<d.length;v++){r=d[v];var m=this.internal.pdfEscape,N=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),k=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(_.objId),b=r.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y)+"] ")+"/Contents ("+m(y(r.contents))+")",a+=" /Popup "+k.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+m(y(b))+") >>",_.content=a;var j=_.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+l(r.bounds.y)+"] ")+" /Parent "+j,r.open&&(a+=" /Open true"),a+=" >>",k.content=a,this.internal.write(_.objId,"0 R",k.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y+r.bounds.h)+"] ";var C=r.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+m(N(r.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+C+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(r.options.name){var B=this.annotations._nameMap[r.options.name];r.options.pageNumber=B.page,r.options.top=B.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",a="",r.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+m(N(r.options.url))+") >>";else if(r.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,a+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var K=l(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),a+=" /XYZ "+r.options.left+" "+K+" "+r.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},t.link=function(n,r,i,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(n),y:d(r),w:c(n+i),h:d(r+a)},options:o,type:"link"})},t.textWithLink=function(n,r,i,a){var o,l,c=this.getTextWidth(n),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var f=this.splitTextToSize(n,l).length;o=Math.ceil(d*f)}else l=c,o=d;return this.text(n,r,i,a),i+=.2*d,a.align==="center"&&(r-=c/2),a.align==="right"&&(r-=c),this.link(r,i-d,l,o,a),c},t.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(Pt.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(_){return e[_.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},l=t.__arabicParser__.isArabicEndLetter=function(_){return o(_)&&a(_)&&e[_.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(_){return o(_)&&i.indexOf(_.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return o(_)&&a(_)&&e[_.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(_){return o(_)&&a(_)&&e[_.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(_){return o(_)&&a(_)&&e[_.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(_){return o(_)&&a(_)&&e[_.charCodeAt(0)].length==4},p=t.__arabicParser__.resolveLigatures=function(_){var k=0,y=n,b="",j=0;for(k=0;k<_.length;k+=1)y[_.charCodeAt(k)]!==void 0?(j++,typeof(y=y[_.charCodeAt(k)])=="number"&&(b+=String.fromCharCode(y),y=n,j=0),k===_.length-1&&(y=n,b+=_.charAt(k-(j-1)),k-=j-1,j=0)):(y=n,b+=_.charAt(k-j),k-=j,j=0);return b};t.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&r[_.charCodeAt(0)]!==void 0};var v=t.__arabicParser__.getCorrectForm=function(_,k,y){return o(_)?a(_)===!1?-1:!d(_)||!o(k)&&!o(y)||!o(y)&&l(k)||l(_)&&!o(k)||l(_)&&c(k)||l(_)&&l(k)?0:f(_)&&o(k)&&!l(k)&&o(y)&&d(y)?3:l(_)||!o(y)?1:2:-1},m=function(_){var k=0,y=0,b=0,j="",C="",B="",K=(_=_||"").split("\\s+"),Z=[];for(k=0;k<K.length;k+=1){for(Z.push(""),y=0;y<K[k].length;y+=1)j=K[k][y],C=K[k][y-1],B=K[k][y+1],o(j)?(b=v(j,C,B),Z[k]+=b!==-1?String.fromCharCode(e[j.charCodeAt(0)][b]):j):Z[k]+=j;Z[k]=p(Z[k])}return Z.join(" ")},N=t.__arabicParser__.processArabic=t.processArabic=function(){var _,k=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(k)){var b=0;for(y=[],b=0;b<k.length;b+=1)Array.isArray(k[b])?y.push([m(k[b][0]),k[b][1],k[b][2]]):y.push([m(k[b])]);_=y}else _=m(k);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};t.events.push(["preProcessText",N])}(Pt.API),Pt.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Pt.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(_){c=_}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(_){d=_}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(_){f=_}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(_){p=_}});var v=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return v},set:function(_){v=_}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var N=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return N},set:function(_){N=_}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){r.call(this);var f=(d=d||{}).fontSize||this.getFontSize(),p=d.font||this.getFont(),v=d.scaleFactor||this.internal.scaleFactor,m=0,N=0,_=0,k=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=d.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(j,C){return j.concat(k.splitTextToSize(C,y))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)m<(_=this.getStringUnitWidth(c[b],{font:p})*f)&&(m=_);return m!==0&&(N=c.length),{w:m/=v,h:Math.max((N*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/v,0)}},t.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,v=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,m&&v&&(this.printHeaderRow(c.lineNumber,!0),c.y+=v[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,f,p,v){if(r.call(this),!f)throw new Error("No data for PDF table.");var m,N,_,k,y=[],b=[],j=[],C={},B={},K=[],Z=[],z=(v=v||{}).autoSize||!1,J=v.printHeaders!==!1,te=v.css&&v.css["font-size"]!==void 0?16*v.css["font-size"]:v.fontSize||12,I=v.margins||Object.assign({width:this.getPageWidth()},e),A=typeof v.padding=="number"?v.padding:3,T=v.headerBackgroundColor||"#c8c8c8",F=v.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=J,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=te,this.internal.__cell__.padding=A,this.internal.__cell__.headerBackgroundColor=T,this.internal.__cell__.headerTextColor=F,this.setFontSize(te),p==null)b=y=Object.keys(f[0]),j=y.map(function(){return"left"});else if(Array.isArray(p)&&dn(p[0])==="object")for(y=p.map(function(G){return G.name}),b=p.map(function(G){return G.prompt||G.name||""}),j=p.map(function(G){return G.align||"left"}),m=0;m<p.length;m+=1)B[p[m].name]=p[m].width*(19.049976/25.4);else Array.isArray(p)&&typeof p[0]=="string"&&(b=y=p,j=y.map(function(){return"left"}));if(z||Array.isArray(p)&&typeof p[0]=="string")for(m=0;m<y.length;m+=1){for(C[k=y[m]]=f.map(function(G){return G[k]}),this.setFont(void 0,"bold"),K.push(this.getTextDimensions(b[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),N=C[k],this.setFont(void 0,"normal"),_=0;_<N.length;_+=1)K.push(this.getTextDimensions(N[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);B[k]=Math.max.apply(null,K)+A+A,K=[]}if(J){var ne={};for(m=0;m<y.length;m+=1)ne[y[m]]={},ne[y[m]].text=b[m],ne[y[m]].align=j[m];var W=l.call(this,ne,B);Z=y.map(function(G){return new a(c,d,B[G],W,ne[G].text,void 0,ne[G].align)}),this.setTableHeaderRow(Z),this.printHeaderRow(1,!1)}var ue=p.reduce(function(G,de){return G[de.name]=de.align,G},{});for(m=0;m<f.length;m+=1){"rowStart"in v&&v.rowStart instanceof Function&&v.rowStart({row:m,data:f[m]},this);var P=l.call(this,f[m],B);for(_=0;_<y.length;_+=1){var Q=f[m][y[_]];"cellStart"in v&&v.cellStart instanceof Function&&v.cellStart({row:m,col:_,data:Q},this),o.call(this,new a(c,d,B[y[_]],P,Q,m+2,ue[y[_]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var f=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,v=this.internal.scaleFactor;return Object.keys(c).map(function(m){var N=c[m];return this.splitTextToSize(N.hasOwnProperty("text")?N.text:N,d[m]-f-f)},this).map(function(m){return this.getLineHeightFactor()*m.length*p/v+f+f},this).reduce(function(m,N){return Math.max(m,N)},0)};t.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var v=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){f=this.internal.__cell__.tableHeaderRow[m].clone(),d&&(f.y=this.internal.__cell__.margins.top||0,v.push(f)),f.lineNumber=c;var N=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(N)}v.length>0&&this.setTableHeaderRow(v),this.setFont(void 0,"normal"),n=!1}}(Pt.API);var Cb={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Ab=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Rg=kb(Ab),Pb=[100,200,300,400,500,600,700,800,900],mC=kb(Pb);function Fg(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(a){return Cb[a=a||"normal"]?a:"normal"}(t.style),r=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(a){return typeof Rg[a=a||"normal"]=="number"?a:"normal"}(t.stretch);return{family:e,style:n,weight:r,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,r].join(" ")}}}function Ox(t,e,n,r){var i;for(i=n;i>=0&&i<e.length;i+=r)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=r)if(t[e[i]])return t[e[i]]}var pC={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Dx={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Mx(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function gC(t,e,n){for(var r=(n=n||{}).defaultFontFamily||"times",i=Object.assign({},pC,n.genericFontFamilies||{}),a=null,o=null,l=0;l<e.length;++l)if(i[(a=Fg(e[l])).family]&&(a.family=i[a.family]),t.hasOwnProperty(a.family)){o=t[a.family];break}if(!(o=o||t[r]))throw new Error("Could not find a font-family for the rule '"+Mx(a)+"' and default family '"+r+"'.");if(o=function(c,d){if(d[c])return d[c];var f=Rg[c],p=f<=Rg.normal?-1:1,v=Ox(d,Ab,f,p);if(!v)throw new Error("Could not find a matching font-stretch value for "+c);return v}(a.stretch,o),o=function(c,d){if(d[c])return d[c];for(var f=Cb[c],p=0;p<f.length;++p)if(d[f[p]])return d[f[p]];throw new Error("Could not find a matching font-style for "+c)}(a.style,o),!(o=function(c,d){if(d[c])return d[c];if(c===400&&d[500])return d[500];if(c===500&&d[400])return d[400];var f=mC[c],p=Ox(d,Pb,f,c<400?-1:1);if(!p)throw new Error("Could not find a matching font-weight for value "+c);return p}(a.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Mx(a)+"'.");return o}function Rx(t){return t.trimLeft()}function vC(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function xC(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var kh,Fx,$x,yp=["times"];(function(t){var e,n,r,i,a,o,l,c,d,f=function(w){return w=w||{},this.isStrokeTransparent=w.isStrokeTransparent||!1,this.strokeOpacity=w.strokeOpacity||1,this.strokeStyle=w.strokeStyle||"#000000",this.fillStyle=w.fillStyle||"#000000",this.isFillTransparent=w.isFillTransparent||!1,this.fillOpacity=w.fillOpacity||1,this.font=w.font||"10px sans-serif",this.textBaseline=w.textBaseline||"alphabetic",this.textAlign=w.textAlign||"left",this.lineWidth=w.lineWidth||1,this.lineJoin=w.lineJoin||"miter",this.lineCap=w.lineCap||"butt",this.path=w.path||[],this.transform=w.transform!==void 0?w.transform.clone():new c,this.globalCompositeOperation=w.globalCompositeOperation||"normal",this.globalAlpha=w.globalAlpha||1,this.clip_path=w.clip_path||[],this.currentPoint=w.currentPoint||new o,this.miterLimit=w.miterLimit||10,this.lastPoint=w.lastPoint||new o,this.lineDashOffset=w.lineDashOffset||0,this.lineDash=w.lineDash||[],this.margin=w.margin||[0,0,0,0],this.prevPageLastElemOffset=w.prevPageLastElemOffset||0,this.ignoreClearRect=typeof w.ignoreClearRect!="boolean"||w.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new f}]);var p=function(w){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=w;Object.defineProperty(this,"pdf",{get:function(){return O}});var R=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return R},set:function(Ce){R=!!Ce}});var H=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return H},set:function(Ce){H=!!Ce}});var re=0;Object.defineProperty(this,"posX",{get:function(){return re},set:function(Ce){isNaN(Ce)||(re=Ce)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(Ce){isNaN(Ce)||(oe=Ce)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Ce){var ie;typeof Ce=="number"?ie=[Ce,Ce,Ce,Ce]:((ie=new Array(4))[0]=Ce[0],ie[1]=Ce.length>=2?Ce[1]:ie[0],ie[2]=Ce.length>=3?Ce[2]:ie[0],ie[3]=Ce.length>=4?Ce[3]:ie[1]),d.margin=ie}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(Ce){fe=Ce}});var be=0;Object.defineProperty(this,"lastBreak",{get:function(){return be},set:function(Ce){be=Ce}});var ze=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ze},set:function(Ce){ze=Ce}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Ce){Ce instanceof f&&(d=Ce)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Ce){d.path=Ce}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(Ce){Le=Ce}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ce){var ie;ie=v(Ce),this.ctx.fillStyle=ie.style,this.ctx.isFillTransparent=ie.a===0,this.ctx.fillOpacity=ie.a,this.pdf.setFillColor(ie.r,ie.g,ie.b,{a:ie.a}),this.pdf.setTextColor(ie.r,ie.g,ie.b,{a:ie.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ce){var ie=v(Ce);this.ctx.strokeStyle=ie.style,this.ctx.isStrokeTransparent=ie.a===0,this.ctx.strokeOpacity=ie.a,ie.a===0?this.pdf.setDrawColor(255,255,255):(ie.a,this.pdf.setDrawColor(ie.r,ie.g,ie.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ce){["butt","round","square"].indexOf(Ce)!==-1&&(this.ctx.lineCap=Ce,this.pdf.setLineCap(Ce))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ce){isNaN(Ce)||(this.ctx.lineWidth=Ce,this.pdf.setLineWidth(Ce))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ce){["bevel","round","miter"].indexOf(Ce)!==-1&&(this.ctx.lineJoin=Ce,this.pdf.setLineJoin(Ce))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ce){isNaN(Ce)||(this.ctx.miterLimit=Ce,this.pdf.setMiterLimit(Ce))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ce){this.ctx.textBaseline=Ce}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ce){["right","end","center","left","start"].indexOf(Ce)!==-1&&(this.ctx.textAlign=Ce)}});var Fe=null;function Me(Ce,ie){if(Fe===null){var pt=function(dt){var Ge=[];return Object.keys(dt).forEach(function(Qe){dt[Qe].forEach(function(st){var ae=null;switch(st){case"bold":ae={family:Qe,weight:"bold"};break;case"italic":ae={family:Qe,style:"italic"};break;case"bolditalic":ae={family:Qe,weight:"bold",style:"italic"};break;case"":case"normal":ae={family:Qe}}ae!==null&&(ae.ref={name:Qe,style:st},Ge.push(ae))})}),Ge}(Ce.getFontList());Fe=function(dt){for(var Ge={},Qe=0;Qe<dt.length;++Qe){var st=Fg(dt[Qe]),ae=st.family,Ae=st.stretch,Re=st.style,he=st.weight;Ge[ae]=Ge[ae]||{},Ge[ae][Ae]=Ge[ae][Ae]||{},Ge[ae][Ae][Re]=Ge[ae][Ae][Re]||{},Ge[ae][Ae][Re][he]=st}return Ge}(pt.concat(ie))}return Fe}var tt=null;Object.defineProperty(this,"fontFaces",{get:function(){return tt},set:function(Ce){Fe=null,tt=Ce}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ce){var ie;if(this.ctx.font=Ce,(ie=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ce))!==null){var pt=ie[1];ie[2];var dt=ie[3],Ge=ie[4];ie[5];var Qe=ie[6],st=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ge)[2];Ge=Math.floor(st==="px"?parseFloat(Ge)*this.pdf.internal.scaleFactor:st==="em"?parseFloat(Ge)*this.pdf.getFontSize():parseFloat(Ge)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ge);var ae=function(pe){var ke,ye,Ze=[],Be=pe.trim();if(Be==="")return yp;if(Be in Dx)return[Dx[Be]];for(;Be!=="";){switch(ye=null,ke=(Be=Rx(Be)).charAt(0)){case'"':case"'":ye=vC(Be.substring(1),ke);break;default:ye=xC(Be)}if(ye===null||(Ze.push(ye[0]),(Be=Rx(ye[1]))!==""&&Be.charAt(0)!==","))return yp;Be=Be.replace(/^,/,"")}return Ze}(Qe);if(this.fontFaces){var Ae=gC(Me(this.pdf,this.fontFaces),ae.map(function(pe){return{family:pe,stretch:"normal",weight:dt,style:pt}}));this.pdf.setFont(Ae.ref.name,Ae.ref.style)}else{var Re="";(dt==="bold"||parseInt(dt,10)>=700||pt==="bold")&&(Re="bold"),pt==="italic"&&(Re+="italic"),Re.length===0&&(Re="normal");for(var he="",Ne={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},He=0;He<ae.length;He++){if(this.pdf.internal.getFont(ae[He],Re,{noFallback:!0,disableWarning:!0})!==void 0){he=ae[He];break}if(Re==="bolditalic"&&this.pdf.internal.getFont(ae[He],"bold",{noFallback:!0,disableWarning:!0})!==void 0)he=ae[He],Re="bold";else if(this.pdf.internal.getFont(ae[He],"normal",{noFallback:!0,disableWarning:!0})!==void 0){he=ae[He],Re="normal";break}}if(he===""){for(var ce=0;ce<ae.length;ce++)if(Ne[ae[ce]]){he=Ne[ae[ce]];break}}he=he===""?"Times":he,this.pdf.setFont(he,Re)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ce){this.ctx.globalCompositeOperation=Ce}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ce){this.ctx.globalAlpha=Ce}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ce){this.ctx.lineDashOffset=Ce,de.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ce){this.ctx.lineDash=Ce,de.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ce){this.ctx.ignoreClearRect=!!Ce}})};p.prototype.setLineDash=function(w){this.lineDash=w},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){C.call(this,"fill",!1)},p.prototype.stroke=function(){C.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(w,O){if(isNaN(w)||isNaN(O))throw vn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var R=this.ctx.transform.applyToPoint(new o(w,O));this.path.push({type:"mt",x:R.x,y:R.y}),this.ctx.lastPoint=new o(w,O)},p.prototype.closePath=function(){var w=new o(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&dn(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){w=new o(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(w.x,w.y)},p.prototype.lineTo=function(w,O){if(isNaN(w)||isNaN(O))throw vn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var R=this.ctx.transform.applyToPoint(new o(w,O));this.path.push({type:"lt",x:R.x,y:R.y}),this.ctx.lastPoint=new o(R.x,R.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),C.call(this,null,!0)},p.prototype.quadraticCurveTo=function(w,O,R,H){if(isNaN(R)||isNaN(H)||isNaN(w)||isNaN(O))throw vn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var re=this.ctx.transform.applyToPoint(new o(R,H)),oe=this.ctx.transform.applyToPoint(new o(w,O));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:re.x,y:re.y}),this.ctx.lastPoint=new o(re.x,re.y)},p.prototype.bezierCurveTo=function(w,O,R,H,re,oe){if(isNaN(re)||isNaN(oe)||isNaN(w)||isNaN(O)||isNaN(R)||isNaN(H))throw vn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new o(re,oe)),be=this.ctx.transform.applyToPoint(new o(w,O)),ze=this.ctx.transform.applyToPoint(new o(R,H));this.path.push({type:"bct",x1:be.x,y1:be.y,x2:ze.x,y2:ze.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new o(fe.x,fe.y)},p.prototype.arc=function(w,O,R,H,re,oe){if(isNaN(w)||isNaN(O)||isNaN(R)||isNaN(H)||isNaN(re))throw vn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new o(w,O));w=fe.x,O=fe.y;var be=this.ctx.transform.applyToPoint(new o(0,R)),ze=this.ctx.transform.applyToPoint(new o(0,0));R=Math.sqrt(Math.pow(be.x-ze.x,2)+Math.pow(be.y-ze.y,2))}Math.abs(re-H)>=2*Math.PI&&(H=0,re=2*Math.PI),this.path.push({type:"arc",x:w,y:O,radius:R,startAngle:H,endAngle:re,counterclockwise:oe})},p.prototype.arcTo=function(w,O,R,H,re){throw new Error("arcTo not implemented.")},p.prototype.rect=function(w,O,R,H){if(isNaN(w)||isNaN(O)||isNaN(R)||isNaN(H))throw vn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(w,O),this.lineTo(w+R,O),this.lineTo(w+R,O+H),this.lineTo(w,O+H),this.lineTo(w,O),this.lineTo(w+R,O),this.lineTo(w,O)},p.prototype.fillRect=function(w,O,R,H){if(isNaN(w)||isNaN(O)||isNaN(R)||isNaN(H))throw vn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var re={};this.lineCap!=="butt"&&(re.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(re.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(w,O,R,H),this.fill(),re.hasOwnProperty("lineCap")&&(this.lineCap=re.lineCap),re.hasOwnProperty("lineJoin")&&(this.lineJoin=re.lineJoin)}},p.prototype.strokeRect=function(w,O,R,H){if(isNaN(w)||isNaN(O)||isNaN(R)||isNaN(H))throw vn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");N.call(this)||(this.beginPath(),this.rect(w,O,R,H),this.stroke())},p.prototype.clearRect=function(w,O,R,H){if(isNaN(w)||isNaN(O)||isNaN(R)||isNaN(H))throw vn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(w,O,R,H))},p.prototype.save=function(w){w=typeof w!="boolean"||w;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,R=0;R<this.pdf.internal.getNumberOfPages();R++)this.pdf.setPage(R+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),w){this.ctx.fontSize=this.pdf.internal.getFontSize();var H=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=H}},p.prototype.restore=function(w){w=typeof w!="boolean"||w;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,R=0;R<this.pdf.internal.getNumberOfPages();R++)this.pdf.setPage(R+1),this.pdf.internal.out("Q");this.pdf.setPage(O),w&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var v=function(w){var O,R,H,re;if(w.isCanvasGradient===!0&&(w=w.getColor()),!w)return{r:0,g:0,b:0,a:0,style:w};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(w))O=0,R=0,H=0,re=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(w);if(oe!==null)O=parseInt(oe[1]),R=parseInt(oe[2]),H=parseInt(oe[3]),re=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(w))!==null)O=parseInt(oe[1]),R=parseInt(oe[2]),H=parseInt(oe[3]),re=parseFloat(oe[4]);else{if(re=1,typeof w=="string"&&w.charAt(0)!=="#"){var fe=new bb(w);w=fe.ok?fe.toHex():"#000000"}w.length===4?(O=w.substring(1,2),O+=O,R=w.substring(2,3),R+=R,H=w.substring(3,4),H+=H):(O=w.substring(1,3),R=w.substring(3,5),H=w.substring(5,7)),O=parseInt(O,16),R=parseInt(R,16),H=parseInt(H,16)}}return{r:O,g:R,b:H,a:re,style:w}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},N=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(w,O,R,H){if(isNaN(O)||isNaN(R)||typeof w!="string")throw vn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(H=isNaN(H)?void 0:H,!m.call(this)){var re=P(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;A.call(this,{text:w,x:O,y:R,scale:oe,angle:re,align:this.textAlign,maxWidth:H})}},p.prototype.strokeText=function(w,O,R,H){if(isNaN(O)||isNaN(R)||typeof w!="string")throw vn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!N.call(this)){H=isNaN(H)?void 0:H;var re=P(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;A.call(this,{text:w,x:O,y:R,scale:oe,renderingMode:"stroke",angle:re,align:this.textAlign,maxWidth:H})}},p.prototype.measureText=function(w){if(typeof w!="string")throw vn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,R=this.pdf.internal.scaleFactor,H=O.internal.getFontSize(),re=O.getStringUnitWidth(w)*H/O.internal.scaleFactor,oe=function(fe){var be=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return be}}),this};return new oe({width:re*=Math.round(96*R/72*1e4)/1e4})},p.prototype.scale=function(w,O){if(isNaN(w)||isNaN(O))throw vn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var R=new c(w,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(R)},p.prototype.rotate=function(w){if(isNaN(w))throw vn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new c(Math.cos(w),Math.sin(w),-Math.sin(w),Math.cos(w),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},p.prototype.translate=function(w,O){if(isNaN(w)||isNaN(O))throw vn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var R=new c(1,0,0,1,w,O);this.ctx.transform=this.ctx.transform.multiply(R)},p.prototype.transform=function(w,O,R,H,re,oe){if(isNaN(w)||isNaN(O)||isNaN(R)||isNaN(H)||isNaN(re)||isNaN(oe))throw vn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new c(w,O,R,H,re,oe);this.ctx.transform=this.ctx.transform.multiply(fe)},p.prototype.setTransform=function(w,O,R,H,re,oe){w=isNaN(w)?1:w,O=isNaN(O)?0:O,R=isNaN(R)?0:R,H=isNaN(H)?1:H,re=isNaN(re)?0:re,oe=isNaN(oe)?0:oe,this.ctx.transform=new c(w,O,R,H,re,oe)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(w,O,R,H,re,oe,fe,be,ze){var Le=this.pdf.getImageProperties(w),Fe=1,Me=1,tt=1,Ce=1;H!==void 0&&be!==void 0&&(tt=be/H,Ce=ze/re,Fe=Le.width/H*be/H,Me=Le.height/re*ze/re),oe===void 0&&(oe=O,fe=R,O=0,R=0),H!==void 0&&be===void 0&&(be=H,ze=re),H===void 0&&be===void 0&&(be=Le.width,ze=Le.height);for(var ie,pt=this.ctx.transform.decompose(),dt=P(pt.rotate.shx),Ge=new c,Qe=(Ge=(Ge=(Ge=Ge.multiply(pt.translate)).multiply(pt.skew)).multiply(pt.scale)).applyToRectangle(new l(oe-O*tt,fe-R*Ce,H*Fe,re*Me)),st=k.call(this,Qe),ae=[],Ae=0;Ae<st.length;Ae+=1)ae.indexOf(st[Ae])===-1&&ae.push(st[Ae]);if(j(ae),this.autoPaging)for(var Re=ae[0],he=ae[ae.length-1],Ne=Re;Ne<he+1;Ne++){this.pdf.setPage(Ne);var He=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ce=Ne===1?this.posY+this.margin[0]:this.margin[0],pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ke=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ye=Ne===1?0:pe+(Ne-2)*ke;if(this.ctx.clip_path.length!==0){var Ze=this.path;ie=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ie,this.posX+this.margin[3],-ye+ce+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=Ze}var Be=JSON.parse(JSON.stringify(Qe));Be=b([Be],this.posX+this.margin[3],-ye+ce+this.ctx.prevPageLastElemOffset)[0];var ut=(Ne>Re||Ne<he)&&_.call(this);ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],He,ke,null).clip().discardPath()),this.pdf.addImage(w,"JPEG",Be.x,Be.y,Be.w,Be.h,null,null,dt),ut&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(w,"JPEG",Qe.x,Qe.y,Qe.w,Qe.h,null,null,dt)};var k=function(w,O,R){var H=[];O=O||this.pdf.internal.pageSize.width,R=R||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var re=this.posY+this.ctx.prevPageLastElemOffset;switch(w.type){default:case"mt":case"lt":H.push(Math.floor((w.y+re)/R)+1);break;case"arc":H.push(Math.floor((w.y+re-w.radius)/R)+1),H.push(Math.floor((w.y+re+w.radius)/R)+1);break;case"qct":var oe=Q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x,w.y);H.push(Math.floor((oe.y+re)/R)+1),H.push(Math.floor((oe.y+oe.h+re)/R)+1);break;case"bct":var fe=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x2,w.y2,w.x,w.y);H.push(Math.floor((fe.y+re)/R)+1),H.push(Math.floor((fe.y+fe.h+re)/R)+1);break;case"rect":H.push(Math.floor((w.y+re)/R)+1),H.push(Math.floor((w.y+w.h+re)/R)+1)}for(var be=0;be<H.length;be+=1)for(;this.pdf.internal.getNumberOfPages()<H[be];)y.call(this);return H},y=function(){var w=this.fillStyle,O=this.strokeStyle,R=this.font,H=this.lineCap,re=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=w,this.strokeStyle=O,this.font=R,this.lineCap=H,this.lineWidth=re,this.lineJoin=oe},b=function(w,O,R){for(var H=0;H<w.length;H++)switch(w[H].type){case"bct":w[H].x2+=O,w[H].y2+=R;case"qct":w[H].x1+=O,w[H].y1+=R;case"mt":case"lt":case"arc":default:w[H].x+=O,w[H].y+=R}return w},j=function(w){return w.sort(function(O,R){return O-R})},C=function(w,O){for(var R,H,re=this.fillStyle,oe=this.strokeStyle,fe=this.lineCap,be=this.lineWidth,ze=Math.abs(be*this.ctx.transform.scaleX),Le=this.lineJoin,Fe=JSON.parse(JSON.stringify(this.path)),Me=JSON.parse(JSON.stringify(this.path)),tt=[],Ce=0;Ce<Me.length;Ce++)if(Me[Ce].x!==void 0)for(var ie=k.call(this,Me[Ce]),pt=0;pt<ie.length;pt+=1)tt.indexOf(ie[pt])===-1&&tt.push(ie[pt]);for(var dt=0;dt<tt.length;dt++)for(;this.pdf.internal.getNumberOfPages()<tt[dt];)y.call(this);if(j(tt),this.autoPaging)for(var Ge=tt[0],Qe=tt[tt.length-1],st=Ge;st<Qe+1;st++){this.pdf.setPage(st),this.fillStyle=re,this.strokeStyle=oe,this.lineCap=fe,this.lineWidth=ze,this.lineJoin=Le;var ae=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ae=st===1?this.posY+this.margin[0]:this.margin[0],Re=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],he=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ne=st===1?0:Re+(st-2)*he;if(this.ctx.clip_path.length!==0){var He=this.path;R=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(R,this.posX+this.margin[3],-Ne+Ae+this.ctx.prevPageLastElemOffset),B.call(this,w,!0),this.path=He}if(H=JSON.parse(JSON.stringify(Fe)),this.path=b(H,this.posX+this.margin[3],-Ne+Ae+this.ctx.prevPageLastElemOffset),O===!1||st===0){var ce=(st>Ge||st<Qe)&&_.call(this);ce&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ae,he,null).clip().discardPath()),B.call(this,w,O),ce&&this.pdf.restoreGraphicsState()}this.lineWidth=be}else this.lineWidth=ze,B.call(this,w,O),this.lineWidth=be;this.path=Fe},B=function(w,O){if((w!=="stroke"||O||!N.call(this))&&(w==="stroke"||O||!m.call(this))){for(var R,H,re=[],oe=this.path,fe=0;fe<oe.length;fe++){var be=oe[fe];switch(be.type){case"begin":re.push({begin:!0});break;case"close":re.push({close:!0});break;case"mt":re.push({start:be,deltas:[],abs:[]});break;case"lt":var ze=re.length;if(oe[fe-1]&&!isNaN(oe[fe-1].x)&&(R=[be.x-oe[fe-1].x,be.y-oe[fe-1].y],ze>0)){for(;ze>=0;ze--)if(re[ze-1].close!==!0&&re[ze-1].begin!==!0){re[ze-1].deltas.push(R),re[ze-1].abs.push(be);break}}break;case"bct":R=[be.x1-oe[fe-1].x,be.y1-oe[fe-1].y,be.x2-oe[fe-1].x,be.y2-oe[fe-1].y,be.x-oe[fe-1].x,be.y-oe[fe-1].y],re[re.length-1].deltas.push(R);break;case"qct":var Le=oe[fe-1].x+2/3*(be.x1-oe[fe-1].x),Fe=oe[fe-1].y+2/3*(be.y1-oe[fe-1].y),Me=be.x+2/3*(be.x1-be.x),tt=be.y+2/3*(be.y1-be.y),Ce=be.x,ie=be.y;R=[Le-oe[fe-1].x,Fe-oe[fe-1].y,Me-oe[fe-1].x,tt-oe[fe-1].y,Ce-oe[fe-1].x,ie-oe[fe-1].y],re[re.length-1].deltas.push(R);break;case"arc":re.push({deltas:[],abs:[],arc:!0}),Array.isArray(re[re.length-1].abs)&&re[re.length-1].abs.push(be)}}H=O?null:w==="stroke"?"stroke":"fill";for(var pt=!1,dt=0;dt<re.length;dt++)if(re[dt].arc)for(var Ge=re[dt].abs,Qe=0;Qe<Ge.length;Qe++){var st=Ge[Qe];st.type==="arc"?z.call(this,st.x,st.y,st.radius,st.startAngle,st.endAngle,st.counterclockwise,void 0,O,!pt):T.call(this,st.x,st.y),pt=!0}else if(re[dt].close===!0)this.pdf.internal.out("h"),pt=!1;else if(re[dt].begin!==!0){var ae=re[dt].start.x,Ae=re[dt].start.y;F.call(this,re[dt].deltas,ae,Ae),pt=!0}H&&J.call(this,H),O&&te.call(this)}},K=function(w){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,R=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return w-R;case"top":return w+O-R;case"hanging":return w+O-2*R;case"middle":return w+O/2-R;case"ideographic":return w;case"alphabetic":default:return w}},Z=function(w){return w+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var w=function(){};return w.colorStops=[],w.addColorStop=function(O,R){this.colorStops.push([O,R])},w.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},w.isCanvasGradient=!0,w},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var z=function(w,O,R,H,re,oe,fe,be,ze){for(var Le=W.call(this,R,H,re,oe),Fe=0;Fe<Le.length;Fe++){var Me=Le[Fe];Fe===0&&(ze?I.call(this,Me.x1+w,Me.y1+O):T.call(this,Me.x1+w,Me.y1+O)),ne.call(this,w,O,Me.x2,Me.y2,Me.x3,Me.y3,Me.x4,Me.y4)}be?te.call(this):J.call(this,fe)},J=function(w){switch(w){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},te=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(w,O){this.pdf.internal.out(n(w)+" "+r(O)+" m")},A=function(w){var O;switch(w.align){case"right":case"end":O="right";break;case"center":O="center";break;case"left":case"start":default:O="left"}var R=this.pdf.getTextDimensions(w.text),H=K.call(this,w.y),re=Z.call(this,H)-R.h,oe=this.ctx.transform.applyToPoint(new o(w.x,H)),fe=this.ctx.transform.decompose(),be=new c;be=(be=(be=be.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var ze,Le,Fe,Me=this.ctx.transform.applyToRectangle(new l(w.x,H,R.w,R.h)),tt=be.applyToRectangle(new l(w.x,re,R.w,R.h)),Ce=k.call(this,tt),ie=[],pt=0;pt<Ce.length;pt+=1)ie.indexOf(Ce[pt])===-1&&ie.push(Ce[pt]);if(j(ie),this.autoPaging)for(var dt=ie[0],Ge=ie[ie.length-1],Qe=dt;Qe<Ge+1;Qe++){this.pdf.setPage(Qe);var st=Qe===1?this.posY+this.margin[0]:this.margin[0],ae=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ae=this.pdf.internal.pageSize.height-this.margin[2],Re=Ae-this.margin[0],he=this.pdf.internal.pageSize.width-this.margin[1],Ne=he-this.margin[3],He=Qe===1?0:ae+(Qe-2)*Re;if(this.ctx.clip_path.length!==0){var ce=this.path;ze=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ze,this.posX+this.margin[3],-1*He+st),B.call(this,"fill",!0),this.path=ce}var pe=b([JSON.parse(JSON.stringify(tt))],this.posX+this.margin[3],-He+st+this.ctx.prevPageLastElemOffset)[0];w.scale>=.01&&(Le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Le*w.scale),Fe=this.lineWidth,this.lineWidth=Fe*w.scale);var ke=this.autoPaging!=="text";if(ke||pe.y+pe.h<=Ae){if(ke||pe.y>=st&&pe.x<=he){var ye=ke?w.text:this.pdf.splitTextToSize(w.text,w.maxWidth||he-pe.x)[0],Ze=b([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-He+st+this.ctx.prevPageLastElemOffset)[0],Be=ke&&(Qe>dt||Qe<Ge)&&_.call(this);Be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ne,Re,null).clip().discardPath()),this.pdf.text(ye,Ze.x,Ze.y,{angle:w.angle,align:O,renderingMode:w.renderingMode}),Be&&this.pdf.restoreGraphicsState()}}else pe.y<Ae&&(this.ctx.prevPageLastElemOffset+=Ae-pe.y);w.scale>=.01&&(this.pdf.setFontSize(Le),this.lineWidth=Fe)}else w.scale>=.01&&(Le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Le*w.scale),Fe=this.lineWidth,this.lineWidth=Fe*w.scale),this.pdf.text(w.text,oe.x+this.posX,oe.y+this.posY,{angle:w.angle,align:O,renderingMode:w.renderingMode,maxWidth:w.maxWidth}),w.scale>=.01&&(this.pdf.setFontSize(Le),this.lineWidth=Fe)},T=function(w,O,R,H){R=R||0,H=H||0,this.pdf.internal.out(n(w+R)+" "+r(O+H)+" l")},F=function(w,O,R){return this.pdf.lines(w,O,R,null,null)},ne=function(w,O,R,H,re,oe,fe,be){this.pdf.internal.out([e(i(R+w)),e(a(H+O)),e(i(re+w)),e(a(oe+O)),e(i(fe+w)),e(a(be+O)),"c"].join(" "))},W=function(w,O,R,H){for(var re=2*Math.PI,oe=Math.PI/2;O>R;)O-=re;var fe=Math.abs(R-O);fe<re&&H&&(fe=re-fe);for(var be=[],ze=H?-1:1,Le=O;fe>1e-5;){var Fe=Le+ze*Math.min(fe,oe);be.push(ue.call(this,w,Le,Fe)),fe-=Math.abs(Fe-Le),Le=Fe}return be},ue=function(w,O,R){var H=(R-O)/2,re=w*Math.cos(H),oe=w*Math.sin(H),fe=re,be=-oe,ze=fe*fe+be*be,Le=ze+fe*re+be*oe,Fe=4/3*(Math.sqrt(2*ze*Le)-Le)/(fe*oe-be*re),Me=fe-Fe*be,tt=be+Fe*fe,Ce=Me,ie=-tt,pt=H+O,dt=Math.cos(pt),Ge=Math.sin(pt);return{x1:w*Math.cos(O),y1:w*Math.sin(O),x2:Me*dt-tt*Ge,y2:Me*Ge+tt*dt,x3:Ce*dt-ie*Ge,y3:Ce*Ge+ie*dt,x4:w*Math.cos(R),y4:w*Math.sin(R)}},P=function(w){return 180*w/Math.PI},Q=function(w,O,R,H,re,oe){var fe=w+.5*(R-w),be=O+.5*(H-O),ze=re+.5*(R-re),Le=oe+.5*(H-oe),Fe=Math.min(w,re,fe,ze),Me=Math.max(w,re,fe,ze),tt=Math.min(O,oe,be,Le),Ce=Math.max(O,oe,be,Le);return new l(Fe,tt,Me-Fe,Ce-tt)},G=function(w,O,R,H,re,oe,fe,be){var ze,Le,Fe,Me,tt,Ce,ie,pt,dt,Ge,Qe,st,ae,Ae,Re=R-w,he=H-O,Ne=re-R,He=oe-H,ce=fe-re,pe=be-oe;for(Le=0;Le<41;Le++)dt=(ie=(Fe=w+(ze=Le/40)*Re)+ze*((tt=R+ze*Ne)-Fe))+ze*(tt+ze*(re+ze*ce-tt)-ie),Ge=(pt=(Me=O+ze*he)+ze*((Ce=H+ze*He)-Me))+ze*(Ce+ze*(oe+ze*pe-Ce)-pt),Le==0?(Qe=dt,st=Ge,ae=dt,Ae=Ge):(Qe=Math.min(Qe,dt),st=Math.min(st,Ge),ae=Math.max(ae,dt),Ae=Math.max(Ae,Ge));return new l(Math.round(Qe),Math.round(st),Math.round(ae-Qe),Math.round(Ae-st))},de=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var w,O,R=(w=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:w,lineDashOffset:O}));this.prevLineDash!==R&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=R)}}})(Pt.API),function(t){var e=function(a){var o,l,c,d,f,p,v,m,N,_;for(l=[],c=0,d=(a+=o="\0\0\0\0".slice(a.length%4||4)).length;d>c;c+=4)(f=(a.charCodeAt(c)<<24)+(a.charCodeAt(c+1)<<16)+(a.charCodeAt(c+2)<<8)+a.charCodeAt(c+3))!==0?(p=(f=((f=((f=((f=(f-(_=f%85))/85)-(N=f%85))/85)-(m=f%85))/85)-(v=f%85))/85)%85,l.push(p+33,v+33,m+33,N+33,_+33)):l.push(122);return function(k,y){for(var b=y;b>0;b--)k.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},n=function(a){var o,l,c,d,f,p=String,v="length",m=255,N="charCodeAt",_="slice",k="replace";for(a[_](-2),a=a[_](0,-2)[k](/\s/g,"")[k]("z","!!!!!"),c=[],d=0,f=(a+=o="uuuuu"[_](a[v]%5||5))[v];f>d;d+=5)l=52200625*(a[N](d)-33)+614125*(a[N](d+1)-33)+7225*(a[N](d+2)-33)+85*(a[N](d+3)-33)+(a[N](d+4)-33),c.push(m&l>>24,m&l>>16,m&l>>8,m&l);return function(y,b){for(var j=b;j>0;j--)y.pop()}(c,o[v]),p.fromCharCode.apply(p,c)},r=function(a){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),o.test(a)===!1)return"";for(var l="",c=0;c<a.length;c+=2)l+=String.fromCharCode("0x"+(a[c]+a[c+1]));return l},i=function(a){for(var o=new Uint8Array(a.length),l=a.length;l--;)o[l]=a.charCodeAt(l);return a=(o=Tg(o)).reduce(function(c,d){return c+String.fromCharCode(d)},"")};t.processDataByFilters=function(a,o){var l=0,c=a||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=n(c),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=r(c),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(f){return("0"+f.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:d.reverse().join(" ")}}}(Pt.API),function(t){t.loadFile=function(e,n,r){return function(i,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,f){var p=new XMLHttpRequest,v=0,m=function(N){var _=N.length,k=[],y=String.fromCharCode;for(v=0;v<_;v+=1)k.push(y(255&N.charCodeAt(v)));return k.join("")};if(p.open("GET",c,!d),p.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(p.onload=function(){p.status===200?f(m(this.responseText)):f(void 0)}),p.send(null),d&&p.status===200)return m(p.responseText)}(i,a,o)}catch{}return l}(e,n,r)},t.loadImageFile=t.loadFile}(Pt.API),function(t){function e(){return(It.html2canvas?Promise.resolve(It.html2canvas):io(()=>import("./html2canvas.esm-e0a7d97b.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function n(){return(It.DOMPurify?Promise.resolve(It.DOMPurify):io(()=>import("./purify.es-31816194.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var r=function(o){var l=dn(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(o,l){var c=document.createElement(o);for(var d in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[d]=l.style[d];return c},a=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),c);return d=(d=d.setProgress(1,o,1,[o])).set(l)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(o,l){return o.__proto__=l||a.prototype,o},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(r(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(n).then(function(c){return this.set({src:i("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},a.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(d,f){for(var p=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),v=d.firstChild;v;v=v.nextSibling)f!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||p.appendChild(c(v,f));return d.nodeType===1&&(d.nodeName==="CANVAS"?(p.width=d.width,p.height=d.height,p.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(p.value=d.value),p.addEventListener("load",function(){p.scrollTop=d.scrollTop,p.scrollLeft=d.scrollLeft},!0)),p}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=d,d)for(var v=0;v<d.length;++v){var m=d[v],N=m.src.find(function(_){return _.format==="truetype"});N&&c.addFont(N.url,m.ref.name,m.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,c.context2d.save(!0),l(this.prop.container,p)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},a.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},a.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},a.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(o){if(r(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in a.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},a.prototype.get=function(o,l){return this.then(function(){var c=o in a.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},a.prototype.setMargin=function(o){return this.then(function(){switch(r(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},a.prototype.setPageSize=function(o){function l(c,d){return Math.floor(c*d/72*96)}return this.then(function(){(o=o||Pt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},a.prototype.setProgress=function(o,l,c,d){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(o,l,c,d){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,d?this.progress.stack.concat(d):null)},a.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(d,f){return c.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(p){return c.updateProgress(null,d),p}).then(d,f).then(function(p){return c.updateProgress(1),p})})},a.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),f=c.call(d,o,l);return a.convert(f,this.__proto__)},a.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},a.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},a.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return a.convert(l,this)},a.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},a.prototype.error=function(o){return this.then(function(){throw new Error(o)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Pt.getPageSize=function(o,l,c){if(dn(o)==="object"){var d=o;o=d.orientation,l=d.unit||l,c=d.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var f,p=(""+c).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+l}var m,N=0,_=0;if(v.hasOwnProperty(p))N=v[p][1]/f,_=v[p][0]/f;else try{N=c[1],_=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",_>N&&(m=_,_=N,N=m);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",N>_&&(m=_,_=N,N=m)}return{width:_,height:N,unit:l,k:f,orientation:o}},t.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Fg):null;var c=new a(l);return l.worker?c:c.from(o).doCallback()}}(Pt.API),Pt.API.addJS=function(t){return $x=t,this.internal.events.subscribe("postPutResources",function(){kh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(kh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Fx=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+$x+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){kh!==void 0&&Fx!==void 0&&this.internal.out("/Names <</JavaScript "+kh+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),a=0;a<i.length;a++){var o=i[a],l=r.exec(o);if(l!=null){var c=l[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,f=[];for(a=0;a<d;a++){var p=n.internal.newObject();f.push(p);var v=n.internal.getPageInfo(a+1);n.internal.write("<< /D["+v.objId+" 0 R /XYZ null null null]>> endobj")}var m=n.internal.newObject();for(n.internal.write("<< /Names [ "),a=0;a<f.length;a++)n.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+m+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,a){var o={title:i,options:a,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<r.children.length;a++){var o=r.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),a>0&&this.line("/Prev "+this.makeRef(r.children[a-1])),a<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var a=0;a<i.children.length;a++)r.count++,this.count_r(r,i.children[a]);return r.count}}])}(Pt.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,r,i,a,o,l){var c,d=this.decode.DCT_DECODE,f=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(c=function(p){for(var v,m=256*p.charCodeAt(4)+p.charCodeAt(5),N=p.length,_={width:0,height:0,numcomponents:1},k=4;k<N;k+=2){if(k+=m,e.indexOf(p.charCodeAt(k+1))!==-1){v=256*p.charCodeAt(k+5)+p.charCodeAt(k+6),_={width:256*p.charCodeAt(k+7)+p.charCodeAt(k+8),height:v,numcomponents:p.charCodeAt(k+9)};break}m=256*p.charCodeAt(k+2)+p.charCodeAt(k+3)}return _}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:n,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:r,alias:i}}return f}}(Pt.API);var Sl,Ch,Bx,qx,Ux,yC=function(){var t,e,n;function r(a){var o,l,c,d,f,p,v,m,N,_,k,y,b,j;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},p=null;;){switch(o=this.readUInt32(),N=(function(){var C,B;for(B=[],C=0;C<4;++C)B.push(String.fromCharCode(this.data[this.pos++]));return B}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":p&&this.animation.frames.push(p),this.pos+=4,p={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),d=this.readUInt16()||100,p.delay=1e3*f/d,p.disposeOp=this.data[this.pos++],p.blendOp=this.data[this.pos++],p.data=[];break;case"IDAT":case"fdAT":for(N==="fdAT"&&(this.pos+=4,o-=4),a=(p!=null?p.data:void 0)||this.imgData,y=0;0<=o?y<o:y>o;0<=o?++y:--y)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((_=c-this.transparency.indexed.length)>0)for(b=0;0<=_?b<_:b>_;0<=_?++b:--b)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":v=(k=this.read(o)).indexOf(0),m=String.fromCharCode.apply(String,k.slice(0,v)),this.text[m]=String.fromCharCode.apply(String,k.slice(v+1));break;case"IEND":return p&&this.animation.frames.push(p),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(j=this.colorType)===4||j===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(a){var o,l;for(l=[],o=0;0<=a?o<a:o>a;0<=a?++o:--o)l.push(this.data[this.pos++]);return l},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(a){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,d=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function f(p,v,m,N){var _,k,y,b,j,C,B,K,Z,z,J,te,I,A,T,F,ne,W,ue,P,Q,G=Math.ceil((d.width-p)/m),de=Math.ceil((d.height-v)/N),w=d.width==G&&d.height==de;for(A=o*G,te=w?l:new Uint8Array(A*de),C=a.length,I=0,k=0;I<de&&c<C;){switch(a[c++]){case 0:for(b=ne=0;ne<A;b=ne+=1)te[k++]=a[c++];break;case 1:for(b=W=0;W<A;b=W+=1)_=a[c++],j=b<o?0:te[k-o],te[k++]=(_+j)%256;break;case 2:for(b=ue=0;ue<A;b=ue+=1)_=a[c++],y=(b-b%o)/o,T=I&&te[(I-1)*A+y*o+b%o],te[k++]=(T+_)%256;break;case 3:for(b=P=0;P<A;b=P+=1)_=a[c++],y=(b-b%o)/o,j=b<o?0:te[k-o],T=I&&te[(I-1)*A+y*o+b%o],te[k++]=(_+Math.floor((j+T)/2))%256;break;case 4:for(b=Q=0;Q<A;b=Q+=1)_=a[c++],y=(b-b%o)/o,j=b<o?0:te[k-o],I===0?T=F=0:(T=te[(I-1)*A+y*o+b%o],F=y&&te[(I-1)*A+(y-1)*o+b%o]),B=j+T-F,K=Math.abs(B-j),z=Math.abs(B-T),J=Math.abs(B-F),Z=K<=z&&K<=J?j:z<=J?T:F,te[k++]=(_+Z)%256;break;default:throw new Error("Invalid filter algorithm: "+a[c-1])}if(!w){var O=((v+I*N)*d.width+p)*o,R=I*A;for(b=0;b<G;b+=1){for(var H=0;H<o;H+=1)l[O++]=te[R++];O+=(m-1)*o}}I++}}return a=Y6(a),d.interlaceMethod==1?(f(0,0,8,8),f(4,0,8,8),f(0,4,4,8),f(2,0,4,4),f(0,2,2,4),f(1,0,2,2),f(0,1,1,2)):f(0,0,1,1),l},r.prototype.decodePalette=function(){var a,o,l,c,d,f,p,v,m;for(l=this.palette,f=this.transparency.indexed||[],d=new Uint8Array((f.length||0)+l.length),c=0,a=0,o=p=0,v=l.length;p<v;o=p+=3)d[c++]=l[o],d[c++]=l[o+1],d[c++]=l[o+2],d[c++]=(m=f[a++])!=null?m:255;return d},r.prototype.copyToImageData=function(a,o){var l,c,d,f,p,v,m,N,_,k,y;if(c=this.colors,_=null,l=this.hasAlphaChannel,this.palette.length&&(_=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),c=4,l=!0),N=(d=a.data||a).length,p=_||o,f=v=0,c===1)for(;f<N;)m=_?4*o[f/4]:v,k=p[m++],d[f++]=k,d[f++]=k,d[f++]=k,d[f++]=l?p[m++]:255,v=m;else for(;f<N;)m=_?4*o[f/4]:v,d[f++]=p[m++],d[f++]=p[m++],d[f++]=p[m++],d[f++]=l?p[m++]:255,v=m},r.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var i=function(){if(Object.prototype.toString.call(It)==="[object Window]"){try{e=It.document.createElement("canvas"),n=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(a){var o;if(i()===!0)return n.width=a.width,n.height=a.height,n.clearRect(0,0,a.width,a.height),n.putImageData(a,0,0),(o=new Image).src=e.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(a){var o,l,c,d,f,p,v,m;if(this.animation){for(m=[],l=f=0,p=(v=this.animation.frames).length;f<p;l=++f)o=v[l],c=a.createImageData(o.width,o.height),d=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,d),o.imageData=c,m.push(o.image=t(c));return m}},r.prototype.renderFrame=function(a,o){var l,c,d;return l=(c=this.animation.frames)[o],d=c[o-1],o===0&&a.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?a.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&a.putImageData(d.imageData,d.xOffset,d.yOffset),l.blendOp===0&&a.clearRect(l.xOffset,l.yOffset,l.width,l.height),a.drawImage(l.image,l.xOffset,l.yOffset)},r.prototype.animate=function(a){var o,l,c,d,f,p,v=this;return l=0,p=this.animation,d=p.numFrames,c=p.frames,f=p.numPlays,(o=function(){var m,N;if(m=l++%d,N=c[m],v.renderFrame(a,m),d>1&&l/d<f)return v.animation._timeout=setTimeout(o,N.delay)})()},r.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},r.prototype.render=function(a){var o,l;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,o=a.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function bC(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,o=1<<(7&i)+1;t[e++],t[e++];var l=null,c=null;a&&(l=e,c=o,e+=3*o);var d=!0,f=[],p=0,v=null,m=0,N=null;for(this.width=n,this.height=r;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,N=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var _=t[e++];p=t[e++]|t[e++]<<8,v=t[e++],!(1&_)&&(v=null),m=_>>2&7,e++;break;case 254:for(;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var k=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,j=t[e++]|t[e++]<<8,C=t[e++],B=C>>6&1,K=1<<(7&C)+1,Z=l,z=c,J=!1;C>>7&&(J=!0,Z=e,z=K,e+=3*K);var te=e;for(e++;;){var I;if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}f.push({x:k,y,width:b,height:j,has_local_palette:J,palette_offset:Z,palette_size:z,data_offset:te,data_length:e-te,transparent_index:v,interlaced:!!B,delay:p,disposal:m});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return N},this.frameInfo=function(A){if(A<0||A>=f.length)throw new Error("Frame index out of range.");return f[A]},this.decodeAndBlitFrameBGRA=function(A,T){var F=this.frameInfo(A),ne=F.width*F.height,W=new Uint8Array(ne);Vx(t,F.data_offset,W,ne);var ue=F.palette_offset,P=F.transparent_index;P===null&&(P=256);var Q=F.width,G=n-Q,de=Q,w=4*(F.y*n+F.x),O=4*((F.y+F.height)*n+F.x),R=w,H=4*G;F.interlaced===!0&&(H+=4*n*7);for(var re=8,oe=0,fe=W.length;oe<fe;++oe){var be=W[oe];if(de===0&&(de=Q,(R+=H)>=O&&(H=4*G+4*n*(re-1),R=w+(Q+G)*(re<<1),re>>=1)),be===P)R+=4;else{var ze=t[ue+3*be],Le=t[ue+3*be+1],Fe=t[ue+3*be+2];T[R++]=Fe,T[R++]=Le,T[R++]=ze,T[R++]=255}--de}},this.decodeAndBlitFrameRGBA=function(A,T){var F=this.frameInfo(A),ne=F.width*F.height,W=new Uint8Array(ne);Vx(t,F.data_offset,W,ne);var ue=F.palette_offset,P=F.transparent_index;P===null&&(P=256);var Q=F.width,G=n-Q,de=Q,w=4*(F.y*n+F.x),O=4*((F.y+F.height)*n+F.x),R=w,H=4*G;F.interlaced===!0&&(H+=4*n*7);for(var re=8,oe=0,fe=W.length;oe<fe;++oe){var be=W[oe];if(de===0&&(de=Q,(R+=H)>=O&&(H=4*G+4*n*(re-1),R=w+(Q+G)*(re<<1),re>>=1)),be===P)R+=4;else{var ze=t[ue+3*be],Le=t[ue+3*be+1],Fe=t[ue+3*be+2];T[R++]=ze,T[R++]=Le,T[R++]=Fe,T[R++]=255}--de}}}function Vx(t,e,n,r){for(var i=t[e++],a=1<<i,o=a+1,l=o+1,c=i+1,d=(1<<c)-1,f=0,p=0,v=0,m=t[e++],N=new Int32Array(4096),_=null;;){for(;f<16&&m!==0;)p|=t[e++]<<f,f+=8,m===1?m=t[e++]:--m;if(f<c)break;var k=p&d;if(p>>=c,f-=c,k!==a){if(k===o)break;for(var y=k<l?k:_,b=0,j=y;j>a;)j=N[j]>>8,++b;var C=j;if(v+b+(y!==k?1:0)>r)return void vn.log("Warning, gif stream longer than expected.");n[v++]=C;var B=v+=b;for(y!==k&&(n[v++]=C),j=y;b--;)j=N[j],n[--B]=255&j,j>>=8;_!==null&&l<4096&&(N[l++]=_<<8|C,l>=d+1&&c<12&&(++c,d=d<<1|1)),_=k}else l=o+1,d=(1<<(c=i+1))-1,_=null}return v!==r&&vn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function bp(t){var e,n,r,i,a,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),f=new Array(64),p=new Array(65535),v=new Array(65535),m=new Array(64),N=new Array(64),_=[],k=0,y=7,b=new Array(64),j=new Array(64),C=new Array(64),B=new Array(256),K=new Array(2048),Z=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],z=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],J=[0,1,2,3,4,5,6,7,8,9,10,11],te=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ne=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function W(w,O){for(var R=0,H=0,re=new Array,oe=1;oe<=16;oe++){for(var fe=1;fe<=w[oe];fe++)re[O[H]]=[],re[O[H]][0]=R,re[O[H]][1]=oe,H++,R++;R*=2}return re}function ue(w){for(var O=w[0],R=w[1]-1;R>=0;)O&1<<R&&(k|=1<<y),R--,--y<0&&(k==255?(P(255),P(0)):P(k),y=7,k=0)}function P(w){_.push(w)}function Q(w){P(w>>8&255),P(255&w)}function G(w,O,R,H,re){for(var oe,fe=re[0],be=re[240],ze=function(Ge,Qe){var st,ae,Ae,Re,he,Ne,He,ce,pe,ke,ye=0;for(pe=0;pe<8;++pe){st=Ge[ye],ae=Ge[ye+1],Ae=Ge[ye+2],Re=Ge[ye+3],he=Ge[ye+4],Ne=Ge[ye+5],He=Ge[ye+6];var Ze=st+(ce=Ge[ye+7]),Be=st-ce,ut=ae+He,it=ae-He,gt=Ae+Ne,Vt=Ae-Ne,vt=Re+he,Yt=Re-he,Bt=Ze+vt,wt=Ze-vt,Qt=ut+gt,Et=ut-gt;Ge[ye]=Bt+Qt,Ge[ye+4]=Bt-Qt;var rt=.707106781*(Et+wt);Ge[ye+2]=wt+rt,Ge[ye+6]=wt-rt;var yt=.382683433*((Bt=Yt+Vt)-(Et=it+Be)),fn=.5411961*Bt+yt,Ht=1.306562965*Et+yt,nr=.707106781*(Qt=Vt+it),Sr=Be+nr,Nt=Be-nr;Ge[ye+5]=Nt+fn,Ge[ye+3]=Nt-fn,Ge[ye+1]=Sr+Ht,Ge[ye+7]=Sr-Ht,ye+=8}for(ye=0,pe=0;pe<8;++pe){st=Ge[ye],ae=Ge[ye+8],Ae=Ge[ye+16],Re=Ge[ye+24],he=Ge[ye+32],Ne=Ge[ye+40],He=Ge[ye+48];var rr=st+(ce=Ge[ye+56]),Jr=st-ce,cr=ae+He,Ln=ae-He,xn=Ae+Ne,_r=Ae-Ne,_i=Re+he,os=Re-he,zr=rr+_i,Pn=rr-_i,kr=cr+xn,ur=cr-xn;Ge[ye]=zr+kr,Ge[ye+32]=zr-kr;var Or=.707106781*(ur+Pn);Ge[ye+16]=Pn+Or,Ge[ye+48]=Pn-Or;var Hn=.382683433*((zr=os+_r)-(ur=Ln+Jr)),Ss=.5411961*zr+Hn,ri=1.306562965*ur+Hn,si=.707106781*(kr=_r+Ln),ki=Jr+si,Ci=Jr-si;Ge[ye+40]=Ci+Ss,Ge[ye+24]=Ci-Ss,Ge[ye+8]=ki+ri,Ge[ye+56]=ki-ri,ye++}for(pe=0;pe<64;++pe)ke=Ge[pe]*Qe[pe],m[pe]=ke>0?ke+.5|0:ke-.5|0;return m}(w,O),Le=0;Le<64;++Le)N[Z[Le]]=ze[Le];var Fe=N[0]-R;R=N[0],Fe==0?ue(H[0]):(ue(H[v[oe=32767+Fe]]),ue(p[oe]));for(var Me=63;Me>0&&N[Me]==0;)Me--;if(Me==0)return ue(fe),R;for(var tt,Ce=1;Ce<=Me;){for(var ie=Ce;N[Ce]==0&&Ce<=Me;)++Ce;var pt=Ce-ie;if(pt>=16){tt=pt>>4;for(var dt=1;dt<=tt;++dt)ue(be);pt&=15}oe=32767+N[Ce],ue(re[(pt<<4)+v[oe]]),ue(p[oe]),Ce++}return Me!=63&&ue(fe),R}function de(w){w=Math.min(Math.max(w,1),100),a!=w&&(function(O){for(var R=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],H=0;H<64;H++){var re=o((R[H]*O+50)/100);re=Math.min(Math.max(re,1),255),l[Z[H]]=re}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var be=o((oe[fe]*O+50)/100);be=Math.min(Math.max(be,1),255),c[Z[fe]]=be}for(var ze=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,Fe=0;Fe<8;Fe++)for(var Me=0;Me<8;Me++)d[Le]=1/(l[Z[Le]]*ze[Fe]*ze[Me]*8),f[Le]=1/(c[Z[Le]]*ze[Fe]*ze[Me]*8),Le++}(w<50?Math.floor(5e3/w):Math.floor(200-2*w)),a=w)}this.encode=function(w,O){O&&de(O),_=new Array,k=0,y=7,Q(65496),Q(65504),Q(16),P(74),P(70),P(73),P(70),P(0),P(1),P(1),P(0),Q(1),Q(1),P(0),P(0),function(){Q(65499),Q(132),P(0);for(var ae=0;ae<64;ae++)P(l[ae]);P(1);for(var Ae=0;Ae<64;Ae++)P(c[Ae])}(),function(ae,Ae){Q(65472),Q(17),P(8),Q(Ae),Q(ae),P(3),P(1),P(17),P(0),P(2),P(17),P(1),P(3),P(17),P(1)}(w.width,w.height),function(){Q(65476),Q(418),P(0);for(var ae=0;ae<16;ae++)P(z[ae+1]);for(var Ae=0;Ae<=11;Ae++)P(J[Ae]);P(16);for(var Re=0;Re<16;Re++)P(te[Re+1]);for(var he=0;he<=161;he++)P(I[he]);P(1);for(var Ne=0;Ne<16;Ne++)P(A[Ne+1]);for(var He=0;He<=11;He++)P(T[He]);P(17);for(var ce=0;ce<16;ce++)P(F[ce+1]);for(var pe=0;pe<=161;pe++)P(ne[pe])}(),Q(65498),Q(12),P(3),P(1),P(0),P(2),P(17),P(3),P(17),P(0),P(63),P(0);var R=0,H=0,re=0;k=0,y=7,this.encode.displayName="_encode_";for(var oe,fe,be,ze,Le,Fe,Me,tt,Ce,ie=w.data,pt=w.width,dt=w.height,Ge=4*pt,Qe=0;Qe<dt;){for(oe=0;oe<Ge;){for(Le=Ge*Qe+oe,Me=-1,tt=0,Ce=0;Ce<64;Ce++)Fe=Le+(tt=Ce>>3)*Ge+(Me=4*(7&Ce)),Qe+tt>=dt&&(Fe-=Ge*(Qe+1+tt-dt)),oe+Me>=Ge&&(Fe-=oe+Me-Ge+4),fe=ie[Fe++],be=ie[Fe++],ze=ie[Fe++],b[Ce]=(K[fe]+K[be+256>>0]+K[ze+512>>0]>>16)-128,j[Ce]=(K[fe+768>>0]+K[be+1024>>0]+K[ze+1280>>0]>>16)-128,C[Ce]=(K[fe+1280>>0]+K[be+1536>>0]+K[ze+1792>>0]>>16)-128;R=G(b,d,R,e,r),H=G(j,f,H,n,i),re=G(C,f,re,n,i),oe+=32}Qe+=8}if(y>=0){var st=[];st[1]=y+1,st[0]=(1<<y+1)-1,ue(st)}return Q(65497),new Uint8Array(_)},t=t||50,function(){for(var w=String.fromCharCode,O=0;O<256;O++)B[O]=w(O)}(),e=W(z,J),n=W(A,T),r=W(te,I),i=W(F,ne),function(){for(var w=1,O=2,R=1;R<=15;R++){for(var H=w;H<O;H++)v[32767+H]=R,p[32767+H]=[],p[32767+H][1]=R,p[32767+H][0]=H;for(var re=-(O-1);re<=-w;re++)v[32767+re]=R,p[32767+re]=[],p[32767+re][1]=R,p[32767+re][0]=O-1+re;w<<=1,O<<=1}}(),function(){for(var w=0;w<256;w++)K[w]=19595*w,K[w+256>>0]=38470*w,K[w+512>>0]=7471*w+32768,K[w+768>>0]=-11059*w,K[w+1024>>0]=-21709*w,K[w+1280>>0]=32768*w+8421375,K[w+1536>>0]=-27439*w,K[w+1792>>0]=-5329*w}(),de(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function hi(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Hx(t){function e(z){if(!z)throw Error("assert :P")}function n(z,J,te){for(var I=0;4>I;I++)if(z[J+I]!=te.charCodeAt(I))return!0;return!1}function r(z,J,te,I,A){for(var T=0;T<A;T++)z[J+T]=te[I+T]}function i(z,J,te,I){for(var A=0;A<I;A++)z[J+A]=te}function a(z){return new Int32Array(z)}function o(z,J){for(var te=[],I=0;I<z;I++)te.push(new J);return te}function l(z,J){var te=[];return function I(A,T,F){for(var ne=F[T],W=0;W<ne&&(A.push(F.length>T+1?[]:new J),!(F.length<T+1));W++)I(A[W],T+1,F)}(te,0,z),te}var c=function(){var z=this;function J(u,h){for(var x=1<<h-1>>>0;u&x;)x>>>=1;return x?(u&x-1)+x:u}function te(u,h,x,S,E){e(!(S%x));do u[h+(S-=x)]=E;while(0<S)}function I(u,h,x,S,E){if(e(2328>=E),512>=E)var D=a(512);else if((D=a(E))==null)return 0;return function(M,$,V,ee,ge,Se){var _e,we,Ue=$,Ee=1<<V,ve=a(16),xe=a(16);for(e(ge!=0),e(ee!=null),e(M!=null),e(0<V),we=0;we<ge;++we){if(15<ee[we])return 0;++ve[ee[we]]}if(ve[0]==ge)return 0;for(xe[1]=0,_e=1;15>_e;++_e){if(ve[_e]>1<<_e)return 0;xe[_e+1]=xe[_e]+ve[_e]}for(we=0;we<ge;++we)_e=ee[we],0<ee[we]&&(Se[xe[_e]++]=we);if(xe[15]==1)return(ee=new A).g=0,ee.value=Se[0],te(M,Ue,1,Ee,ee),Ee;var $e,We=-1,qe=Ee-1,ft=0,at=1,Ct=1,ct=1<<V;for(we=0,_e=1,ge=2;_e<=V;++_e,ge<<=1){if(at+=Ct<<=1,0>(Ct-=ve[_e]))return 0;for(;0<ve[_e];--ve[_e])(ee=new A).g=_e,ee.value=Se[we++],te(M,Ue+ft,ge,ct,ee),ft=J(ft,_e)}for(_e=V+1,ge=2;15>=_e;++_e,ge<<=1){if(at+=Ct<<=1,0>(Ct-=ve[_e]))return 0;for(;0<ve[_e];--ve[_e]){if(ee=new A,(ft&qe)!=We){for(Ue+=ct,$e=1<<(We=_e)-V;15>We&&!(0>=($e-=ve[We]));)++We,$e<<=1;Ee+=ct=1<<($e=We-V),M[$+(We=ft&qe)].g=$e+V,M[$+We].value=Ue-$-We}ee.g=_e-V,ee.value=Se[we++],te(M,Ue+(ft>>V),ge,ct,ee),ft=J(ft,_e)}}return at!=2*xe[15]-1?0:Ee}(u,h,x,S,E,D)}function A(){this.value=this.g=0}function T(){this.value=this.g=0}function F(){this.G=o(5,A),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Ar,T)}function ne(u,h,x,S){e(u!=null),e(h!=null),e(2147483648>S),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=h,u.pa=x,u.Jd=h,u.Yc=x+S,u.Zc=4<=S?x+S-4+1:x,oe(u)}function W(u,h){for(var x=0;0<h--;)x|=be(u,128)<<h;return x}function ue(u,h){var x=W(u,h);return fe(u)?-x:x}function P(u,h,x,S){var E,D=0;for(e(u!=null),e(h!=null),e(4294967288>S),u.Sb=S,u.Ra=0,u.u=0,u.h=0,4<S&&(S=4),E=0;E<S;++E)D+=h[x+E]<<8*E;u.Ra=D,u.bb=S,u.oa=h,u.pa=x}function Q(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<hl-8>>>0,++u.bb,u.u-=8;R(u)&&(u.h=1,u.u=0)}function G(u,h){if(e(0<=h),!u.h&&h<=dl){var x=O(u)&ul[h];return u.u+=h,Q(u),x}return u.h=1,u.u=0}function de(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function w(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(u){return u.Ra>>>(u.u&hl-1)>>>0}function R(u){return e(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>hl}function H(u,h){u.u=h,u.h=R(u)}function re(u){u.u>=Fc&&(e(u.u>=Fc),Q(u))}function oe(u){e(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(e(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function fe(u){return W(u,1)}function be(u,h){var x=u.Ca;0>u.b&&oe(u);var S=u.b,E=x*h>>>8,D=(u.I>>>S>E)+0;for(D?(x-=E,u.I-=E+1<<S>>>0):x=E+1,S=x,E=0;256<=S;)E+=8,S>>=8;return S=7^E+cs[S],u.b-=S,u.Ca=(x<<S)-1,D}function ze(u,h,x){u[h+0]=x>>24&255,u[h+1]=x>>16&255,u[h+2]=x>>8&255,u[h+3]=x>>0&255}function Le(u,h){return u[h+0]<<0|u[h+1]<<8}function Fe(u,h){return Le(u,h)|u[h+2]<<16}function Me(u,h){return Le(u,h)|Le(u,h+2)<<16}function tt(u,h){var x=1<<h;return e(u!=null),e(0<h),u.X=a(x),u.X==null?0:(u.Mb=32-h,u.Xa=h,1)}function Ce(u,h){e(u!=null),e(h!=null),e(u.Xa==h.Xa),r(h.X,0,u.X,0,1<<h.Xa)}function ie(){this.X=[],this.Xa=this.Mb=0}function pt(u,h,x,S){e(x!=null),e(S!=null);var E=x[0],D=S[0];return E==0&&(E=(u*D+h/2)/h),D==0&&(D=(h*E+u/2)/u),0>=E||0>=D?0:(x[0]=E,S[0]=D,1)}function dt(u,h){return u+(1<<h)-1>>>h}function Ge(u,h){return((4278255360&u)+(4278255360&h)>>>0&4278255360)+((16711935&u)+(16711935&h)>>>0&16711935)>>>0}function Qe(u,h){z[h]=function(x,S,E,D,M,$,V){var ee;for(ee=0;ee<M;++ee){var ge=z[u]($[V+ee-1],E,D+ee);$[V+ee]=Ge(x[S+ee],ge)}}}function st(){this.ud=this.hd=this.jd=0}function ae(u,h){return((4278124286&(u^h))>>>1)+(u&h)>>>0}function Ae(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function Re(u,h){return Ae(u+(u-h+.5>>1))}function he(u,h,x){return Math.abs(h-x)-Math.abs(u-x)}function Ne(u,h,x,S,E,D,M){for(S=D[M-1],x=0;x<E;++x)D[M+x]=S=Ge(u[h+x],S)}function He(u,h,x,S,E){var D;for(D=0;D<x;++D){var M=u[h+D],$=M>>8&255,V=16711935&(V=(V=16711935&M)+(($<<16)+$));S[E+D]=(4278255360&M)+V>>>0}}function ce(u,h){h.jd=u>>0&255,h.hd=u>>8&255,h.ud=u>>16&255}function pe(u,h,x,S,E,D){var M;for(M=0;M<S;++M){var $=h[x+M],V=$>>>8,ee=$,ge=255&(ge=(ge=$>>>16)+((u.jd<<24>>24)*(V<<24>>24)>>>5));ee=255&(ee=(ee=ee+((u.hd<<24>>24)*(V<<24>>24)>>>5))+((u.ud<<24>>24)*(ge<<24>>24)>>>5)),E[D+M]=(4278255360&$)+(ge<<16)+ee}}function ke(u,h,x,S,E){z[h]=function(D,M,$,V,ee,ge,Se,_e,we){for(V=Se;V<_e;++V)for(Se=0;Se<we;++Se)ee[ge++]=E($[S(D[M++])])},z[u]=function(D,M,$,V,ee,ge,Se){var _e=8>>D.b,we=D.Ea,Ue=D.K[0],Ee=D.w;if(8>_e)for(D=(1<<D.b)-1,Ee=(1<<_e)-1;M<$;++M){var ve,xe=0;for(ve=0;ve<we;++ve)ve&D||(xe=S(V[ee++])),ge[Se++]=E(Ue[xe&Ee]),xe>>=_e}else z["VP8LMapColor"+x](V,ee,Ue,Ee,ge,Se,M,$,we)}}function ye(u,h,x,S,E){for(x=h+x;h<x;){var D=u[h++];S[E++]=D>>16&255,S[E++]=D>>8&255,S[E++]=D>>0&255}}function Ze(u,h,x,S,E){for(x=h+x;h<x;){var D=u[h++];S[E++]=D>>16&255,S[E++]=D>>8&255,S[E++]=D>>0&255,S[E++]=D>>24&255}}function Be(u,h,x,S,E){for(x=h+x;h<x;){var D=(M=u[h++])>>16&240|M>>12&15,M=M>>0&240|M>>28&15;S[E++]=D,S[E++]=M}}function ut(u,h,x,S,E){for(x=h+x;h<x;){var D=(M=u[h++])>>16&248|M>>13&7,M=M>>5&224|M>>3&31;S[E++]=D,S[E++]=M}}function it(u,h,x,S,E){for(x=h+x;h<x;){var D=u[h++];S[E++]=D>>0&255,S[E++]=D>>8&255,S[E++]=D>>16&255}}function gt(u,h,x,S,E,D){if(D==0)for(x=h+x;h<x;)ze(S,((D=u[h++])[0]>>24|D[1]>>8&65280|D[2]<<8&16711680|D[3]<<24)>>>0),E+=32;else r(S,E,u,h,x)}function Vt(u,h){z[h][0]=z[u+"0"],z[h][1]=z[u+"1"],z[h][2]=z[u+"2"],z[h][3]=z[u+"3"],z[h][4]=z[u+"4"],z[h][5]=z[u+"5"],z[h][6]=z[u+"6"],z[h][7]=z[u+"7"],z[h][8]=z[u+"8"],z[h][9]=z[u+"9"],z[h][10]=z[u+"10"],z[h][11]=z[u+"11"],z[h][12]=z[u+"12"],z[h][13]=z[u+"13"],z[h][14]=z[u+"0"],z[h][15]=z[u+"0"]}function vt(u){return u==jm||u==Sm||u==$d||u==_m}function Yt(){this.eb=[],this.size=this.A=this.fb=0}function Bt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function wt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Yt,this.f.kb=new Bt,this.sd=null}function Qt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Et(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function rt(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function yt(u,h){var x=u.T,S=h.ba.f.RGBA,E=S.eb,D=S.fb+u.ka*S.A,M=Us[h.ba.S],$=u.y,V=u.O,ee=u.f,ge=u.N,Se=u.ea,_e=u.W,we=h.cc,Ue=h.dc,Ee=h.Mc,ve=h.Nc,xe=u.ka,$e=u.ka+u.T,We=u.U,qe=We+1>>1;for(xe==0?M($,V,null,null,ee,ge,Se,_e,ee,ge,Se,_e,E,D,null,null,We):(M(h.ec,h.fc,$,V,we,Ue,Ee,ve,ee,ge,Se,_e,E,D-S.A,E,D,We),++x);xe+2<$e;xe+=2)we=ee,Ue=ge,Ee=Se,ve=_e,ge+=u.Rc,_e+=u.Rc,D+=2*S.A,M($,(V+=2*u.fa)-u.fa,$,V,we,Ue,Ee,ve,ee,ge,Se,_e,E,D-S.A,E,D,We);return V+=u.fa,u.j+$e<u.o?(r(h.ec,h.fc,$,V,We),r(h.cc,h.dc,ee,ge,qe),r(h.Mc,h.Nc,Se,_e,qe),x--):1&$e||M($,V,null,null,ee,ge,Se,_e,ee,ge,Se,_e,E,D+S.A,null,null,We),x}function fn(u,h,x){var S=u.F,E=[u.J];if(S!=null){var D=u.U,M=h.ba.S,$=M==Fd||M==$d;h=h.ba.f.RGBA;var V=[0],ee=u.ka;V[0]=u.T,u.Kb&&(ee==0?--V[0]:(--ee,E[0]-=u.width),u.j+u.ka+u.T==u.o&&(V[0]=u.o-u.j-ee));var ge=h.eb;ee=h.fb+ee*h.A,u=bn(S,E[0],u.width,D,V,ge,ee+($?0:3),h.A),e(x==V),u&&vt(M)&&Bs(ge,ee,$,D,V,h.A)}return 0}function Ht(u){var h=u.ma,x=h.ba.S,S=11>x,E=x==Md||x==Rd||x==Fd||x==Nm||x==12||vt(x);if(h.memory=null,h.Ib=null,h.Jb=null,h.Nd=null,!Mc(h.Oa,u,E?11:12))return 0;if(E&&vt(x)&&Ke(),u.da)alert("todo:use_scaling");else{if(S){if(h.Ib=rt,u.Kb){if(x=u.U+1>>1,h.memory=a(u.U+2*x),h.memory==null)return 0;h.ec=h.memory,h.fc=0,h.cc=h.ec,h.dc=h.fc+u.U,h.Mc=h.cc,h.Nc=h.dc+x,h.Ib=yt,Ke()}}else alert("todo:EmitYUV");E&&(h.Jb=fn,S&&je())}if(S&&!j1){for(u=0;256>u;++u)Sw[u]=89858*(u-128)+qd>>Bd,Cw[u]=-22014*(u-128)+qd,kw[u]=-45773*(u-128),_w[u]=113618*(u-128)+qd>>Bd;for(u=Gc;u<Am;++u)h=76283*(u-16)+qd>>Bd,Aw[u-Gc]=_s(h,255),Pw[u-Gc]=_s(h+8>>4,15);j1=1}return 1}function nr(u){var h=u.ma,x=u.U,S=u.T;return e(!(1&u.ka)),0>=x||0>=S?0:(x=h.Ib(u,h),h.Jb!=null&&h.Jb(u,h,x),h.Dc+=x,1)}function Sr(u){u.ma.memory=null}function Nt(u,h,x,S){return G(u,8)!=47?0:(h[0]=G(u,14)+1,x[0]=G(u,14)+1,S[0]=G(u,1),G(u,3)!=0?0:!u.h)}function rr(u,h){if(4>u)return u+1;var x=u-2>>1;return(2+(1&u)<<x)+G(h,x)+1}function Jr(u,h){return 120<h?h-120:1<=(x=((x=uw[h-1])>>4)*u+(8-(15&x)))?x:1;var x}function cr(u,h,x){var S=O(x),E=u[h+=255&S].g-8;return 0<E&&(H(x,x.u+8),S=O(x),h+=u[h].value,h+=S&(1<<E)-1),H(x,x.u+u[h].g),u[h].value}function Ln(u,h,x){return x.g+=u.g,x.value+=u.value<<h>>>0,e(8>=x.g),u.g}function xn(u,h,x){var S=u.xc;return e((h=S==0?0:u.vc[u.md*(x>>S)+(h>>S)])<u.Wb),u.Ya[h]}function _r(u,h,x,S){var E=u.ab,D=u.c*h,M=u.C;h=M+h;var $=x,V=S;for(S=u.Ta,x=u.Ua;0<E--;){var ee=u.gc[E],ge=M,Se=h,_e=$,we=V,Ue=(V=S,$=x,ee.Ea);switch(e(ge<Se),e(Se<=ee.nc),ee.hc){case 2:Id(_e,we,(Se-ge)*Ue,V,$);break;case 0:var Ee=ge,ve=Se,xe=V,$e=$,We=(ct=ee).Ea;Ee==0&&(bm(_e,we,null,null,1,xe,$e),Ne(_e,we+1,0,0,We-1,xe,$e+1),we+=We,$e+=We,++Ee);for(var qe=1<<ct.b,ft=qe-1,at=dt(We,ct.b),Ct=ct.K,ct=ct.w+(Ee>>ct.b)*at;Ee<ve;){var sn=Ct,ln=ct,tn=1;for($c(_e,we,xe,$e-We,1,xe,$e);tn<We;){var Kt=(tn&~ft)+qe;Kt>We&&(Kt=We),(0,Na[sn[ln++]>>8&15])(_e,we+ +tn,xe,$e+tn-We,Kt-tn,xe,$e+tn),tn=Kt}we+=We,$e+=We,++Ee&ft||(ct+=at)}Se!=ee.nc&&r(V,$-Ue,V,$+(Se-ge-1)*Ue,Ue);break;case 1:for(Ue=_e,ve=we,We=(_e=ee.Ea)-($e=_e&~(xe=(we=1<<ee.b)-1)),Ee=dt(_e,ee.b),qe=ee.K,ee=ee.w+(ge>>ee.b)*Ee;ge<Se;){for(ft=qe,at=ee,Ct=new st,ct=ve+$e,sn=ve+_e;ve<ct;)ce(ft[at++],Ct),wo(Ct,Ue,ve,we,V,$),ve+=we,$+=we;ve<sn&&(ce(ft[at++],Ct),wo(Ct,Ue,ve,We,V,$),ve+=We,$+=We),++ge&xe||(ee+=Ee)}break;case 3:if(_e==V&&we==$&&0<ee.b){for(ve=V,_e=Ue=$+(Se-ge)*Ue-($e=(Se-ge)*dt(ee.Ea,ee.b)),we=V,xe=$,Ee=[],$e=(We=$e)-1;0<=$e;--$e)Ee[$e]=we[xe+$e];for($e=We-1;0<=$e;--$e)ve[_e+$e]=Ee[$e];Rs(ee,ge,Se,V,Ue,V,$)}else Rs(ee,ge,Se,_e,we,V,$)}$=S,V=x}V!=x&&r(S,x,$,V,D)}function _i(u,h){var x=u.V,S=u.Ba+u.c*u.C,E=h-u.C;if(e(h<=u.l.o),e(16>=E),0<E){var D=u.l,M=u.Ta,$=u.Ua,V=D.width;if(_r(u,E,x,S),E=$=[$],e((x=u.C)<(S=h)),e(D.v<D.va),S>D.o&&(S=D.o),x<D.j){var ee=D.j-x;x=D.j,E[0]+=ee*V}if(x>=S?x=0:(E[0]+=4*D.v,D.ka=x-D.j,D.U=D.va-D.v,D.T=S-x,x=1),x){if($=$[0],11>(x=u.ca).S){var ge=x.f.RGBA,Se=(S=x.S,E=D.U,D=D.T,ee=ge.eb,ge.A),_e=D;for(ge=ge.fb+u.Ma*ge.A;0<_e--;){var we=M,Ue=$,Ee=E,ve=ee,xe=ge;switch(S){case Dd:us(we,Ue,Ee,ve,xe);break;case Md:Qr(we,Ue,Ee,ve,xe);break;case jm:Qr(we,Ue,Ee,ve,xe),Bs(ve,xe,0,Ee,1,0);break;case f1:Ki(we,Ue,Ee,ve,xe);break;case Rd:gt(we,Ue,Ee,ve,xe,1);break;case Sm:gt(we,Ue,Ee,ve,xe,1),Bs(ve,xe,0,Ee,1,0);break;case Fd:gt(we,Ue,Ee,ve,xe,0);break;case $d:gt(we,Ue,Ee,ve,xe,0),Bs(ve,xe,1,Ee,1,0);break;case Nm:ja(we,Ue,Ee,ve,xe);break;case _m:ja(we,Ue,Ee,ve,xe),yn(ve,xe,Ee,1,0);break;case m1:Ji(we,Ue,Ee,ve,xe);break;default:e(0)}$+=V,ge+=Se}u.Ma+=D}else alert("todo:EmitRescaledRowsYUVA");e(u.Ma<=x.height)}}u.C=h,e(u.C<=u.i)}function os(u){var h;if(0<u.ua)return 0;for(h=0;h<u.Wb;++h){var x=u.Ya[h].G,S=u.Ya[h].H;if(0<x[1][S[1]+0].g||0<x[2][S[2]+0].g||0<x[3][S[3]+0].g)return 0}return 1}function zr(u,h,x,S,E,D){if(u.Z!=0){var M=u.qd,$=u.rd;for(e(Ca[u.Z]!=null);h<x;++h)Ca[u.Z](M,$,S,E,S,E,D),M=S,$=E,E+=D;u.qd=M,u.rd=$}}function Pn(u,h){var x=u.l.ma,S=x.Z==0||x.Z==1?u.l.j:u.C;if(S=u.C<S?S:u.C,e(h<=u.l.o),h>S){var E=u.l.width,D=x.ca,M=x.tb+E*S,$=u.V,V=u.Ba+u.c*S,ee=u.gc;e(u.ab==1),e(ee[0].hc==3),Ed(ee[0],S,h,$,V,D,M),zr(x,S,h,D,M,E)}u.C=u.Ma=h}function kr(u,h,x,S,E,D,M){var $=u.$/S,V=u.$%S,ee=u.m,ge=u.s,Se=x+u.$,_e=Se;E=x+S*E;var we=x+S*D,Ue=280+ge.ua,Ee=u.Pb?$:16777216,ve=0<ge.ua?ge.Wa:null,xe=ge.wc,$e=Se<we?xn(ge,V,$):null;e(u.C<D),e(we<=E);var We=!1;e:for(;;){for(;We||Se<we;){var qe=0;if($>=Ee){var ft=Se-x;e((Ee=u).Pb),Ee.wd=Ee.m,Ee.xd=ft,0<Ee.s.ua&&Ce(Ee.s.Wa,Ee.s.vb),Ee=$+hw}if(V&xe||($e=xn(ge,V,$)),e($e!=null),$e.Qb&&(h[Se]=$e.qb,We=!0),!We)if(re(ee),$e.jc){qe=ee,ft=h;var at=Se,Ct=$e.pd[O(qe)&Ar-1];e($e.jc),256>Ct.g?(H(qe,qe.u+Ct.g),ft[at]=Ct.value,qe=0):(H(qe,qe.u+Ct.g-256),e(256<=Ct.value),qe=Ct.value),qe==0&&(We=!0)}else qe=cr($e.G[0],$e.H[0],ee);if(ee.h)break;if(We||256>qe){if(!We)if($e.nd)h[Se]=($e.qb|qe<<8)>>>0;else{if(re(ee),We=cr($e.G[1],$e.H[1],ee),re(ee),ft=cr($e.G[2],$e.H[2],ee),at=cr($e.G[3],$e.H[3],ee),ee.h)break;h[Se]=(at<<24|We<<16|qe<<8|ft)>>>0}if(We=!1,++Se,++V>=S&&(V=0,++$,M!=null&&$<=D&&!($%16)&&M(u,$),ve!=null))for(;_e<Se;)qe=h[_e++],ve.X[(506832829*qe&4294967295)>>>ve.Mb]=qe}else if(280>qe){if(qe=rr(qe-256,ee),ft=cr($e.G[4],$e.H[4],ee),re(ee),ft=Jr(S,ft=rr(ft,ee)),ee.h)break;if(Se-x<ft||E-Se<qe)break e;for(at=0;at<qe;++at)h[Se+at]=h[Se+at-ft];for(Se+=qe,V+=qe;V>=S;)V-=S,++$,M!=null&&$<=D&&!($%16)&&M(u,$);if(e(Se<=E),V&xe&&($e=xn(ge,V,$)),ve!=null)for(;_e<Se;)qe=h[_e++],ve.X[(506832829*qe&4294967295)>>>ve.Mb]=qe}else{if(!(qe<Ue))break e;for(We=qe-280,e(ve!=null);_e<Se;)qe=h[_e++],ve.X[(506832829*qe&4294967295)>>>ve.Mb]=qe;qe=Se,e(!(We>>>(ft=ve).Xa)),h[qe]=ft.X[We],We=!0}We||e(ee.h==R(ee))}if(u.Pb&&ee.h&&Se<E)e(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&Ce(u.s.vb,u.s.Wa);else{if(ee.h)break e;M!=null&&M(u,$>D?D:$),u.a=0,u.$=Se-x}return 1}return u.a=3,0}function ur(u){e(u!=null),u.vc=null,u.yc=null,u.Ya=null;var h=u.Wa;h!=null&&(h.X=null),u.vb=null,e(u!=null)}function Or(){var u=new ym;return u==null?null:(u.a=0,u.xb=v1,Vt("Predictor","VP8LPredictors"),Vt("Predictor","VP8LPredictors_C"),Vt("PredictorAdd","VP8LPredictorsAdd"),Vt("PredictorAdd","VP8LPredictorsAdd_C"),Id=He,wo=pe,us=ye,Qr=Ze,ja=Be,Ji=ut,Ki=it,z.VP8LMapColor32b=fl,z.VP8LMapColor8b=Ld,u)}function Hn(u,h,x,S,E){var D=1,M=[u],$=[h],V=S.m,ee=S.s,ge=null,Se=0;e:for(;;){if(x)for(;D&&G(V,1);){var _e=M,we=$,Ue=S,Ee=1,ve=Ue.m,xe=Ue.gc[Ue.ab],$e=G(ve,2);if(Ue.Oc&1<<$e)D=0;else{switch(Ue.Oc|=1<<$e,xe.hc=$e,xe.Ea=_e[0],xe.nc=we[0],xe.K=[null],++Ue.ab,e(4>=Ue.ab),$e){case 0:case 1:xe.b=G(ve,3)+2,Ee=Hn(dt(xe.Ea,xe.b),dt(xe.nc,xe.b),0,Ue,xe.K),xe.K=xe.K[0];break;case 3:var We,qe=G(ve,8)+1,ft=16<qe?0:4<qe?1:2<qe?2:3;if(_e[0]=dt(xe.Ea,ft),xe.b=ft,We=Ee=Hn(qe,1,0,Ue,xe.K)){var at,Ct=qe,ct=xe,sn=1<<(8>>ct.b),ln=a(sn);if(ln==null)We=0;else{var tn=ct.K[0],Kt=ct.w;for(ln[0]=ct.K[0][0],at=1;at<1*Ct;++at)ln[at]=Ge(tn[Kt+at],ln[at-1]);for(;at<4*sn;++at)ln[at]=0;ct.K[0]=null,ct.K[0]=ln,We=1}}Ee=We;break;case 2:break;default:e(0)}D=Ee}}if(M=M[0],$=$[0],D&&G(V,1)&&!(D=1<=(Se=G(V,4))&&11>=Se)){S.a=3;break e}var gn;if(gn=D)t:{var mn,Rt,ir,ds=S,ar=M,hs=$,cn=Se,Cs=x,As=ds.m,xr=ds.s,Pr=[null],es=1,Vs=0,Ti=dw[cn];n:for(;;){if(Cs&&G(As,1)){var yr=G(As,3)+2,ea=dt(ar,yr),ko=dt(hs,yr),xl=ea*ko;if(!Hn(ea,ko,0,ds,Pr))break n;for(Pr=Pr[0],xr.xc=yr,mn=0;mn<xl;++mn){var Aa=Pr[mn]>>8&65535;Pr[mn]=Aa,Aa>=es&&(es=Aa+1)}}if(As.h)break n;for(Rt=0;5>Rt;++Rt){var $n=p1[Rt];!Rt&&0<cn&&($n+=1<<cn),Vs<$n&&(Vs=$n)}var Pm=o(es*Ti,A),k1=es,C1=o(k1,F);if(C1==null)var Vd=null;else e(65536>=k1),Vd=C1;var Wc=a(Vs);if(Vd==null||Wc==null||Pm==null){ds.a=1;break n}var Hd=Pm;for(mn=ir=0;mn<es;++mn){var ci=Vd[mn],yl=ci.G,bl=ci.H,A1=0,Gd=1,P1=0;for(Rt=0;5>Rt;++Rt){$n=p1[Rt],yl[Rt]=Hd,bl[Rt]=ir,!Rt&&0<cn&&($n+=1<<cn);s:{var Wd,Im=$n,Zd=ds,Zc=Wc,Lw=Hd,Tw=ir,Em=0,Pa=Zd.m,zw=G(Pa,1);if(i(Zc,0,0,Im),zw){var Ow=G(Pa,1)+1,Dw=G(Pa,1),I1=G(Pa,Dw==0?1:8);Zc[I1]=1,Ow==2&&(Zc[I1=G(Pa,8)]=1);var Jd=1}else{var E1=a(19),L1=G(Pa,4)+4;if(19<L1){Zd.a=3;var Kd=0;break s}for(Wd=0;Wd<L1;++Wd)E1[cw[Wd]]=G(Pa,3);var Lm=void 0,Jc=void 0,T1=Zd,Mw=E1,Yd=Im,z1=Zc,Tm=0,Ia=T1.m,O1=8,D1=o(128,A);r:for(;I(D1,0,7,Mw,19);){if(G(Ia,1)){var Rw=2+2*G(Ia,3);if((Lm=2+G(Ia,Rw))>Yd)break r}else Lm=Yd;for(Jc=0;Jc<Yd&&Lm--;){re(Ia);var M1=D1[0+(127&O(Ia))];H(Ia,Ia.u+M1.g);var wl=M1.value;if(16>wl)z1[Jc++]=wl,wl!=0&&(O1=wl);else{var Fw=wl==16,R1=wl-16,$w=ow[R1],F1=G(Ia,aw[R1])+$w;if(Jc+F1>Yd)break r;for(var Bw=Fw?O1:0;0<F1--;)z1[Jc++]=Bw}}Tm=1;break r}Tm||(T1.a=3),Jd=Tm}(Jd=Jd&&!Pa.h)&&(Em=I(Lw,Tw,8,Zc,Im)),Jd&&Em!=0?Kd=Em:(Zd.a=3,Kd=0)}if(Kd==0)break n;if(Gd&&lw[Rt]==1&&(Gd=Hd[ir].g==0),A1+=Hd[ir].g,ir+=Kd,3>=Rt){var Kc,zm=Wc[0];for(Kc=1;Kc<$n;++Kc)Wc[Kc]>zm&&(zm=Wc[Kc]);P1+=zm}}if(ci.nd=Gd,ci.Qb=0,Gd&&(ci.qb=(yl[3][bl[3]+0].value<<24|yl[1][bl[1]+0].value<<16|yl[2][bl[2]+0].value)>>>0,A1==0&&256>yl[0][bl[0]+0].value&&(ci.Qb=1,ci.qb+=yl[0][bl[0]+0].value<<8)),ci.jc=!ci.Qb&&6>P1,ci.jc){var Qd,ta=ci;for(Qd=0;Qd<Ar;++Qd){var Ea=Qd,La=ta.pd[Ea],Xd=ta.G[0][ta.H[0]+Ea];256<=Xd.value?(La.g=Xd.g+256,La.value=Xd.value):(La.g=0,La.value=0,Ea>>=Ln(Xd,8,La),Ea>>=Ln(ta.G[1][ta.H[1]+Ea],16,La),Ea>>=Ln(ta.G[2][ta.H[2]+Ea],0,La),Ln(ta.G[3][ta.H[3]+Ea],24,La))}}}xr.vc=Pr,xr.Wb=es,xr.Ya=Vd,xr.yc=Pm,gn=1;break t}gn=0}if(!(D=gn)){S.a=3;break e}if(0<Se){if(ee.ua=1<<Se,!tt(ee.Wa,Se)){S.a=1,D=0;break e}}else ee.ua=0;var Om=S,$1=M,qw=$,Dm=Om.s,Mm=Dm.xc;if(Om.c=$1,Om.i=qw,Dm.md=dt($1,Mm),Dm.wc=Mm==0?-1:(1<<Mm)-1,x){S.xb=yw;break e}if((ge=a(M*$))==null){S.a=1,D=0;break e}D=(D=kr(S,ge,0,M,$,$,null))&&!V.h;break e}return D?(E!=null?E[0]=ge:(e(ge==null),e(x)),S.$=0,x||ur(ee)):ur(ee),D}function Ss(u,h){var x=u.c*u.i,S=x+h+16*h;return e(u.c<=h),u.V=a(S),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+x+h,1)}function ri(u,h){var x=u.C,S=h-x,E=u.V,D=u.Ba+u.c*x;for(e(h<=u.l.o);0<S;){var M=16<S?16:S,$=u.l.ma,V=u.l.width,ee=V*M,ge=$.ca,Se=$.tb+V*x,_e=u.Ta,we=u.Ua;_r(u,M,E,D),Wn(_e,we,ge,Se,ee),zr($,x,x+M,ge,Se,V),S-=M,E+=M*u.c,x+=M}e(x==h),u.C=u.Ma=h}function si(){this.ub=this.yd=this.td=this.Rb=0}function ki(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ci(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function pa(){this.Yb=function(){var u=[];return function h(x,S,E){for(var D=E[S],M=0;M<D&&(x.push(E.length>S+1?[]:0),!(E.length<S+1));M++)h(x[M],S+1,E)}(u,0,[3,11]),u}()}function po(){this.jb=a(3),this.Wc=l([4,8],pa),this.Xc=l([4,17],pa)}function ga(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function U(){this.ld=this.La=this.dd=this.tc=0}function Pe(){this.Na=this.la=0}function Te(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Xe(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function jt(){this.uc=this.M=this.Nb=0,this.wa=Array(new U),this.Y=0,this.ya=Array(new Xe),this.aa=0,this.l=new on}function At(){this.y=a(16),this.f=a(8),this.ea=a(8)}function qt(){this.cb=this.a=0,this.sc="",this.m=new de,this.Od=new si,this.Kc=new ki,this.ed=new ga,this.Qa=new Ci,this.Ic=this.$c=this.Aa=0,this.D=new jt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,de),this.ia=0,this.pb=o(4,Te),this.Pa=new po,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new At),this.Hd=0,this.rb=Array(new Pe),this.sb=0,this.wa=Array(new U),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Xe),this.L=this.aa=0,this.gd=l([4,2],U),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function on(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Kr(){var u=new qt;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,Hc||(Hc=Ai)),u}function rn(u,h,x){return u.a==0&&(u.a=h,u.sc=x,u.cb=0),0}function Gi(u,h,x){return 3<=x&&u[h+0]==157&&u[h+1]==1&&u[h+2]==42}function Ms(u,h){if(u==null)return 0;if(u.a=0,u.sc="OK",h==null)return rn(u,2,"null VP8Io passed to VP8GetHeaders()");var x=h.data,S=h.w,E=h.ha;if(4>E)return rn(u,7,"Truncated header.");var D=x[S+0]|x[S+1]<<8|x[S+2]<<16,M=u.Od;if(M.Rb=!(1&D),M.td=D>>1&7,M.yd=D>>4&1,M.ub=D>>5,3<M.td)return rn(u,3,"Incorrect keyframe parameters.");if(!M.yd)return rn(u,4,"Frame not displayable.");S+=3,E-=3;var $=u.Kc;if(M.Rb){if(7>E)return rn(u,7,"cannot parse picture header");if(!Gi(x,S,E))return rn(u,3,"Bad code word");$.c=16383&(x[S+4]<<8|x[S+3]),$.Td=x[S+4]>>6,$.i=16383&(x[S+6]<<8|x[S+5]),$.Ud=x[S+6]>>6,S+=7,E-=7,u.za=$.c+15>>4,u.Ub=$.i+15>>4,h.width=$.c,h.height=$.i,h.Da=0,h.j=0,h.v=0,h.va=h.width,h.o=h.height,h.da=0,h.ib=h.width,h.hb=h.height,h.U=h.width,h.T=h.height,i((D=u.Pa).jb,0,255,D.jb.length),e((D=u.Qa)!=null),D.Cb=0,D.Bb=0,D.Fb=1,i(D.Zb,0,0,D.Zb.length),i(D.Lb,0,0,D.Lb)}if(M.ub>E)return rn(u,7,"bad partition length");ne(D=u.m,x,S,M.ub),S+=M.ub,E-=M.ub,M.Rb&&($.Ld=fe(D),$.Kd=fe(D)),$=u.Qa;var V,ee=u.Pa;if(e(D!=null),e($!=null),$.Cb=fe(D),$.Cb){if($.Bb=fe(D),fe(D)){for($.Fb=fe(D),V=0;4>V;++V)$.Zb[V]=fe(D)?ue(D,7):0;for(V=0;4>V;++V)$.Lb[V]=fe(D)?ue(D,6):0}if($.Bb)for(V=0;3>V;++V)ee.jb[V]=fe(D)?W(D,8):255}else $.Bb=0;if(D.Ka)return rn(u,3,"cannot parse segment header");if(($=u.ed).zd=fe(D),$.Tb=W(D,6),$.wb=W(D,3),$.Pc=fe(D),$.Pc&&fe(D)){for(ee=0;4>ee;++ee)fe(D)&&($.vd[ee]=ue(D,6));for(ee=0;4>ee;++ee)fe(D)&&($.od[ee]=ue(D,6))}if(u.L=$.Tb==0?0:$.zd?1:2,D.Ka)return rn(u,3,"cannot parse filter header");var ge=E;if(E=V=S,S=V+ge,$=ge,u.Xb=(1<<W(u.m,2))-1,ge<3*(ee=u.Xb))x=7;else{for(V+=3*ee,$-=3*ee,ge=0;ge<ee;++ge){var Se=x[E+0]|x[E+1]<<8|x[E+2]<<16;Se>$&&(Se=$),ne(u.Jc[+ge],x,V,Se),V+=Se,$-=Se,E+=3}ne(u.Jc[+ee],x,V,$),x=V<S?0:5}if(x!=0)return rn(u,x,"cannot parse partitions");for(x=W(V=u.m,7),E=fe(V)?ue(V,4):0,S=fe(V)?ue(V,4):0,$=fe(V)?ue(V,4):0,ee=fe(V)?ue(V,4):0,V=fe(V)?ue(V,4):0,ge=u.Qa,Se=0;4>Se;++Se){if(ge.Cb){var _e=ge.Zb[Se];ge.Fb||(_e+=x)}else{if(0<Se){u.pb[Se]=u.pb[0];continue}_e=x}var we=u.pb[Se];we.Sc[0]=km[_s(_e+E,127)],we.Sc[1]=Cm[_s(_e+0,127)],we.Eb[0]=2*km[_s(_e+S,127)],we.Eb[1]=101581*Cm[_s(_e+$,127)]>>16,8>we.Eb[1]&&(we.Eb[1]=8),we.Qc[0]=km[_s(_e+ee,117)],we.Qc[1]=Cm[_s(_e+V,127)],we.lc=_e+V}if(!M.Rb)return rn(u,4,"Not a key frame.");for(fe(D),M=u.Pa,x=0;4>x;++x){for(E=0;8>E;++E)for(S=0;3>S;++S)for($=0;11>$;++$)ee=be(D,vw[x][E][S][$])?W(D,8):pw[x][E][S][$],M.Wc[x][E].Yb[S][$]=ee;for(E=0;17>E;++E)M.Xc[x][E]=M.Wc[x][xw[E]]}return u.kc=fe(D),u.kc&&(u.Bd=W(D,8)),u.cb=1}function Ai(u,h,x,S,E,D,M){var $=h[E].Yb[x];for(x=0;16>E;++E){if(!be(u,$[x+0]))return E;for(;!be(u,$[x+1]);)if($=h[++E].Yb[0],x=0,E==16)return 16;var V=h[E+1].Yb;if(be(u,$[x+2])){var ee=u,ge=0;if(be(ee,(_e=$)[(Se=x)+3]))if(be(ee,_e[Se+6])){for($=0,Se=2*(ge=be(ee,_e[Se+8]))+(_e=be(ee,_e[Se+9+ge])),ge=0,_e=fw[Se];_e[$];++$)ge+=ge+be(ee,_e[$]);ge+=3+(8<<Se)}else be(ee,_e[Se+7])?(ge=7+2*be(ee,165),ge+=be(ee,145)):ge=5+be(ee,159);else ge=be(ee,_e[Se+4])?3+be(ee,_e[Se+5]):2;$=V[2]}else ge=1,$=V[1];V=M+mw[E],0>(ee=u).b&&oe(ee);var Se,_e=ee.b,we=(Se=ee.Ca>>1)-(ee.I>>_e)>>31;--ee.b,ee.Ca+=we,ee.Ca|=1,ee.I-=(Se+1&we)<<_e,D[V]=((ge^we)-we)*S[(0<E)+0]}return 16}function ii(u){var h=u.rb[u.sb-1];h.la=0,h.Na=0,i(u.zc,0,0,u.zc.length),u.ja=0}function tl(u,h){if(u==null)return 0;if(h==null)return rn(u,2,"NULL VP8Io parameter in VP8Decode().");if(!u.cb&&!Ms(u,h))return 0;if(e(u.cb),h.ac==null||h.ac(h)){h.ob&&(u.L=0);var x=Ud[u.L];if(u.L==2?(u.yb=0,u.zb=0):(u.yb=h.v-x>>4,u.zb=h.j-x>>4,0>u.yb&&(u.yb=0),0>u.zb&&(u.zb=0)),u.Va=h.o+15+x>>4,u.Hb=h.va+15+x>>4,u.Hb>u.za&&(u.Hb=u.za),u.Va>u.Ub&&(u.Va=u.Ub),0<u.L){var S=u.ed;for(x=0;4>x;++x){var E;if(u.Qa.Cb){var D=u.Qa.Lb[x];u.Qa.Fb||(D+=S.Tb)}else D=S.Tb;for(E=0;1>=E;++E){var M=u.gd[x][E],$=D;if(S.Pc&&($+=S.vd[0],E&&($+=S.od[0])),0<($=0>$?0:63<$?63:$)){var V=$;0<S.wb&&(V=4<S.wb?V>>2:V>>1)>9-S.wb&&(V=9-S.wb),1>V&&(V=1),M.dd=V,M.tc=2*$+V,M.ld=40<=$?2:15<=$?1:0}else M.tc=0;M.La=E}}}x=0}else rn(u,6,"Frame setup failed"),x=u.a;if(x=x==0){if(x){u.$c=0,0<u.Aa||(u.Ic=Ew);e:{x=u.Ic,S=4*(V=u.za);var ee=32*V,ge=V+1,Se=0<u.L?V*(0<u.Aa?2:1):0,_e=(u.Aa==2?2:1)*V;if((M=S+832+(E=3*(16*x+Ud[u.L])/2*ee)+(D=u.Fa!=null&&0<u.Fa.length?u.Kc.c*u.Kc.i:0))!=M)x=0;else{if(M>u.Vb){if(u.Vb=0,u.Ec=a(M),u.Fc=0,u.Ec==null){x=rn(u,1,"no memory during frame initialization.");break e}u.Vb=M}M=u.Ec,$=u.Fc,u.Ac=M,u.Bc=$,$+=S,u.Gd=o(ee,At),u.Hd=0,u.rb=o(ge+1,Pe),u.sb=1,u.wa=Se?o(Se,U):null,u.Y=0,u.D.Nb=0,u.D.wa=u.wa,u.D.Y=u.Y,0<u.Aa&&(u.D.Y+=V),e(!0),u.oc=M,u.pc=$,$+=832,u.ya=o(_e,Xe),u.aa=0,u.D.ya=u.ya,u.D.aa=u.aa,u.Aa==2&&(u.D.aa+=V),u.R=16*V,u.B=8*V,V=(ee=Ud[u.L])*u.R,ee=ee/2*u.B,u.sa=M,u.ta=$+V,u.qa=u.sa,u.ra=u.ta+16*x*u.R+ee,u.Ha=u.qa,u.Ia=u.ra+8*x*u.B+ee,u.$c=0,$+=E,u.mb=D?M:null,u.nb=D?$:null,e($+D<=u.Fc+u.Vb),ii(u),i(u.Ac,u.Bc,0,S),x=1}}if(x){if(h.ka=0,h.y=u.sa,h.O=u.ta,h.f=u.qa,h.N=u.ra,h.ea=u.Ha,h.Vd=u.Ia,h.fa=u.R,h.Rc=u.B,h.F=null,h.J=0,!zd){for(x=-255;255>=x;++x)dr[255+x]=0>x?-x:x;for(x=-1020;1020>=x;++x)Qi[1020+x]=-128>x?-128:127<x?127:x;for(x=-112;112>=x;++x)Vc[112+x]=-16>x?-16:15<x?15:x;for(x=-255;510>=x;++x)vl[255+x]=0>x?0:255<x?255:x;zd=1}ml=kt,Yi=Y,Bc=Ie,Xr=Ye,Fs=zt,Gn=go,pl=Ac,Td=yo,qc=xm,No=Pc,jo=vm,Sa=il,So=Ic,gl=Cd,_o=kd,_a=Ei,Uc=Zi,$s=gm,li[0]=Ii,li[1]=Wt,li[2]=um,li[3]=dm,li[4]=wd,li[5]=rl,li[6]=Nd,li[7]=_c,li[8]=fm,li[9]=hm,ka[0]=nl,ka[1]=Pi,ka[2]=en,ka[3]=Yr,ka[4]=Dr,ka[5]=cm,ka[6]=bd,Xi[0]=ya,Xi[1]=Tn,Xi[2]=mm,Xi[3]=kc,Xi[4]=xo,Xi[5]=pm,Xi[6]=Cc,x=1}else x=0}x&&(x=function(we,Ue){for(we.M=0;we.M<we.Va;++we.M){var Ee,ve=we.Jc[we.M&we.Xb],xe=we.m,$e=we;for(Ee=0;Ee<$e.za;++Ee){var We=xe,qe=$e,ft=qe.Ac,at=qe.Bc+4*Ee,Ct=qe.zc,ct=qe.ya[qe.aa+Ee];if(qe.Qa.Bb?ct.$b=be(We,qe.Pa.jb[0])?2+be(We,qe.Pa.jb[2]):be(We,qe.Pa.jb[1]):ct.$b=0,qe.kc&&(ct.Ad=be(We,qe.Bd)),ct.Za=!be(We,145)+0,ct.Za){var sn=ct.Ob,ln=0;for(qe=0;4>qe;++qe){var tn,Kt=Ct[0+qe];for(tn=0;4>tn;++tn){Kt=gw[ft[at+tn]][Kt];for(var gn=g1[be(We,Kt[0])];0<gn;)gn=g1[2*gn+be(We,Kt[gn])];Kt=-gn,ft[at+tn]=Kt}r(sn,ln,ft,at,4),ln+=4,Ct[0+qe]=Kt}}else Kt=be(We,156)?be(We,128)?1:3:be(We,163)?2:0,ct.Ob[0]=Kt,i(ft,at,Kt,4),i(Ct,0,Kt,4);ct.Dd=be(We,142)?be(We,114)?be(We,183)?1:3:2:0}if($e.m.Ka)return rn(we,7,"Premature end-of-partition0 encountered.");for(;we.ja<we.za;++we.ja){if($e=ve,We=(xe=we).rb[xe.sb-1],ft=xe.rb[xe.sb+xe.ja],Ee=xe.ya[xe.aa+xe.ja],at=xe.kc?Ee.Ad:0)We.la=ft.la=0,Ee.Za||(We.Na=ft.Na=0),Ee.Hc=0,Ee.Gc=0,Ee.ia=0;else{var mn,Rt;if(We=ft,ft=$e,at=xe.Pa.Xc,Ct=xe.ya[xe.aa+xe.ja],ct=xe.pb[Ct.$b],qe=Ct.ad,sn=0,ln=xe.rb[xe.sb-1],Kt=tn=0,i(qe,sn,0,384),Ct.Za)var ir=0,ds=at[3];else{gn=a(16);var ar=We.Na+ln.Na;if(ar=Hc(ft,at[1],ar,ct.Eb,0,gn,0),We.Na=ln.Na=(0<ar)+0,1<ar)ml(gn,0,qe,sn);else{var hs=gn[0]+3>>3;for(gn=0;256>gn;gn+=16)qe[sn+gn]=hs}ir=1,ds=at[0]}var cn=15&We.la,Cs=15&ln.la;for(gn=0;4>gn;++gn){var As=1&Cs;for(hs=Rt=0;4>hs;++hs)cn=cn>>1|(As=(ar=Hc(ft,ds,ar=As+(1&cn),ct.Sc,ir,qe,sn))>ir)<<7,Rt=Rt<<2|(3<ar?3:1<ar?2:qe[sn+0]!=0),sn+=16;cn>>=4,Cs=Cs>>1|As<<7,tn=(tn<<8|Rt)>>>0}for(ds=cn,ir=Cs>>4,mn=0;4>mn;mn+=2){for(Rt=0,cn=We.la>>4+mn,Cs=ln.la>>4+mn,gn=0;2>gn;++gn){for(As=1&Cs,hs=0;2>hs;++hs)ar=As+(1&cn),cn=cn>>1|(As=0<(ar=Hc(ft,at[2],ar,ct.Qc,0,qe,sn)))<<3,Rt=Rt<<2|(3<ar?3:1<ar?2:qe[sn+0]!=0),sn+=16;cn>>=2,Cs=Cs>>1|As<<5}Kt|=Rt<<4*mn,ds|=cn<<4<<mn,ir|=(240&Cs)<<mn}We.la=ds,ln.la=ir,Ct.Hc=tn,Ct.Gc=Kt,Ct.ia=43690&Kt?0:ct.ia,at=!(tn|Kt)}if(0<xe.L&&(xe.wa[xe.Y+xe.ja]=xe.gd[Ee.$b][Ee.Za],xe.wa[xe.Y+xe.ja].La|=!at),$e.Ka)return rn(we,7,"Premature end-of-file encountered.")}if(ii(we),xe=Ue,$e=1,Ee=(ve=we).D,We=0<ve.L&&ve.M>=ve.zb&&ve.M<=ve.Va,ve.Aa==0)e:{if(Ee.M=ve.M,Ee.uc=We,Dc(ve,Ee),$e=1,Ee=(Rt=ve.D).Nb,We=(Kt=Ud[ve.L])*ve.R,ft=Kt/2*ve.B,gn=16*Ee*ve.R,hs=8*Ee*ve.B,at=ve.sa,Ct=ve.ta-We+gn,ct=ve.qa,qe=ve.ra-ft+hs,sn=ve.Ha,ln=ve.Ia-ft+hs,Cs=(cn=Rt.M)==0,tn=cn>=ve.Va-1,ve.Aa==2&&Dc(ve,Rt),Rt.uc)for(As=(ar=ve).D.M,e(ar.D.uc),Rt=ar.yb;Rt<ar.Hb;++Rt){ir=Rt,ds=As;var xr=(Pr=($n=ar).D).Nb;mn=$n.R;var Pr=Pr.wa[Pr.Y+ir],es=$n.sa,Vs=$n.ta+16*xr*mn+16*ir,Ti=Pr.dd,yr=Pr.tc;if(yr!=0)if(e(3<=yr),$n.L==1)0<ir&&_a(es,Vs,mn,yr+4),Pr.La&&$s(es,Vs,mn,yr),0<ds&&_o(es,Vs,mn,yr+4),Pr.La&&Uc(es,Vs,mn,yr);else{var ea=$n.B,ko=$n.qa,xl=$n.ra+8*xr*ea+8*ir,Aa=$n.Ha,$n=$n.Ia+8*xr*ea+8*ir;xr=Pr.ld,0<ir&&(Td(es,Vs,mn,yr+4,Ti,xr),No(ko,xl,Aa,$n,ea,yr+4,Ti,xr)),Pr.La&&(Sa(es,Vs,mn,yr,Ti,xr),gl(ko,xl,Aa,$n,ea,yr,Ti,xr)),0<ds&&(pl(es,Vs,mn,yr+4,Ti,xr),qc(ko,xl,Aa,$n,ea,yr+4,Ti,xr)),Pr.La&&(jo(es,Vs,mn,yr,Ti,xr),So(ko,xl,Aa,$n,ea,yr,Ti,xr))}}if(ve.ia&&alert("todo:DitherRow"),xe.put!=null){if(Rt=16*cn,cn=16*(cn+1),Cs?(xe.y=ve.sa,xe.O=ve.ta+gn,xe.f=ve.qa,xe.N=ve.ra+hs,xe.ea=ve.Ha,xe.W=ve.Ia+hs):(Rt-=Kt,xe.y=at,xe.O=Ct,xe.f=ct,xe.N=qe,xe.ea=sn,xe.W=ln),tn||(cn-=Kt),cn>xe.o&&(cn=xe.o),xe.F=null,xe.J=null,ve.Fa!=null&&0<ve.Fa.length&&Rt<cn&&(xe.J=zc(ve,xe,Rt,cn-Rt),xe.F=ve.mb,xe.F==null&&xe.F.length==0)){$e=rn(ve,3,"Could not decode alpha data.");break e}Rt<xe.j&&(Kt=xe.j-Rt,Rt=xe.j,e(!(1&Kt)),xe.O+=ve.R*Kt,xe.N+=ve.B*(Kt>>1),xe.W+=ve.B*(Kt>>1),xe.F!=null&&(xe.J+=xe.width*Kt)),Rt<cn&&(xe.O+=xe.v,xe.N+=xe.v>>1,xe.W+=xe.v>>1,xe.F!=null&&(xe.J+=xe.v),xe.ka=Rt-xe.j,xe.U=xe.va-xe.v,xe.T=cn-Rt,$e=xe.put(xe))}Ee+1!=ve.Ic||tn||(r(ve.sa,ve.ta-We,at,Ct+16*ve.R,We),r(ve.qa,ve.ra-ft,ct,qe+8*ve.B,ft),r(ve.Ha,ve.Ia-ft,sn,ln+8*ve.B,ft))}if(!$e)return rn(we,6,"Output aborted.")}return 1}(u,h)),h.bc!=null&&h.bc(h),x&=1}return x?(u.cb=0,x):0}function ls(u,h,x,S,E){E=u[h+x+32*S]+(E>>3),u[h+x+32*S]=-256&E?0>E?0:255:E}function Wi(u,h,x,S,E,D){ls(u,h,0,x,S+E),ls(u,h,1,x,S+D),ls(u,h,2,x,S-D),ls(u,h,3,x,S-E)}function Cr(u){return(20091*u>>16)+u}function va(u,h,x,S){var E,D=0,M=a(16);for(E=0;4>E;++E){var $=u[h+0]+u[h+8],V=u[h+0]-u[h+8],ee=(35468*u[h+4]>>16)-Cr(u[h+12]),ge=Cr(u[h+4])+(35468*u[h+12]>>16);M[D+0]=$+ge,M[D+1]=V+ee,M[D+2]=V-ee,M[D+3]=$-ge,D+=4,h++}for(E=D=0;4>E;++E)$=(u=M[D+0]+4)+M[D+8],V=u-M[D+8],ee=(35468*M[D+4]>>16)-Cr(M[D+12]),ls(x,S,0,0,$+(ge=Cr(M[D+4])+(35468*M[D+12]>>16))),ls(x,S,1,0,V+ee),ls(x,S,2,0,V-ee),ls(x,S,3,0,$-ge),D++,S+=32}function go(u,h,x,S){var E=u[h+0]+4,D=35468*u[h+4]>>16,M=Cr(u[h+4]),$=35468*u[h+1]>>16;Wi(x,S,0,E+M,u=Cr(u[h+1]),$),Wi(x,S,1,E+D,u,$),Wi(x,S,2,E-D,u,$),Wi(x,S,3,E-M,u,$)}function Y(u,h,x,S,E){va(u,h,x,S),E&&va(u,h+16,x,S+4)}function Ie(u,h,x,S){Yi(u,h+0,x,S,1),Yi(u,h+32,x,S+128,1)}function Ye(u,h,x,S){var E;for(u=u[h+0]+4,E=0;4>E;++E)for(h=0;4>h;++h)ls(x,S,h,E,u)}function zt(u,h,x,S){u[h+0]&&Xr(u,h+0,x,S),u[h+16]&&Xr(u,h+16,x,S+4),u[h+32]&&Xr(u,h+32,x,S+128),u[h+48]&&Xr(u,h+48,x,S+128+4)}function kt(u,h,x,S){var E,D=a(16);for(E=0;4>E;++E){var M=u[h+0+E]+u[h+12+E],$=u[h+4+E]+u[h+8+E],V=u[h+4+E]-u[h+8+E],ee=u[h+0+E]-u[h+12+E];D[0+E]=M+$,D[8+E]=M-$,D[4+E]=ee+V,D[12+E]=ee-V}for(E=0;4>E;++E)M=(u=D[0+4*E]+3)+D[3+4*E],$=D[1+4*E]+D[2+4*E],V=D[1+4*E]-D[2+4*E],ee=u-D[3+4*E],x[S+0]=M+$>>3,x[S+16]=ee+V>>3,x[S+32]=M-$>>3,x[S+48]=ee-V>>3,S+=64}function Lt(u,h,x){var S,E=h-32,D=ks,M=255-u[E-1];for(S=0;S<x;++S){var $,V=D,ee=M+u[h-1];for($=0;$<x;++$)u[h+$]=V[ee+u[E+$]];h+=32}}function Wt(u,h){Lt(u,h,4)}function Tn(u,h){Lt(u,h,8)}function Pi(u,h){Lt(u,h,16)}function en(u,h){var x;for(x=0;16>x;++x)r(u,h+32*x,u,h-32,16)}function Yr(u,h){var x;for(x=16;0<x;--x)i(u,h,u[h-1],16),h+=32}function xa(u,h,x){var S;for(S=0;16>S;++S)i(h,x+32*S,u,16)}function nl(u,h){var x,S=16;for(x=0;16>x;++x)S+=u[h-1+32*x]+u[h+x-32];xa(S>>5,u,h)}function Dr(u,h){var x,S=8;for(x=0;16>x;++x)S+=u[h-1+32*x];xa(S>>4,u,h)}function cm(u,h){var x,S=8;for(x=0;16>x;++x)S+=u[h+x-32];xa(S>>4,u,h)}function bd(u,h){xa(128,u,h)}function Tt(u,h,x){return u+2*h+x+2>>2}function um(u,h){var x,S=h-32;for(S=new Uint8Array([Tt(u[S-1],u[S+0],u[S+1]),Tt(u[S+0],u[S+1],u[S+2]),Tt(u[S+1],u[S+2],u[S+3]),Tt(u[S+2],u[S+3],u[S+4])]),x=0;4>x;++x)r(u,h+32*x,S,0,S.length)}function dm(u,h){var x=u[h-1],S=u[h-1+32],E=u[h-1+64],D=u[h-1+96];ze(u,h+0,16843009*Tt(u[h-1-32],x,S)),ze(u,h+32,16843009*Tt(x,S,E)),ze(u,h+64,16843009*Tt(S,E,D)),ze(u,h+96,16843009*Tt(E,D,D))}function Ii(u,h){var x,S=4;for(x=0;4>x;++x)S+=u[h+x-32]+u[h-1+32*x];for(S>>=3,x=0;4>x;++x)i(u,h+32*x,S,4)}function wd(u,h){var x=u[h-1+0],S=u[h-1+32],E=u[h-1+64],D=u[h-1-32],M=u[h+0-32],$=u[h+1-32],V=u[h+2-32],ee=u[h+3-32];u[h+0+96]=Tt(S,E,u[h-1+96]),u[h+1+96]=u[h+0+64]=Tt(x,S,E),u[h+2+96]=u[h+1+64]=u[h+0+32]=Tt(D,x,S),u[h+3+96]=u[h+2+64]=u[h+1+32]=u[h+0+0]=Tt(M,D,x),u[h+3+64]=u[h+2+32]=u[h+1+0]=Tt($,M,D),u[h+3+32]=u[h+2+0]=Tt(V,$,M),u[h+3+0]=Tt(ee,V,$)}function Nd(u,h){var x=u[h+1-32],S=u[h+2-32],E=u[h+3-32],D=u[h+4-32],M=u[h+5-32],$=u[h+6-32],V=u[h+7-32];u[h+0+0]=Tt(u[h+0-32],x,S),u[h+1+0]=u[h+0+32]=Tt(x,S,E),u[h+2+0]=u[h+1+32]=u[h+0+64]=Tt(S,E,D),u[h+3+0]=u[h+2+32]=u[h+1+64]=u[h+0+96]=Tt(E,D,M),u[h+3+32]=u[h+2+64]=u[h+1+96]=Tt(D,M,$),u[h+3+64]=u[h+2+96]=Tt(M,$,V),u[h+3+96]=Tt($,V,V)}function rl(u,h){var x=u[h-1+0],S=u[h-1+32],E=u[h-1+64],D=u[h-1-32],M=u[h+0-32],$=u[h+1-32],V=u[h+2-32],ee=u[h+3-32];u[h+0+0]=u[h+1+64]=D+M+1>>1,u[h+1+0]=u[h+2+64]=M+$+1>>1,u[h+2+0]=u[h+3+64]=$+V+1>>1,u[h+3+0]=V+ee+1>>1,u[h+0+96]=Tt(E,S,x),u[h+0+64]=Tt(S,x,D),u[h+0+32]=u[h+1+96]=Tt(x,D,M),u[h+1+32]=u[h+2+96]=Tt(D,M,$),u[h+2+32]=u[h+3+96]=Tt(M,$,V),u[h+3+32]=Tt($,V,ee)}function _c(u,h){var x=u[h+0-32],S=u[h+1-32],E=u[h+2-32],D=u[h+3-32],M=u[h+4-32],$=u[h+5-32],V=u[h+6-32],ee=u[h+7-32];u[h+0+0]=x+S+1>>1,u[h+1+0]=u[h+0+64]=S+E+1>>1,u[h+2+0]=u[h+1+64]=E+D+1>>1,u[h+3+0]=u[h+2+64]=D+M+1>>1,u[h+0+32]=Tt(x,S,E),u[h+1+32]=u[h+0+96]=Tt(S,E,D),u[h+2+32]=u[h+1+96]=Tt(E,D,M),u[h+3+32]=u[h+2+96]=Tt(D,M,$),u[h+3+64]=Tt(M,$,V),u[h+3+96]=Tt($,V,ee)}function hm(u,h){var x=u[h-1+0],S=u[h-1+32],E=u[h-1+64],D=u[h-1+96];u[h+0+0]=x+S+1>>1,u[h+2+0]=u[h+0+32]=S+E+1>>1,u[h+2+32]=u[h+0+64]=E+D+1>>1,u[h+1+0]=Tt(x,S,E),u[h+3+0]=u[h+1+32]=Tt(S,E,D),u[h+3+32]=u[h+1+64]=Tt(E,D,D),u[h+3+64]=u[h+2+64]=u[h+0+96]=u[h+1+96]=u[h+2+96]=u[h+3+96]=D}function fm(u,h){var x=u[h-1+0],S=u[h-1+32],E=u[h-1+64],D=u[h-1+96],M=u[h-1-32],$=u[h+0-32],V=u[h+1-32],ee=u[h+2-32];u[h+0+0]=u[h+2+32]=x+M+1>>1,u[h+0+32]=u[h+2+64]=S+x+1>>1,u[h+0+64]=u[h+2+96]=E+S+1>>1,u[h+0+96]=D+E+1>>1,u[h+3+0]=Tt($,V,ee),u[h+2+0]=Tt(M,$,V),u[h+1+0]=u[h+3+32]=Tt(x,M,$),u[h+1+32]=u[h+3+64]=Tt(S,x,M),u[h+1+64]=u[h+3+96]=Tt(E,S,x),u[h+1+96]=Tt(D,E,S)}function mm(u,h){var x;for(x=0;8>x;++x)r(u,h+32*x,u,h-32,8)}function kc(u,h){var x;for(x=0;8>x;++x)i(u,h,u[h-1],8),h+=32}function vo(u,h,x){var S;for(S=0;8>S;++S)i(h,x+32*S,u,8)}function ya(u,h){var x,S=8;for(x=0;8>x;++x)S+=u[h+x-32]+u[h-1+32*x];vo(S>>4,u,h)}function pm(u,h){var x,S=4;for(x=0;8>x;++x)S+=u[h+x-32];vo(S>>3,u,h)}function xo(u,h){var x,S=4;for(x=0;8>x;++x)S+=u[h-1+32*x];vo(S>>3,u,h)}function Cc(u,h){vo(128,u,h)}function sl(u,h,x){var S=u[h-x],E=u[h+0],D=3*(E-S)+wm[1020+u[h-2*x]-u[h+x]],M=Od[112+(D+4>>3)];u[h-x]=ks[255+S+Od[112+(D+3>>3)]],u[h+0]=ks[255+E-M]}function jd(u,h,x,S){var E=u[h+0],D=u[h+x];return qs[255+u[h-2*x]-u[h-x]]>S||qs[255+D-E]>S}function Sd(u,h,x,S){return 4*qs[255+u[h-x]-u[h+0]]+qs[255+u[h-2*x]-u[h+x]]<=S}function _d(u,h,x,S,E){var D=u[h-3*x],M=u[h-2*x],$=u[h-x],V=u[h+0],ee=u[h+x],ge=u[h+2*x],Se=u[h+3*x];return 4*qs[255+$-V]+qs[255+M-ee]>S?0:qs[255+u[h-4*x]-D]<=E&&qs[255+D-M]<=E&&qs[255+M-$]<=E&&qs[255+Se-ge]<=E&&qs[255+ge-ee]<=E&&qs[255+ee-V]<=E}function kd(u,h,x,S){var E=2*S+1;for(S=0;16>S;++S)Sd(u,h+S,x,E)&&sl(u,h+S,x)}function Ei(u,h,x,S){var E=2*S+1;for(S=0;16>S;++S)Sd(u,h+S*x,1,E)&&sl(u,h+S*x,1)}function Zi(u,h,x,S){var E;for(E=3;0<E;--E)kd(u,h+=4*x,x,S)}function gm(u,h,x,S){var E;for(E=3;0<E;--E)Ei(u,h+=4,x,S)}function ba(u,h,x,S,E,D,M,$){for(D=2*D+1;0<E--;){if(_d(u,h,x,D,M))if(jd(u,h,x,$))sl(u,h,x);else{var V=u,ee=h,ge=x,Se=V[ee-2*ge],_e=V[ee-ge],we=V[ee+0],Ue=V[ee+ge],Ee=V[ee+2*ge],ve=27*($e=wm[1020+3*(we-_e)+wm[1020+Se-Ue]])+63>>7,xe=18*$e+63>>7,$e=9*$e+63>>7;V[ee-3*ge]=ks[255+V[ee-3*ge]+$e],V[ee-2*ge]=ks[255+Se+xe],V[ee-ge]=ks[255+_e+ve],V[ee+0]=ks[255+we-ve],V[ee+ge]=ks[255+Ue-xe],V[ee+2*ge]=ks[255+Ee-$e]}h+=S}}function ai(u,h,x,S,E,D,M,$){for(D=2*D+1;0<E--;){if(_d(u,h,x,D,M))if(jd(u,h,x,$))sl(u,h,x);else{var V=u,ee=h,ge=x,Se=V[ee-ge],_e=V[ee+0],we=V[ee+ge],Ue=Od[112+((Ee=3*(_e-Se))+4>>3)],Ee=Od[112+(Ee+3>>3)],ve=Ue+1>>1;V[ee-2*ge]=ks[255+V[ee-2*ge]+ve],V[ee-ge]=ks[255+Se+Ee],V[ee+0]=ks[255+_e-Ue],V[ee+ge]=ks[255+we-ve]}h+=S}}function Ac(u,h,x,S,E,D){ba(u,h,x,1,16,S,E,D)}function yo(u,h,x,S,E,D){ba(u,h,1,x,16,S,E,D)}function vm(u,h,x,S,E,D){var M;for(M=3;0<M;--M)ai(u,h+=4*x,x,1,16,S,E,D)}function il(u,h,x,S,E,D){var M;for(M=3;0<M;--M)ai(u,h+=4,1,x,16,S,E,D)}function xm(u,h,x,S,E,D,M,$){ba(u,h,E,1,8,D,M,$),ba(x,S,E,1,8,D,M,$)}function Pc(u,h,x,S,E,D,M,$){ba(u,h,1,E,8,D,M,$),ba(x,S,1,E,8,D,M,$)}function Ic(u,h,x,S,E,D,M,$){ai(u,h+4*E,E,1,8,D,M,$),ai(x,S+4*E,E,1,8,D,M,$)}function Cd(u,h,x,S,E,D,M,$){ai(u,h+4,1,E,8,D,M,$),ai(x,S+4,1,E,8,D,M,$)}function al(){this.ba=new wt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Et,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ec(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Lc(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ad(){this.ua=0,this.Wa=new ie,this.vb=new ie,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new F,this.yc=new A}function ym(){this.xb=this.a=0,this.l=new on,this.ca=new wt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new w,this.Pb=0,this.wd=new w,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ad,this.ab=0,this.gc=o(4,Lc),this.Oc=0}function ol(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new on,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function bo(u,h,x,S,E,D,M){for(u=u==null?0:u[h+0],h=0;h<M;++h)E[D+h]=u+x[S+h]&255,u=E[D+h]}function Tc(u,h,x,S,E,D,M){var $;if(u==null)bo(null,null,x,S,E,D,M);else for($=0;$<M;++$)E[D+$]=u[h+$]+x[S+$]&255}function wa(u,h,x,S,E,D,M){if(u==null)bo(null,null,x,S,E,D,M);else{var $,V=u[h+0],ee=V,ge=V;for($=0;$<M;++$)ee=ge+(V=u[h+$])-ee,ge=x[S+$]+(-256&ee?0>ee?0:255:ee)&255,ee=V,E[D+$]=ge}}function zc(u,h,x,S){var E=h.width,D=h.o;if(e(u!=null&&h!=null),0>x||0>=S||x+S>D)return null;if(!u.Cc){if(u.ga==null){var M;if(u.ga=new ol,(M=u.ga==null)||(M=h.width*h.o,e(u.Gb.length==0),u.Gb=a(M),u.Uc=0,u.Gb==null?M=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,M=1),M=!M),!M){M=u.ga;var $=u.Fa,V=u.P,ee=u.qc,ge=u.mb,Se=u.nb,_e=V+1,we=ee-1,Ue=M.l;if(e($!=null&&ge!=null&&h!=null),Ca[0]=null,Ca[1]=bo,Ca[2]=Tc,Ca[3]=wa,M.ca=ge,M.tb=Se,M.c=h.width,M.i=h.height,e(0<M.c&&0<M.i),1>=ee)h=0;else if(M.$a=$[V+0]>>0&3,M.Z=$[V+0]>>2&3,M.Lc=$[V+0]>>4&3,V=$[V+0]>>6&3,0>M.$a||1<M.$a||4<=M.Z||1<M.Lc||V)h=0;else if(Ue.put=nr,Ue.ac=Ht,Ue.bc=Sr,Ue.ma=M,Ue.width=h.width,Ue.height=h.height,Ue.Da=h.Da,Ue.v=h.v,Ue.va=h.va,Ue.j=h.j,Ue.o=h.o,M.$a)e:{e(M.$a==1),h=Or();t:for(;;){if(h==null){h=0;break e}if(e(M!=null),M.mc=h,h.c=M.c,h.i=M.i,h.l=M.l,h.l.ma=M,h.l.width=M.c,h.l.height=M.i,h.a=0,P(h.m,$,_e,we),!Hn(M.c,M.i,1,h,null)||(h.ab==1&&h.gc[0].hc==3&&os(h.s)?(M.ic=1,$=h.c*h.i,h.Ta=null,h.Ua=0,h.V=a($),h.Ba=0,h.V==null?(h.a=1,h=0):h=1):(M.ic=0,h=Ss(h,M.c)),!h))break t;h=1;break e}M.mc=null,h=0}else h=we>=M.c*M.i;M=!h}if(M)return null;u.ga.Lc!=1?u.Ga=0:S=D-x}e(u.ga!=null),e(x+S<=D);e:{if(h=($=u.ga).c,D=$.l.o,$.$a==0){if(_e=u.rc,we=u.Vc,Ue=u.Fa,V=u.P+1+x*h,ee=u.mb,ge=u.nb+x*h,e(V<=u.P+u.qc),$.Z!=0)for(e(Ca[$.Z]!=null),M=0;M<S;++M)Ca[$.Z](_e,we,Ue,V,ee,ge,h),_e=ee,we=ge,ge+=h,V+=h;else for(M=0;M<S;++M)r(ee,ge,Ue,V,h),_e=ee,we=ge,ge+=h,V+=h;u.rc=_e,u.Vc=we}else{if(e($.mc!=null),h=x+S,e((M=$.mc)!=null),e(h<=M.i),M.C>=h)h=1;else if($.ic||je(),$.ic){$=M.V,_e=M.Ba,we=M.c;var Ee=M.i,ve=(Ue=1,V=M.$/we,ee=M.$%we,ge=M.m,Se=M.s,M.$),xe=we*Ee,$e=we*h,We=Se.wc,qe=ve<$e?xn(Se,ee,V):null;e(ve<=xe),e(h<=Ee),e(os(Se));t:for(;;){for(;!ge.h&&ve<$e;){if(ee&We||(qe=xn(Se,ee,V)),e(qe!=null),re(ge),256>(Ee=cr(qe.G[0],qe.H[0],ge)))$[_e+ve]=Ee,++ve,++ee>=we&&(ee=0,++V<=h&&!(V%16)&&Pn(M,V));else{if(!(280>Ee)){Ue=0;break t}Ee=rr(Ee-256,ge);var ft,at=cr(qe.G[4],qe.H[4],ge);if(re(ge),!(ve>=(at=Jr(we,at=rr(at,ge)))&&xe-ve>=Ee)){Ue=0;break t}for(ft=0;ft<Ee;++ft)$[_e+ve+ft]=$[_e+ve+ft-at];for(ve+=Ee,ee+=Ee;ee>=we;)ee-=we,++V<=h&&!(V%16)&&Pn(M,V);ve<$e&&ee&We&&(qe=xn(Se,ee,V))}e(ge.h==R(ge))}Pn(M,V>h?h:V);break t}!Ue||ge.h&&ve<xe?(Ue=0,M.a=ge.h?5:3):M.$=ve,h=Ue}else h=kr(M,M.V,M.Ba,M.c,M.i,h,ri);if(!h){S=0;break e}}x+S>=D&&(u.Cc=1),S=1}if(!S)return null;if(u.Cc&&((S=u.ga)!=null&&(S.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+x*E}function g(u,h,x,S,E,D){for(;0<E--;){var M,$=u,V=h+(x?1:0),ee=u,ge=h+(x?0:3);for(M=0;M<S;++M){var Se=ee[ge+4*M];Se!=255&&(Se*=32897,$[V+4*M+0]=$[V+4*M+0]*Se>>23,$[V+4*M+1]=$[V+4*M+1]*Se>>23,$[V+4*M+2]=$[V+4*M+2]*Se>>23)}h+=D}}function L(u,h,x,S,E){for(;0<S--;){var D;for(D=0;D<x;++D){var M=u[h+2*D+0],$=15&(ee=u[h+2*D+1]),V=4369*$,ee=(240&ee|ee>>4)*V>>16;u[h+2*D+0]=(240&M|M>>4)*V>>16&240|(15&M|M<<4)*V>>16>>4&15,u[h+2*D+1]=240&ee|$}h+=E}}function se(u,h,x,S,E,D,M,$){var V,ee,ge=255;for(ee=0;ee<E;++ee){for(V=0;V<S;++V){var Se=u[h+V];D[M+4*V]=Se,ge&=Se}h+=x,M+=$}return ge!=255}function me(u,h,x,S,E){var D;for(D=0;D<E;++D)x[S+D]=u[h+D]>>8}function je(){Bs=g,yn=L,bn=se,Wn=me}function Oe(u,h,x){z[u]=function(S,E,D,M,$,V,ee,ge,Se,_e,we,Ue,Ee,ve,xe,$e,We){var qe,ft=We-1>>1,at=$[V+0]|ee[ge+0]<<16,Ct=Se[_e+0]|we[Ue+0]<<16;e(S!=null);var ct=3*at+Ct+131074>>2;for(h(S[E+0],255&ct,ct>>16,Ee,ve),D!=null&&(ct=3*Ct+at+131074>>2,h(D[M+0],255&ct,ct>>16,xe,$e)),qe=1;qe<=ft;++qe){var sn=$[V+qe]|ee[ge+qe]<<16,ln=Se[_e+qe]|we[Ue+qe]<<16,tn=at+sn+Ct+ln+524296,Kt=tn+2*(sn+Ct)>>3;ct=Kt+at>>1,at=(tn=tn+2*(at+ln)>>3)+sn>>1,h(S[E+2*qe-1],255&ct,ct>>16,Ee,ve+(2*qe-1)*x),h(S[E+2*qe-0],255&at,at>>16,Ee,ve+(2*qe-0)*x),D!=null&&(ct=tn+Ct>>1,at=Kt+ln>>1,h(D[M+2*qe-1],255&ct,ct>>16,xe,$e+(2*qe-1)*x),h(D[M+2*qe+0],255&at,at>>16,xe,$e+(2*qe+0)*x)),at=sn,Ct=ln}1&We||(ct=3*at+Ct+131074>>2,h(S[E+We-1],255&ct,ct>>16,Ee,ve+(We-1)*x),D!=null&&(ct=3*Ct+at+131074>>2,h(D[M+We-1],255&ct,ct>>16,xe,$e+(We-1)*x)))}}function Ke(){Us[Dd]=bw,Us[Md]=x1,Us[f1]=ww,Us[Rd]=y1,Us[Fd]=b1,Us[Nm]=w1,Us[m1]=Nw,Us[jm]=x1,Us[Sm]=y1,Us[$d]=b1,Us[_m]=w1}function ht(u){return u&~jw?0>u?0:255:u>>N1}function St(u,h){return ht((19077*u>>8)+(26149*h>>8)-14234)}function Mt(u,h,x){return ht((19077*u>>8)-(6419*h>>8)-(13320*x>>8)+8708)}function Ot(u,h){return ht((19077*u>>8)+(33050*h>>8)-17685)}function Xt(u,h,x,S,E){S[E+0]=St(u,x),S[E+1]=Mt(u,h,x),S[E+2]=Ot(u,h)}function zn(u,h,x,S,E){S[E+0]=Ot(u,h),S[E+1]=Mt(u,h,x),S[E+2]=St(u,x)}function Fn(u,h,x,S,E){var D=Mt(u,h,x);h=D<<3&224|Ot(u,h)>>3,S[E+0]=248&St(u,x)|D>>5,S[E+1]=h}function sr(u,h,x,S,E){var D=240&Ot(u,h)|15;S[E+0]=240&St(u,x)|Mt(u,h,x)>>4,S[E+1]=D}function Mr(u,h,x,S,E){S[E+0]=255,Xt(u,h,x,S,E+1)}function vr(u,h,x,S,E){zn(u,h,x,S,E),S[E+3]=255}function oi(u,h,x,S,E){Xt(u,h,x,S,E),S[E+3]=255}function _s(u,h){return 0>u?0:u>h?h:u}function Li(u,h,x){z[u]=function(S,E,D,M,$,V,ee,ge,Se){for(var _e=ge+(-2&Se)*x;ge!=_e;)h(S[E+0],D[M+0],$[V+0],ee,ge),h(S[E+1],D[M+0],$[V+0],ee,ge+x),E+=2,++M,++V,ge+=2*x;1&Se&&h(S[E+0],D[M+0],$[V+0],ee,ge)}}function Pd(u,h,x){return x==0?u==0?h==0?6:5:h==0?4:0:x}function Oc(u,h,x,S,E){switch(u>>>30){case 3:Yi(h,x,S,E,0);break;case 2:Gn(h,x,S,E);break;case 1:Xr(h,x,S,E)}}function Dc(u,h){var x,S,E=h.M,D=h.Nb,M=u.oc,$=u.pc+40,V=u.oc,ee=u.pc+584,ge=u.oc,Se=u.pc+600;for(x=0;16>x;++x)M[$+32*x-1]=129;for(x=0;8>x;++x)V[ee+32*x-1]=129,ge[Se+32*x-1]=129;for(0<E?M[$-1-32]=V[ee-1-32]=ge[Se-1-32]=129:(i(M,$-32-1,127,21),i(V,ee-32-1,127,9),i(ge,Se-32-1,127,9)),S=0;S<u.za;++S){var _e=h.ya[h.aa+S];if(0<S){for(x=-1;16>x;++x)r(M,$+32*x-4,M,$+32*x+12,4);for(x=-1;8>x;++x)r(V,ee+32*x-4,V,ee+32*x+4,4),r(ge,Se+32*x-4,ge,Se+32*x+4,4)}var we=u.Gd,Ue=u.Hd+S,Ee=_e.ad,ve=_e.Hc;if(0<E&&(r(M,$-32,we[Ue].y,0,16),r(V,ee-32,we[Ue].f,0,8),r(ge,Se-32,we[Ue].ea,0,8)),_e.Za){var xe=M,$e=$-32+16;for(0<E&&(S>=u.za-1?i(xe,$e,we[Ue].y[15],4):r(xe,$e,we[Ue+1].y,0,4)),x=0;4>x;x++)xe[$e+128+x]=xe[$e+256+x]=xe[$e+384+x]=xe[$e+0+x];for(x=0;16>x;++x,ve<<=2)xe=M,$e=$+S1[x],li[_e.Ob[x]](xe,$e),Oc(ve,Ee,16*+x,xe,$e)}else if(xe=Pd(S,E,_e.Ob[0]),ka[xe](M,$),ve!=0)for(x=0;16>x;++x,ve<<=2)Oc(ve,Ee,16*+x,M,$+S1[x]);for(x=_e.Gc,xe=Pd(S,E,_e.Dd),Xi[xe](V,ee),Xi[xe](ge,Se),ve=Ee,xe=V,$e=ee,255&(_e=x>>0)&&(170&_e?Bc(ve,256,xe,$e):Fs(ve,256,xe,$e)),_e=ge,ve=Se,255&(x>>=8)&&(170&x?Bc(Ee,320,_e,ve):Fs(Ee,320,_e,ve)),E<u.Ub-1&&(r(we[Ue].y,0,M,$+480,16),r(we[Ue].f,0,V,ee+224,8),r(we[Ue].ea,0,ge,Se+224,8)),x=8*D*u.B,we=u.sa,Ue=u.ta+16*S+16*D*u.R,Ee=u.qa,_e=u.ra+8*S+x,ve=u.Ha,xe=u.Ia+8*S+x,x=0;16>x;++x)r(we,Ue+x*u.R,M,$+32*x,16);for(x=0;8>x;++x)r(Ee,_e+x*u.B,V,ee+32*x,8),r(ve,xe+x*u.B,ge,Se+32*x,8)}}function ll(u,h,x,S,E,D,M,$,V){var ee=[0],ge=[0],Se=0,_e=V!=null?V.kd:0,we=V??new Ec;if(u==null||12>x)return 7;we.data=u,we.w=h,we.ha=x,h=[h],x=[x],we.gb=[we.gb];e:{var Ue=h,Ee=x,ve=we.gb;if(e(u!=null),e(Ee!=null),e(ve!=null),ve[0]=0,12<=Ee[0]&&!n(u,Ue[0],"RIFF")){if(n(u,Ue[0]+8,"WEBP")){ve=3;break e}var xe=Me(u,Ue[0]+4);if(12>xe||4294967286<xe){ve=3;break e}if(_e&&xe>Ee[0]-8){ve=7;break e}ve[0]=xe,Ue[0]+=12,Ee[0]-=12}ve=0}if(ve!=0)return ve;for(xe=0<we.gb[0],x=x[0];;){e:{var $e=u;Ee=h,ve=x;var We=ee,qe=ge,ft=Ue=[0];if((ct=Se=[Se])[0]=0,8>ve[0])ve=7;else{if(!n($e,Ee[0],"VP8X")){if(Me($e,Ee[0]+4)!=10){ve=3;break e}if(18>ve[0]){ve=7;break e}var at=Me($e,Ee[0]+8),Ct=1+Fe($e,Ee[0]+12);if(2147483648<=Ct*($e=1+Fe($e,Ee[0]+15))){ve=3;break e}ft!=null&&(ft[0]=at),We!=null&&(We[0]=Ct),qe!=null&&(qe[0]=$e),Ee[0]+=18,ve[0]-=18,ct[0]=1}ve=0}}if(Se=Se[0],Ue=Ue[0],ve!=0)return ve;if(Ee=!!(2&Ue),!xe&&Se)return 3;if(D!=null&&(D[0]=!!(16&Ue)),M!=null&&(M[0]=Ee),$!=null&&($[0]=0),M=ee[0],Ue=ge[0],Se&&Ee&&V==null){ve=0;break}if(4>x){ve=7;break}if(xe&&Se||!xe&&!Se&&!n(u,h[0],"ALPH")){x=[x],we.na=[we.na],we.P=[we.P],we.Sa=[we.Sa];e:{at=u,ve=h,xe=x;var ct=we.gb;We=we.na,qe=we.P,ft=we.Sa,Ct=22,e(at!=null),e(xe!=null),$e=ve[0];var sn=xe[0];for(e(We!=null),e(ft!=null),We[0]=null,qe[0]=null,ft[0]=0;;){if(ve[0]=$e,xe[0]=sn,8>sn){ve=7;break e}var ln=Me(at,$e+4);if(4294967286<ln){ve=3;break e}var tn=8+ln+1&-2;if(Ct+=tn,0<ct&&Ct>ct){ve=3;break e}if(!n(at,$e,"VP8 ")||!n(at,$e,"VP8L")){ve=0;break e}if(sn[0]<tn){ve=7;break e}n(at,$e,"ALPH")||(We[0]=at,qe[0]=$e+8,ft[0]=ln),$e+=tn,sn-=tn}}if(x=x[0],we.na=we.na[0],we.P=we.P[0],we.Sa=we.Sa[0],ve!=0)break}x=[x],we.Ja=[we.Ja],we.xa=[we.xa];e:if(ct=u,ve=h,xe=x,We=we.gb[0],qe=we.Ja,ft=we.xa,at=ve[0],$e=!n(ct,at,"VP8 "),Ct=!n(ct,at,"VP8L"),e(ct!=null),e(xe!=null),e(qe!=null),e(ft!=null),8>xe[0])ve=7;else{if($e||Ct){if(ct=Me(ct,at+4),12<=We&&ct>We-12){ve=3;break e}if(_e&&ct>xe[0]-8){ve=7;break e}qe[0]=ct,ve[0]+=8,xe[0]-=8,ft[0]=Ct}else ft[0]=5<=xe[0]&&ct[at+0]==47&&!(ct[at+4]>>5),qe[0]=xe[0];ve=0}if(x=x[0],we.Ja=we.Ja[0],we.xa=we.xa[0],h=h[0],ve!=0)break;if(4294967286<we.Ja)return 3;if($==null||Ee||($[0]=we.xa?2:1),M=[M],Ue=[Ue],we.xa){if(5>x){ve=7;break}$=M,_e=Ue,Ee=D,u==null||5>x?u=0:5<=x&&u[h+0]==47&&!(u[h+4]>>5)?(xe=[0],ct=[0],We=[0],P(qe=new w,u,h,x),Nt(qe,xe,ct,We)?($!=null&&($[0]=xe[0]),_e!=null&&(_e[0]=ct[0]),Ee!=null&&(Ee[0]=We[0]),u=1):u=0):u=0}else{if(10>x){ve=7;break}$=Ue,u==null||10>x||!Gi(u,h+3,x-3)?u=0:(_e=u[h+0]|u[h+1]<<8|u[h+2]<<16,Ee=16383&(u[h+7]<<8|u[h+6]),u=16383&(u[h+9]<<8|u[h+8]),1&_e||3<(_e>>1&7)||!(_e>>4&1)||_e>>5>=we.Ja||!Ee||!u?u=0:(M&&(M[0]=Ee),$&&($[0]=u),u=1))}if(!u||(M=M[0],Ue=Ue[0],Se&&(ee[0]!=M||ge[0]!=Ue)))return 3;V!=null&&(V[0]=we,V.offset=h-V.w,e(4294967286>h-V.w),e(V.offset==V.ha-x));break}return ve==0||ve==7&&Se&&V==null?(D!=null&&(D[0]|=we.na!=null&&0<we.na.length),S!=null&&(S[0]=M),E!=null&&(E[0]=Ue),0):ve}function Mc(u,h,x){var S=h.width,E=h.height,D=0,M=0,$=S,V=E;if(h.Da=u!=null&&0<u.Da,h.Da&&($=u.cd,V=u.bd,D=u.v,M=u.j,11>x||(D&=-2,M&=-2),0>D||0>M||0>=$||0>=V||D+$>S||M+V>E))return 0;if(h.v=D,h.j=M,h.va=D+$,h.o=M+V,h.U=$,h.T=V,h.da=u!=null&&0<u.da,h.da){if(!pt($,V,x=[u.ib],D=[u.hb]))return 0;h.ib=x[0],h.hb=D[0]}return h.ob=u!=null&&u.ob,h.Kb=u==null||!u.Sd,h.da&&(h.ob=h.ib<3*S/4&&h.hb<3*E/4,h.Kb=0),1}function Rc(u){if(u==null)return 2;if(11>u.S){var h=u.f.RGBA;h.fb+=(u.height-1)*h.A,h.A=-h.A}else h=u.f.kb,u=u.height,h.O+=(u-1)*h.fa,h.fa=-h.fa,h.N+=(u-1>>1)*h.Ab,h.Ab=-h.Ab,h.W+=(u-1>>1)*h.Db,h.Db=-h.Db,h.F!=null&&(h.J+=(u-1)*h.lb,h.lb=-h.lb);return 0}function cl(u,h,x,S){if(S==null||0>=u||0>=h)return 2;if(x!=null){if(x.Da){var E=x.cd,D=x.bd,M=-2&x.v,$=-2&x.j;if(0>M||0>$||0>=E||0>=D||M+E>u||$+D>h)return 2;u=E,h=D}if(x.da){if(!pt(u,h,E=[x.ib],D=[x.hb]))return 2;u=E[0],h=D[0]}}S.width=u,S.height=h;e:{var V=S.width,ee=S.height;if(u=S.S,0>=V||0>=ee||!(u>=Dd&&13>u))u=2;else{if(0>=S.Rd&&S.sd==null){M=D=E=h=0;var ge=($=V*_1[u])*ee;if(11>u||(D=(ee+1)/2*(h=(V+1)/2),u==12&&(M=(E=V)*ee)),(ee=a(ge+2*D+M))==null){u=1;break e}S.sd=ee,11>u?((V=S.f.RGBA).eb=ee,V.fb=0,V.A=$,V.size=ge):((V=S.f.kb).y=ee,V.O=0,V.fa=$,V.Fd=ge,V.f=ee,V.N=0+ge,V.Ab=h,V.Cd=D,V.ea=ee,V.W=0+ge+D,V.Db=h,V.Ed=D,u==12&&(V.F=ee,V.J=0+ge+2*D),V.Tc=M,V.lb=E)}if(h=1,E=S.S,D=S.width,M=S.height,E>=Dd&&13>E)if(11>E)u=S.f.RGBA,h&=($=Math.abs(u.A))*(M-1)+D<=u.size,h&=$>=D*_1[E],h&=u.eb!=null;else{u=S.f.kb,$=(D+1)/2,ge=(M+1)/2,V=Math.abs(u.fa),ee=Math.abs(u.Ab);var Se=Math.abs(u.Db),_e=Math.abs(u.lb),we=_e*(M-1)+D;h&=V*(M-1)+D<=u.Fd,h&=ee*(ge-1)+$<=u.Cd,h=(h&=Se*(ge-1)+$<=u.Ed)&V>=D&ee>=$&Se>=$,h&=u.y!=null,h&=u.f!=null,h&=u.ea!=null,E==12&&(h&=_e>=D,h&=we<=u.Tc,h&=u.F!=null)}else h=0;u=h?0:2}}return u!=0||x!=null&&x.fd&&(u=Rc(S)),u}var Ar=64,ul=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],dl=24,hl=32,Fc=8,cs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Qe("Predictor0","PredictorAdd0"),z.Predictor0=function(){return 4278190080},z.Predictor1=function(u){return u},z.Predictor2=function(u,h,x){return h[x+0]},z.Predictor3=function(u,h,x){return h[x+1]},z.Predictor4=function(u,h,x){return h[x-1]},z.Predictor5=function(u,h,x){return ae(ae(u,h[x+1]),h[x+0])},z.Predictor6=function(u,h,x){return ae(u,h[x-1])},z.Predictor7=function(u,h,x){return ae(u,h[x+0])},z.Predictor8=function(u,h,x){return ae(h[x-1],h[x+0])},z.Predictor9=function(u,h,x){return ae(h[x+0],h[x+1])},z.Predictor10=function(u,h,x){return ae(ae(u,h[x-1]),ae(h[x+0],h[x+1]))},z.Predictor11=function(u,h,x){var S=h[x+0];return 0>=he(S>>24&255,u>>24&255,(h=h[x-1])>>24&255)+he(S>>16&255,u>>16&255,h>>16&255)+he(S>>8&255,u>>8&255,h>>8&255)+he(255&S,255&u,255&h)?S:u},z.Predictor12=function(u,h,x){var S=h[x+0];return(Ae((u>>24&255)+(S>>24&255)-((h=h[x-1])>>24&255))<<24|Ae((u>>16&255)+(S>>16&255)-(h>>16&255))<<16|Ae((u>>8&255)+(S>>8&255)-(h>>8&255))<<8|Ae((255&u)+(255&S)-(255&h)))>>>0},z.Predictor13=function(u,h,x){var S=h[x-1];return(Re((u=ae(u,h[x+0]))>>24&255,S>>24&255)<<24|Re(u>>16&255,S>>16&255)<<16|Re(u>>8&255,S>>8&255)<<8|Re(u>>0&255,S>>0&255))>>>0};var bm=z.PredictorAdd0;z.PredictorAdd1=Ne,Qe("Predictor2","PredictorAdd2"),Qe("Predictor3","PredictorAdd3"),Qe("Predictor4","PredictorAdd4"),Qe("Predictor5","PredictorAdd5"),Qe("Predictor6","PredictorAdd6"),Qe("Predictor7","PredictorAdd7"),Qe("Predictor8","PredictorAdd8"),Qe("Predictor9","PredictorAdd9"),Qe("Predictor10","PredictorAdd10"),Qe("Predictor11","PredictorAdd11"),Qe("Predictor12","PredictorAdd12"),Qe("Predictor13","PredictorAdd13");var $c=z.PredictorAdd2;ke("ColorIndexInverseTransform","MapARGB","32b",function(u){return u>>8&255},function(u){return u}),ke("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(u){return u},function(u){return u>>8&255});var Id,Rs=z.ColorIndexInverseTransform,fl=z.MapARGB,Ed=z.VP8LColorIndexInverseTransformAlpha,Ld=z.MapAlpha,Na=z.VP8LPredictorsAdd=[];Na.length=16,(z.VP8LPredictors=[]).length=16,(z.VP8LPredictorsAdd_C=[]).length=16,(z.VP8LPredictors_C=[]).length=16;var wo,us,Qr,ja,Ji,Ki,ml,Yi,Gn,Bc,Xr,Fs,pl,Td,qc,No,jo,Sa,So,gl,_o,_a,Uc,$s,Bs,yn,bn,Wn,dr=a(511),Qi=a(2041),Vc=a(225),vl=a(767),zd=0,wm=Qi,Od=Vc,ks=vl,qs=dr,Dd=0,Md=1,f1=2,Rd=3,Fd=4,Nm=5,m1=6,jm=7,Sm=8,$d=9,_m=10,aw=[2,3,7],ow=[3,3,11],p1=[280,256,256,256,40],lw=[0,1,1,1,0],cw=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],uw=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],dw=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],hw=8,km=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Cm=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Hc=null,fw=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],mw=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],g1=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],pw=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],gw=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],vw=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],xw=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ka=[],li=[],Xi=[],yw=1,v1=2,Ca=[],Us=[];Oe("UpsampleRgbLinePair",Xt,3),Oe("UpsampleBgrLinePair",zn,3),Oe("UpsampleRgbaLinePair",oi,4),Oe("UpsampleBgraLinePair",vr,4),Oe("UpsampleArgbLinePair",Mr,4),Oe("UpsampleRgba4444LinePair",sr,2),Oe("UpsampleRgb565LinePair",Fn,2);var bw=z.UpsampleRgbLinePair,ww=z.UpsampleBgrLinePair,x1=z.UpsampleRgbaLinePair,y1=z.UpsampleBgraLinePair,b1=z.UpsampleArgbLinePair,w1=z.UpsampleRgba4444LinePair,Nw=z.UpsampleRgb565LinePair,Bd=16,qd=1<<Bd-1,Gc=-227,Am=482,N1=6,jw=(256<<N1)-1,j1=0,Sw=a(256),_w=a(256),kw=a(256),Cw=a(256),Aw=a(Am-Gc),Pw=a(Am-Gc);Li("YuvToRgbRow",Xt,3),Li("YuvToBgrRow",zn,3),Li("YuvToRgbaRow",oi,4),Li("YuvToBgraRow",vr,4),Li("YuvToArgbRow",Mr,4),Li("YuvToRgba4444Row",sr,2),Li("YuvToRgb565Row",Fn,2);var S1=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ud=[0,2,8],Iw=[8,7,6,4,4,2,2,2,1,1,1,1],Ew=1;this.WebPDecodeRGBA=function(u,h,x,S,E){var D=Md,M=new al,$=new wt;M.ba=$,$.S=D,$.width=[$.width],$.height=[$.height];var V=$.width,ee=$.height,ge=new Qt;if(ge==null||u==null)var Se=2;else e(ge!=null),Se=ll(u,h,x,ge.width,ge.height,ge.Pd,ge.Qd,ge.format,null);if(Se!=0?V=0:(V!=null&&(V[0]=ge.width[0]),ee!=null&&(ee[0]=ge.height[0]),V=1),V){$.width=$.width[0],$.height=$.height[0],S!=null&&(S[0]=$.width),E!=null&&(E[0]=$.height);e:{if(S=new on,(E=new Ec).data=u,E.w=h,E.ha=x,E.kd=1,h=[0],e(E!=null),((u=ll(E.data,E.w,E.ha,null,null,null,h,null,E))==0||u==7)&&h[0]&&(u=4),(h=u)==0){if(e(M!=null),S.data=E.data,S.w=E.w+E.offset,S.ha=E.ha-E.offset,S.put=nr,S.ac=Ht,S.bc=Sr,S.ma=M,E.xa){if((u=Or())==null){M=1;break e}if(function(_e,we){var Ue=[0],Ee=[0],ve=[0];t:for(;;){if(_e==null)return 0;if(we==null)return _e.a=2,0;if(_e.l=we,_e.a=0,P(_e.m,we.data,we.w,we.ha),!Nt(_e.m,Ue,Ee,ve)){_e.a=3;break t}if(_e.xb=v1,we.width=Ue[0],we.height=Ee[0],!Hn(Ue[0],Ee[0],1,_e,null))break t;return 1}return e(_e.a!=0),0}(u,S)){if(S=(h=cl(S.width,S.height,M.Oa,M.ba))==0){t:{S=u;n:for(;;){if(S==null){S=0;break t}if(e(S.s.yc!=null),e(S.s.Ya!=null),e(0<S.s.Wb),e((x=S.l)!=null),e((E=x.ma)!=null),S.xb!=0){if(S.ca=E.ba,S.tb=E.tb,e(S.ca!=null),!Mc(E.Oa,x,Rd)){S.a=2;break n}if(!Ss(S,x.width)||x.da)break n;if((x.da||vt(S.ca.S))&&je(),11>S.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),S.ca.f.kb.F!=null&&je()),S.Pb&&0<S.s.ua&&S.s.vb.X==null&&!tt(S.s.vb,S.s.Wa.Xa)){S.a=1;break n}S.xb=0}if(!kr(S,S.V,S.Ba,S.c,S.i,x.o,_i))break n;E.Dc=S.Ma,S=1;break t}e(S.a!=0),S=0}S=!S}S&&(h=u.a)}else h=u.a}else{if((u=new Kr)==null){M=1;break e}if(u.Fa=E.na,u.P=E.P,u.qc=E.Sa,Ms(u,S)){if((h=cl(S.width,S.height,M.Oa,M.ba))==0){if(u.Aa=0,x=M.Oa,e((E=u)!=null),x!=null){if(0<(V=0>(V=x.Md)?0:100<V?255:255*V/100)){for(ee=ge=0;4>ee;++ee)12>(Se=E.pb[ee]).lc&&(Se.ia=V*Iw[0>Se.lc?0:Se.lc]>>3),ge|=Se.ia;ge&&(alert("todo:VP8InitRandom"),E.ia=1)}E.Ga=x.Id,100<E.Ga?E.Ga=100:0>E.Ga&&(E.Ga=0)}tl(u,S)||(h=u.a)}}else h=u.a}h==0&&M.Oa!=null&&M.Oa.fd&&(h=Rc(M.ba))}M=h}D=M!=0?null:11>D?$.f.RGBA.eb:$.f.kb.y}else D=null;return D};var _1=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(z,J){for(var te="",I=0;I<4;I++)te+=String.fromCharCode(z[J++]);return te}function f(z,J){return(z[J+0]<<0|z[J+1]<<8|z[J+2]<<16)>>>0}function p(z,J){return(z[J+0]<<0|z[J+1]<<8|z[J+2]<<16|z[J+3]<<24)>>>0}new c;var v=[0],m=[0],N=[],_=new c,k=t,y=function(z,J){var te={},I=0,A=!1,T=0,F=0;if(te.frames=[],!function(O,R,H,re){for(var oe=0;oe<re;oe++)if(O[R+oe]!=H.charCodeAt(oe))return!0;return!1}(z,J,"RIFF",4)){for(p(z,J+=4),J+=8;J<z.length;){var ne=d(z,J),W=p(z,J+=4);J+=4;var ue=W+(1&W);switch(ne){case"VP8 ":case"VP8L":te.frames[I]===void 0&&(te.frames[I]={}),(G=te.frames[I]).src_off=A?F:J-8,G.src_size=T+W+8,I++,A&&(A=!1,T=0,F=0);break;case"VP8X":(G=te.header={}).feature_flags=z[J];var P=J+4;G.canvas_width=1+f(z,P),P+=3,G.canvas_height=1+f(z,P),P+=3;break;case"ALPH":A=!0,T=ue+8,F=J-8;break;case"ANIM":(G=te.header).bgcolor=p(z,J),P=J+4,G.loop_count=(de=z)[(w=P)+0]<<0|de[w+1]<<8,P+=2;break;case"ANMF":var Q,G;(G=te.frames[I]={}).offset_x=2*f(z,J),J+=3,G.offset_y=2*f(z,J),J+=3,G.width=1+f(z,J),J+=3,G.height=1+f(z,J),J+=3,G.duration=f(z,J),J+=3,Q=z[J++],G.dispose=1&Q,G.blend=Q>>1&1}ne!="ANMF"&&(J+=ue)}var de,w;return te}}(k,0);y.response=k,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,j=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,v=[b.canvas_height],m=[b.canvas_width];for(var C=0;C<j.length&&j[C].blend!=0;C++);}var B=j[0],K=_.WebPDecodeRGBA(k,B.src_off,B.src_size,m,v);B.rgba=K,B.imgwidth=m[0],B.imgheight=v[0];for(var Z=0;Z<m[0]*v[0]*4;Z++)N[Z]=K[Z];return this.width=m,this.height=v,this.data=N,this}(function(t){var e=function(){return typeof Tg=="function"},n=function(v,m,N,_){var k=4,y=o;switch(_){case t.image_compression.FAST:k=1,y=a;break;case t.image_compression.MEDIUM:k=6,y=l;break;case t.image_compression.SLOW:k=9,y=c}v=r(v,m,N,y);var b=Tg(v,{level:k});return t.__addimage__.arrayBufferToBinaryString(b)},r=function(v,m,N,_){for(var k,y,b,j=v.length/m,C=new Uint8Array(v.length+j),B=f(),K=0;K<j;K+=1){if(b=K*m,k=v.subarray(b,b+m),_)C.set(_(k,N,y),b+K);else{for(var Z,z=B.length,J=[];Z<z;Z+=1)J[Z]=B[Z](k,N,y);var te=p(J.concat());C.set(J[te],b+K)}y=k}return C},i=function(v){var m=Array.apply([],v);return m.unshift(0),m},a=function(v,m){var N,_=[],k=v.length;_[0]=1;for(var y=0;y<k;y+=1)N=v[y-m]||0,_[y+1]=v[y]-N+256&255;return _},o=function(v,m,N){var _,k=[],y=v.length;k[0]=2;for(var b=0;b<y;b+=1)_=N&&N[b]||0,k[b+1]=v[b]-_+256&255;return k},l=function(v,m,N){var _,k,y=[],b=v.length;y[0]=3;for(var j=0;j<b;j+=1)_=v[j-m]||0,k=N&&N[j]||0,y[j+1]=v[j]+256-(_+k>>>1)&255;return y},c=function(v,m,N){var _,k,y,b,j=[],C=v.length;j[0]=4;for(var B=0;B<C;B+=1)_=v[B-m]||0,k=N&&N[B]||0,y=N&&N[B-m]||0,b=d(_,k,y),j[B+1]=v[B]-b+256&255;return j},d=function(v,m,N){if(v===m&&m===N)return v;var _=Math.abs(m-N),k=Math.abs(v-N),y=Math.abs(v+m-N-N);return _<=k&&_<=y?v:k<=y?m:N},f=function(){return[i,a,o,l,c]},p=function(v){var m=v.map(function(N){return N.reduce(function(_,k){return _+Math.abs(k)},0)});return m.indexOf(Math.min.apply(null,m))};t.processPNG=function(v,m,N,_){var k,y,b,j,C,B,K,Z,z,J,te,I,A,T,F,ne=this.decode.FLATE_DECODE,W="";if(this.__addimage__.isArrayBuffer(v)&&(v=new Uint8Array(v)),this.__addimage__.isArrayBufferView(v)){if(v=(b=new yC(v)).imgData,y=b.bits,k=b.colorSpace,C=b.colors,[4,6].indexOf(b.colorType)!==-1){if(b.bits===8){z=(Z=b.pixelBitlength==32?new Uint32Array(b.decodePixels().buffer):b.pixelBitlength==16?new Uint16Array(b.decodePixels().buffer):new Uint8Array(b.decodePixels().buffer)).length,te=new Uint8Array(z*b.colors),J=new Uint8Array(z);var ue,P=b.pixelBitlength-b.bits;for(T=0,F=0;T<z;T++){for(A=Z[T],ue=0;ue<P;)te[F++]=A>>>ue&255,ue+=b.bits;J[T]=A>>>ue&255}}if(b.bits===16){z=(Z=new Uint32Array(b.decodePixels().buffer)).length,te=new Uint8Array(z*(32/b.pixelBitlength)*b.colors),J=new Uint8Array(z*(32/b.pixelBitlength)),I=b.colors>1,T=0,F=0;for(var Q=0;T<z;)A=Z[T++],te[F++]=A>>>0&255,I&&(te[F++]=A>>>16&255,A=Z[T++],te[F++]=A>>>0&255),J[Q++]=A>>>16&255;y=8}_!==t.image_compression.NONE&&e()?(v=n(te,b.width*b.colors,b.colors,_),K=n(J,b.width,1,_)):(v=te,K=J,ne=void 0)}if(b.colorType===3&&(k=this.color_spaces.INDEXED,B=b.palette,b.transparency.indexed)){var G=b.transparency.indexed,de=0;for(T=0,z=G.length;T<z;++T)de+=G[T];if((de/=255)===z-1&&G.indexOf(0)!==-1)j=[G.indexOf(0)];else if(de!==z){for(Z=b.decodePixels(),J=new Uint8Array(Z.length),T=0,z=Z.length;T<z;T++)J[T]=G[Z[T]];K=n(J,b.width,1)}}var w=function(O){var R;switch(O){case t.image_compression.FAST:R=11;break;case t.image_compression.MEDIUM:R=13;break;case t.image_compression.SLOW:R=14;break;default:R=12}return R}(_);return ne===this.decode.FLATE_DECODE&&(W="/Predictor "+w+" "),W+="/Colors "+C+" /BitsPerComponent "+y+" /Columns "+b.width,(this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),(K&&this.__addimage__.isArrayBuffer(K)||this.__addimage__.isArrayBufferView(K))&&(K=this.__addimage__.arrayBufferToBinaryString(K)),{alias:N,data:v,index:m,filter:ne,decodeParameters:W,transparency:j,palette:B,sMask:K,predictor:w,width:b.width,height:b.height,bitsPerComponent:y,colorSpace:k}}}})(Pt.API),function(t){t.processGIF89A=function(e,n,r,i){var a=new bC(e),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},f=new bp(100).encode(d,100);return t.processJPEG.call(this,f,n,r,i)},t.processGIF87A=t.processGIF89A}(Pt.API),hi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:r,blue:n,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},hi.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){vn.log("bit decode error:"+n)}},hi.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}n!==0&&(this.pos+=4-n)}},hi.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,l=a>>4,c=15&a,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*i+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},hi.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},hi.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,d=a>>15?255:0,f=r*this.width*4+4*i;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=d}this.pos+=t}},hi.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&n)/n*255|0,d=(o>>11)/e*255|0,f=i*this.width*4+4*a;this.data[f]=d,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=t}},hi.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},hi.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*n;this.data[l]=a,this.data[l+1]=i,this.data[l+2]=r,this.data[l+3]=o}},hi.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,r,i){var a=new hi(e,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},d=new bp(100).encode(c,100);return t.processJPEG.call(this,d,n,r,i)}}(Pt.API),Hx.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,r,i){var a=new Hx(e),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},d=new bp(100).encode(c,100);return t.processJPEG.call(this,d,n,r,i)}}(Pt.API),Pt.API.processRGBA=function(t,e,n){for(var r=t.data,i=r.length,a=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,d=0;d<i;d+=4){var f=r[d],p=r[d+1],v=r[d+2],m=r[d+3];a[l++]=f,a[l++]=p,a[l++]=v,o[c++]=m}var N=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:N,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Pt.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Sl=Pt.API,Ch=Sl.getCharWidthsArray=function(t,e){var n,r,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=d.fof?d.fof:1,p=e.doKerning!==!1,v=0,m=t.length,N=0,_=l[0]||c,k=[];for(n=0;n<m;n++)r=t.charCodeAt(n),typeof i.metadata.widthOfString=="function"?k.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/a)||0)/1e3):(v=p&&dn(d[r])==="object"&&!isNaN(parseInt(d[r][N],10))?d[r][N]/f:0,k.push((l[r]||_)/c+v)),N=r;return k},Bx=Sl.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Sl.processArabic&&(t=Sl.processArabic(t)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t,n,i)/n:Ch.apply(this,arguments).reduce(function(a,o){return a+o},0)},qx=function(t,e,n,r){for(var i=[],a=0,o=t.length,l=0;a!==o&&l+e[a]<n;)l+=e[a],a++;i.push(t.slice(0,a));var c=a;for(l=0;a!==o;)l+e[a]>r&&(i.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&i.push(t.slice(c,a)),i},Ux=function(t,e,n){n||(n={});var r,i,a,o,l,c,d,f=[],p=[f],v=n.textIndent||0,m=0,N=0,_=t.split(" "),k=Ch.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?_[0].length+2:n.lineIndent||0){var y=Array(c).join(" "),b=[];_.map(function(C){(C=C.split(/\s*\n/)).length>1?b=b.concat(C.map(function(B,K){return(K&&B.length?`
`:"")+B})):b.push(C[0])}),_=b,c=Bx.apply(this,[y,n])}for(a=0,o=_.length;a<o;a++){var j=0;if(r=_[a],c&&r[0]==`
`&&(r=r.substr(1),j=1),v+m+(N=(i=Ch.apply(this,[r,n])).reduce(function(C,B){return C+B},0))>e||j){if(N>e){for(l=qx.apply(this,[r,i,e-(v+m),e]),f.push(l.shift()),f=[l.pop()];l.length;)p.push([l.shift()]);N=i.slice(r.length-(f[0]?f[0].length:0)).reduce(function(C,B){return C+B},0)}else f=[r];p.push(f),v=N+c,m=k}else f.push(r),v+=m+N,m=k}return d=c?function(C,B){return(B?y:"")+C.join(" ")}:function(C){return C.join(" ")},p.map(d)},Sl.splitTextToSize=function(t,e,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),a=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var p=this.internal.getFont(f.fontName,f.fontStyle);return p.metadata.Unicode?{widths:p.metadata.Unicode.widths||{0:1},kerning:p.metadata.Unicode.kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;a.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=n.lineIndent;var l,c,d=[];for(l=0,c=r.length;l<c;l++)d=d.concat(Ux.apply(this,[r[l],o,a]));return d},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",n={},r={},i=0;i<e.length;i++)n[e[i]]="0123456789abcdef"[i],r["0123456789abcdef"[i]]=e[i];var a=function(p){return"0x"+parseInt(p,10).toString(16)},o=t.__fontmetrics__.compress=function(p){var v,m,N,_,k=["{"];for(var y in p){if(v=p[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=a(y).slice(2)).slice(0,-1)+r[m.slice(-1)]),typeof v=="number")v<0?(N=a(v).slice(3),_="-"):(N=a(v).slice(2),_=""),N=_+N.slice(0,-1)+r[N.slice(-1)];else{if(dn(v)!=="object")throw new Error("Don't know what to do with value type "+dn(v)+".");N=o(v)}k.push(m+N)}return k.push("}"),k.join("")},l=t.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,m,N,_,k={},y=1,b=k,j=[],C="",B="",K=p.length-1,Z=1;Z<K;Z+=1)(_=p[Z])=="'"?v?(N=v.join(""),v=void 0):v=[]:v?v.push(_):_=="{"?(j.push([b,N]),b={},N=void 0):_=="}"?((m=j.pop())[0][m[1]]=b,N=void 0,b=m[0]):_=="-"?y=-1:N===void 0?n.hasOwnProperty(_)?(C+=n[_],N=parseInt(C,16)*y,y=1,C=""):C+=_:n.hasOwnProperty(_)?(B+=n[_],b[N]=parseInt(B,16)*y,y=1,N=void 0,B=""):B+=_;return k},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},f={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(p){var v=p.font,m=f.Unicode[v.postScriptName];m&&(v.metadata.Unicode={},v.metadata.Unicode.widths=m.widths,v.metadata.Unicode.kerning=m.kerning);var N=d.Unicode[v.postScriptName];N&&(v.metadata.Unicode.encoding=N,v.encoding=N.codePages[0])}])}(Pt.API),function(t){var e=function(n){for(var r=n.length,i=new Uint8Array(r),a=0;a<r;a++)i[a]=n.charCodeAt(a);return i};t.API.events.push(["addFont",function(n){var r=void 0,i=n.font,a=n.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(Eu(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])}(Pt),function(t){function e(){return(It.canvg?Promise.resolve(It.canvg):io(()=>import("./index.es-8999013f.js"),[],import.meta.url)).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}Pt.API.addSvgAsImage=function(n,r,i,a,o,l,c,d){if(isNaN(r)||isNaN(i))throw vn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(o))throw vn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=a,f.height=o;var p=f.getContext("2d");p.fillStyle="#fff",p.fillRect(0,0,f.width,f.height);var v={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return e().then(function(N){return N.fromString(p,n,v)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(N){return N.render(v)}).then(function(){m.addImage(f.toDataURL("image/jpeg",1),r,i,a,o,c,d)})}}(),Pt.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(e,n);return this},Pt.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var r,i,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,f=0,p=0;function v(N,_){var k,y=!1;for(k=0;k<N.length;k+=1)N[k]===_&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=l.length;for(p=0;p<m;p+=1)n[l[p]].value=n[l[p]].defaultValue,n[l[p]].explicitSet=!1}if(dn(t)==="object"){for(i in t)if(a=t[i],v(l,i)&&a!==void 0){if(n[i].type==="boolean"&&typeof a=="boolean")n[i].value=a;else if(n[i].type==="name"&&v(n[i].valueSet,a))n[i].value=a;else if(n[i].type==="integer"&&Number.isInteger(a))n[i].value=a;else if(n[i].type==="array"){for(d=0;d<a.length;d+=1)if(r=!0,a[d].length===1&&typeof a[d][0]=="number")c.push(String(a[d]-1));else if(a[d].length>1){for(f=0;f<a[d].length;f+=1)typeof a[d][f]!="number"&&(r=!1);r===!0&&c.push([a[d][0]-1,a[d][1]-1].join(" "))}n[i].value="["+c.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var N,_=[];for(N in n)n[N].explicitSet===!0&&(n[N].type==="name"?_.push("/"+N+" /"+n[N].value):_.push("/"+N+" "+n[N].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=a.length+o.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(i+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(Pt.API),function(t){var e=t.API,n=e.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],f=[""],p=0,v=a.length;p<v;++p){if(l=o.metadata.characterToGlyph(a.charCodeAt(p)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(p),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(d[4-l.length],l)}return f.join("")},r=function(a){var o,l,c,d,f,p,v;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,v=(l=Object.keys(a).sort(function(m,N){return m-N})).length;p<v;p++)o=l[p],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(d=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,d=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var p=l.metadata.Unicode.widths,v=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",N=0;N<v.length;N++)m+=String.fromCharCode(v[N]);var _=d();f({data:m,addLength1:!0,objectId:_}),c("endobj");var k=d();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:k}),c("endobj");var y=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Ol(l.fontName)),c("/FontFile2 "+_+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+Ol(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+t.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+k+" 0 R"),c("/BaseFont /"+Ol(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,d=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var p=l.metadata.rawData,v="",m=0;m<p.length;m++)v+=String.fromCharCode(p[m]);var N=d();f({data:v,addLength1:!0,objectId:N}),c("endobj");var _=d();f({data:r(l.metadata.toUnicode),addLength1:!0,objectId:_}),c("endobj");var k=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+N+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Ol(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+Ol(l.fontName)+"/FontDescriptor "+k+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var i=function(a){var o,l=a.text||"",c=a.x,d=a.y,f=a.options||{},p=a.mutex||{},v=p.pdfEscape,m=p.activeFontKey,N=p.fonts,_=m,k="",y=0,b="",j=N[_].encoding;if(N[_].encoding!=="Identity-H")return{text:l,x:c,y:d,options:f,mutex:p};for(b=l,_=m,Array.isArray(l)&&(b=l[0]),y=0;y<b.length;y+=1)N[_].metadata.hasOwnProperty("cmap")&&(o=N[_].metadata.cmap.unicode.codeMap[b[y].charCodeAt(0)]),o||b[y].charCodeAt(0)<256&&N[_].metadata.hasOwnProperty("Unicode")?k+=b[y]:k+="";var C="";return parseInt(_.slice(1))<14||j==="WinAnsiEncoding"?C=v(k,_).split("").map(function(B){return B.charCodeAt(0).toString(16)}).join(""):j==="Identity-H"&&(C=n(k,N[_])),p.isHex=!0,{text:C,x:c,y:d,options:f,mutex:p}};e.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([i(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(i(Object.assign({},c,{text:o[d]})).text);a.text=l}else a.text=i(Object.assign({},c,{text:o})).text}])}(Pt),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,r){return e.call(this),this.internal.vFS[n]=r,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(Pt.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(r){var i,a,o,l,c,d,f,p=e,v=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],N={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},k=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,j=0;this.__bidiEngine__={};var C=function(I){var A=I.charCodeAt(),T=A>>8,F=_[T];return F!==void 0?p[256*F+(255&A)]:T===252||T===253?"AL":y.test(T)?"L":T===8?"R":"N"},B=function(I){for(var A,T=0;T<I.length;T++){if((A=C(I.charAt(T)))==="L")return!1;if(A==="R")return!0}return!1},K=function(I,A,T,F){var ne,W,ue,P,Q=A[F];switch(Q){case"L":case"R":b=!1;break;case"N":case"AN":break;case"EN":b&&(Q="AN");break;case"AL":b=!0,Q="R";break;case"WS":Q="N";break;case"CS":F<1||F+1>=A.length||(ne=T[F-1])!=="EN"&&ne!=="AN"||(W=A[F+1])!=="EN"&&W!=="AN"?Q="N":b&&(W="AN"),Q=W===ne?W:"N";break;case"ES":Q=(ne=F>0?T[F-1]:"B")==="EN"&&F+1<A.length&&A[F+1]==="EN"?"EN":"N";break;case"ET":if(F>0&&T[F-1]==="EN"){Q="EN";break}if(b){Q="N";break}for(ue=F+1,P=A.length;ue<P&&A[ue]==="ET";)ue++;Q=ue<P&&A[ue]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(P=A.length,ue=F+1;ue<P&&A[ue]==="NSM";)ue++;if(ue<P){var G=I[F],de=G>=1425&&G<=2303||G===64286;if(ne=A[ue],de&&(ne==="R"||ne==="AL")){Q="R";break}}}Q=F<1||(ne=A[F-1])==="B"?"N":T[F-1];break;case"B":b=!1,i=!0,Q=j;break;case"S":a=!0,Q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"BN":Q="N"}return Q},Z=function(I,A,T){var F=I.split("");return T&&z(F,T,{hiLevel:j}),F.reverse(),A&&A.reverse(),F.join("")},z=function(I,A,T){var F,ne,W,ue,P,Q=-1,G=I.length,de=0,w=[],O=j?m:v,R=[];for(b=!1,i=!1,a=!1,ne=0;ne<G;ne++)R[ne]=C(I[ne]);for(W=0;W<G;W++){if(P=de,w[W]=K(I,R,w,W),F=240&(de=O[P][N[w[W]]]),de&=15,A[W]=ue=O[de][5],F>0)if(F===16){for(ne=Q;ne<W;ne++)A[ne]=1;Q=-1}else Q=-1;if(O[de][6])Q===-1&&(Q=W);else if(Q>-1){for(ne=Q;ne<W;ne++)A[ne]=ue;Q=-1}R[W]==="B"&&(A[W]=0),T.hiLevel|=ue}a&&function(H,re,oe){for(var fe=0;fe<oe;fe++)if(H[fe]==="S"){re[fe]=j;for(var be=fe-1;be>=0&&H[be]==="WS";be--)re[be]=j}}(R,A,G)},J=function(I,A,T,F,ne){if(!(ne.hiLevel<I)){if(I===1&&j===1&&!i)return A.reverse(),void(T&&T.reverse());for(var W,ue,P,Q,G=A.length,de=0;de<G;){if(F[de]>=I){for(P=de+1;P<G&&F[P]>=I;)P++;for(Q=de,ue=P-1;Q<ue;Q++,ue--)W=A[Q],A[Q]=A[ue],A[ue]=W,T&&(W=T[Q],T[Q]=T[ue],T[ue]=W);de=P}de++}}},te=function(I,A,T){var F=I.split(""),ne={hiLevel:j};return T||(T=[]),z(F,T,ne),function(W,ue,P){if(P.hiLevel!==0&&f)for(var Q,G=0;G<W.length;G++)ue[G]===1&&(Q=k.indexOf(W[G]))>=0&&(W[G]=k[Q+1])}(F,T,ne),J(2,F,A,T,ne),J(1,F,A,T,ne),F.join("")};return this.__bidiEngine__.doBidiReorder=function(I,A,T){if(function(ne,W){if(W)for(var ue=0;ue<ne.length;ue++)W[ue]=ue;l===void 0&&(l=B(ne)),d===void 0&&(d=B(ne))}(I,A),o||!c||d)if(o&&c&&l^d)j=l?1:0,I=Z(I,A,T);else if(!o&&c&&d)j=l?1:0,I=te(I,A,T),I=Z(I,A);else if(!o||l||c||d){if(o&&!c&&l^d)I=Z(I,A),l?(j=0,I=te(I,A,T)):(j=1,I=te(I,A,T),I=Z(I,A));else if(o&&l&&!c&&d)j=1,I=te(I,A,T),I=Z(I,A);else if(!o&&!c&&l^d){var F=f;l?(j=1,I=te(I,A,T),j=0,f=!1,I=te(I,A,T),f=F):(j=0,I=te(I,A,T),I=Z(I,A),j=1,f=!1,I=te(I,A,T),f=F,I=Z(I,A))}}else j=0,I=te(I,A,T);else j=l?1:0,I=te(I,A,T);return I},this.__bidiEngine__.setOptions=function(I){I&&(o=I.isInputVisual,c=I.isOutputVisual,l=I.isInputRtl,d=I.isOutputRtl,f=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(r){var i=r.text;r.x,r.y;var a=r.options||{};r.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,n.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([n.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([n.doBidiReorder(i[l])]);r.text=o}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(Pt),Pt.API.TTFFont=function(){function t(e){var n;if(this.rawData=e,n=this.contents=new oo(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new OC(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new wC(this.contents),this.head=new jC(this),this.name=new AC(this),this.cmap=new Ib(this),this.toUnicode={},this.hhea=new SC(this),this.maxp=new PC(this),this.hmtx=new IC(this),this.post=new kC(this),this.os2=new _C(this),this.loca=new zC(this),this.glyf=new EC(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,r){var i,a,o,l;for(o=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)i=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(e,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},t}();var Si,oo=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,r;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},t.prototype.writeString=function(e){var n,r,i;for(i=[],n=0,r=e.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(e.charCodeAt(n)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,r,i,a,o,l,c;return e=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*n+1099511627776*r+4294967296*i+16777216*a+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var n,r;return n=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,r;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push(this.readByte());return n},t.prototype.write=function(e){var n,r,i,a;for(a=[],r=0,i=e.length;r<i;r++)n=e[r],a.push(this.writeByte(n));return a},t}(),wC=function(){var t;function e(n){var r,i,a;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(n){var r,i,a,o,l,c,d,f,p,v,m,N,_;for(_ in m=Object.keys(n).length,c=Math.log(2),p=16*Math.floor(Math.log(m)/c),o=Math.floor(p/c),f=16*m-p,(i=new oo).writeInt(this.scalarType),i.writeShort(m),i.writeShort(p),i.writeShort(o),i.writeShort(f),a=16*m,d=i.pos+a,l=null,N=[],n)for(v=n[_],i.writeString(_),i.writeInt(t(v)),i.writeInt(d),i.writeInt(v.length),N=N.concat(v),_==="head"&&(l=d),d+=v.length;d%4;)N.push(0),d++;return i.write(N),r=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(r),i.data},t=function(n){var r,i,a,o;for(n=Eb.call(n);n.length%4;)n.push(0);for(a=new oo(n),i=0,r=0,o=n.length;r<o;r=r+=4)i+=a.readUInt32();return 4294967295&i},e}(),NC={}.hasOwnProperty,Hi=function(t,e){for(var n in e)NC.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Si=function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var jC=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="head",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},e.prototype.encode=function(n){var r;return(r=new oo).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(n),r.writeShort(this.glyphDataFormat),r.data},e}(),Gx=function(){function t(e,n){var r,i,a,o,l,c,d,f,p,v,m,N,_,k,y,b,j;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),v=m/2,e.pos+=6,a=function(){var C,B;for(B=[],c=C=0;0<=v?C<v:C>v;c=0<=v?++C:--C)B.push(e.readUInt16());return B}(),e.pos+=2,_=function(){var C,B;for(B=[],c=C=0;0<=v?C<v:C>v;c=0<=v?++C:--C)B.push(e.readUInt16());return B}(),d=function(){var C,B;for(B=[],c=C=0;0<=v?C<v:C>v;c=0<=v?++C:--C)B.push(e.readUInt16());return B}(),f=function(){var C,B;for(B=[],c=C=0;0<=v?C<v:C>v;c=0<=v?++C:--C)B.push(e.readUInt16());return B}(),i=(this.length-e.pos+this.offset)/2,l=function(){var C,B;for(B=[],c=C=0;0<=i?C<i:C>i;c=0<=i?++C:--C)B.push(e.readUInt16());return B}(),c=y=0,j=a.length;y<j;c=++y)for(k=a[c],r=b=N=_[c];N<=k?b<=k:b>=k;r=N<=k?++b:--b)f[c]===0?o=r+d[c]:(o=l[f[c]/2+(r-N)-(v-c)]||0)!==0&&(o+=d[c]),this.codeMap[r]=65535&o}e.pos=p}return t.encode=function(e,n){var r,i,a,o,l,c,d,f,p,v,m,N,_,k,y,b,j,C,B,K,Z,z,J,te,I,A,T,F,ne,W,ue,P,Q,G,de,w,O,R,H,re,oe,fe,be,ze,Le,Fe;switch(F=new oo,o=Object.keys(e).sort(function(Me,tt){return Me-tt}),n){case"macroman":for(_=0,k=function(){var Me=[];for(N=0;N<256;++N)Me.push(0);return Me}(),b={0:0},a={},ne=0,Q=o.length;ne<Q;ne++)b[be=e[i=o[ne]]]==null&&(b[be]=++_),a[i]={old:e[i],new:b[e[i]]},k[i]=b[e[i]];return F.writeUInt16(1),F.writeUInt16(0),F.writeUInt32(12),F.writeUInt16(0),F.writeUInt16(262),F.writeUInt16(0),F.write(k),{charMap:a,subtable:F.data,maxGlyphID:_+1};case"unicode":for(A=[],p=[],j=0,b={},r={},y=d=null,W=0,G=o.length;W<G;W++)b[B=e[i=o[W]]]==null&&(b[B]=++j),r[i]={old:B,new:b[B]},l=b[B]-i,y!=null&&l===d||(y&&p.push(y),A.push(i),d=l),y=i;for(y&&p.push(y),p.push(65535),A.push(65535),te=2*(J=A.length),z=2*Math.pow(Math.log(J)/Math.LN2,2),v=Math.log(z/2)/Math.LN2,Z=2*J-z,c=[],K=[],m=[],N=ue=0,de=A.length;ue<de;N=++ue){if(I=A[N],f=p[N],I===65535){c.push(0),K.push(0);break}if(I-(T=r[I].new)>=32768)for(c.push(0),K.push(2*(m.length+J-N)),i=P=I;I<=f?P<=f:P>=f;i=I<=f?++P:--P)m.push(r[i].new);else c.push(T-I),K.push(0)}for(F.writeUInt16(3),F.writeUInt16(1),F.writeUInt32(12),F.writeUInt16(4),F.writeUInt16(16+8*J+2*m.length),F.writeUInt16(0),F.writeUInt16(te),F.writeUInt16(z),F.writeUInt16(v),F.writeUInt16(Z),oe=0,w=p.length;oe<w;oe++)i=p[oe],F.writeUInt16(i);for(F.writeUInt16(0),fe=0,O=A.length;fe<O;fe++)i=A[fe],F.writeUInt16(i);for(ze=0,R=c.length;ze<R;ze++)l=c[ze],F.writeUInt16(l);for(Le=0,H=K.length;Le<H;Le++)C=K[Le],F.writeUInt16(C);for(Fe=0,re=m.length;Fe<re;Fe++)_=m[Fe],F.writeUInt16(_);return{charMap:r,subtable:F.data,maxGlyphID:j+1}}},t}(),Ib=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="cmap",e.prototype.parse=function(n){var r,i,a;for(n.pos=this.offset,this.version=n.readUInt16(),a=n.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)r=new Gx(n,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(n,r){var i,a;return r==null&&(r="macroman"),i=Gx.encode(n,r),(a=new oo).writeUInt16(0),a.writeUInt16(1),i.table=a.data.concat(i.subtable),i},e}(),SC=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="hhea",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},e}(),_C=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="OS/2",e.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var r,i;for(i=[],r=0;r<10;++r)i.push(n.readByte());return i}(),this.charRange=function(){var r,i;for(i=[],r=0;r<4;++r)i.push(n.readInt());return i}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var r,i;for(i=[],r=0;r<2;r=++r)i.push(n.readInt());return i}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},e}(),kC=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="post",e.prototype.parse=function(n){var r,i,a;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var o;for(i=n.readUInt16(),this.glyphNameIndex=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],a=[];n.pos<this.offset+this.length;)r=n.readByte(),a.push(this.names.push(n.readString(r)));return a;case 151552:return i=n.readUInt16(),this.offsets=n.read(i);case 196608:break;case 262144:return this.map=(function(){var l,c,d;for(d=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)d.push(n.readUInt32());return d}).call(this)}},e}(),CC=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},AC=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="name",e.prototype.parse=function(n){var r,i,a,o,l,c,d,f,p,v,m;for(n.pos=this.offset,n.readShort(),r=n.readShort(),c=n.readShort(),i=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)i.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+c+n.readShort()});for(d={},o=p=0,v=i.length;p<v;o=++p)a=i[o],n.pos=a.offset,f=n.readString(a.length),l=new CC(f,a),d[m=a.nameID]==null&&(d[m]=[]),d[a.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e}(),PC=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="maxp",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},e}(),IC=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="hmtx",e.prototype.parse=function(n){var r,i,a,o,l,c,d;for(n.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var f,p;for(p=[],r=f=0;0<=a?f<a:f>a;r=0<=a?++f:--f)p.push(n.readInt16());return p}(),this.widths=(function(){var f,p,v,m;for(m=[],f=0,p=(v=this.metrics).length;f<p;f++)o=v[f],m.push(o.advance);return m}).call(this),i=this.widths[this.widths.length-1],d=[],r=l=0;0<=a?l<a:l>a;r=0<=a?++l:--l)d.push(this.widths.push(i));return d},e.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},e}(),Eb=[].slice,EC=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(n){var r,i,a,o,l,c,d,f,p,v;return n in this.cache?this.cache[n]:(o=this.file.loca,r=this.file.contents,i=o.indexOf(n),(a=o.lengthOf(n))===0?this.cache[n]=null:(r.pos=this.offset+i,l=(c=new oo(r.read(a))).readShort(),f=c.readShort(),v=c.readShort(),d=c.readShort(),p=c.readShort(),this.cache[n]=l===-1?new TC(c,f,v,d,p):new LC(c,l,f,v,d,p),this.cache[n]))},e.prototype.encode=function(n,r,i){var a,o,l,c,d;for(l=[],o=[],c=0,d=r.length;c<d;c++)a=n[r[c]],o.push(l.length),a&&(l=l.concat(a.encode(i)));return o.push(l.length),{table:l,offsets:o}},e}(),LC=function(){function t(e,n,r,i,a,o){this.raw=e,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),TC=function(){function t(e,n,r,i,a){var o,l;for(this.raw=e,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,n,r;for(n=new oo(Eb.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)n.pos=this.glyphOffsets[e];return n.data},t}(),zC=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Hi(e,Si),e.prototype.tag="loca",e.prototype.parse=function(n){var r,i;return n.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,o;for(o=[],i=0,a=this.length;i<a;i+=2)o.push(2*n.readUInt16());return o}).call(this):(function(){var a,o;for(o=[],i=0,a=this.length;i<a;i+=4)o.push(n.readUInt32());return o}).call(this)},e.prototype.indexOf=function(n){return this.offsets[n]},e.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},e.prototype.encode=function(n,r){for(var i=new Uint32Array(this.offsets.length),a=0,o=0,l=0;l<i.length;++l)if(i[l]=a,o<r.length&&r[o]==l){++o,i[l]=a;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(a+=d)}for(var f=new Array(4*i.length),p=0;p<i.length;++p)f[4*p+3]=255&i[p],f[4*p+2]=(65280&i[p])>>8,f[4*p+1]=(16711680&i[p])>>16,f[4*p]=(4278190080&i[p])>>24;return f},e}(),OC=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,r,i,a;for(n in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)r=a[n],e[n]=i[r];return e},t.prototype.glyphsFor=function(e){var n,r,i,a,o,l,c;for(i={},o=0,l=e.length;o<l;o++)i[a=e[o]]=this.font.glyf.glyphFor(a);for(a in n=[],i)(r=i[a])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(a in c=this.glyphsFor(n))r=c[a],i[a]=r;return i},t.prototype.encode=function(e,n){var r,i,a,o,l,c,d,f,p,v,m,N,_,k,y;for(i in r=Ib.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),m={0:0},y=r.charMap)m[(c=y[i]).old]=c.new;for(N in v=r.maxGlyphID,o)N in m||(m[N]=v++);return f=function(b){var j,C;for(j in C={},b)C[b[j]]=j;return C}(m),p=Object.keys(f).sort(function(b,j){return b-j}),_=function(){var b,j,C;for(C=[],b=0,j=p.length;b<j;b++)l=p[b],C.push(f[l]);return C}(),a=this.font.glyf.encode(o,_,m),d=this.font.loca.encode(a.offsets,_),k={cmap:this.font.cmap.raw(),glyf:a.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(k["OS/2"]=this.font.os2.raw()),this.font.directory.encode(k)},t}();Pt.API.PDFObject=function(){var t;function e(){}return t=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},e.convert=function(n){var r,i,a,o;if(Array.isArray(n))return"["+function(){var l,c,d;for(d=[],l=0,c=n.length;l<c;l++)r=n[l],d.push(e.convert(r));return d}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in a=["<<"],n)o=n[i],a.push("/"+i+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+n},e}();const DC={latticini:7,carne:3,pesce:2,verdura:7,frutta:7,conserva:365,pane:3,bevande:30},Vr={INVENTORY:"haccp:inventory",REFRIGERATORS:"haccp:refrigerators",USED_INGREDIENTS:"haccp:used-ingredients",ONBOARDING:"haccp:onboarding",SUPPLIERS:"haccp:suppliers",ORDERS:"haccp:orders",MIGRATED:"haccp:migrated"},Ps={FIXED:"fixed",RANGE:"range",AMBIENT:"ambient"},MC=t=>{if(t.setTempMode)return t.setTempMode===Ps.FIXED?{mode:Ps.FIXED,value:t.setTempC}:t.setTempMode===Ps.RANGE?{mode:Ps.RANGE,range:t.setTempRangeC}:t.setTempMode===Ps.AMBIENT?{mode:Ps.AMBIENT}:{mode:"unknown"};const e=t.targetTemp||t.setTemperature||t.temperature||t.temp;if(!e)return t.unknownField?{mode:"unknown"}:{mode:Ps.AMBIENT};if(typeof e=="number")return{mode:Ps.FIXED,value:e};if(typeof e=="string"){let n=e.toLowerCase().trim().replace(/\s+/g," ").replace(/,/g,".");if(n.includes("ambiente")||n.includes("ambient"))return{mode:Ps.AMBIENT};const r=n.match(/\b(?:da\s*)?(-?\d+(?:\.\d+)?)\s*(?:\s*C|c)?\s*(?:-||a)\s*(-?\d+(?:\.\d+)?)/i);if(r){const o=parseFloat(r[1]),l=parseFloat(r[2]);return{mode:Ps.RANGE,range:{min:o,max:l}}}const i=n.match(/(\d+(?:\.\d+)?)\s*[-]\s*(\d+(?:\.\d+)?)/);if(i){const o=parseFloat(i[1]),l=parseFloat(i[2]);return{mode:Ps.RANGE,range:{min:o,max:l}}}const a=n.match(/(\d+(?:\.\d+)?)/);if(a){const o=parseFloat(a[1]);return{mode:Ps.FIXED,value:o}}}return{mode:Ps.AMBIENT}},RC={"haccp-inventory":Vr.INVENTORY,"haccp-refrigerators":Vr.REFRIGERATORS,"haccp-used-ingredients":Vr.USED_INGREDIENTS,"haccp-onboarding":Vr.ONBOARDING,"haccp-suppliers":Vr.SUPPLIERS,"haccp-orders":Vr.ORDERS},FC=()=>{if(localStorage.getItem(Vr.MIGRATED)==="true")return;console.log(" Iniziando migrazione chiavi localStorage...");let e=0;Object.entries(RC).forEach(([n,r])=>{const i=localStorage.getItem(n);if(i)try{JSON.parse(i),localStorage.setItem(r,i),console.log(` Migrato: ${n} -> ${r}`),e++}catch(a){console.warn(` Errore nel migrare ${n}:`,a)}}),localStorage.setItem(Vr.MIGRATED,"true"),console.log(` Migrazione completata: ${e} chiavi migrate`)},_l=t=>{try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch(e){return console.error(`Errore nel leggere ${t}:`,e),null}},Wx=(t,e)=>{try{localStorage.setItem(t,JSON.stringify(e))}catch(n){console.error(`Errore nel salvare ${t}:`,n)}},br=[{id:"carne",name:"Carne",color:"bg-red-100 text-red-800",temp:"0-4C",storage:"Frigorifero"},{id:"pesce",name:"Pesce",color:"bg-blue-100 text-blue-800",temp:"0-2C",storage:"Frigorifero"},{id:"latticini",name:"Latticini",color:"bg-yellow-100 text-yellow-800",temp:"2-4C",storage:"Frigorifero"},{id:"verdura",name:"Verdura",color:"bg-green-100 text-green-800",temp:"2-8C",storage:"Frigorifero"},{id:"frutta",name:"Frutta",color:"bg-orange-100 text-orange-800",temp:"2-8C",storage:"Frigorifero"},{id:"pane",name:"Pane",color:"bg-amber-100 text-amber-800",temp:"Ambiente",storage:"Shelf"},{id:"conserva",name:"Conserve",color:"bg-purple-100 text-purple-800",temp:"Ambiente",storage:"Shelf"},{id:"bevande",name:"Bevande",color:"bg-cyan-100 text-cyan-800",temp:"2-8C",storage:"Frigorifero"}],Zx=[{id:"pollo",name:"Petto di Pollo",category:"carne",temp:"0-4C"},{id:"manzo",name:"Macinato di Manzo",category:"carne",temp:"0-4C"},{id:"salmone",name:"Salmone Fresco",category:"pesce",temp:"0-2C"},{id:"tonno",name:"Tonno Fresco",category:"pesce",temp:"0-2C"},{id:"latte",name:"Latte Intero",category:"latticini",temp:"2-4C"},{id:"formaggio",name:"Formaggio Grana",category:"latticini",temp:"2-4C"},{id:"pomodori",name:"Pomodori",category:"verdura",temp:"2-8C"},{id:"lattuga",name:"Lattuga",category:"verdura",temp:"2-8C"},{id:"mele",name:"Mele",category:"frutta",temp:"2-8C"},{id:"banane",name:"Banane",category:"frutta",temp:"2-8C"},{id:"pane_bianco",name:"Pane Bianco",category:"pane",temp:"Ambiente"},{id:"pasta",name:"Pasta",category:"conserva",temp:"Ambiente"},{id:"acqua",name:"Acqua",category:"bevande",temp:"2-8C"}],kl=[{id:"glutine",name:"Glutine",color:"bg-amber-100 text-amber-800"},{id:"latte",name:"Latte",color:"bg-blue-100 text-blue-800"},{id:"uova",name:"Uova",color:"bg-yellow-100 text-yellow-800"},{id:"soia",name:"Soia",color:"bg-green-100 text-green-800"},{id:"frutta_guscio",name:"Frutta a Guscio",color:"bg-orange-100 text-orange-800"},{id:"arachidi",name:"Arachidi",color:"bg-red-100 text-red-800"},{id:"pesce",name:"Pesce",color:"bg-cyan-100 text-cyan-800"},{id:"crostacei",name:"Crostacei",color:"bg-purple-100 text-purple-800"}],$C=()=>{var ga;const{alertModal:t,confirmModal:e,promptModal:n,closeAlert:r,closeConfirm:i,closePrompt:a,alertSuccess:o,alertError:l,alertWarning:c,confirmDelete:d,promptText:f}=md(),[p,v]=q.useState([]),[m,N]=q.useState(!1),[_,k]=q.useState(null),{formRef:y,scrollToForm:b}=Zo(m,"inventory-product-form");q.useEffect(()=>{m&&b()},[m,b]);const[j,C]=q.useState(""),[B,K]=q.useState(""),[Z,z]=q.useState(""),[J,te]=q.useState(""),[I,A]=q.useState(""),[T,F]=q.useState(""),[ne,W]=q.useState(""),[ue,P]=q.useState(""),[Q,G]=q.useState(""),[de,w]=q.useState(!1),[O,R]=q.useState(!1),[H,re]=q.useState([]),[oe,fe]=q.useState([]),[be,ze]=q.useState([]),[Le,Fe]=q.useState([]),[Me,tt]=q.useState([]),[Ce,ie]=q.useState(!1),[pt,dt]=q.useState([]),[Ge,Qe]=q.useState(!1),[st,ae]=q.useState(!1),[Ae,Re]=q.useState([]),[he,Ne]=q.useState([]),[He,ce]=q.useState(!1),[pe,ke]=q.useState([]),[ye,Ze]=q.useState(!1),[Be,ut]=q.useState([]),[it,gt]=q.useState(!1),[Vt,vt]=q.useState(""),[Yt,Bt]=q.useState(""),[wt,Qt]=q.useState(""),[Et,rt]=q.useState(""),[yt,fn]=q.useState({name:"",category:"",department:"",conservationPoint:"",expiryDate:"",allergens:[],notes:"",lotNumber:"",batchDeliveryDate:"",supplierName:"",associatedOrderId:""}),[Ht,nr]=q.useState({orderId:"",supplierName:"",orderDate:new Date().toISOString().split("T")[0],notes:""});q.useEffect(()=>{var qt,on;FC();const U=_l(Vr.INVENTORY),Pe=_l(Vr.REFRIGERATORS),Te=_l(Vr.SUPPLIERS),Xe=_l(Vr.ORDERS),jt=_l(Vr.USED_INGREDIENTS),At=_l(Vr.ONBOARDING);if(At){if((qt=At.departments)!=null&&qt.list){const Kr=At.departments.list.filter(rn=>rn.enabled).map(rn=>({id:rn.id,name:rn.name}));Fe(Kr)}(on=At.conservation)!=null&&on.points&&tt(At.conservation.points)}U&&v(U),Pe&&re(Pe),Te&&fe(Te),Xe&&ze(Xe),jt&&ut(jt)},[]),q.useEffect(()=>{Wx(Vr.INVENTORY,p)},[p]),q.useEffect(()=>{Wx(Vr.USED_INGREDIENTS,Be)},[Be]),q.useEffect(()=>{const U=p.filter(Pe=>!Pe.conservationPoint||Pe.conservationPoint==="");dt(U),U.length>0&&ie(!0)},[p]);const Sr=U=>{const Pe=p.filter(Te=>Te.department===U);if(Pe.length>0){const Te=`Il reparto "${U}" contiene ${Pe.length} prodotti. Vuoi sostituirlo con un altro reparto?`;d(Te,()=>{f(`Seleziona il nuovo reparto per i ${Pe.length} prodotti:
${Le.map(Xe=>Xe.name).join(`
`)}`,Xe=>{Xe&&Le.find(jt=>jt.name===Xe)?(v(jt=>jt.map(At=>At.department===U?{...At,department:Xe}:At)),Fe(jt=>jt.filter(At=>At.name!==U)),o(`Reparto "${U}" sostituito con "${Xe}" per ${Pe.length} prodotti.`)):l("Reparto non valido. Operazione annullata.")},{title:"Seleziona nuovo reparto",placeholder:"Nome del nuovo reparto",validation:Xe=>!Xe||!Le.find(jt=>jt.name===Xe)?{isValid:!1,error:"Seleziona un reparto valido dalla lista"}:{isValid:!0,error:""}})})}else Fe(Te=>Te.filter(Xe=>Xe.name!==U))},Nt=U=>{const Pe=p.filter(Te=>Te.conservationPoint===U);if(Pe.length>0){const Te=`Il punto di conservazione "${U}" contiene ${Pe.length} prodotti. Vuoi sostituirlo con un altro punto?`;d(Te,()=>{f(`Seleziona il nuovo punto di conservazione per i ${Pe.length} prodotti:
${Me.map(Xe=>Xe.name).join(`
`)}`,Xe=>{Xe&&Me.find(jt=>jt.name===Xe)?(v(jt=>jt.map(At=>At.conservationPoint===U?{...At,conservationPoint:Xe}:At)),tt(jt=>jt.filter(At=>At.name!==U)),o(`Punto di conservazione "${U}" sostituito con "${Xe}" per ${Pe.length} prodotti.`)):l("Punto di conservazione non valido. Operazione annullata.")},{title:"Seleziona nuovo punto di conservazione",placeholder:"Nome del nuovo punto di conservazione",validation:Xe=>!Xe||!Me.find(jt=>jt.name===Xe)?{isValid:!1,error:"Seleziona un punto di conservazione valido dalla lista"}:{isValid:!0,error:""}})})}else tt(Te=>Te.filter(Xe=>Xe.name!==U))},rr=U=>{const Pe=new Date,Xe=new Date(U)-Pe,jt=Math.ceil(Xe/(1e3*60*60*24));return jt<0?{status:"expired",label:"Scaduto",color:"bg-red-100 text-red-800"}:jt<=3?{status:"critical",label:"Critico",color:"bg-red-100 text-red-800"}:jt<=7?{status:"warning",label:"In scadenza",color:"bg-yellow-100 text-yellow-800"}:{status:"ok",label:"OK",color:"bg-green-100 text-green-800"}},Jr=U=>{if(!br.find(Xe=>Xe.id===U))return"Categoria non trovata";const Te=H.find(Xe=>{const jt=MC(Xe);return jt.mode==="fixed"&&jt.value>=0&&jt.value<=4});return Te?Te.name:"Nessun frigorifero appropriato"},cr=U=>{const Pe=new Date,Te=DC[U]||7,Xe=new Date(Pe);return Xe.setDate(Pe.getDate()+Te),Xe.toISOString().split("T")[0]},Ln=U=>{ut(Pe=>Pe.filter(Te=>Te.id!==U.id)),fn({name:U.name,category:U.category,expiryDate:cr(U.category),department:U.department||"",conservationPoint:U.conservationPoint||"",allergens:U.allergens||[],notes:U.notes||"",lotNumber:U.lotNumber||"",batchDeliveryDate:U.batchDeliveryDate||"",associatedOrderId:U.associatedOrderId||"",supplierName:U.supplierName||""}),N(!0),gt(!1)},xn=U=>{ke(Pe=>Pe.includes(U)?Pe.filter(Te=>Te!==U):[...Pe,U])},_r=U=>{U.preventDefault(),p.filter(Te=>pe.includes(Te.id));const Pe=p.map(Te=>pe.includes(Te.id)?{...Te,associatedOrderId:Ht.orderId,supplierName:Ht.supplierName,batchDeliveryDate:Ht.orderDate,lotNumber:`L${new Date().toISOString().slice(2,10).replace(/-/g,"")}${Math.random().toString(36).substr(2,3).toUpperCase()}`}:Te);v(Pe),ke([]),Ze(!1),nr({orderId:"",supplierName:"",orderDate:new Date().toISOString().split("T")[0],notes:""})},_i=U=>{Ne(Pe=>Pe.includes(U)?Pe.filter(Te=>Te!==U):[...Pe,U])},os=()=>{const U=new Pt;U.setFontSize(20),U.text("Lista della Spesa",20,30),U.setFontSize(12),U.text(`Data: ${new Date().toLocaleDateString("it-IT")}`,20,45);let Pe=60;U.setFontSize(14),U.text("Prodotti da acquistare:",20,Pe),Pe+=10;const Te=p.filter(Xe=>he.includes(Xe.id));Te.length===0?(U.setFontSize(12),U.text("Nessun prodotto selezionato",20,Pe)):(U.setFontSize(10),Te.forEach((Xe,jt)=>{Pe>280&&(U.addPage(),Pe=20);const At=br.find(qt=>qt.id===Xe.category);U.text(`${jt+1}. ${Xe.name}`,20,Pe),At&&U.text(`   Categoria: ${At.name}`,25,Pe+5),Xe.department&&U.text(`   Reparto: ${Xe.department}`,25,Pe+10),Xe.conservationPoint&&U.text(`   Punto di Conservazione: ${Xe.conservationPoint}`,25,Pe+15),Pe+=20})),U.save(`lista-spesa-${new Date().toISOString().split("T")[0]}.pdf`),ce(!1),Ne([])},zr=U=>{if(de){const Pe={};return U.forEach(Te=>{const Xe=Te.department||"Non assegnato";Pe[Xe]||(Pe[Xe]=[]),Pe[Xe].push(Te)}),Pe}else if(O){const Pe={};return U.forEach(Te=>{const Xe=Te.conservationPoint||"Non assegnato";Pe[Xe]||(Pe[Xe]=[]),Pe[Xe].push(Te)}),Pe}return{"Tutti i prodotti":U}},Pn=p.filter(U=>{var Gi,Ms,Ai;const Pe=!j||U.name.toLowerCase().includes(j.toLowerCase())||((Gi=U.department)==null?void 0:Gi.toLowerCase().includes(j.toLowerCase()))||((Ms=U.conservationPoint)==null?void 0:Ms.toLowerCase().includes(j.toLowerCase()))||((Ai=br.find(ii=>ii.id===U.category))==null?void 0:Ai.name.toLowerCase().includes(j.toLowerCase())),Te=!B||U.category===B;let Xe=!0;Z&&(Xe=rr(U.expiryDate).status===Z);const jt=!J||U.allergens&&U.allergens.includes(J),At=!I||U.lotNumber&&U.lotNumber.toLowerCase().includes(I.toLowerCase()),qt=!T||U.supplierName&&U.supplierName.toLowerCase().includes(T.toLowerCase()),on=!ne||U.associatedOrderId&&U.associatedOrderId.toLowerCase().includes(ne.toLowerCase()),Kr=!ue||U.department===ue,rn=!Q||U.conservationPoint===Q;return Pe&&Te&&Xe&&jt&&At&&qt&&on&&Kr&&rn}),kr=()=>{fn({name:"",category:"",department:"",conservationPoint:"",expiryDate:"",allergens:[],notes:"",lotNumber:"",batchDeliveryDate:"",supplierName:"",associatedOrderId:""}),k(null),N(!1)},ur=(U,Pe)=>{fn(Te=>({...Te,[U]:Pe}))},Or=U=>{fn(Pe=>({...Pe,allergens:Pe.allergens.includes(U)?Pe.allergens.filter(Te=>Te!==U):[...Pe.allergens,U]}))},Hn=U=>{if(U.preventDefault(),!yt.name||!yt.category||!yt.department||!yt.conservationPoint||!yt.expiryDate){l("Compila tutti i campi obbligatori");return}const Pe={...yt,id:_?_.id:Date.now().toString(),addedAt:_?_.addedAt:new Date().toISOString()};v(_?Te=>Te.map(Xe=>Xe.id===_.id?Pe:Xe):Te=>[...Te,Pe]),kr()},Ss=U=>{fn({name:U.name,category:U.category,department:U.department||"",conservationPoint:U.conservationPoint||"",expiryDate:U.expiryDate,allergens:U.allergens||[],notes:U.notes||"",lotNumber:U.lotNumber||"",batchDeliveryDate:U.batchDeliveryDate||"",supplierName:U.supplierName||"",associatedOrderId:U.associatedOrderId||""}),k(U),N(!0)},ri=U=>{const Pe=p.find(Te=>Te.id===U);if(Pe){const Te={...Pe,usedDate:new Date().toISOString(),id:`used_${Date.now()}_${Pe.id}`};ut(Xe=>[...Xe,Te])}v(Te=>Te.filter(Xe=>Xe.id!==U))},si=U=>{const Pe=new Date,Te=new Date(Pe.getTime()+7*24*60*60*1e3),Xe=Jr(U.category),jt=Me.find(on=>on.name===Xe),At=(jt==null?void 0:jt.location)||"",qt={...U,id:Date.now().toString(),department:At,conservationPoint:Xe,expiryDate:Te.toISOString().split("T")[0],allergens:[],notes:"",lotNumber:"",batchDeliveryDate:Pe.toISOString().split("T")[0],supplierName:"",associatedOrderId:"",addedAt:new Date().toISOString()};v(on=>[...on,qt])},ki=U=>{Re(Pe=>Pe.includes(U)?Pe.filter(Te=>Te!==U):[...Pe,U])},Ci=()=>{v(U=>U.filter(Pe=>!Ae.includes(Pe.id))),Re([]),Qe(!1)},pa=()=>{v([]),ae(!1)},po=()=>{const U=new Pt;U.setFontSize(20),U.text("Inventario HACCP",20,20),U.setFontSize(12),U.text(`Data: ${new Date().toLocaleDateString("it-IT")}`,20,30),U.text(`Totale prodotti: ${p.length}`,20,40);let Pe=60;p.forEach((Te,Xe)=>{Pe>280&&(U.addPage(),Pe=20);const jt=br.find(qt=>qt.id===Te.category),At=rr(Te.expiryDate);if(U.text(`${Xe+1}. ${Te.name}`,20,Pe),U.text(`   Categoria: ${(jt==null?void 0:jt.name)||"N/A"}`,25,Pe+5),Te.department&&U.text(`   Reparto: ${Te.department}`,25,Pe+10),Te.conservationPoint&&U.text(`   Punto di Conservazione: ${Te.conservationPoint}`,25,Pe+15),U.text(`   Scadenza: ${new Date(Te.expiryDate).toLocaleDateString("it-IT")} (${At.label})`,25,Pe+15),Te.allergens&&Te.allergens.length>0){const qt=Te.allergens.map(on=>{var Kr;return(Kr=kl.find(rn=>rn.id===on))==null?void 0:Kr.name}).filter(Boolean).join(", ");U.text(`   Allergeni: ${qt}`,25,Pe+20),Pe+=25}else Pe+=20;Te.notes&&(U.text(`   Note: ${Te.notes}`,25,Pe),Pe+=10),Pe+=10}),U.save(`inventario-haccp-${new Date().toISOString().split("T")[0]}.pdf`)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Inventario"}),s.jsx("p",{className:"text-gray-600",children:"Gestisci i prodotti e la tracciabilit HACCP"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{onClick:po,className:"flex items-center gap-2",children:[s.jsx(Ys,{className:"h-4 w-4"}),"Export PDF"]}),s.jsxs(le,{onClick:()=>N(!0),className:"bg-blue-600 hover:bg-blue-700",children:[s.jsx(pr,{className:"h-4 w-4 mr-2"}),"Aggiungi Prodotto"]}),s.jsxs(le,{variant:"outline",onClick:()=>gt(!it),className:"flex items-center gap-2",children:[s.jsx(Vn,{className:"h-4 w-4"}),"Ingredienti Utilizzati (",Be.length,")"]})]})]}),s.jsx(an,{title:"Filtri",icon:I5,defaultExpanded:!0,children:s.jsx(et,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"search",children:"Cerca"}),s.jsxs("div",{className:"relative",children:[s.jsx(Tl,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(bt,{id:"search",value:j,onChange:U=>C(U.target.value),placeholder:"Nome prodotto, reparto, punto di conservazione...",className:"pl-10"})]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"category",children:"Categoria"}),s.jsxs("select",{id:"category",value:B,onChange:U=>K(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tutte le categorie"}),br.map(U=>s.jsx("option",{value:U.id,children:U.name},U.id))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"expiry",children:"Scadenza"}),s.jsxs("select",{id:"expiry",value:Z,onChange:U=>z(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tutte le scadenze"}),s.jsx("option",{value:"expired",children:"Scaduti"}),s.jsx("option",{value:"critical",children:"Critici (3 giorni)"}),s.jsx("option",{value:"warning",children:"In scadenza (7 giorni)"}),s.jsx("option",{value:"ok",children:"OK (>7 giorni)"})]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"allergen",children:"Allergene"}),s.jsxs("select",{id:"allergen",value:J,onChange:U=>te(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tutti gli allergeni"}),kl.map(U=>s.jsx("option",{value:U.id,children:U.name},U.id))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"lot",children:"Numero Lotto"}),s.jsx(bt,{id:"lot",value:I,onChange:U=>A(U.target.value),placeholder:"Filtra per numero lotto..."})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"supplier",children:"Fornitore"}),s.jsx(bt,{id:"supplier",value:T,onChange:U=>F(U.target.value),placeholder:"Filtra per fornitore..."})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"orderId",children:"ID Ordine"}),s.jsx(bt,{id:"orderId",value:ne,onChange:U=>W(U.target.value),placeholder:"Filtra per ID ordine..."})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"department",children:"Reparto"}),s.jsxs("select",{id:"department",value:ue,onChange:U=>P(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tutti i reparti"}),Le.map(U=>s.jsx("option",{value:U.name,children:U.name},U.id))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"conservationPoint",children:"Punto di Conservazione"}),s.jsxs("select",{id:"conservationPoint",value:Q,onChange:U=>G(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tutti i punti"}),Me.map(U=>s.jsx("option",{value:U.name,children:U.name},U.id))]})]}),s.jsxs("div",{className:"col-span-full",children:[s.jsxs("div",{className:"flex flex-wrap gap-4 items-center mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"groupByDepartment",checked:de,onChange:U=>{w(U.target.checked),U.target.checked&&R(!1)},className:"rounded"}),s.jsx(Je,{htmlFor:"groupByDepartment",className:"text-sm",children:"Raggruppa per Reparto"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"groupByConservationPoint",checked:O,onChange:U=>{R(U.target.checked),U.target.checked&&w(!1)},className:"rounded"}),s.jsx(Je,{htmlFor:"groupByConservationPoint",className:"text-sm",children:"Raggruppa per Punto di Conservazione"})]})]}),s.jsx(le,{onClick:()=>{C(""),K(""),z(""),te(""),A(""),F(""),W(""),P(""),G(""),w(!1),R(!1)},variant:"outline",className:"w-full",children:" Reset Filtri"})]})]})})}),Ce&&pt.length>0&&s.jsx(an,{title:`Attenzione: ${pt.length} prodotti senza punto di conservazione!`,icon:pn,defaultExpanded:!0,className:"border-red-200 bg-red-50",children:s.jsxs(et,{children:[s.jsx("p",{className:"text-red-700 mb-4",children:"I seguenti prodotti devono essere posizionati in un adeguato punto di conservazione:"}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:pt.map(U=>{const Pe=br.find(Te=>Te.id===U.category);return s.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-red-200",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),s.jsx("span",{className:"font-medium",children:U.name}),s.jsxs("span",{className:"text-sm text-gray-600",children:["(",(Pe==null?void 0:Pe.name)||"Categoria sconosciuta",")"]})]}),s.jsxs(le,{onClick:()=>{Ss(U),ie(!1)},size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:[s.jsx(wi,{className:"h-4 w-4 mr-1"}),"Assegna"]})]},U.id)})}),s.jsx("div",{className:"flex gap-2 mt-4",children:s.jsx(le,{onClick:()=>ie(!1),variant:"outline",size:"sm",children:"Chiudi"})})]})}),s.jsxs(an,{title:"Gestione Inventario",icon:Vn,defaultExpanded:!0,children:[s.jsx("div",{className:"flex gap-2 mb-4",children:p.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(le,{onClick:()=>Qe(!0),className:"flex items-center gap-2",variant:"outline",children:" Rimuovi Prodotti"}),s.jsx(le,{onClick:()=>ae(!0),className:"flex items-center gap-2",variant:"destructive",children:" Cancella Tutto l'Inventario"})]})}),s.jsx(et,{children:Pn.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Vn,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),s.jsx("p",{className:"text-gray-600",children:p.length===0?"Inventario vuoto. Inizia aggiungendo prodotti con i pulsanti categoria sopra!":"Nessun prodotto trovato con i filtri attuali"})]}):s.jsx("div",{className:"space-y-3",children:Object.entries(zr(Pn)).map(([U,Pe])=>s.jsxs("div",{children:[(de||O)&&s.jsxs("h3",{className:"text-lg font-semibold mb-3 text-gray-800 bg-gray-100 px-3 py-2 rounded-md",children:[U," (",Pe.length," prodotti)"]}),s.jsx("div",{className:"space-y-3",children:Pe.map(Te=>{const Xe=br.find(At=>At.id===Te.category),jt=rr(Te.expiryDate);return s.jsx("div",{className:"border rounded-lg p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-medium",children:Te.name||"Prodotto non disponibile"}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Xe==null?void 0:Xe.color}`,children:Xe==null?void 0:Xe.name}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${jt.color}`,children:jt.label})]}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsxs("p",{children:[" Reparto: ",Te.department||"Non assegnato"]}),s.jsxs("p",{children:[" Punto: ",Te.conservationPoint||"Non assegnato"]}),s.jsxs("p",{children:[" Scadenza: ",new Date(Te.expiryDate).toLocaleDateString("it-IT")]}),Te.allergens&&Te.allergens.length>0&&s.jsxs("p",{children:[" Allergeni: ",Te.allergens.map(At=>{var qt;return(qt=kl.find(on=>on.id===At))==null?void 0:qt.name}).join(", ")]}),Te.notes&&s.jsxs("p",{children:[" ",Te.notes]})]})]}),s.jsxs("div",{className:"flex gap-2 ml-4",children:[s.jsx(le,{onClick:()=>Ss(Te),size:"sm",variant:"outline",children:s.jsx(wi,{className:"h-4 w-4"})}),s.jsx(le,{onClick:()=>ri(Te.id),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:s.jsx(er,{className:"h-4 w-4"})})]})]})},Te.id)})})]},U))})})]}),s.jsxs(an,{title:`Prodotti nell'inventario (${Pn.length})`,icon:Vn,defaultExpanded:!0,children:[(de||O)&&s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Raggruppati per ",de?"Reparto":"Punto di Conservazione"]}),s.jsx("div",{className:"flex gap-2 mb-4",children:p.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(le,{onClick:()=>Qe(!0),className:"flex items-center gap-2",variant:"outline",children:" Rimuovi Prodotti"}),s.jsx(le,{onClick:()=>ae(!0),className:"flex items-center gap-2",variant:"destructive",children:" Cancella Tutto l'Inventario"})]})}),s.jsx(et,{children:Pn.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Vn,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),s.jsx("p",{className:"text-gray-600",children:p.length===0?"Inventario vuoto. Inizia aggiungendo prodotti con i pulsanti categoria sopra!":"Nessun prodotto trovato con i filtri attuali"})]}):s.jsx("div",{className:"space-y-3",children:Object.entries(zr(Pn)).map(([U,Pe])=>s.jsxs("div",{children:[(de||O)&&s.jsxs("h3",{className:"text-lg font-semibold mb-3 text-gray-800 bg-gray-100 px-3 py-2 rounded-md",children:[U," (",Pe.length," prodotti)"]}),s.jsx("div",{className:"space-y-3",children:Pe.map(Te=>{const Xe=br.find(At=>At.id===Te.category),jt=rr(Te.expiryDate);return s.jsx("div",{className:"border rounded-lg p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-medium",children:Te.name||"Prodotto non disponibile"}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Xe==null?void 0:Xe.color}`,children:Xe==null?void 0:Xe.name}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${jt.color}`,children:jt.label})]}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsxs("p",{children:[" Reparto: ",Te.department||"Non assegnato"]}),s.jsxs("p",{children:[" Punto: ",Te.conservationPoint||"Non assegnato"]}),s.jsxs("p",{children:[" Scadenza: ",new Date(Te.expiryDate).toLocaleDateString("it-IT")]}),Te.allergens&&Te.allergens.length>0&&s.jsxs("p",{children:[" Allergeni: ",Te.allergens.map(At=>{var qt;return(qt=kl.find(on=>on.id===At))==null?void 0:qt.name}).join(", ")]}),Te.notes&&s.jsxs("p",{children:[" ",Te.notes]})]})]}),s.jsxs("div",{className:"flex gap-2 ml-4",children:[s.jsx(le,{onClick:()=>Ss(Te),size:"sm",variant:"outline",children:s.jsx(wi,{className:"h-4 w-4"})}),s.jsx(le,{onClick:()=>ri(Te.id),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:s.jsx(er,{className:"h-4 w-4"})})]})]})},Te.id)})})]},U))})})]}),s.jsx(an,{title:"Gestione Reparti e Punti di Conservazione",icon:Wr,defaultExpanded:!1,children:s.jsx(et,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold mb-3",children:["Reparti Attivi (",Le.length,")"]}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:Le.map(U=>{const Pe=p.filter(Te=>Te.department===U.name).length;return s.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:U.name}),s.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",Pe," prodotti)"]})]}),s.jsx(le,{onClick:()=>Sr(U.name),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:s.jsx(er,{className:"h-4 w-4"})})]},U.id)})})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold mb-3",children:["Punti di Conservazione (",Me.length,")"]}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:Me.map(U=>{const Pe=p.filter(Te=>Te.conservationPoint===U.name).length;return s.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:U.name}),s.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",Pe," prodotti)"]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[U.location,"  ",U.targetTemp,"C"]})]}),s.jsx(le,{onClick:()=>Nt(U.name),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:s.jsx(er,{className:"h-4 w-4"})})]},U.id)})})]})]})})}),!m&&s.jsx(an,{title:"Aggiunta prodotti rapidi",icon:Vn,defaultExpanded:!1,children:s.jsxs(et,{children:[s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:br.map(U=>{const Pe=Zx.filter(Te=>Te.category===U.id);return s.jsx("div",{className:"space-y-2",children:s.jsxs("button",{onClick:()=>K(B===U.id?"":U.id),className:`w-full p-4 text-left rounded-lg border-2 transition-colors ${B===U.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[s.jsx("div",{className:`inline-flex px-2 py-1 text-xs rounded-full ${U.color} mb-2`,children:U.name}),s.jsx("div",{className:"text-sm font-medium",children:U.temp}),s.jsx("div",{className:"text-xs text-gray-600",children:U.storage}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Pe.length," prodotti"]})]})},U.id)})}),B&&s.jsxs("div",{className:"border-t pt-4",children:[s.jsxs("h4",{className:"font-medium mb-3",children:["Prodotti ",(ga=br.find(U=>U.id===B))==null?void 0:ga.name,":"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Zx.filter(U=>U.category===B).map(U=>{var Pe;return s.jsx("button",{onClick:()=>si(U),className:"p-3 text-left bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors group",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-sm text-green-900",children:U.name||"Prodotto non disponibile"}),s.jsx("div",{className:"text-xs text-green-700 mt-1",children:H.length>0?Jr(U.category):"Nessun frigorifero registrato"}),s.jsx("div",{className:"text-xs text-green-600 mt-1",children:(Pe=br.find(Te=>Te.id===U.category))==null?void 0:Pe.temp})]}),s.jsx(pr,{className:"h-4 w-4 text-green-600 group-hover:text-green-700"})]})},U.id)})})]}),!B&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Vn,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),s.jsx("p",{className:"text-sm",children:"Seleziona una categoria sopra per vedere i prodotti disponibili"})]})]})}),s.jsx(an,{title:"Ordini e Spesa",icon:q4,defaultExpanded:!1,children:s.jsx(et,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:" Lista della Spesa"}),s.jsx(le,{onClick:()=>ce(!0),disabled:he.length===0,size:"sm",variant:"outline",children:" Genera PDF"})]}),s.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:Pn.length===0?s.jsxs("div",{className:"text-center py-4 text-gray-500",children:[s.jsx("p",{className:"text-sm",children:"Nessun prodotto disponibile per la lista della spesa"}),s.jsx("p",{className:"text-xs",children:"Aggiungi prodotti all'inventario per iniziare"})]}):Pn.map(U=>{const Pe=he.includes(U.id);return s.jsxs("div",{className:"flex items-center p-2 border rounded hover:bg-gray-50",children:[s.jsx("input",{type:"checkbox",checked:Pe,onChange:()=>_i(U.id),className:"mr-3 w-4 h-4"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-sm",children:U.name||"Prodotto non disponibile"}),s.jsx("div",{className:"text-xs text-gray-500",children:U.department&&U.conservationPoint?`${U.department}  ${U.conservationPoint}`:U.department||U.conservationPoint||"Non assegnato"})]})]},U.id)})}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Selezionati: ",he.length," prodotti"]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:" Gestione Ordini"}),s.jsx(le,{onClick:()=>Ze(!0),disabled:pe.length===0,size:"sm",variant:"outline",children:" Crea Ordine"})]}),s.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:Pn.length===0?s.jsxs("div",{className:"text-center py-4 text-gray-500",children:[s.jsx("p",{className:"text-sm",children:"Nessun prodotto disponibile per gli ordini"}),s.jsx("p",{className:"text-xs",children:"Aggiungi prodotti all'inventario per iniziare"})]}):Pn.map(U=>{const Pe=pe.includes(U.id);return s.jsxs("div",{className:"flex items-center p-2 border rounded hover:bg-gray-50",children:[s.jsx("input",{type:"checkbox",checked:Pe,onChange:()=>xn(U.id),className:"mr-3 w-4 h-4"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-sm",children:U.name||"Prodotto non disponibile"}),s.jsx("div",{className:"text-xs text-gray-500",children:U.department&&U.conservationPoint?`${U.department}  ${U.conservationPoint}`:U.department||U.conservationPoint||"Non assegnato"})]})]},U.id)})}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Prodotti selezionati: ",pe.length]})]})]})})}),it&&s.jsx(an,{title:`Ingredienti gi Utilizzati (${Be.length})`,icon:Vn,defaultExpanded:!1,children:s.jsx(et,{children:Be.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Vn,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),s.jsx("p",{className:"text-lg font-medium",children:"Nessun ingrediente utilizzato"}),s.jsx("p",{className:"text-sm",children:"I prodotti eliminati dall'inventario appariranno qui"})]}):s.jsx("div",{className:"space-y-3",children:Be.map(U=>{var Pe;return s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border rounded-lg opacity-75",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-900",children:U.name}),s.jsxs("div",{className:"text-sm text-gray-600",children:[(Pe=br.find(Te=>Te.id===U.category))==null?void 0:Pe.name," ",U.location,"  Utilizzato: ",new Date(U.usedDate).toLocaleDateString("it-IT")]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{onClick:()=>Ln(U),size:"sm",className:"bg-green-600 hover:bg-green-700",children:" Reinserisci"}),s.jsx(le,{onClick:()=>{d("Sei sicuro di voler eliminare definitivamente questo ingrediente?",()=>{ut(Te=>Te.filter(Xe=>Xe.id!==U.id))})},size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:" Elimina"})]})]},U.id)})})})}),s.jsx(an,{title:"Categorie Personalizzate",icon:Wr,defaultExpanded:!1,children:s.jsx(D6,{})}),m&&s.jsxs(ot,{ref:y,id:"inventory-product-form",children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(pr,{className:"h-5 w-5"}),_?"Modifica Prodotto":"Aggiungi Prodotto"]})}),s.jsx(et,{children:s.jsxs("form",{onSubmit:Hn,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"name",children:"Nome Prodotto *"}),s.jsx(bt,{id:"name",value:yt.name,onChange:U=>ur("name",U.target.value),placeholder:"Es. Pomodori San Marzano",required:!0})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"category",children:"Categoria *"}),s.jsxs("select",{id:"category",value:yt.category,onChange:U=>ur("category",U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Seleziona categoria"}),br.map(U=>s.jsx("option",{value:U.id,children:U.name},U.id))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"department",children:"Reparto *"}),s.jsxs("select",{id:"department",value:yt.department,onChange:U=>ur("department",U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Seleziona reparto"}),Le.map(U=>s.jsx("option",{value:U.name,children:U.name},U.id))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"conservationPoint",children:"Punto di Conservazione *"}),s.jsxs("select",{id:"conservationPoint",value:yt.conservationPoint,onChange:U=>ur("conservationPoint",U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Seleziona punto di conservazione"}),Me.map(U=>s.jsx("option",{value:U.name,children:U.name},U.id))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"expiryDate",children:"Data di Scadenza *"}),s.jsx(bt,{id:"expiryDate",type:"date",value:yt.expiryDate,onChange:U=>ur("expiryDate",U.target.value),required:!0})]})]}),s.jsxs("div",{children:[s.jsx(Je,{children:"Allergeni"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-2",children:kl.map(U=>s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",checked:yt.allergens.includes(U.id),onChange:()=>Or(U.id),className:"rounded"}),s.jsx("span",{className:"text-sm",children:U.name})]},U.id))})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"notes",children:"Note"}),s.jsx("textarea",{id:"notes",value:yt.notes,onChange:U=>ur("notes",U.target.value),placeholder:"Note aggiuntive sul prodotto...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(le,{type:"button",onClick:kr,variant:"outline",children:"Annulla"}),s.jsxs(le,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[_?"Aggiorna":"Aggiungi"," Prodotto"]})]})]})})]}),Ge&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Rimuovi Prodotti dall'Inventario"}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx("input",{type:"text",value:Vt,onChange:U=>vt(U.target.value),placeholder:"Cerca prodotti, reparti, punti...",className:"px-3 py-2 border rounded-md"}),s.jsxs("select",{value:Yt,onChange:U=>Bt(U.target.value),className:"px-3 py-2 border rounded-md",children:[s.jsx("option",{value:"",children:"Tutte le categorie"}),br.map(U=>s.jsx("option",{value:U.id,children:U.name},U.id))]}),s.jsxs("select",{value:wt,onChange:U=>Qt(U.target.value),className:"px-3 py-2 border rounded-md",children:[s.jsx("option",{value:"",children:"Tutte le scadenze"}),s.jsx("option",{value:"expired",children:"Scaduti"}),s.jsx("option",{value:"critical",children:"Critici (3 giorni)"}),s.jsx("option",{value:"warning",children:"In scadenza (7 giorni)"}),s.jsx("option",{value:"ok",children:"OK (>7 giorni)"})]}),s.jsxs("select",{value:Et,onChange:U=>rt(U.target.value),className:"px-3 py-2 border rounded-md",children:[s.jsx("option",{value:"",children:"Tutti gli allergeni"}),kl.map(U=>s.jsx("option",{value:U.id,children:U.name},U.id))]})]}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Seleziona i prodotti da rimuovere dall'inventario:"}),s.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:Pn.filter(U=>{var At,qt,on;const Pe=!Vt||U.name.toLowerCase().includes(Vt.toLowerCase())||((At=U.department)==null?void 0:At.toLowerCase().includes(Vt.toLowerCase()))||((qt=U.conservationPoint)==null?void 0:qt.toLowerCase().includes(Vt.toLowerCase()))||((on=br.find(Kr=>Kr.id===U.category))==null?void 0:on.name.toLowerCase().includes(Vt.toLowerCase())),Te=!Yt||U.category===Yt;let Xe=!0;wt&&(Xe=rr(U.expiryDate).status===wt);const jt=!Et||U.allergens&&U.allergens.includes(Et);return Pe&&Te&&Xe&&jt}).map(U=>{const Pe=br.find(Xe=>Xe.id===U.category),Te=rr(U.expiryDate);return s.jsxs("div",{className:"flex items-center p-2 border rounded hover:bg-gray-50",children:[s.jsx("input",{type:"checkbox",checked:Ae.includes(U.id),onChange:()=>ki(U.id),className:"mr-3 w-4 h-4"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:U.name||"Prodotto non disponibile"}),s.jsxs("div",{className:"text-sm text-gray-500",children:[Pe==null?void 0:Pe.name,"  ",U.department||"N/A","  ",U.conservationPoint||"N/A","  Scade: ",new Date(U.expiryDate).toLocaleDateString("it-IT")]})]}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Te.color}`,children:Te.label})]},U.id)})})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Selezionati: ",Ae.length," prodotti"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{onClick:()=>Qe(!1),variant:"outline",children:"Annulla"}),s.jsxs(le,{onClick:Ci,disabled:Ae.length===0,className:"bg-red-600 hover:bg-red-700",children:["Rimuovi ",Ae.length," Prodotti"]})]})]})]})}),He&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:" Lista della Spesa"}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Prodotti selezionati per la lista della spesa (",he.length,"):"]}),s.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:he.length===0?s.jsxs("div",{className:"text-center py-4 text-gray-500",children:[s.jsx("p",{className:"text-sm",children:"Nessun prodotto selezionato"}),s.jsx("p",{className:"text-xs",children:"Torna alla sezione inventario per selezionare i prodotti"})]}):p.filter(U=>he.includes(U.id)).map(U=>{const Pe=br.find(Te=>Te.id===U.category);return s.jsx("div",{className:"flex items-center p-3 border rounded bg-gray-50",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:U.name||"Prodotto non disponibile"}),s.jsxs("div",{className:"text-sm text-gray-600",children:[Pe==null?void 0:Pe.name,"  ",U.department||"N/A","  ",U.conservationPoint||"N/A"]})]})},U.id)})})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(le,{onClick:os,className:"flex-1",children:" Genera PDF"}),s.jsx(le,{onClick:()=>{ce(!1),Ne([])},variant:"outline",children:"Annulla"})]})]})}),ye&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:" Crea Nuovo Ordine"}),s.jsxs("form",{onSubmit:_r,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{children:"Numero Ordine *"}),s.jsx(bt,{value:Ht.orderId,onChange:U=>nr({...Ht,orderId:U.target.value}),placeholder:"es. ORD-2024-001",required:!0})]}),s.jsxs("div",{children:[s.jsx(Je,{children:"Fornitore *"}),s.jsx(bt,{value:Ht.supplierName,onChange:U=>nr({...Ht,supplierName:U.target.value}),placeholder:"Nome fornitore",required:!0})]}),s.jsxs("div",{children:[s.jsx(Je,{children:"Data Ordine *"}),s.jsx(bt,{type:"date",value:Ht.orderDate,onChange:U=>nr({...Ht,orderDate:U.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(Je,{children:"Note"}),s.jsx(bt,{value:Ht.notes,onChange:U=>nr({...Ht,notes:U.target.value}),placeholder:"Note aggiuntive..."})]})]}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsxs("h3",{className:"font-medium mb-3",children:["Prodotti selezionati (",pe.length,"):"]}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:p.filter(U=>pe.includes(U.id)).map(U=>{const Pe=br.find(Te=>Te.id===U.category);return s.jsxs("div",{className:"p-2 border rounded",children:[s.jsx("div",{className:"font-medium text-sm",children:U.name}),s.jsxs("div",{className:"text-xs text-gray-600",children:[Pe==null?void 0:Pe.name,"  ",U.department||"N/A","  ",U.conservationPoint||"N/A"]})]},U.id)})}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(le,{type:"submit",className:"flex-1",children:" Crea Ordine"}),s.jsx(le,{type:"button",onClick:()=>Ze(!1),variant:"outline",children:"Annulla"})]})]})]})]})}),st&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4 text-red-600",children:" Conferma Cancellazione"}),s.jsx("p",{className:"text-gray-700 mb-6",children:"Sei sicuro di voler cancellare TUTTO l'inventario? Questa azione non pu essere annullata."}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(le,{onClick:()=>ae(!1),variant:"outline",children:"Annulla"}),s.jsx(le,{onClick:pa,className:"bg-red-600 hover:bg-red-700",children:"S, Cancella Tutto"})]})]})}),s.jsx(pd,{isOpen:t.isOpen,onClose:r,title:t.title,message:t.message,type:t.type,confirmText:t.confirmText,onConfirm:t.onConfirm}),s.jsx(gd,{isOpen:e.isOpen,onClose:i,title:e.title,message:e.message,type:e.type,confirmText:e.confirmText,cancelText:e.cancelText,onConfirm:e.onConfirm,onCancel:e.onCancel}),s.jsx(vd,{isOpen:n.isOpen,onClose:a,title:n.title,message:n.message,placeholder:n.placeholder,defaultValue:n.defaultValue,type:n.type,confirmText:n.confirmText,cancelText:n.cancelText,validation:n.validation,onConfirm:n.onConfirm,onCancel:n.onCancel})]})};function BC({currentUser:t,currentSection:e,products:n=[],temperatures:r=[],cleaning:i=[],staff:a=[],onAction:o}){const[l,c]=q.useState([]),[d,f]=q.useState(""),[p,v]=q.useState(!1);q.useState([]);const[m,N]=q.useState(!1),[_,k]=q.useState(!1),[y,b]=q.useState(null),[j,C]=q.useState(!0),[B,K]=q.useState(!1),[Z,z]=q.useState(!1),J=q.useRef(null),te=q.useRef(!0),I=q.useRef(!0);Di(" AIAssistant: Component rendering, isMinimized:",j,"isMounted:",B,"isVisible:",Z),q.useEffect(()=>{Di(" AIAssistant: useEffect triggered - setting up component"),C(!0),te.current=!0,I.current=!0,z(!1),Di(" AIAssistant: Starting mount timer (500ms)"),setTimeout(()=>{Di(" AIAssistant: Mount timer complete - making visible"),K(!0),C(!0),te.current=!0,z(!0)},500),Di(" AIAssistant: Starting grace period (2000ms)"),setTimeout(()=>{I.current=!1,Di(" AIAssistant: Grace period ended, chat can now be opened by user")},2e3)},[]),q.useEffect(()=>{Di(" AIAssistant: State changed - isMinimized:",j,"isMounted:",B,"isVisible:",Z,"forceMinimized:",te.current,"gracePeriod:",I.current)},[j,B,Z]);const A=H=>{if(Di("AIAssistant: handleSetMinimized called with:",H,"gracePeriod:",I.current,"forceMinimized:",te.current),H===!1&&I.current){Di("AIAssistant: BLOCKED - Still in grace period, no opening allowed");return}if(H===!1&&te.current){Di("AIAssistant: Preventing auto-open, first user click required");return}te.current=!1,C(H)},T=()=>{var H;(H=J.current)==null||H.scrollIntoView({behavior:"smooth"})};q.useEffect(()=>{T()},[l]),q.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const H=window.SpeechRecognition||window.webkitSpeechRecognition,re=new H;re.continuous=!1,re.interimResults=!1,re.lang="it-IT",re.onstart=()=>{k(!0),F("assistant"," Ti sto ascoltando... Parla ora!","system")},re.onresult=oe=>{const fe=oe.results[0][0].transcript;f(fe),F("assistant",` Ho sentito: "${fe}"`,"system")},re.onerror=oe=>{rs("Speech recognition error:",oe.error),k(!1),F("assistant"," Errore nel riconoscimento vocale. Riprova!","system")},re.onend=()=>{k(!1)},b(re)}},[]),q.useEffect(()=>{},[]);const F=(H,re,oe="text",fe=null)=>{const be={id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sender:H,content:re,type:oe,data:fe,timestamp:new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"})};c(ze=>[...ze,be])},ne=async()=>{if(!d.trim())return;const H=d.trim();f(""),F("user",H),v(!0),setTimeout(()=>{const re=W(H,e);F("assistant",re.content,re.type,re.data),v(!1)},1e3)},W=(H,re)=>{const oe=H.toLowerCase();switch(re){case"inventory":return ue(oe);case"cleaning":return P(oe);case"temperature":return Q();case"staff":return G();case"dashboard":return de();default:return w(oe)}},ue=H=>{if(H.includes("aggiungere")||H.includes("nuovo prodotto"))return{content:`Per aggiungere un nuovo prodotto:

1. **Vai alla sezione "Inventario"**
2. **Clicca "Aggiungi Prodotto"**
3. **Compila i campi richiesti:**
   - Nome prodotto
   - Categoria
   - Posizione
   - Data scadenza
   - Allergeni (se presenti)

**Suggerimento**: Puoi anche usare le categorie predefinite per aggiunta rapida!`,type:"text"};if(H.includes("scadenza")||H.includes("scaduti")){const re=n.filter(oe=>{const fe=Math.ceil((new Date(oe.expiryDate)-new Date)/864e5);return fe<=7&&fe>0});return re.length>0?{content:` **Prodotti in scadenza** (${re.length} prodotti):

${re.map(oe=>` ${oe.name} - Scade il ${oe.expiryDate}`).join(`
`)}

**Suggerimento**: Vuoi che generi delle ricette per utilizzare questi ingredienti?`,type:"alert",data:{products:re}}:{content:" Nessun prodotto in scadenza nei prossimi 7 giorni!",type:"text"}}return{content:`Per l'inventario posso aiutarti con:
 Aggiungere prodotti
 Controllare scadenze
 Gestire categorie
 Suggerimenti ricette

Cosa ti serve?`,type:"text"}},P=H=>{if(H.includes("attivit")||H.includes("mansioni")){const re=i.filter(oe=>!oe.completed);return{content:` **Attivit da svolgere** (${re.length} totali):

${re.slice(0,5).map(oe=>` ${oe.task} - Assegnato a: ${oe.assignee}`).join(`
`)}
${re.length>5?`
... e altre ${re.length-5} attivit`:""}

**Suggerimento**: Usa le schede per filtrare per frequenza (Giornaliere/Settimanali/Mensili/Annuali)`,type:"text"}}return H.includes("temperatura")||H.includes("frigo")?{content:` **Ultime temperature registrate**:

${r.slice(-3).map(oe=>` ${oe.location}: ${oe.temperature}C (${oe.status})`).join(`
`)}

**Suggerimento**: Registra temperature regolarmente per monitorare la sicurezza alimentare!`,type:"text"}:{content:`Per la sezione pulizia posso aiutarti con:
 Gestione attivit
 Controlli temperatura
 Frequenze mansioni
 Report completamento

Cosa ti serve?`,type:"text"}},Q=H=>({content:`Per i controlli temperatura posso aiutarti con:
 Registrare nuove temperature
 Monitorare trend
 Alert automatici
 Report periodici

Cosa ti serve?`,type:"text"}),G=H=>({content:`Per la gestione del personale posso aiutarti con:
 Aggiungere dipendenti
 Gestire ruoli
 Assegnare mansioni
 Report attivit

Cosa ti serve?`,type:"text"}),de=H=>({content:`Per la dashboard posso aiutarti con:
 Panoramica generale
 Statistiche rapide
 Alert importanti
 Navigazione sezioni

Cosa ti serve?`,type:"text"}),w=H=>H.includes("aiuto")||H.includes("help")?{content:` **Come posso aiutarti:**

** Inventario:**
 Aggiungere prodotti
 Controllare scadenze
 Suggerimenti ricette

** Pulizia:**
 Gestire attivit
 Controlli temperatura
 Frequenze mansioni

** Personale:**
 Gestire dipendenti
 Assegnare ruoli

** Dashboard:**
 Panoramica generale
 Statistiche

** Automatizzazioni:**
 Alert scadenze
 Ordini settimanali
 Suggerimenti ricette

Dimmi in quale sezione ti trovi o cosa ti serve!`,type:"text"}:{content:"Non sono sicuro di aver capito. Puoi essere pi specifico? Oppure dimmi in quale sezione ti trovi per ricevere aiuto mirato!",type:"text"},O=H=>{H.key==="Enter"&&!H.shiftKey&&(H.preventDefault(),ne())},R=()=>{if(!y){F("assistant"," Riconoscimento vocale non supportato dal tuo browser. Usa Chrome o Edge!","system");return}_?y.stop():y.start()};return s.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:!B||!Z?null:j?s.jsx(le,{onClick:()=>A(!1),className:"w-12 h-12 rounded-full bg-blue-600 hover:bg-blue-700 shadow-lg",children:s.jsx(Ga,{className:"h-6 w-6 text-white"})}):s.jsxs(ot,{className:"w-80 h-96 flex flex-col",children:[s.jsx(Ut,{className:"pb-3",children:s.jsxs(Gt,{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ga,{className:"h-4 w-4 text-blue-600"}),"Assistente IA",_&&s.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[s.jsx(Sf,{className:"h-3 w-3 animate-pulse"}),s.jsx("span",{className:"text-xs",children:"Ascoltando..."})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>A(!0),className:"h-6 w-6 p-0",children:s.jsx(M4,{className:"h-3 w-3"})}),s.jsx(le,{variant:"ghost",size:"sm",onClick:()=>N(!m),className:"h-6 w-6 p-0",children:s.jsx(Wr,{className:"h-3 w-3"})})]})]})}),s.jsxs(et,{className:"flex-1 flex flex-col p-0",children:[s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[l.map(H=>s.jsx("div",{className:`flex ${H.sender==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${H.sender==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:s.jsxs("div",{className:"flex items-start gap-2",children:[H.sender==="assistant"&&s.jsx(Ga,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm whitespace-pre-wrap",children:H.content}),s.jsx("div",{className:`text-xs mt-1 ${H.sender==="user"?"text-blue-100":"text-gray-500"}`,children:H.timestamp})]})]})})},H.id)),p&&s.jsx("div",{className:"flex justify-start",children:s.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ga,{className:"h-4 w-4 text-blue-600"}),s.jsxs("div",{className:"flex space-x-1",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),s.jsx("div",{ref:J})]}),s.jsx("div",{className:"p-4 border-t bg-white",children:s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx(bt,{value:d,onChange:H=>f(H.target.value),onKeyPress:O,placeholder:"Scrivi un messaggio...",className:"flex-1 min-h-[40px]"}),s.jsx(le,{onClick:R,disabled:p,size:"sm",className:`px-3 h-10 ${_?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`,children:_?s.jsx(E5,{className:"h-4 w-4"}):s.jsx(Sf,{className:"h-4 w-4"})}),s.jsx(le,{onClick:ne,disabled:!d.trim()||p,size:"sm",className:"px-3 h-10",children:s.jsx(T5,{className:"h-4 w-4"})})]})})]})]})})}function qC({products:t=[],onRecipeSuggestion:e}){const[n,r]=q.useState([]),[i,a]=q.useState(!1),[o,l]=q.useState([]),[c,d]=q.useState(!1);q.useEffect(()=>{(()=>{const N=new Date,_=t.filter(k=>{if(!k.expiryDate)return!1;const y=new Date(k.expiryDate),b=Math.ceil((y-N)/(1e3*60*60*24));return b<=7&&b>0});r(_),_.length>0&&d(!1)})()},[t]);const f=()=>{const m=[];n.forEach(N=>{const _=v(N);_&&m.push(_)}),l(m),a(!0)},p=()=>{d(!0)},v=m=>({"Mozzarella di Bufala":{name:"Insalata Caprese",ingredients:["Mozzarella di Bufala","Pomodoro","Basilico","Olio EVO"],instructions:"Taglia mozzarella e pomodoro a fette, alterna su piatto, guarnisci con basilico e olio.",difficulty:"Facile",time:"10 minuti"},"Parmigiano Reggiano":{name:"Risotto al Parmigiano",ingredients:["Riso Carnaroli","Parmigiano Reggiano","Burro","Brodo"],instructions:"Prepara risotto classico, manteca con parmigiano e burro.",difficulty:"Media",time:"25 minuti"},"Prosciutto Crudo":{name:"Antipasto Prosciutto e Melone",ingredients:["Prosciutto Crudo","Melone","Rucola"],instructions:"Avvolgi fette di prosciutto su cubetti di melone, guarnisci con rucola.",difficulty:"Facile",time:"5 minuti"},Salmone:{name:"Salmone al Forno con Erbe",ingredients:["Salmone","Limone","Erbe aromatiche","Olio EVO"],instructions:"Condisci salmone con erbe, limone e olio, cuoci in forno a 180C per 15 min.",difficulty:"Facile",time:"20 minuti"},"Basilico Fresco":{name:"Pesto alla Genovese",ingredients:["Basilico Fresco","Parmigiano","Pine Nuts","Olio EVO","Aglio"],instructions:"Frulla tutti gli ingredienti fino a ottenere una crema omogenea.",difficulty:"Facile",time:"10 minuti"}})[m.name]||{name:`Ricetta con ${m.name}`,ingredients:[m.name,"Altri ingredienti disponibili"],instructions:"Crea una ricetta utilizzando questo ingrediente prima che scada.",difficulty:"Media",time:"15 minuti"};return n.length===0||c?null:s.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-md",children:s.jsxs(ot,{className:"border-orange-200 bg-orange-50",children:[s.jsx(Ut,{className:"pb-3",children:s.jsxs(Gt,{className:"flex items-center gap-2 text-orange-800",children:[s.jsx(pn,{className:"h-5 w-5"}),"Prodotti in Scadenza"]})}),s.jsxs(et,{className:"space-y-3",children:[s.jsxs("div",{className:"text-sm text-orange-700",children:[s.jsxs("p",{className:"font-medium mb-2",children:[n.length," prodotto",n.length>1?"i":""," in scadenza:"]}),s.jsx("ul",{className:"space-y-1",children:n.map(m=>s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(Qu,{className:"h-3 w-3"}),s.jsx("span",{children:m.name}),s.jsxs("span",{className:"text-xs",children:["(scade il ",new Date(m.expiryDate).toLocaleDateString("it-IT"),")"]})]},m.id))})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{onClick:f,className:"bg-orange-600 hover:bg-orange-700 text-white",size:"sm",children:[s.jsx(_4,{className:"h-4 w-4 mr-1"}),"Suggerisci Ricette"]}),s.jsxs(le,{variant:"outline",size:"sm",className:"text-orange-600 border-orange-300",onClick:p,children:[s.jsx(er,{className:"h-4 w-4 mr-1"}),"Rimuovi Alert"]})]}),i&&o.length>0&&s.jsxs("div",{className:"mt-4 p-3 bg-white rounded-lg border",children:[s.jsx("h4",{className:"font-medium mb-2",children:"Ricette Suggerite:"}),s.jsx("div",{className:"space-y-2",children:o.map((m,N)=>s.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[s.jsx("h5",{className:"font-medium text-sm",children:m.name}),s.jsxs("p",{className:"text-xs text-gray-600",children:["Tempo: ",m.time,"  Difficolt: ",m.difficulty]}),s.jsx("p",{className:"text-xs text-gray-700 mt-1",children:m.instructions})]},N))})]})]})]})})}function UC({temperatures:t,cleaning:e,products:n,refrigerators:r,setTemperatures:i,setCleaning:a,setProducts:o,setRefrigerators:l}){const[c,d]=q.useState(!1),[f,p]=q.useState({temperatures:0,cleaning:0,products:0,refrigerators:0,totalSize:0}),{alertModal:v,confirmModal:m,promptModal:N,closeAlert:_,closeConfirm:k,closePrompt:y,alertSuccess:b,alertError:j,alertWarning:C,confirmDelete:B,confirmAction:K}=md();q.useEffect(()=>{(()=>{const A=t||[],T=e||[],F=n||[],ne=r||[],W=JSON.stringify(A).length,ue=JSON.stringify(T).length,P=JSON.stringify(F).length,Q=JSON.stringify(ne).length;p({temperatures:A.length,cleaning:T.length,products:F.length,refrigerators:ne.length,totalSize:W+ue+P+Q})})()},[t,e,n,r]);const Z=()=>{if(!c)return;const I=new Date;I.setDate(I.getDate()-30);const A=t||[],T=e||[],F=A.filter(w=>new Date(w.timestamp)<I),ne=A.filter(w=>new Date(w.timestamp)>=I),W=T.filter(w=>w.completed&&new Date(w.createdAt)<I),ue=T.filter(w=>!w.completed||new Date(w.createdAt)>=I);let P=[];const Q={temperatures:F,cleaning:W,expiredLabels:P,archivedAt:new Date().toISOString()},G=JSON.parse(localStorage.getItem("haccp-archives")||"[]");G.push(Q),localStorage.setItem("haccp-archives",JSON.stringify(G)),i(ne),a(ue),F.length+W.length+P.length>0?b(` Archiviazione completata!

 Elementi archiviati:
 ${F.length} registrazioni temperature
 ${W.length} attivit completate
 ${P.length} etichette prodotti scaduti

 Controllo scadenze temporaneamente disabilitato`):b(` Archiviazione completata!

 Elementi archiviati:
 ${F.length} registrazioni temperature
 ${W.length} attivit completate
 Controllo etichette scadute: disabilitato`)};q.useEffect(()=>{if(!c)return;const I=setInterval(()=>{Z()},24*60*60*1e3);return()=>clearInterval(I)},[c]);const z=I=>Math.min(I/5242880*100,100),J=I=>I<50?"text-green-600":I<80?"text-yellow-600":"text-red-600",te=I=>{if(I===0)return"0 Bytes";const A=1024,T=["Bytes","KB","MB","GB"],F=Math.floor(Math.log(I)/Math.log(A));return parseFloat((I/Math.pow(A,F)).toFixed(2))+" "+T[F]};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(vu,{title:"Gestione Storage",subtitle:"Monitoraggio spazio e archiviazione dati",icon:pu,iconColor:"text-gray-600",iconBgColor:"bg-gray-100",count:f.temperatures+f.cleaning+f.products+f.refrigerators,testId:"storage-manager",defaultExpanded:!0,children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Utilizzo Storage"}),s.jsxs("div",{className:"relative w-48 h-48 mx-auto",children:[s.jsxs("svg",{className:"w-48 h-48 transform -rotate-90",viewBox:"0 0 100 100",children:[s.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#3B82F6",strokeWidth:"8",strokeDasharray:`${f.temperatures/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2} 251.2`,strokeDashoffset:"0"}),s.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#10B981",strokeWidth:"8",strokeDasharray:`${f.cleaning/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2} 251.2`,strokeDashoffset:`-${f.temperatures/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2}`}),s.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#F59E0B",strokeWidth:"8",strokeDasharray:`${f.products/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2} 251.2`,strokeDashoffset:`-${(f.temperatures+f.cleaning)/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2}`}),s.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#8B5CF6",strokeWidth:"8",strokeDasharray:`${f.refrigerators/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2} 251.2`,strokeDashoffset:`-${(f.temperatures+f.cleaning+f.products)/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2}`})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-2xl font-bold ${J(z(f.totalSize))}`,children:te(f.totalSize)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Utilizzato"})]})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Dettaglio Dati"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Temperature"})]}),s.jsxs("span",{className:"text-sm text-gray-600",children:[f.temperatures," record"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Attivit"})]}),s.jsxs("span",{className:"text-sm text-gray-600",children:[f.cleaning," record"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Prodotti"})]}),s.jsxs("span",{className:"text-sm text-gray-600",children:[f.products," record"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),s.jsx("span",{className:"text-sm font-medium",children:"Frigoriferi"})]}),s.jsxs("span",{className:"text-sm text-gray-600",children:[f.refrigerators," record"]})]})]})]})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Kv,{className:"h-4 w-4"}),"Archiviazione Automatica"]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Rimuove automaticamente i dati vecchi per mantenere l'app veloce"})]}),s.jsx(le,{variant:c?"default":"outline",onClick:()=>d(!c),className:"flex items-center gap-2",children:c?s.jsxs(s.Fragment,{children:[s.jsx(kn,{className:"h-4 w-4"}),"Abilitata"]}):s.jsxs(s.Fragment,{children:[s.jsx(Wr,{className:"h-4 w-4"}),"Disabilitata"]})})]}),c&&s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Cosa fa l'archiviazione automatica:"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsx("li",{children:" Rimuove le registrazioni temperature pi vecchie di 30 giorni"}),s.jsx("li",{children:" Archivia le attivit completate pi vecchie di 30 giorni"}),s.jsx("li",{children:" Chiede conferma per rimuovere etichette di prodotti scaduti OGGI"}),s.jsx("li",{children:" Mantiene tutti i prodotti e frigoriferi attivi"}),s.jsx("li",{children:" Crea un backup completo dei dati rimossi"}),s.jsx("li",{children:" Libera spazio solo con conferma utente per le foto"}),s.jsx("li",{children:" Si esegue automaticamente ogni 24 ore"})]}),s.jsx("div",{className:"mt-3",children:s.jsxs(le,{onClick:Z,className:"flex items-center gap-2",size:"sm",children:[s.jsx(Kv,{className:"h-4 w-4"}),"Archivia Ora"]})})]})]}),s.jsxs("div",{className:"border-t pt-6",children:[s.jsx("h3",{className:"font-semibold mb-4",children:"Azioni Manuali"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs(le,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{const I={temperatures:t,cleaning:e,products:n,refrigerators:r,exportedAt:new Date().toISOString()},A=new Blob([JSON.stringify(I,null,2)],{type:"application/json"}),T=URL.createObjectURL(A),F=document.createElement("a");F.href=T,F.download=`haccp-backup-${new Date().toISOString().split("T")[0]}.json`,F.click()},children:[s.jsx(Ys,{className:"h-4 w-4"}),"Esporta Tutti i Dati"]}),s.jsxs(le,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{B("Sei sicuro di voler eliminare tutti i dati? Questa azione non pu essere annullata.",()=>{i([]),a([]),o([]),l([]),b("Tutti i dati sono stati eliminati.")})},children:[s.jsx(er,{className:"h-4 w-4"}),"Elimina Tutti i Dati"]})]})]})]})}),s.jsx(pd,{isOpen:v.isOpen,onClose:_,title:v.title,message:v.message,type:v.type,confirmText:v.confirmText,onConfirm:v.onConfirm}),s.jsx(gd,{isOpen:m.isOpen,onClose:k,title:m.title,message:m.message,type:m.type,confirmText:m.confirmText,cancelText:m.cancelText,onConfirm:m.onConfirm,onCancel:m.onCancel}),s.jsx(vd,{isOpen:N.isOpen,onClose:y,title:N.title,message:N.message,placeholder:N.placeholder,defaultValue:N.defaultValue,type:N.type,confirmText:N.confirmText,cancelText:N.cancelText,validation:N.validation,onConfirm:N.onConfirm,onCancel:N.onCancel})]})}function VC(){const[t,e]=q.useState(null),[n,r]=q.useState(!1),[i,a]=q.useState(!1);q.useEffect(()=>{const c=()=>window.matchMedia("(display-mode: standalone)").matches?(a(!0),!0):!1,d=localStorage.getItem("pwa-install-rejected");return!c()&&!d&&(window.addEventListener("beforeinstallprompt",f=>{f.preventDefault(),e(f),r(!0)}),window.addEventListener("appinstalled",()=>{a(!0),r(!1),e(null)})),()=>{window.removeEventListener("beforeinstallprompt",()=>{}),window.removeEventListener("appinstalled",()=>{})}},[]);const o=async()=>{if(!t)return;t.prompt();const{outcome:c}=await t.userChoice;c==="accepted"?(De("PWA installata con successo!"),a(!0)):(De("Installazione PWA rifiutata"),localStorage.setItem("pwa-install-rejected","true")),e(null),r(!1)},l=()=>{r(!1),localStorage.setItem("pwa-install-rejected","true")};return i||!n?null:s.jsx("div",{className:"fixed bottom-4 left-4 right-4 bg-white border border-gray-200 rounded-lg shadow-lg p-4 z-50",children:s.jsx("div",{className:"flex items-start justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ys,{className:"h-5 w-5 text-blue-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Installa l'App"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Installa Mini-ePackPro sul tuo dispositivo per un accesso pi veloce e funzionalit offline."}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{onClick:o,size:"sm",className:"flex items-center gap-2",children:[s.jsx(Ys,{className:"h-4 w-4"}),"Installa"]}),s.jsxs(le,{onClick:l,variant:"outline",size:"sm",children:[s.jsx(un,{className:"h-4 w-4"}),"Non ora"]})]})]})})})}class HC{constructor(e){this.companyId=e,this.storagePrefix=`cloud-sim-${e}`,console.log(" CloudSimulator attivo per:",e)}async saveToCloud(e,n,r){return new Promise((i,a)=>{try{setTimeout(()=>{const o=`${this.storagePrefix}-${e}`,l={data:n,lastModified:new Date().toISOString(),modifiedBy:r,companyId:this.companyId,version:Date.now()};localStorage.setItem(o,JSON.stringify(l)),console.log(` [SIMULATO] Salvato in cloud: ${e}`),i({success:!0,message:` ${e} condiviso con tutti!`,timestamp:l.lastModified})},800+Math.random()*400)}catch{a({success:!1,message:` Errore simulato nel salvare ${e}`})}})}async loadFromCloud(e){return new Promise((n,r)=>{try{setTimeout(()=>{const i=`${this.storagePrefix}-${e}`,a=localStorage.getItem(i);if(a){const o=JSON.parse(a);console.log(` [SIMULATO] Scaricato dal cloud: ${e}`),n({success:!0,data:o.data,lastModified:o.lastModified,message:` Ricevuti aggiornamenti di ${e}!`})}else n({success:!0,data:null,message:` Nessun dato di ${e} nel cloud`})},600+Math.random()*300)}catch{r({success:!1,message:` Errore nel scaricare ${e}`})}})}isOnline(){return navigator.onLine}async getCompanyInfo(){return new Promise(e=>{setTimeout(()=>{e({id:this.companyId,name:"Demo Pizzeria Da Mario",plan:"free",users:5,maxUsers:25,storageUsed:"45 MB",storageMax:"1 GB"})},300)})}async getRecentChanges(){return new Promise(e=>{setTimeout(()=>{e({success:!0,changes:[{type:"inventory",user:"Luca (Magazzino)",action:"Aggiunto: Mozzarella di Bufala",time:"5 min fa"},{type:"temperatures",user:"Sara (Cucina)",action:"Temperatura Frigo A: 4.2C",time:"12 min fa"},{type:"cleaning",user:"Marco (Pulizie)",action:"Completata: Sanificazione tavoli",time:"25 min fa"}],hasUpdates:Math.random()>.5})},400)})}getStorageStats(){return{localSpace:"45 MB",cloudSpace:"12 MB",photosCount:23,documentsCount:156,lastSync:localStorage.getItem("haccp-last-sync")||"Mai",syncCount:parseInt(localStorage.getItem("cloud-sim-sync-count")||"0")}}incrementSyncCount(){const e=parseInt(localStorage.getItem("cloud-sim-sync-count")||"0");localStorage.setItem("cloud-sim-sync-count",(e+1).toString())}async cleanupCloudStorage(){return new Promise(e=>{setTimeout(()=>{const n=Math.floor(Math.random()*20)+5;e({success:!0,message:` Liberati ${n} MB dal cloud!`,spaceSaved:`${n} MB`})},1e3)})}}const GC=(t="demo-company")=>new HC(t),Ws={version:"2.0",lastUpdated:"2024-12-19",principles:[{id:"data-collection",title:"Raccolta Dati Pertinenti",description:"Raccogliere dati pertinenti (temperature, pulizie, controlli, fornitori, prodotti) in formato tracciabile",critical:!0,implementation:"Ogni funzione deve salvare timestamp, operatore e dati completi"},{id:"data-archiving",title:"Archiviazione 12 Mesi",description:"Archiviare i dati per almeno 12 mesi in formato esportabile (PDF o JSON) leggibile da terzi (ASL, NAS, auditor)",critical:!0,implementation:"Sistema di backup automatico e export manuale"},{id:"data-integrity",title:"Integrit Dati",description:"Garantire integrit dei dati (nessuna modifica senza tracciamento, log azioni con data e ora)",critical:!0,implementation:"Log di tutte le modifiche con timestamp e operatore"},{id:"prerequisites",title:"Prerequisiti Normativi",description:"Facilitare il rispetto dei prerequisiti normativi: igiene personale, controllo infestanti, manutenzione impianti, formazione personale",critical:!0,implementation:"Checklist e promemoria per prerequisiti"},{id:"ccp-management",title:"Gestione CCP",description:"Gestire i CCP (Critical Control Points) con controlli programmati e azioni correttive",critical:!0,implementation:"Sistema di allarmi e azioni correttive automatiche"}],guidelines:{temperature:{id:"temperature-control",title:"Registrazione Temperature",frequency:"Almeno 2 volte al giorno (inizio e met turno)",criticalPoints:[{name:"Frigo A - Conservazione Freschi",range:{min:2,max:4,unit:"C"},description:"Latticini, formaggi freschi, salumi, verdure fresche",preset:"pizzeria-bar",allowedCategories:["latticini","carni","verdure","formaggi"]},{name:"Frigo B - Surgelati",range:{min:-19,max:-16,unit:"C"},description:"Surgelati, pesce congelato, gelati",preset:"pizzeria-bar",allowedCategories:["surgelati","pesce_surgelato","gelati"]},{name:"Banco ingredienti",range:{min:0,max:8,unit:"C"},description:"Pomodoro, mozzarella, verdure fresche",preset:"pizzeria",allowedCategories:["verdure","latticini","condimenti"]},{name:"Freezer",range:{min:-18,max:null,unit:"C"},description:"Tutti i prodotti surgelati",preset:"universal",allowedCategories:["surgelati","pesce_surgelato","gelati","verdure_congelate"]}],correctiveActions:["Isolare prodotto e segnalarlo immediatamente","Riparare/controllare apparecchio","Registrare azione correttiva e prodotto isolato","Verificare temperatura prima di riutilizzare"],whyMatters:"Le temperature fuori range favoriscono la proliferazione batterica e compromettono la sicurezza alimentare"},conservationPoints:{id:"conservation-points-haccp",title:"Punti di Conservazione HACCP",description:"Gestione strutturata dei punti di conservazione secondo standard HACCP",criticalPoints:[{name:"Frigo A - Conservazione Freschi",temperature:{min:2,max:4,unit:"C"},categories:["latticini","carni","verdure","formaggi"],monitoring:"2 volte al giorno",correctiveAction:"Isolare prodotti e verificare temperatura",preset:"pizzeria-bar"},{name:"Frigo B - Surgelati",temperature:{min:-19,max:-16,unit:"C"},categories:["surgelati","pesce_surgelato","gelati"],monitoring:"1 volta al giorno",correctiveAction:"Verificare funzionamento e isolare prodotti",preset:"pizzeria-bar"}],validationRules:["Temperatura deve essere sempre nel range specificato","Categorie prodotti devono corrispondere al punto di conservazione","Monitoraggio frequente e registrazione obbligatoria","Azioni correttive immediate in caso di deviazione"],whyMatters:"La corretta gestione dei punti di conservazione  fondamentale per la sicurezza alimentare e la conformit HACCP"},cleaning:{id:"cleaning-sanitization",title:"Pulizie e Sanificazioni",zones:[{name:"Superfici di lavoro",frequency:"Dopo ogni uso",products:["Detergente neutro","Disinfettante alimentare"]},{name:"Celle e frigoriferi",frequency:"Settimanale",products:["Detergente specifico","Disinfettante alimentare"]},{name:"Pavimenti",frequency:"Quotidiano",products:["Detergente pavimenti","Disinfettante"]},{name:"Attrezzature",frequency:"Secondo manuale tecnico",products:["Detergente specifico per attrezzature"]}],recording:"Indicare operatore, orario, detergente/disinfettante usato",whyMatters:"La pulizia regolare previene contaminazioni e mantiene standard igienici"},staff:{id:"staff-management",title:"Gestione Personale",roles:[{name:"Amministratore",level:1,responsibilities:["Gestione completa sistema","Responsabilit legale","Approvazione procedure"]},{name:"Responsabile",level:2,responsibilities:["Supervisione operativa","Controllo procedure","Formazione staff"]},{name:"Dipendente",level:3,responsibilities:["Esecuzione procedure","Registrazione dati","Segnalazione problemi"]},{name:"Collaboratore occasionale",level:4,responsibilities:["Esecuzione procedure base","Seguire istruzioni responsabile"]}],requirements:["Mansioni assegnate e documentate","Formazione HACCP registrata e aggiornata","Conoscenza procedure operative","Responsabilit chiare per ogni ruolo"],whyMatters:"Personale formato e responsabilizzato garantisce applicazione corretta delle procedure HACCP"},products:{id:"product-management",title:"Gestione Prodotti",scheda:["Nome commerciale e nome scientifico","Categoria (carne, latticini, verdure, ecc.)","Data di ricezione e scadenza","Fornitore e documentazione","Etichetta interna se necessario (es. preparazioni interne con TMC)","Condizioni di conservazione","Allergeni presenti"],whyMatters:"Tracciabilit completa garantisce sicurezza e conformit normativa"},suppliers:{id:"supplier-management",title:"Gestione Fornitori",registration:["Nome e categoria merceologica","Contatti e documentazione","DDT/fatture con data di consegna","Valutazione periodica affidabilit","Controllo documenti di trasporto","Verifica certificazioni HACCP"],whyMatters:"Fornitori qualificati garantiscono materie prime sicure e conformi"},nonConformity:{id:"non-conformity",title:"Gestione Non Conformit",recording:["Data e ora del rilevamento","Descrizione dettagliata del problema","Azione correttiva intrapresa","Responsabile dell'azione","Verifica efficacia azione correttiva","Prevenzione ricorrenza"],examples:["Temperatura fuori range per pi di 2 ore","Presenza infestanti in magazzino","Prodotto scaduto in vendita","Dispositivo di controllo non funzionante","Personale non formato per mansione"],whyMatters:"Gestione corretta delle non conformit previene rischi e migliora il sistema"}},requirements:{refrigerators:{mandatory:["nome","tipo","range-temperatura","posizione"],validation:"Minimo 1 registrato per sbloccare registrazione temperature",blocking:["temperatures"],whyMatters:"I frigoriferi sono punti di controllo critici per la catena del freddo"},temperature:{mandatory:["punto-controllo","valore","ora","operatore"],validation:"Se valore fuori range  mostra alert e richiede azione correttiva",blocking:[],whyMatters:"Le temperature fuori range compromettono la sicurezza alimentare"},staff:{mandatory:["nome","ruolo","mansioni","formazione-haccp"],validation:"Minimo 1 per sbloccare pulizie e controlli",blocking:["cleaning","inventory"],whyMatters:"Il personale formato  responsabile dell'applicazione delle procedure"},cleaning:{mandatory:["area","frequenza","prodotto-usato","operatore","data-ora"],validation:"Blocco se area non associata a un reparto",blocking:[],whyMatters:"Le pulizie regolari prevengono contaminazioni"},products:{mandatory:["nome","categoria","data-ricezione","scadenza","fornitore"],validation:"Alert se scadenza imminente (<3 giorni)",blocking:[],whyMatters:"La tracciabilit garantisce sicurezza e conformit"},suppliers:{mandatory:["nome","categoria","contatto","documentazione"],validation:"Minimo 1 per associare prodotti",blocking:["products"],whyMatters:"I fornitori qualificati garantiscono materie prime sicure"},nonConformity:{mandatory:["data","descrizione","azione-correttiva","responsabile"],validation:"Blocco salvataggio se mancano dettagli essenziali",blocking:[],whyMatters:"La gestione delle non conformit previene rischi futuri"}},educationalMessages:{welcome:"Benvenuto nel sistema HACCP! Questo sistema ti guider nella gestione della sicurezza alimentare.",whyHaccp:"L'HACCP  un sistema preventivo richiesto per legge che garantisce la sicurezza alimentare.",dataImportance:"Ogni dato registrato contribuisce alla sicurezza e alla conformit normativa.",responsibility:"La sicurezza alimentare  responsabilit di tutti i membri dello staff."},getRequirement:t=>Ws.requirements[t]||null,getGuideline:t=>Ws.guidelines[t]||null,getPrinciple:t=>Ws.principles.find(e=>e.id===t)||null,validateRequirement:(t,e)=>{const n=Ws.getRequirement(t);if(!n)return{valid:!1,error:"Sezione non trovata"};const r=n.mandatory.filter(i=>!e[i]);return{valid:r.length===0,missing:r,message:r.length>0?`Campi mancanti: ${r.join(", ")}`:"Tutti i campi obbligatori sono compilati"}},getBlockingSections:t=>{const e=Ws.getRequirement(t);return e?e.blocking:[]},isSectionBlocked:(t,e)=>{if(!Ws.getRequirement(t))return!1;switch(t){case"temperatures":return!e.refrigerators||e.refrigerators.length===0;case"cleaning":return!e.refrigerators||e.refrigerators.length===0||!e.staff||e.staff.length===0;case"inventory":return!e.departments||e.departments.length===0||!e.refrigerators||e.refrigerators.length===0;case"products":return!e.suppliers||e.suppliers.length===0;default:return!1}}};function WC(){q.useState(new Set(["principles"]));const[t,e]=q.useState("principles"),[n,r]=q.useState(""),i=Ws.principles.filter(p=>p.title.toLowerCase().includes(n.toLowerCase())||p.description.toLowerCase().includes(n.toLowerCase())),a=Object.entries(Ws.guidelines).filter(([p,v])=>v.title.toLowerCase().includes(n.toLowerCase())||v.whyMatters&&v.whyMatters.toLowerCase().includes(n.toLowerCase())),o=p=>s.jsx("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("h4",{className:"font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[s.jsx(ex,{className:"h-5 w-5"}),p.title]}),s.jsx("p",{className:"text-blue-800 mb-2",children:p.description}),s.jsxs("div",{className:"bg-blue-100 p-3 rounded",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Implementazione:"}),s.jsx("p",{className:"text-sm text-blue-800",children:p.implementation})]})]}),s.jsx(kn,{className:"h-6 w-6 text-blue-600 flex-shrink-0 ml-2"})]})},p.id),l=(p,v)=>s.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg border-l-4 border-green-500",children:[s.jsxs("h4",{className:"font-semibold text-green-900 mb-3 flex items-center gap-2",children:[d(p),v.title]}),v.frequency&&s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-sm font-medium text-green-800",children:"Frequenza:"}),s.jsx("p",{className:"text-green-700",children:v.frequency})]}),v.criticalPoints&&s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-sm font-medium text-green-800",children:"Punti di Controllo:"}),s.jsx("div",{className:"space-y-2",children:v.criticalPoints.map((m,N)=>s.jsxs("div",{className:"bg-green-100 p-2 rounded",children:[s.jsx("p",{className:"font-medium text-green-900",children:m.name}),s.jsxs("p",{className:"text-sm text-green-800",children:["Range: ",m.range.min,"C - ",m.range.max||"","C"]}),s.jsx("p",{className:"text-sm text-green-700",children:m.description})]},N))})]}),v.zones&&s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-sm font-medium text-green-800",children:"Zone e Frequenza:"}),s.jsx("div",{className:"space-y-2",children:v.zones.map((m,N)=>s.jsxs("div",{className:"bg-green-100 p-2 rounded",children:[s.jsx("p",{className:"font-medium text-green-900",children:m.name}),s.jsxs("p",{className:"text-sm text-green-800",children:["Frequenza: ",m.frequency]}),s.jsxs("p",{className:"text-sm text-green-700",children:["Prodotti: ",m.products.join(", ")]})]},N))})]}),v.roles&&s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-sm font-medium text-green-800",children:"Ruoli e Responsabilit:"}),s.jsx("div",{className:"space-y-2",children:v.roles.map((m,N)=>s.jsxs("div",{className:"bg-green-100 p-2 rounded",children:[s.jsx("p",{className:"font-medium text-green-900",children:m.name}),s.jsxs("div",{className:"text-sm text-green-800",children:[s.jsx("p",{children:"Responsabilit:"}),s.jsx("ul",{className:"list-disc list-inside ml-2",children:m.responsibilities.map((_,k)=>s.jsx("li",{children:_},k))})]})]},N))})]}),v.correctiveActions&&s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-sm font-medium text-green-800",children:"Azioni Correttive:"}),s.jsx("ul",{className:"list-disc list-inside space-y-1",children:v.correctiveActions.map((m,N)=>s.jsx("li",{className:"text-green-700",children:m},N))})]}),v.whyMatters&&s.jsxs("div",{className:"bg-green-100 p-3 rounded",children:[s.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Perch  importante:"}),s.jsx("p",{className:"text-sm text-green-800",children:v.whyMatters})]})]},v.id),c=(p,v)=>s.jsxs("div",{className:"mb-4 p-4 bg-orange-50 rounded-lg border-l-4 border-orange-500",children:[s.jsxs("h4",{className:"font-semibold text-orange-900 mb-3 flex items-center gap-2",children:[s.jsx(Qs,{className:"h-5 w-5"}),f(p)]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-sm font-medium text-orange-800",children:"Dati obbligatori:"}),s.jsx("ul",{className:"list-disc list-inside space-y-1",children:v.mandatory.map((m,N)=>s.jsx("li",{className:"text-orange-700",children:m},N))})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-sm font-medium text-orange-800",children:"Validazione:"}),s.jsx("p",{className:"text-orange-700",children:v.validation})]}),v.blocking&&v.blocking.length>0&&s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-sm font-medium text-orange-800",children:"Blocca sezioni:"}),s.jsx("p",{className:"text-orange-700",children:v.blocking.join(", ")})]}),s.jsxs("div",{className:"bg-orange-100 p-3 rounded",children:[s.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Perch  importante:"}),s.jsx("p",{className:"text-sm text-orange-800",children:v.whyMatters})]})]},p),d=p=>({temperature:s.jsx(ws,{className:"h-5 w-5"}),cleaning:s.jsx(hd,{className:"h-5 w-5"}),staff:s.jsx(Er,{className:"h-5 w-5"}),products:s.jsx(Vn,{className:"h-5 w-5"}),suppliers:s.jsx(Pu,{className:"h-5 w-5"}),nonConformity:s.jsx(pn,{className:"h-5 w-5"})})[p]||s.jsx(Qs,{className:"h-5 w-5"}),f=p=>({refrigerators:"Gestione Frigoriferi",temperature:"Registrazione Temperature",staff:"Gestione Personale",cleaning:"Gestione Pulizie",products:"Gestione Prodotti",suppliers:"Gestione Fornitori",nonConformity:"Gestione Non Conformit"})[p]||p;return s.jsxs("div",{className:"space-y-6",children:[s.jsx(ot,{children:s.jsxs(Ut,{children:[s.jsxs(Gt,{className:"flex items-center gap-3 text-2xl",children:[s.jsx(jf,{className:"h-8 w-8 text-blue-600"}),"Manuale HACCP - Guida Completa"]}),s.jsx("p",{className:"text-gray-600",children:"Riferimento completo per normative HACCP e procedure operative"})]})}),s.jsxs(n1,{value:t,onValueChange:e,className:"w-full",children:[s.jsxs(Xf,{className:"grid w-full grid-cols-3",children:[s.jsx(ms,{value:"principles",children:"Principi Base"}),s.jsx(ms,{value:"guidelines",children:"Linee Guida"}),s.jsx(ms,{value:"requirements",children:"Requisiti"})]}),s.jsx(ps,{value:"principles",className:"space-y-4",children:s.jsxs(ot,{children:[s.jsxs(Ut,{children:[s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(ex,{className:"h-6 w-6 text-blue-600"}),"Principi Fondamentali HACCP"]}),s.jsx("p",{className:"text-gray-600",children:"Questi principi garantiscono la conformit alle normative di sicurezza alimentare"}),s.jsxs("div",{className:"mt-4 relative",children:[s.jsx("input",{type:"text",placeholder:"Cerca nei principi...",value:n,onChange:p=>r(p.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),n&&s.jsx("button",{onClick:()=>r(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(X,{className:"h-4 w-4"})})]})]}),s.jsx(et,{children:i.map(o)})]})}),s.jsx(ps,{value:"guidelines",className:"space-y-4",children:s.jsxs(ot,{children:[s.jsxs(Ut,{children:[s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(jf,{className:"h-6 w-6 text-green-600"}),"Linee Guida Operative"]}),s.jsx("p",{className:"text-gray-600",children:"Procedure dettagliate per ogni area operativa"})]}),s.jsx(et,{children:a.map(([p,v])=>l(p,v))})]})}),s.jsx(ps,{value:"requirements",className:"space-y-4",children:s.jsxs(ot,{children:[s.jsxs(Ut,{children:[s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(kn,{className:"h-6 w-6 text-orange-600"}),"Requisiti Minimi e Validazioni"]}),s.jsx("p",{className:"text-gray-600",children:"Dati obbligatori e controlli automatici per ogni sezione"})]}),s.jsx(et,{children:Object.entries(Ws.requirements).map(([p,v])=>c(p,v))})]})})]}),s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Qs,{className:"h-6 w-6 text-purple-600"}),"Informazioni Importanti"]})}),s.jsx(et,{children:s.jsx("div",{className:"space-y-3",children:Object.entries(Ws.educationalMessages).map(([p,v])=>s.jsx("div",{className:"p-3 bg-purple-50 rounded-lg border-l-4 border-purple-500",children:s.jsx("p",{className:"text-purple-800",children:v})},p))})})]}),s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"text-center text-sm text-gray-500",children:[s.jsxs("p",{children:["Versione ",Ws.version,"  Ultimo aggiornamento: ",Ws.lastUpdated]}),s.jsx("p",{className:"mt-1",children:"Questo manuale  conforme alle normative HACCP vigenti"})]})})})]})}const Ah=[{key:"latticini",name:"Latticini",icon:"",description:"Latte, formaggi, yogurt"},{key:"salumi",name:"Salumi",icon:"",description:"Prosciutto, salame, mortadella"},{key:"verdure",name:"Verdure",icon:"",description:"Verdure fresche e ortaggi"},{key:"farine",name:"Farine",icon:"",description:"Farine, cereali, impasti"},{key:"surgelati",name:"Surgelati",icon:"",description:"Prodotti surgelati"},{key:"altro",name:"Altro",icon:"",description:"Altri prodotti alimentari"}];function ZC({currentUser:t}){const[e,n]=q.useState([]),[r,i]=q.useState(!1),[a,o]=q.useState(null),[l,c]=q.useState({name:"",category:"",vat:"",phone:"",email:"",notes:""}),{alertModal:d,confirmModal:f,promptModal:p,closeAlert:v,closeConfirm:m,closePrompt:N,alertSuccess:_,alertError:k,alertWarning:y,confirmDelete:b,confirmAction:j}=md();q.useEffect(()=>{const A=localStorage.getItem("haccp-suppliers");if(A)try{n(JSON.parse(A))}catch(T){rs("Errore nel caricamento fornitori:",T),n([])}},[]),q.useEffect(()=>{localStorage.setItem("haccp-suppliers",JSON.stringify(e))},[e]);const C=()=>{c({name:"",category:"",vat:"",phone:"",email:"",notes:""}),o(null),i(!1)},B=A=>{if(A.preventDefault(),!l.name.trim()||!l.category){k(" Attenzione: Nome fornitore e categoria sono obbligatori per la tracciabilit HACCP");return}const T={id:(a==null?void 0:a.id)||Date.now().toString(),...l,name:l.name.trim(),category:l.category,createdAt:(a==null?void 0:a.createdAt)||new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:(a==null?void 0:a.createdBy)||(t==null?void 0:t.id)||"unknown",updatedBy:(t==null?void 0:t.id)||"unknown"};a?(n(F=>F.map(ne=>ne.id===a.id?T:ne)),_(" Fornitore aggiornato con successo!")):(n(F=>[...F,T]),_(" Nuovo fornitore aggiunto con successo!")),C()},K=A=>{b(` ATTENZIONE: Stai per eliminare questo fornitore.

Questa azione non pu essere annullata e rimuover tutte le informazioni di tracciabilit associate.

Procedere?`,()=>{n(T=>T.filter(F=>F.id!==A)),_(" Fornitore eliminato con successo")})},Z=A=>{o(A),c({name:A.name,category:A.category,vat:A.vat||"",phone:A.phone||"",email:A.email||"",notes:A.notes||""}),i(!0)},z=A=>Ah.find(T=>T.key===A)||{name:"Sconosciuta",icon:"",description:"Categoria non definita"},[J,te]=q.useState("all"),I=J==="all"?e:e.filter(A=>A.category===J);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestione Fornitori"}),s.jsx("p",{className:"text-gray-600",children:" Gestisci i fornitori per garantire la tracciabilit HACCP e la sicurezza alimentare"})]}),s.jsxs(le,{onClick:()=>i(!0),className:"flex items-center gap-2",children:[s.jsx(pr,{className:"h-4 w-4"}),"Nuovo Fornitore"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(ot,{children:s.jsxs(et,{className:"p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Fornitori Totali"})]})}),Ah.map(A=>s.jsx(ot,{children:s.jsxs(et,{className:"p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(T=>T.category===A.key).length}),s.jsx("div",{className:"text-sm text-gray-600",children:A.name})]})},A.key))]}),s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Wa,{className:"h-5 w-5"}),"Filtra per Categoria"]})}),s.jsx(et,{children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>te("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${J==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Tutti (",e.length,")"]}),Ah.map(A=>s.jsxs("button",{onClick:()=>te(A.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${J===A.key?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[A.icon," ",A.name," (",e.filter(T=>T.category===A.key).length,")"]},A.key))]})})]}),r&&s.jsxs(ot,{children:[s.jsxs(Ut,{children:[s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Pu,{className:"h-5 w-5"}),a?"Modifica Fornitore":"Nuovo Fornitore"]}),s.jsx("p",{className:"text-sm text-gray-600",children:" Compila i campi obbligatori per garantire la tracciabilit HACCP"})]}),s.jsx(et,{children:s.jsxs("form",{onSubmit:B,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Je,{htmlFor:"name",className:"flex items-center gap-2",children:["Nome Fornitore *",s.jsx("span",{className:"text-xs text-gray-500",title:"Nome completo del fornitore per la tracciabilit",children:""})]}),s.jsx(bt,{id:"name",value:l.name,onChange:A=>c({...l,name:A.target.value}),placeholder:"Es: Fornitura Rossi SRL",required:!0}),s.jsx("p",{className:"text-xs text-gray-500",children:" Inserisci il nome completo per la tracciabilit HACCP"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Je,{htmlFor:"category",className:"flex items-center gap-2",children:["Categoria *",s.jsx("span",{className:"text-xs text-gray-500",title:"Tipo di prodotti forniti",children:""})]}),s.jsxs("select",{id:"category",value:l.category,onChange:A=>c({...l,category:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[s.jsx("option",{value:"",children:"-- Seleziona Categoria --"}),Ah.map(A=>s.jsxs("option",{value:A.key,children:[A.icon," ",A.name," - ",A.description]},A.key))]}),s.jsx("p",{className:"text-xs text-gray-500",children:" Categorizza per tipo di prodotto fornito"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Je,{htmlFor:"vat",children:"Partita IVA"}),s.jsx(bt,{id:"vat",value:l.vat,onChange:A=>c({...l,vat:A.target.value}),placeholder:"IT12345678901"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Je,{htmlFor:"phone",children:"Telefono"}),s.jsx(bt,{id:"phone",value:l.phone,onChange:A=>c({...l,phone:A.target.value}),placeholder:"+39 123 456 7890"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Je,{htmlFor:"email",children:"Email"}),s.jsx(bt,{id:"email",type:"email",value:l.email,onChange:A=>c({...l,email:A.target.value}),placeholder:"fornitore@example.com"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Je,{htmlFor:"notes",children:"Note"}),s.jsx("textarea",{id:"notes",value:l.notes,onChange:A=>c({...l,notes:A.target.value}),placeholder:"Note aggiuntive, orari di consegna, requisiti speciali...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{type:"submit",className:"flex items-center gap-2",children:[s.jsx(B4,{className:"h-4 w-4"}),a?"Aggiorna":"Salva"," Fornitore"]}),s.jsxs(le,{type:"button",variant:"outline",onClick:C,className:"flex items-center gap-2",children:[s.jsx(un,{className:"h-4 w-4"}),"Annulla"]})]})]})})]}),s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Pu,{className:"h-5 w-5"}),"Fornitori (",I.length,")"]})}),s.jsx(et,{children:I.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Pu,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),s.jsx("p",{className:"text-lg font-medium",children:"Nessun fornitore trovato"}),s.jsx("p",{className:"text-sm",children:J==="all"?"Inizia aggiungendo il primo fornitore per la tracciabilit HACCP":`Nessun fornitore nella categoria "${z(J).name}"`})]}):s.jsx("div",{className:"space-y-3",children:I.map(A=>{const T=z(A.category);return s.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"font-semibold text-lg",children:A.name}),s.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:[T.icon," ",T.name]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[A.vat&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Partita IVA:"}),s.jsx("div",{className:"font-medium",children:A.vat})]}),A.phone&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Telefono:"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx($4,{className:"h-3 w-3"}),s.jsx("span",{className:"font-medium",children:A.phone})]})]}),A.email&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Email:"}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(O4,{className:"h-3 w-3"}),s.jsx("span",{className:"font-medium",children:A.email})]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Aggiornato:"}),s.jsx("div",{className:"font-medium",children:new Date(A.updatedAt).toLocaleDateString("it-IT")})]})]}),A.notes&&s.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-gray-600 text-sm",children:"Note:"}),s.jsx("p",{className:"text-gray-800 mt-1",children:A.notes})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{size:"sm",variant:"outline",onClick:()=>Z(A),className:"text-blue-600 hover:text-blue-700",children:s.jsx(wi,{className:"h-4 w-4"})}),s.jsx(le,{size:"sm",variant:"outline",onClick:()=>K(A.id),className:"text-red-600 hover:text-red-700",children:s.jsx(er,{className:"h-4 w-4"})})]})]})},A.id)})})})]}),s.jsx(pd,{isOpen:d.isOpen,onClose:v,title:d.title,message:d.message,type:d.type,confirmText:d.confirmText,onConfirm:d.onConfirm}),s.jsx(gd,{isOpen:f.isOpen,onClose:m,title:f.title,message:f.message,type:f.type,confirmText:f.confirmText,cancelText:f.cancelText,onConfirm:f.onConfirm,onCancel:f.onCancel}),s.jsx(vd,{isOpen:p.isOpen,onClose:N,title:p.title,message:p.message,placeholder:p.placeholder,defaultValue:p.defaultValue,type:p.type,confirmText:p.confirmText,cancelText:p.cancelText,validation:p.validation,onConfirm:p.onConfirm,onCancel:p.onCancel})]})}const cu=["haccp-temperatures","haccp-refrigerators","haccp-staff","haccp-cleaning","haccp-products","haccp-departments","haccp-users","haccp-actions","haccp-roles","haccp-suppliers","haccp-onboarding","haccp-presets","haccp-dev-mode"];function JC({currentUser:t,isAdmin:e=!1}){const[n,r]=q.useState({autoBackupEnabled:!1,autoBackupFrequency:"weekly",lastBackupDate:null,nextBackupDate:null}),[i,a]=q.useState([]),[o,l]=q.useState(!1),[c,d]=q.useState(!1);q.useEffect(()=>{const m=localStorage.getItem("haccp-backup-settings");if(m)try{const _=JSON.parse(m);r(k=>({...k,..._}))}catch(_){rs("Errore nel caricamento impostazioni backup:",_)}const N=localStorage.getItem("haccp-backup-history");if(N)try{a(JSON.parse(N))}catch(_){rs("Errore nel caricamento cronologia backup:",_)}},[]),q.useEffect(()=>{localStorage.setItem("haccp-backup-settings",JSON.stringify(n))},[n]),q.useEffect(()=>{if(n.autoBackupEnabled&&n.lastBackupDate){const m=new Date(n.lastBackupDate),N=new Date(m);n.autoBackupFrequency==="weekly"?N.setDate(N.getDate()+7):n.autoBackupFrequency==="monthly"&&N.setMonth(N.getMonth()+1),r(_=>({..._,nextBackupDate:N.toISOString()}))}},[n.autoBackupEnabled,n.lastBackupDate,n.autoBackupFrequency]);const f=async()=>{l(!0);try{const m={version:"1.0",timestamp:new Date().toISOString(),exportedBy:(t==null?void 0:t.name)||"unknown",data:{}};for(const b of cu){const j=localStorage.getItem(b);if(j)try{m.data[b]=JSON.parse(j)}catch(C){rd(`Errore nel parsing ${b}:`,C),m.data[b]=j}}const N=new Blob([JSON.stringify(m,null,2)],{type:"application/json"}),_=URL.createObjectURL(N),k=document.createElement("a");k.href=_,k.download=`haccp-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(_);const y={id:Date.now().toString(),type:"manual",timestamp:new Date().toISOString(),user:(t==null?void 0:t.name)||"unknown",size:N.size,success:!0};a(b=>[y,...b.slice(0,9)]),localStorage.setItem("haccp-backup-history",JSON.stringify([y,...i.slice(0,9)])),alert(` Export completato con successo!

 File scaricato nella cartella Download
 Tutti i dati HACCP sono stati esportati`)}catch(m){rs("Errore durante export:",m),alert(` Errore durante l'export dei dati

Controlla la console per maggiori dettagli`)}finally{l(!1)}},p=async m=>{const N=m.target.files[0];if(N){d(!0);try{const _=await N.text(),k=JSON.parse(_);if(!k.version||!k.data||!k.timestamp)throw new Error("Formato file non valido. Il file deve contenere version, data e timestamp.");const y=Object.keys(k.data);if(!confirm(` ATTENZIONE: Stai per importare dati HACCP!

 Dati trovati: ${y.length} chiavi
 Data export: ${new Date(k.timestamp).toLocaleString("it-IT")}
 Esportato da: ${k.exportedBy||"sconosciuto"}

 Questa operazione sovrascriver i dati esistenti!

Procedere con l'import?`)){d(!1);return}const j={};for(const Z of cu){const z=localStorage.getItem(Z);z&&(j[Z]=z)}const C={version:"1.0",timestamp:new Date().toISOString(),type:"pre-import-backup",data:j};localStorage.setItem("haccp-pre-import-backup",JSON.stringify(C));let B=0;for(const[Z,z]of Object.entries(k.data))if(cu.includes(Z))try{typeof z=="string"?localStorage.setItem(Z,z):localStorage.setItem(Z,JSON.stringify(z)),B++}catch(J){rd(`Errore nell'import di ${Z}:`,J)}const K={id:Date.now().toString(),type:"import",timestamp:new Date().toISOString(),user:(t==null?void 0:t.name)||"unknown",importedKeys:B,success:!0,sourceFile:N.name};a(Z=>[K,...Z.slice(0,9)]),localStorage.setItem("haccp-backup-history",JSON.stringify([K,...i.slice(0,9)])),alert(` Import completato con successo!

 Chiavi importate: ${B}/${Object.keys(k.data).length}
 Backup pre-import salvato come 'haccp-pre-import-backup'

 Ricarica la pagina per applicare le modifiche`),setTimeout(()=>{window.location.reload()},2e3)}catch(_){rs("Errore durante import:",_),alert(` Errore durante l'import:

${_.message}

Controlla che il file sia un backup HACCP valido.`)}finally{d(!1),m.target.value=""}}},v=async()=>{try{await f(),r(N=>({...N,lastBackupDate:new Date().toISOString()}));const m={id:Date.now().toString(),type:"auto",timestamp:new Date().toISOString(),user:"Sistema",success:!0};a(N=>[m,...N.slice(0,9)]),localStorage.setItem("haccp-backup-history",JSON.stringify([m,...i.slice(0,9)]))}catch(m){rs("Errore backup automatico:",m)}};return q.useEffect(()=>{if(n.autoBackupEnabled&&n.nextBackupDate){const m=new Date,N=new Date(n.nextBackupDate);m>=N&&v()}},[n.autoBackupEnabled,n.nextBackupDate]),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Backup e Export Dati"}),s.jsx("p",{className:"text-gray-600",children:" Gestisci il backup e l'export dei dati HACCP per garantire la sicurezza e la tracciabilit"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(ot,{children:s.jsxs(et,{className:"p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.filter(m=>m.success).length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Backup Completati"})]})}),s.jsx(ot,{children:s.jsxs(et,{className:"p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.filter(m=>m.type==="auto").length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Backup Automatici"})]})}),s.jsx(ot,{children:s.jsxs(et,{className:"p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.filter(m=>m.type==="import").length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Import Completati"})]})})]}),e&&s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Wr,{className:"h-5 w-5"}),"Backup Automatico"]})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium",children:"Abilita Backup Automatico"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Crea automaticamente backup periodici per garantire la sicurezza dei dati"})]}),s.jsx(le,{variant:n.autoBackupEnabled?"default":"outline",onClick:()=>r(m=>({...m,autoBackupEnabled:!m.autoBackupEnabled})),className:"flex items-center gap-2",children:n.autoBackupEnabled?s.jsxs(s.Fragment,{children:[s.jsx(kn,{className:"h-4 w-4"}),"Abilitato"]}):s.jsxs(s.Fragment,{children:[s.jsx(pn,{className:"h-4 w-4"}),"Disabilitato"]})})]}),n.autoBackupEnabled&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium",children:"Frequenza Backup"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Quanto spesso creare backup automatici"})]}),s.jsxs("select",{value:n.autoBackupFrequency,onChange:m=>r(N=>({...N,autoBackupFrequency:m.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"weekly",children:"Settimanale"}),s.jsx("option",{value:"monthly",children:"Mensile"})]})]}),n.lastBackupDate&&s.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[s.jsx(Qs,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium",children:"Ultimo backup:"}),s.jsx("span",{children:new Date(n.lastBackupDate).toLocaleString("it-IT")})]}),n.nextBackupDate&&s.jsxs("div",{className:"text-blue-700 text-sm mt-1",children:["Prossimo backup: ",new Date(n.nextBackupDate).toLocaleString("it-IT")]})]})]})]})})]}),s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Ys,{className:"h-5 w-5"}),"Export Dati"]})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-600",children:" Esporta tutti i dati HACCP in formato JSON per backup, migrazione o condivisione. Include temperature, pulizie, inventario, staff e tutte le configurazioni."}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(le,{onClick:f,disabled:o,className:"flex items-center gap-2",children:[o?s.jsx(Gh,{className:"h-4 w-4 animate-spin"}):s.jsx(Ys,{className:"h-4 w-4"}),o?"Esportando...":"Export Completo JSON"]}),s.jsxs("span",{className:"text-sm text-gray-500",children:[cu.length," chiavi dati incluse"]})]}),s.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[s.jsx(kn,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium",children:"Dati inclusi nell'export:"})]}),s.jsx("div",{className:"text-green-700 text-sm mt-2 grid grid-cols-2 gap-2",children:cu.map(m=>s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(k4,{className:"h-3 w-3"}),m.replace("haccp-","")]},m))})]})]})})]}),s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Iu,{className:"h-5 w-5"}),"Import Dati"]})}),s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-600",children:" Importa dati HACCP da un file di backup JSON.  Questa operazione sovrascriver i dati esistenti!"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"file",accept:".json",onChange:p,className:"hidden",id:"import-file"}),s.jsx("label",{htmlFor:"import-file",children:s.jsxs(le,{as:"span",disabled:c,className:"flex items-center gap-2 cursor-pointer",children:[c?s.jsx(Gh,{className:"h-4 w-4 animate-spin"}):s.jsx(Iu,{className:"h-4 w-4"}),c?"Importando...":"Seleziona File JSON"]})}),c&&s.jsx("span",{className:"text-sm text-gray-500",children:"Import in corso..."})]}),s.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[s.jsx(pn,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium",children:"Attenzione Import:"})]}),s.jsxs("ul",{className:"text-yellow-700 text-sm mt-2 space-y-1",children:[s.jsx("li",{children:" I dati esistenti verranno sovrascritti"}),s.jsx("li",{children:" Verr creato un backup automatico pre-import"}),s.jsx("li",{children:" Solo file JSON HACCP validi sono accettati"}),s.jsx("li",{children:" La pagina verr ricaricata dopo l'import"})]})]})]})})]}),s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Qu,{className:"h-5 w-5"}),"Cronologia Backup"]})}),s.jsx(et,{children:i.length===0?s.jsxs("div",{className:"text-center py-6 text-gray-500",children:[s.jsx(Qu,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),s.jsx("p",{children:"Nessun backup registrato"}),s.jsx("p",{className:"text-sm",children:"I backup appariranno qui dopo aver eseguito export o import"})]}):s.jsx("div",{className:"space-y-3",children:i.map(m=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-full ${m.type==="auto"?"bg-blue-100 text-blue-600":m.type==="import"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"}`,children:m.type==="auto"?s.jsx(Gh,{className:"h-4 w-4"}):m.type==="import"?s.jsx(Iu,{className:"h-4 w-4"}):s.jsx(Ys,{className:"h-4 w-4"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:m.type==="auto"?"Backup Automatico":m.type==="import"?"Import Dati":"Export Manuale"}),s.jsxs("div",{className:"text-sm text-gray-600",children:[new Date(m.timestamp).toLocaleString("it-IT"),"  ",m.user]}),m.sourceFile&&s.jsxs("div",{className:"text-xs text-gray-500",children:["File: ",m.sourceFile]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:m.success?s.jsx(kn,{className:"h-5 w-5 text-green-600"}):s.jsx(pn,{className:"h-5 w-5 text-red-600"})})]},m.id))})})]})]})}function KC({currentUser:t,isAdmin:e=!1,onSettingsChange:n}){const[r,i]=q.useState(!1),[a,o]=q.useState({keepPhotosLocal:!1,keepDocsLocal:!0,keepDataLocal:!0,autoShareTemperatures:!0,autoShareInventory:!0,autoShareCleaning:!0,autoShareStaff:e,keepDaysLocal:7,maxPhotosLocal:e?100:20}),[l,c]=q.useState({usedSpace:"45 MB",availableSpace:"2.1 GB",photosCount:23,docsCount:156}),[d]=q.useState(()=>GC("demo-pizzeria"));q.useEffect(()=>{const m=localStorage.getItem("haccp-data-settings");m&&o({...a,...JSON.parse(m)});const N=d.getStorageStats();c({usedSpace:N.localSpace,availableSpace:"2.1 GB",photosCount:N.photosCount,docsCount:N.documentsCount})},[d]);const f=(m,N)=>{const _={...a,[m]:N};o(_),localStorage.setItem("haccp-data-settings",JSON.stringify(_)),n==null||n(_)},p=({title:m,description:N,value:_,onChange:k,icon:y,adminOnly:b=!1})=>b&&!e?null:s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-white",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(y,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:m}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N}),b&&s.jsxs("span",{className:"inline-flex items-center gap-1 mt-1 px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded",children:[s.jsx(Wr,{className:"h-3 w-3"}),"Solo Amministratore"]})]})]}),s.jsx(le,{variant:"ghost",onClick:()=>k(!_),className:"p-1",children:_?s.jsx(G4,{className:"h-6 w-6 text-green-600"}):s.jsx(H4,{className:"h-6 w-6 text-gray-400"})})]}),v=({title:m,description:N,current:_,options:k,onChange:y,icon:b})=>s.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[s.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[s.jsx(b,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:m}),s.jsx("p",{className:"text-sm text-gray-600",children:N})]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:k.map(j=>s.jsx(le,{variant:_===j.value?"default":"outline",onClick:()=>y(j.value),className:"text-sm py-2",children:j.label},j.value))})]});return s.jsxs(q.Fragment,{children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" Gestione Dati"}),s.jsx("p",{className:"text-gray-600",children:"Decidi cosa tenere sul tuo telefono e cosa condividere"})]}),s.jsx(an,{title:"Spazio sul Tuo Telefono",icon:U4,defaultExpanded:!0,className:"bg-gradient-to-r from-green-50 to-blue-50",children:s.jsx(et,{children:s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l.usedSpace}),s.jsx("p",{className:"text-xs text-gray-600",children:"Usato dall'app"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold text-green-600",children:l.availableSpace}),s.jsx("p",{className:"text-xs text-gray-600",children:"Spazio libero"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold text-orange-600",children:l.photosCount}),s.jsx("p",{className:"text-xs text-gray-600",children:"Foto salvate"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:l.docsCount}),s.jsx("p",{className:"text-xs text-gray-600",children:"Documenti"})]})]})})}),s.jsx(an,{title:"Foto e Documenti",icon:Ll,defaultExpanded:!0,children:s.jsxs(et,{className:"space-y-4",children:[s.jsx(p,{icon:C5,title:"Salva Foto sul Telefono",description:"Le foto delle etichette rimangono sul tuo telefono anche senza internet. Occupa pi spazio ma  pi veloce.",value:a.keepPhotosLocal,onChange:m=>f("keepPhotosLocal",m)}),s.jsx(p,{icon:I4,title:"Salva Documenti sul Telefono",description:"Tieni una copia di ricette, procedure e documenti sul telefono per consultarli anche offline.",value:a.keepDocsLocal,onChange:m=>f("keepDocsLocal",m)}),s.jsx(v,{icon:pu,title:"Quante Foto Tenere",description:"Numero massimo di foto da tenere salvate sul telefono",current:a.maxPhotosLocal,onChange:m=>f("maxPhotosLocal",m),options:[{value:10,label:"10 foto"},{value:50,label:"50 foto"},{value:100,label:"100 foto"}]})]})}),s.jsx(an,{title:"Condivisione Automatica",icon:nx,defaultExpanded:!0,children:s.jsxs(et,{className:"space-y-4",children:[s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[" ",s.jsx("strong",{children:"Cosa significa:"})," Se attivi queste opzioni, le modifiche che fai verranno condivise automaticamente con i colleghi appena hai internet."]})}),s.jsx(p,{icon:ws,title:"Condividi Temperature Automaticamente",description:"Le temperature dei frigoriferi vengono condivise subito con tutti. Importante per la sicurezza alimentare.",value:a.autoShareTemperatures,onChange:m=>f("autoShareTemperatures",m)}),s.jsx(p,{icon:Vn,title:"Condividi Inventario Automaticamente",description:"Quando aggiungi o modifichi prodotti, tutti vedono subito le modifiche.",value:a.autoShareInventory,onChange:m=>f("autoShareInventory",m)}),s.jsx(p,{icon:kn,title:"Condividi Pulizie Automaticamente",description:"Le attivit di pulizia completate vengono condivise subito con il team.",value:a.autoShareCleaning,onChange:m=>f("autoShareCleaning",m)}),s.jsx(p,{icon:Er,title:"Condividi Gestione Staff",description:"Modifiche a dipendenti, ruoli e permessi vengono condivise automaticamente.",value:a.autoShareStaff,onChange:m=>f("autoShareStaff",m),adminOnly:!0})]})}),s.jsx(an,{title:"Quanto Tenere sul Telefono",icon:pu,defaultExpanded:!1,children:s.jsxs(et,{className:"space-y-4",children:[s.jsx(v,{icon:pu,title:"Giorni di Dati da Tenere",description:"Quanti giorni di temperature, pulizie e inventario tenere salvati sul telefono",current:a.keepDaysLocal,onChange:m=>f("keepDaysLocal",m),options:[{value:3,label:"3 giorni"},{value:7,label:"1 settimana"},{value:30,label:"1 mese"}]}),s.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Qs,{className:"h-4 w-4 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Perch  importante?"}),s.jsxs("ul",{className:"text-xs text-gray-600 mt-1 space-y-1",children:[s.jsxs("li",{children:["  ",s.jsx("strong",{children:"Meno giorni"})," = telefono pi veloce e pi spazio libero"]}),s.jsxs("li",{children:["  ",s.jsx("strong",{children:"Pi giorni"})," = puoi vedere dati anche senza internet"]}),s.jsxs("li",{children:["  ",s.jsx("strong",{children:"Tutti i dati"})," rimangono sempre salvati online"]})]})]})]})})]})}),s.jsx(an,{title:" Azioni Rapide",icon:Wo,defaultExpanded:!1,children:s.jsx(et,{children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[s.jsxs(le,{variant:"outline",className:"flex items-center gap-2",onClick:async()=>{try{const m=await d.cleanupCloudStorage();if(m.success){alert(` ${m.message}
 Spazio liberato: ${m.spaceSaved}`);const N=d.getStorageStats();c(_=>({..._,usedSpace:N.localSpace}))}}catch{alert(" Errore durante la pulizia dello spazio")}},children:[s.jsx(pu,{className:"h-4 w-4"}),"Libera Spazio"]}),s.jsxs(le,{variant:"outline",className:"flex items-center gap-2",onClick:async()=>{var m;try{alert(" Sto sincronizzando tutto..."),await new Promise(_=>setTimeout(_,1500));const N=await d.getRecentChanges();N.success&&alert(` Sincronizzazione completata!
 Trovate ${((m=N.changes)==null?void 0:m.length)||0} modifiche dai colleghi`)}catch{alert(" Errore durante la sincronizzazione")}},children:[s.jsx(nx,{className:"h-4 w-4"}),"Sincronizza Ora"]})]})})}),s.jsx(an,{title:"Backup e Export Dati",icon:Ys,defaultExpanded:!1,children:s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-600",children:" Gestisci il backup e l'export dei dati HACCP per garantire la sicurezza e la tracciabilit. Esporta tutti i dati in formato JSON o importa da backup esistenti."}),s.jsx(JC,{currentUser:t,isAdmin:e})]})})}),s.jsx(an,{title:"Gestione Fornitori",icon:Pu,defaultExpanded:!1,children:s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-600",children:" Gestisci i fornitori per garantire la tracciabilit HACCP e la sicurezza alimentare. Mantieni aggiornate le informazioni sui fornitori per la compliance normativa."}),s.jsx(ZC,{currentUser:t})]})})}),s.jsx(an,{title:"Manuale HACCP",icon:jf,defaultExpanded:!1,children:s.jsx(et,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-600",children:"Consulta la guida completa per normative HACCP e procedure operative. Questo manuale ti aiuter a comprendere i requisiti e implementare correttamente le procedure."}),s.jsxs(le,{variant:"outline",className:"flex items-center gap-2 w-full",onClick:()=>i(!0),children:[s.jsx(jf,{className:"h-4 w-4"}),"Apri Manuale HACCP"]})]})})})]}),r&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl h-full max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Manuale HACCP"}),s.jsx(le,{variant:"outline",size:"sm",onClick:()=>i(!1),children:" Chiudi"})]}),s.jsx("div",{className:"overflow-y-auto h-full p-4",children:s.jsx(WC,{})})]})})]})}function YC({isOpen:t,onClose:e,onLogin:n,users:r,onAddUser:i}){const[a,o]=q.useState(""),[l,c]=q.useState(""),[d,f]=q.useState(!1),[p,v]=q.useState(!1),[m,N]=q.useState(""),[_,k]=q.useState({name:"",pin:"",role:"employee",department:""}),[y,b]=q.useState([]),[j,C]=q.useState([]);q.useEffect(()=>{const J=localStorage.getItem("haccp-departments"),te=localStorage.getItem("haccp-departments-version"),I=["Banconisti","Cuochi","Amministrazione"];if(te!=="2.0"||!J)b(I),C(I);else try{const T=JSON.parse(J).filter(ne=>ne.isCustom).map(ne=>ne.name),F=[...T];I.forEach(ne=>{T.includes(ne)||F.push(ne)}),b(F),C(I)}catch(A){rs("Errore nel caricamento reparti:",A),b(I),C(I)}},[]),q.useEffect(()=>{if(r.length>0&&!a){const J=r.find(te=>te.name==="Admin"&&te.pin==="0000");J&&(o(J.id),c("0000"),De(" Login precompilato: Admin / 0000"))}},[r,a]);const B=()=>{if(!a||!l){N("Seleziona utente e inserisci PIN");return}const J=r.find(te=>te.id===a);if(!J){N("Utente non trovato");return}if(J.pin!==l){N("PIN non corretto");return}n(J),Z()},K=()=>{if(!_.name.trim()||!_.pin.trim()){N("Nome e PIN sono obbligatori");return}if(_.pin.length!==4){N("Il PIN deve essere di 4 cifre");return}if(r.some(J=>J.pin===_.pin)){N("PIN gi in uso, scegline un altro");return}i(_),f(!1),k({name:"",pin:"",role:"employee",department:""}),N("")},Z=()=>{o(""),c(""),N(""),f(!1),v(!1)},z=()=>{Z(),e()};return t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[s.jsx("h2",{className:"text-xl font-semibold",children:d?"Aggiungi Nuovo Utente":"Inizia il Turno"}),s.jsx(le,{variant:"ghost",size:"sm",onClick:z,children:s.jsx(un,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"p-6",children:[m&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:m}),d?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"new-name",children:"Nome Completo"}),s.jsx(bt,{id:"new-name",value:_.name,onChange:J=>k({..._,name:J.target.value}),placeholder:"es. Mario Rossi"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"new-pin",children:"PIN (4 cifre)"}),s.jsx(bt,{id:"new-pin",type:"password",value:_.pin,onChange:J=>{const te=J.target.value.replace(/\D/g,"").slice(0,4);k({..._,pin:te})},maxLength:4,placeholder:""})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"new-role",children:"Ruolo"}),s.jsxs("select",{id:"new-role",value:_.role,onChange:J=>k({..._,role:J.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"-- Seleziona ruolo --"}),s.jsx("option",{value:"dipendente",children:"Dipendente (Staff Fisso) (Consigliato)"}),s.jsx("option",{value:"responsabile",children:"Responsabile (Consigliato)"}),s.jsx("option",{value:"collaboratore",children:"Collaboratore Occasionale (Consigliato)"}),s.jsx("option",{value:"admin",children:"Amministratore (Consigliato)"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:`I ruoli contrassegnati come "Consigliato" sono provvisori e verranno sostituiti dalle categorie create dall'amministratore.`})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"new-department",children:"Reparto"}),s.jsxs("select",{id:"new-department",value:_.department,onChange:J=>k({..._,department:J.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"-- Seleziona reparto --"}),y.map(J=>{const te=j.includes(J);return s.jsxs("option",{value:J,children:[J," ",te?"(Consigliato)":""]},J)})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:`I reparti contrassegnati come "Consigliato" sono provvisori e verranno sostituiti dalle categorie create dall'amministratore.`})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsxs(le,{onClick:K,className:"flex-1",disabled:!_.name.trim()||_.pin.length!==4,children:[s.jsx(pr,{className:"mr-2 h-4 w-4"}),"Crea Utente"]}),s.jsx(le,{variant:"outline",onClick:()=>{f(!1),N("")},children:"Indietro"})]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"user-select",children:"Seleziona Utente"}),s.jsxs("select",{id:"user-select",value:a,onChange:J=>{o(J.target.value),N("")},className:"mt-1 block w-full rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"-- Scegli utente --"}),r.map(J=>s.jsxs("option",{value:J.id,children:[J.name," (",J.department,")",J.role==="admin"&&" - Admin"]},J.id))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"pin",children:"PIN (4 cifre)"}),s.jsxs("div",{className:"relative",children:[s.jsx(bt,{id:"pin",type:p?"text":"password",value:l,onChange:J=>{const te=J.target.value.replace(/\D/g,"").slice(0,4);c(te),N("")},maxLength:4,placeholder:"",className:"pr-10"}),s.jsx(le,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>v(!p),children:p?s.jsx(A4,{className:"h-4 w-4"}):s.jsx(jg,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsxs(le,{onClick:B,className:"flex-1",disabled:!a||l.length!==4,children:[s.jsx(z5,{className:"mr-2 h-4 w-4"}),"Entra"]}),s.jsx(le,{variant:"outline",onClick:z,children:"Annulla"})]}),s.jsx("div",{className:"pt-4 border-t",children:s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>f(!0),className:"w-full",children:[s.jsx(pr,{className:"mr-2 h-4 w-4"}),"Aggiungi Nuovo Utente"]})})]})]})]})}):null}function QC({activeTab:t,temperatures:e}){const[n,r]=q.useState(!1);q.useEffect(()=>{r(t==="temperature")},[t]);const i=()=>{if(typeof window.jspdf>"u"){alert("Errore: Librerie PDF non caricate. Ricarica la pagina e riprova.");return}if(e.length===0){alert("Nessuna temperatura registrata da esportare.");return}try{const a=["Posizione","Temperatura","Orario"],o=[];e.forEach(v=>{o.push([v.location,`${v.temperature}C`,v.time])});const{jsPDF:l}=window.jspdf,c=new l;c.setFontSize(18),c.text("Report: Temperature HACCP",14,22),c.setFontSize(12);const d=new Date().toLocaleDateString("it-IT");c.text(`Data esportazione: ${d}`,14,32),c.text(`Totale rilevazioni: ${e.length}`,14,40),c.autoTable({startY:50,head:[a],body:o,theme:"striped",styles:{fontSize:10,cellPadding:3},headStyles:{fillColor:[25,118,210],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},columnStyles:{0:{cellWidth:60},1:{cellWidth:40,halign:"center"},2:{cellWidth:50}}});const f=c.internal.getNumberOfPages();c.setFontSize(8);for(let v=1;v<=f;v++)c.setPage(v),c.text(`Mini-ePackPro HACCP - Pagina ${v} di ${f}`,14,c.internal.pageSize.height-10);const p=`report_Temperature_${new Date().toISOString().slice(0,10)}.pdf`;c.save(p)}catch(a){rs("PDF export error:",a),alert("Errore durante l'esportazione del PDF. Riprova.")}};return n?s.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:s.jsxs(le,{onClick:i,className:"bg-primary-500 hover:bg-primary-600 text-white shadow-lg hover:shadow-xl transition-all duration-300 flex items-center gap-2 px-6 py-3 rounded-xl",size:"lg",children:[s.jsx(P4,{className:"h-5 w-5"}),s.jsx("span",{className:"hidden sm:inline",children:"Esporta Temperature in PDF"}),s.jsx("span",{className:"sm:hidden",children:"PDF"})]})}):null}const XC=()=>({"haccp-roles":[],"haccp-suppliers":[],"haccp-onboarding":{currentStep:"preset",completedSteps:[],progress:0,startedAt:new Date().toISOString(),lastActivity:new Date().toISOString()},"haccp-presets":[],"haccp-dev-mode":{enabled:!1,features:[],bypassOnboarding:!1,showDebugInfo:!1,lastToggled:new Date().toISOString()}}),eA=()=>{try{if(new URLSearchParams(window.location.search).get("dev")==="1"){const e={enabled:!0,features:["bypass-onboarding","show-debug-info"],bypassOnboarding:!0,showDebugInfo:!0,lastToggled:new Date().toISOString(),reason:"Attivato via URL parameter"};return localStorage.setItem("haccp-dev-mode",JSON.stringify(e)),console.log(" Dev mode attivato via URL parameter"),!0}}catch(t){console.warn("Errore nell'inizializzazione dev mode:",t)}return!1},id="haccp-dev-mode",Nc=()=>{try{const t=localStorage.getItem(id);if(t&&t!=="undefined"&&t!=="null"&&t!=="[object Object]"){const e=JSON.parse(t);return e&&typeof e=="object"&&e.enabled===!0}}catch(t){console.warn("Errore nel parsing dev mode:",t),localStorage.removeItem(id),localStorage.removeItem("haccp-dev-mode"),localStorage.removeItem("haccp-dev-mode-version")}return!1},tA=(t=null,e="")=>{const n=Nc(),r=t!==null?t:!n,i={enabled:r,features:r?["bypass-onboarding","show-debug-info"]:[],bypassOnboarding:r,showDebugInfo:r,lastToggled:new Date().toISOString(),reason:e||(r?"Attivato manualmente":"Disattivato manualmente")};try{return localStorage.setItem(id,JSON.stringify(i)),r&&!n&&window.location.reload(),r}catch(a){return console.error("Errore nel salvataggio dev mode:",a),!1}},o1=()=>{try{const t=localStorage.getItem(id);if(t&&t!=="undefined"&&t!=="null"){const e=JSON.parse(t);if(e&&typeof e=="object")return e}}catch(t){console.warn("Errore nel parsing dev mode settings:",t),localStorage.removeItem(id)}return{enabled:!1,features:[],bypassOnboarding:!1,showDebugInfo:!1,lastToggled:null,reason:null}},Lb=t=>Nc()?o1().features.includes(t):!1,nA=()=>Nc()&&Lb("bypass-onboarding"),rA=()=>Nc()&&Lb("show-debug-info"),sA=()=>rA()?{timestamp:new Date().toISOString(),userAgent:navigator.userAgent,localStorage:{keys:Object.keys(localStorage),size:new Blob(Object.values(localStorage)).size},sessionStorage:{keys:Object.keys(sessionStorage),size:new Blob(Object.values(sessionStorage)).size},url:window.location.href,devMode:o1()}:null,iA=()=>{if(!Nc())return!1;try{return["haccp-dev-mode","haccp-onboarding","haccp-presets"].forEach(e=>{localStorage.removeItem(e)}),!0}catch(t){return console.error("Errore nella pulizia dati dev:",t),!1}};function Jx(){const[t,e]=q.useState(!1),[n,r]=q.useState(!1),[i,a]=q.useState(!1),[o,l]=q.useState(null);if(q.useEffect(()=>{const v=()=>{const N=Nc();e(N),N&&l(o1())};v();const m=N=>{N.key==="haccp-dev-mode"&&v()};return window.addEventListener("storage",m),()=>{window.removeEventListener("storage",m)}},[]),!t)return null;const c=()=>{tA(!1,"Disattivato via banner")},d=async()=>{confirm(` ATTENZIONE: Stai per rimuovere tutti i dati di sviluppo.

Questo rimuover:
 Modalit dev
 Onboarding
 Preset

I dati HACCP (temperature, pulizie, inventario) NON verranno toccati.

Procedere?`)&&(iA()?(alert(` Dati di sviluppo rimossi con successo!

La modalit dev  stata disattivata.`),window.location.reload()):alert(" Errore nella rimozione dei dati di sviluppo"))},f=()=>{window.location.reload()},p=sA();return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-yellow-500 text-yellow-900 px-4 py-2 shadow-lg",children:s.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(pn,{className:"h-5 w-5"}),s.jsx("span",{className:"font-bold",children:"DEV MODE ATTIVO"}),s.jsx("span",{className:"text-sm opacity-75",children:" Onboarding bypassato  Debug info  Testing features"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>a(!i),className:"p-1 hover:bg-yellow-400 rounded transition-colors",title:"Mostra info debug",children:s.jsx(Qs,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>r(!n),className:"p-1 hover:bg-yellow-400 rounded transition-colors",title:"Impostazioni dev",children:s.jsx(Wr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:f,className:"p-1 hover:bg-yellow-400 rounded transition-colors",title:"Ricarica pagina",children:s.jsx(Gh,{className:"h-4 w-4"})}),s.jsx("button",{onClick:c,className:"p-1 hover:bg-yellow-400 rounded transition-colors",title:"Disattiva dev mode",children:s.jsx(un,{className:"h-4 w-4"})})]})]})}),i&&p&&s.jsxs("div",{className:"fixed top-16 left-4 right-4 z-40 bg-white border border-yellow-300 rounded-lg shadow-xl p-4 max-h-96 overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"font-bold text-yellow-800 flex items-center gap-2",children:[s.jsx(Qs,{className:"h-5 w-5"}),"Debug Info"]}),s.jsx("button",{onClick:()=>a(!1),className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(un,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Timestamp:"})," ",p.timestamp]}),s.jsxs("div",{children:[s.jsx("strong",{children:"URL:"})," ",p.url]}),s.jsxs("div",{children:[s.jsx("strong",{children:"User Agent:"})," ",p.userAgent]}),s.jsxs("div",{children:[s.jsx("strong",{children:"LocalStorage:"})," ",p.localStorage.keys.length," chiavi, ",Math.round(p.localStorage.size/1024)," KB"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"SessionStorage:"})," ",p.sessionStorage.keys.length," chiavi, ",Math.round(p.sessionStorage.size/1024)," KB"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Dev Mode Settings:"}),s.jsx("pre",{className:"mt-1 p-2 bg-gray-100 rounded text-xs overflow-x-auto",children:JSON.stringify(p.devMode,null,2)})]})]})]}),n&&s.jsxs("div",{className:"fixed top-16 left-4 right-4 z-40 bg-white border border-yellow-300 rounded-lg shadow-xl p-4 max-w-md",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"font-bold text-yellow-800 flex items-center gap-2",children:[s.jsx(Wr,{className:"h-5 w-5"}),"Impostazioni Dev Mode"]}),s.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(un,{className:"h-4 w-4"})})]}),o&&s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Stato:"}),s.jsx("span",{className:"ml-2 px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:"ATTIVO"})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Attivato il:"})," ",new Date(o.lastToggled).toLocaleString("it-IT")]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Motivo:"})," ",o.reason]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Features:"}),s.jsx("div",{className:"mt-1 space-y-1",children:o.features.map(v=>s.jsx("div",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:v},v))})]}),s.jsxs("div",{className:"pt-3 border-t",children:[s.jsxs("button",{onClick:d,className:"w-full px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors flex items-center justify-center gap-2",children:[s.jsx(er,{className:"h-4 w-4"}),"Rimuovi Dati Dev"]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1 text-center",children:"Rimuove solo i dati di sviluppo, mantiene i dati HACCP"})]})]})]}),s.jsx("div",{className:"h-16"})]})}const aA=({currentStep:t,completedSteps:e,onStepClick:n,steps:r})=>{const i=(c,d)=>{(c===0||e.has(d))&&n(c)},a=(c,d)=>c===0||e.has(d),o=c=>e.has(c),l=c=>c===t;return s.jsx("div",{className:"flex items-center justify-center space-x-2 mb-6",children:r.map((c,d)=>{const f=a(d,c.id),p=o(c.id),v=l(d);return s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:()=>i(d,c.id),disabled:!f,className:`
                w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium
                transition-all duration-200 ease-in-out
                ${v?"bg-blue-600 text-white shadow-lg scale-110":p?"bg-green-500 text-white hover:bg-green-600 hover:scale-105 cursor-pointer":f?"bg-gray-200 text-gray-600 hover:bg-gray-300 hover:scale-105 cursor-pointer":"bg-gray-100 text-gray-400 cursor-not-allowed"}
                ${f?"hover:shadow-md":""}
              `,title:v?`Step corrente: ${c.title}`:p?`Vai allo step ${d+1}: ${c.title}`:d===0?`Step ${d+1}: ${c.title}`:`Completa gli step precedenti per accedere a: ${c.title}`,children:p?s.jsx(kn,{className:"h-5 w-5"}):f?d+1:s.jsx(L4,{className:"h-4 w-4"})}),d<r.length-1&&s.jsx("div",{className:`
                  w-8 h-0.5 mx-1
                  ${p?"bg-green-500":"bg-gray-300"}
                `})]},c.id)})})},Jn={categories:[{id:"fresh_dairy",name:"Latticini e Formaggi",minTemp:2,maxTemp:4,description:"Latte, formaggi freschi, yogurt",incompatibleWith:["frozen","dry_goods","hot_holding"]},{id:"fresh_meat",name:"Carni Fresche",minTemp:0,maxTemp:4,description:"Carni crude, pollame, salumi freschi",incompatibleWith:["frozen","dry_goods","hot_holding"]},{id:"fresh_fish",name:"Pesce Fresco",minTemp:0,maxTemp:2,description:"Pesce fresco, molluschi, crostacei",incompatibleWith:["frozen","dry_goods","hot_holding"]},{id:"fresh_produce",name:"Verdure e Ortaggi",minTemp:2,maxTemp:8,description:"Verdure fresche, insalate, ortaggi",incompatibleWith:["frozen","hot_holding"]},{id:"fresh_fruits",name:"Frutta Fresca",minTemp:2,maxTemp:8,description:"Frutta fresca di stagione",incompatibleWith:["frozen","hot_holding"]},{id:"frozen",name:"Surgelati",minTemp:-20,maxTemp:-16,description:"Tutti i prodotti surgelati",incompatibleWith:["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","hot_holding","fresh_beverages"]},{id:"deep_frozen",name:"Ultra Surgelati",minTemp:-25,maxTemp:-18,description:"Prodotti ultra surgelati (es. gelati)",incompatibleWith:["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","hot_holding","fresh_beverages"]},{id:"dry_goods",name:"Dispensa Secca",minTemp:15,maxTemp:25,description:"Pasta, riso, farina, conserve",incompatibleWith:["fresh_dairy","fresh_meat","fresh_fish","frozen","deep_frozen"]},{id:"hot_holding",name:"Mantenimento Caldo",minTemp:60,maxTemp:70,description:"Piatti pronti caldi, mantenuti a temperatura",incompatibleWith:["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","frozen","deep_frozen","fresh_beverages"]},{id:"chilled_ready",name:"Pronti Freddi",minTemp:2,maxTemp:8,description:"Piatti pronti freddi, insalate pronte",incompatibleWith:["frozen","deep_frozen","hot_holding"]},{id:"fresh_beverages",name:"Bevande Fresche",minTemp:2,maxTemp:10,description:"Bibite, succhi, acqua, bevande fresche",incompatibleWith:["frozen","deep_frozen","hot_holding"]},{id:"abbattitore_menu",name:"Prodotti per Men / Scorte",minTemp:-80,maxTemp:-10,description:"Prodotti per men e scorte in abbattitore",incompatibleWith:["hot_holding","fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","fresh_beverages","chilled_ready"]},{id:"abbattitore_esposizione",name:"Prodotti per Esposizione / Vendita",minTemp:-80,maxTemp:-10,description:"Prodotti per esposizione e vendita in abbattitore",incompatibleWith:["hot_holding","fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","fresh_beverages","chilled_ready"]}],tolerance:.5,validateConservationPoint:t=>{var n;const e=[];if((n=t.name)!=null&&n.trim()||e.push("Nome punto di conservazione obbligatorio"),t.location||e.push("Posizione obbligatoria"),(!t.minTemp||!t.maxTemp)&&e.push("Range temperature obbligatorio"),t.assignedRole||e.push("Ruolo assegnato obbligatorio"),t.minTemp&&t.maxTemp){const r=parseFloat(t.minTemp),i=parseFloat(t.maxTemp);isNaN(r)||isNaN(i)?e.push("Temperature non valide"):r>=i&&e.push("Temperatura minima deve essere inferiore alla massima")}return{isValid:e.length===0,errors:e}},validateTemperatureCompatibility:(t,e,n)=>{if(!n||n.length===0)return{compatible:!0,message:"Nessuna categoria selezionata"};const r=parseFloat(t),i=parseFloat(e);if(isNaN(r)||isNaN(i))return{compatible:!1,message:"Temperature non valide"};const a=Jn.tolerance;for(const o of n){const l=Jn.categories.find(f=>f.id===o);if(!l)continue;const c=l.minTemp-a,d=l.maxTemp+a;if(r<c||i>d)return{compatible:!1,message:`Temperature non compatibili con ${l.name}. Range consentito: ${l.minTemp}C - ${l.maxTemp}C (${a}C)`,category:l.name,requiredRange:{min:l.minTemp,max:l.maxTemp}}}return{compatible:!0,message:"Temperature compatibili con tutte le categorie selezionate"}},getOptimalTemperatureSuggestions:t=>{if(!t||t.length===0)return null;const e=Jn.categories.filter(o=>t.includes(o.id));if(e.length===0)return null;if(e.length===1){const o=e[0];return{minTemp:o.minTemp,maxTemp:o.maxTemp,message:`Range ottimale per ${o.name}: ${o.minTemp}C - ${o.maxTemp}C`}}const n=e.map(o=>o.minTemp),r=e.map(o=>o.maxTemp),i=Math.max(...n),a=Math.min(...r);return i<=a?{minTemp:i,maxTemp:a,message:`Range ottimale per tutte le categorie: ${i}C - ${a}C`}:{compatible:!1,message:"Le categorie selezionate richiedono range di temperatura incompatibili",categories:e.map(o=>o.name)}}},oA=({formData:t,setFormData:e,currentStep:n,validateStep:r,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{var p,v,m,N,_,k,y,b,j,C;const[c,d]=q.useState(null),f=B=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(B);return q.useEffect(()=>{var K;const B=((K=t.business)==null?void 0:K.email)||"";B.length>0?d(f(B)):d(null)},[(p=t.business)==null?void 0:p.email]),(v=t.business)!=null&&v.companyName&&((m=t.business)!=null&&m.address)&&((N=t.business)!=null&&N.email),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Informazioni Attivit"}),s.jsx("p",{className:"text-gray-600",children:"Configura i dati base della tua attivit"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"businessName",children:"Nome Attivit *"}),s.jsx(bt,{id:"businessName",value:((_=t.business)==null?void 0:_.companyName)||"",onChange:B=>e(K=>({...K,business:{...K.business,companyName:B.target.value}})),placeholder:"Es. Pizzeria Bella Napoli",className:"mt-1"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"vatNumber",children:"P.IVA"}),s.jsx(bt,{id:"vatNumber",value:((k=t.business)==null?void 0:k.vatNumber)||"",onChange:B=>e(K=>({...K,business:{...K.business,vatNumber:B.target.value}})),placeholder:"11 caratteri max",maxLength:11,className:"mt-1"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx(Je,{htmlFor:"address",children:"Indirizzo *"}),s.jsxs("div",{className:"flex gap-2 mt-1",children:[s.jsx(bt,{id:"address",value:((y=t.business)==null?void 0:y.address)||"",onChange:B=>e(K=>({...K,business:{...K.business,address:B.target.value}})),placeholder:"Via Roma 123, Milano",className:"flex-1"}),s.jsx(le,{variant:"outline",size:"sm",onClick:async()=>{if(navigator.geolocation)try{const B=event.target.closest("button"),K=B.innerHTML;B.innerHTML='<div class="animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"></div>',B.disabled=!0;const Z=await new Promise((I,A)=>{navigator.geolocation.getCurrentPosition(I,A,{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}),{latitude:z,longitude:J}=Z.coords,te=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${z}&lon=${J}&zoom=18&addressdetails=1`);if(te.ok){const I=await te.json();if(I.display_name&&I.address){const A=I.address,T=A.road||"",F=A.house_number||"",ne=A.postcode||"",W=A.city||A.town||A.village||"",ue=A.state||"",P=[T,F,W,ue].filter(Boolean).join(", ");e(Q=>({...Q,business:{...Q.business,address:P,via:T,civico:F,cap:ne,citta:W,provincia:ue,coordinates:{lat:z,lon:J}}})),B.innerHTML='<div class="text-green-600"></div>',setTimeout(()=>{B.innerHTML=K,B.disabled=!1},2e3)}}else throw new Error("Errore nel reverse geocoding")}catch(B){rs("Errore geolocalizzazione:",B),alert("Errore nella geolocalizzazione: "+B.message);const K=event.target.closest("button");K.innerHTML=originalContent,K.disabled=!1}else alert("Geolocalizzazione non supportata dal browser")},children:s.jsx(D4,{className:"h-4 w-4"})})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:" Clicca il pulsante GPS per rilevare automaticamente la tua posizione e compilare l'indirizzo"}),((b=t.business)==null?void 0:b.address)&&s.jsx("div",{className:"space-y-2 mt-2",children:s.jsxs("div",{className:"flex items-start gap-2 p-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsx("div",{className:"text-yellow-600 mt-0.5",children:""}),s.jsxs("div",{className:"text-sm text-yellow-800",children:[s.jsx("p",{className:"font-medium",children:"Verifica il numero civico!"}),s.jsx("p",{className:"text-sm mt-1",children:"La geolocalizzazione ha un margine di errore di 5-15 metri. Controlla che il numero civico sia corretto e modificalo se necessario."})]})]})})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"phone",children:"Telefono"}),s.jsx(bt,{id:"phone",value:((j=t.business)==null?void 0:j.phone)||"",onChange:B=>e(K=>({...K,business:{...K.business,phone:B.target.value}})),placeholder:"+39 123 456 7890",className:"mt-1"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"email",children:"Email *"}),s.jsxs("div",{className:"relative mt-1",children:[s.jsx(bt,{id:"email",type:"email",value:((C=t.business)==null?void 0:C.email)||"",onChange:B=>e(K=>({...K,business:{...K.business,email:B.target.value}})),placeholder:"info@pizzeria.it",className:`pr-10 ${c===!0?"border-green-500 focus:border-green-500 focus:ring-green-500":c===!1?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300"}`}),c===!0&&s.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:s.jsx(kn,{className:"h-5 w-5 text-green-500"})}),c===!1&&s.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:s.jsx(O5,{className:"h-5 w-5 text-red-500"})})]}),c===!1&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Inserisci un indirizzo email valido (es. info@pizzeria.it)"})]})]}),s.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qs,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-blue-900",children:"Campi Obbligatori"}),s.jsx("p",{className:"text-sm text-blue-800 mt-1",children:'Vengono indicati con asterisco " * "'})]})]})})]})},lA=({formData:t,setFormData:e,currentStep:n,validateStep:r,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{const[c,d]=q.useState(""),[f,p]=q.useState([{id:"cucina",name:"Cucina",enabled:!0,isCustom:!1,required:!1},{id:"bancone",name:"Bancone",enabled:!0,isCustom:!1,required:!1},{id:"sala",name:"Sala",enabled:!0,isCustom:!1,required:!1},{id:"magazzino",name:"Magazzino",enabled:!0,isCustom:!1,required:!1}]);q.useEffect(()=>{var y;if((y=t.departments)!=null&&y.list&&t.departments.list.length>0){const b=t.departments.list,C=[{id:"cucina",name:"Cucina",enabled:!0,isCustom:!1,required:!1},{id:"bancone",name:"Bancone",enabled:!0,isCustom:!1,required:!1},{id:"sala",name:"Sala",enabled:!0,isCustom:!1,required:!1},{id:"magazzino",name:"Magazzino",enabled:!0,isCustom:!1,required:!1}].map(K=>{const Z=b.find(z=>z.id===K.id);return Z?{...Z,required:!1}:K}),B=b.filter(K=>K.isCustom);p([...C,...B])}},[]);const v=y=>{p(b=>b.map(j=>j.id===y?{...j,enabled:!j.enabled}:j))},m=()=>{if(c.trim()){const y={id:`custom-${Date.now()}`,name:c.trim(),enabled:!0,isCustom:!0};p(b=>[...b,y]),d("")}},N=y=>{p(b=>b.filter(j=>j.id!==y))},_=f.filter(y=>y.enabled).length,k=_>0;return q.useEffect(()=>{e(y=>({...y,departments:{list:f,enabledCount:_}}))},[f,_,e]),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Reparti"}),s.jsx("p",{className:"text-gray-600",children:"Organizza la struttura operativa della tua attivit"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Reparti Standard"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:f.filter(y=>!y.isCustom&&y&&y.id&&y.name&&typeof y.name=="string").map(y=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsx("span",{className:"font-medium",children:y.name||"Nome non disponibile"}),s.jsxs("label",{className:"flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:y.enabled,onChange:()=>v(y.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-600",children:y.enabled?"Attivo":"Inattivo"})]})]},y.id))})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Aggiungi Reparto Personalizzato"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(bt,{value:c,onChange:y=>d(y.target.value),placeholder:"Nome del nuovo reparto",className:"flex-1"}),s.jsxs(le,{onClick:m,disabled:!c.trim(),variant:"outline",size:"sm",children:[s.jsx(pr,{className:"h-4 w-4 mr-1"}),"Aggiungi"]})]})]}),f.filter(y=>y.isCustom).length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Reparti Personalizzati"}),f.filter(y=>y.isCustom&&y&&y.id&&y.name&&typeof y.name=="string").map(y=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-gray-50",children:[s.jsx("span",{className:"font-medium",children:y.name||"Nome non disponibile"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:y.enabled,onChange:()=>v(y.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-600",children:y.enabled?"Attivo":"Inattivo"})]}),s.jsx(le,{onClick:()=>N(y.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:s.jsx(un,{className:"h-4 w-4"})})]})]},y.id))]}),s.jsx("div",{className:`p-4 rounded-lg ${k?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${k?"bg-green-500":"bg-yellow-500"} text-white text-sm font-bold`,children:_}),s.jsxs("div",{children:[k&&s.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),s.jsxs("p",{className:`font-medium ${k?"text-green-900":"text-yellow-900"}`,children:["Reparti attivi: ",_]}),s.jsx("p",{className:`text-sm ${k?"text-green-800":"text-yellow-800"}`,children:k?" Requisito soddisfatto! Puoi procedere.":" Devi attivare almeno 1 reparto per continuare."})]})]})})]})},cA=({formData:t,setFormData:e,currentStep:n,setCurrentStep:r,validateStep:i,confirmStep:a,markStepAsUnconfirmed:o,isStepConfirmed:l,canConfirmStep:c})=>{var ue;const[d,f]=q.useState(((ue=t.staff)==null?void 0:ue.staffMembers)||[]),[p,v]=q.useState(!1),[m,N]=q.useState(null),{formRef:_,scrollToForm:k}=Zo(p,"staff-add-form");q.useEffect(()=>{p&&k()},[p,k]);const[y,b]=q.useState({}),[j,C]=q.useState({name:"",surname:"",role:"",categories:[""],haccpExpiry:""});q.useEffect(()=>{var P;(P=t.staff)!=null&&P.staffMembers&&t.staff.staffMembers.length>0&&f(t.staff.staffMembers)},[t.staff]);const B=["Amministratore","Responsabile","Dipendente","Collaboratore Occasionale / Part-time"],K=["Cuochi","Banconisti","Camerieri","Social & Media Manager","Amministratore","Altro"],Z=()=>{C({name:"",surname:"",role:"",categories:[""],haccpExpiry:""}),N(null)},z=P=>P.some(Q=>Q!=="Social & Media Manager"&&Q!=="Altro"),J=()=>{C(P=>({...P,categories:[...P.categories,""]}))},te=P=>{j.categories.length>1&&C(Q=>({...Q,categories:Q.categories.filter((G,de)=>de!==P)}))},I=(P,Q)=>{C(G=>({...G,categories:G.categories.map((de,w)=>w===P?Q:de)}))},A=()=>{const P=[...new Set(j.categories.filter(Q=>Q.trim()))];if(j.name&&j.surname&&j.role&&P.length>0){const Q={id:Date.now(),name:j.name,surname:j.surname,role:j.role,categories:P,primaryCategory:P[0],fullName:`${j.name} ${j.surname}`,haccpExpiry:z(P)&&j.haccpExpiry?j.haccpExpiry:""},G=[...d,Q];f(G),e(de=>({...de,staff:{...de.staff,staffMembers:G}})),l(n)&&o(n),Z(),v(!1),b({})}},T=P=>{C({name:P.name,surname:P.surname,role:P.role||"",categories:P.categories&&P.categories.length>0?P.categories:[P.category||""],haccpExpiry:P.haccpExpiry}),N(P),v(!0)},F=()=>{const P=[...new Set(j.categories.filter(Q=>Q.trim()))];if(j.name&&j.surname&&j.role&&P.length>0){const Q=d.map(G=>G.id===m.id?{...G,name:j.name,surname:j.surname,role:j.role,categories:P,primaryCategory:P[0],fullName:`${j.name} ${j.surname}`,haccpExpiry:z(P)&&j.haccpExpiry?j.haccpExpiry:""}:G);f(Q),e(G=>({...G,staff:{...G.staff,staffMembers:Q}})),l(n)&&o(n),Z(),v(!1),b({})}},ne=P=>{const Q=d.filter(G=>G.id!==P);f(Q),e(G=>({...G,staff:{...G.staff,staffMembers:Q}})),l(n)&&o(n),b({})},W=()=>d.length===0?!1:d.every(P=>P.fullName&&P.fullName.trim().length>=3&&P.role&&(P.categories&&P.categories.length>0||P.category));return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Staff e Ruoli"}),s.jsx("p",{className:"text-gray-600",children:"Registra il personale e assegna responsabilit"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Membri dello Staff"}),s.jsxs(le,{onClick:()=>v(!0),variant:"outline",size:"sm",children:[s.jsx(pr,{className:"h-4 w-4 mr-1"}),"Aggiungi Staff"]})]}),d.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("p",{children:"Nessun membro dello staff registrato"}),s.jsx("p",{className:"text-sm",children:'Clicca "Aggiungi Staff" per iniziare'})]}):s.jsx("div",{className:"space-y-3",children:d.map((P,Q)=>s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-gray-50",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:P.fullName||"Nome non disponibile"}),s.jsx("p",{className:"text-sm text-gray-600",children:P.role}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(P.categories&&P.categories.length>0?P.categories:[P.category||"Non assegnato"]).map((G,de)=>s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:G},de))})]}),P.haccpExpiry&&s.jsxs("div",{className:"text-sm text-gray-600",children:["HACCP: ",P.haccpExpiry]})]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{onClick:()=>T(P),variant:"outline",size:"sm",children:s.jsx(wi,{className:"h-4 w-4"})}),s.jsx(le,{onClick:()=>ne(P.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:s.jsx(er,{className:"h-4 w-4"})})]})]}),(y[`staff_${Q}_name`]||y[`staff_${Q}_role`]||y[`staff_${Q}_category`])&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"text-sm text-red-800",children:[y[`staff_${Q}_name`]&&s.jsxs("p",{children:[" ",y[`staff_${Q}_name`]]}),y[`staff_${Q}_role`]&&s.jsxs("p",{children:[" ",y[`staff_${Q}_role`]]}),y[`staff_${Q}_category`]&&s.jsxs("p",{children:[" ",y[`staff_${Q}_category`]]})]})})]},P.id))})]}),p&&s.jsxs("div",{ref:_,id:"staff-add-form",className:"border rounded-lg p-4 bg-white",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:m?"Modifica Membro":"Aggiungi Nuovo Membro"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"name",children:"Nome *"}),s.jsx(bt,{id:"name",value:j.name,onChange:P=>C(Q=>({...Q,name:P.target.value})),placeholder:"Nome",className:"mt-1"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"surname",children:"Cognome *"}),s.jsx(bt,{id:"surname",value:j.surname,onChange:P=>C(Q=>({...Q,surname:P.target.value})),placeholder:"Cognome",className:"mt-1"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"role",children:"Ruolo *"}),s.jsxs("select",{id:"role",value:j.role,onChange:P=>C(Q=>({...Q,role:P.target.value})),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Seleziona ruolo"}),B.map(P=>s.jsx("option",{value:P,children:P},P))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"categories",children:"Categorie *"}),s.jsxs("div",{className:"space-y-2",children:[j.categories.map((P,Q)=>s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsxs("select",{value:P,onChange:G=>I(Q,G.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:Q===0,children:[s.jsx("option",{value:"",children:"Seleziona una categoria..."}),K.map(G=>s.jsx("option",{value:G,children:G},G))]}),j.categories.length>1&&s.jsx(le,{type:"button",onClick:()=>te(Q),variant:"outline",size:"sm",className:"h-10 w-10 p-0 text-red-600 hover:text-red-800",children:""})]},Q)),s.jsx(le,{type:"button",onClick:J,variant:"outline",size:"sm",className:"w-full",children:"+ Aggiungi Categoria"})]})]}),z(j.categories)&&s.jsxs("div",{className:"md:col-span-2",children:[s.jsx(Je,{htmlFor:"haccpExpiry",children:"Scadenza Attestato HACCP"}),s.jsx(bt,{id:"haccpExpiry",type:"date",value:j.haccpExpiry,onChange:P=>C(Q=>({...Q,haccpExpiry:P.target.value})),className:"mt-1"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[s.jsx(le,{variant:"outline",onClick:()=>{v(!1),Z()},children:"Annulla"}),s.jsx(le,{onClick:m?F:A,disabled:!j.name||!j.surname||!j.role||j.categories.every(P=>!P.trim()),children:m?"Aggiorna":"Aggiungi"})]})]}),s.jsx("div",{className:`p-4 rounded-lg ${l(n)?"bg-green-50 border border-green-200":W()?"bg-blue-50 border border-blue-200":"bg-yellow-50 border border-yellow-200"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${l(n)?"bg-green-500":W()?"bg-blue-500":"bg-yellow-500"} text-white text-sm font-bold`,children:d.length}),s.jsxs("div",{children:[l(n)&&s.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),s.jsxs("p",{className:`font-medium ${l(n)?"text-green-900":W()?"text-blue-900":"text-yellow-900"}`,children:["Membri registrati: ",d.length]}),s.jsx("p",{className:`text-sm ${l(n)?"text-green-800":W()?"text-blue-800":"text-yellow-800"}`,children:l(n)?" Step confermato! Puoi procedere al prossimo step.":W()?' Dati validi! Clicca "Conferma Dati Staff" per confermare.':" Devi registrare almeno un membro con tutti i campi obbligatori."})]})]})}),y.staff&&s.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("p",{className:"font-medium",children:" Errore generale:"}),s.jsxs("p",{children:[" ",y.staff]})]})})]})},uA=({formData:t,setFormData:e,currentStep:n,validateStep:r,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{var G,de;const[c,d]=q.useState([]),[f,p]=q.useState(!1),[v,m]=q.useState(null),{formRef:N,scrollToForm:_}=Zo(f,"conservation-step-form");q.useEffect(()=>{f&&_()},[f,_]);const[k,y]=q.useState({}),[b,j]=q.useState(!1),[C,B]=q.useState({name:"",location:"",targetTemp:"",selectedCategories:[],isAbbattitore:!1,isAmbiente:!1}),K=((G=t.departments)==null?void 0:G.list)||[];(de=t.staff)!=null&&de.staffMembers,De(" ConservationStep - formData:",t),De(" ConservationStep - departments:",K);const Z=K.length>0?K.filter(w=>w&&w.enabled).map(w=>w.name||w):["Cucina","Bancone","Sala","Magazzino"];De(" ConservationStep - availableDepartments:",Z),q.useEffect(()=>{var w;if((w=t.conservation)!=null&&w.points&&t.conservation.points.length>0){const O=t.conservation.points.map(R=>{if(R.targetTemp&&R.selectedCategories&&R.selectedCategories.length>0){const H=J(R.targetTemp,R.selectedCategories);return{...R,compliance:{compliant:(H==null?void 0:H.compliant)||!1,message:(H==null?void 0:H.message)||"Non validato",type:(H==null?void 0:H.type)||"error",color:(H==null?void 0:H.color)||"red"}}}return{...R,compliance:{compliant:!1,message:"Non validato",type:"error",color:"red"}}});d(O)}},[t.conservation]);const z=()=>{B({name:"",location:"",targetTemp:"",selectedCategories:[],isAbbattitore:!1,isAmbiente:!1}),m(null)},J=(w,O=[])=>{if(typeof w=="string"&&w.includes("Ambiente"))return O.includes("dry_goods")?{compliant:!0,message:" Temperatura ambiente valida per Dispensa Secca",type:"compliant",color:"green"}:{compliant:!1,message:' Per temperatura ambiente seleziona solo "Dispensa Secca"',type:"warning",color:"orange"};const R=parseFloat(w);if(isNaN(R))return{compliant:!1,message:"Temperatura non valida",type:"error"};if(O.length>0){const H=Jn.tolerance;let re=!1;for(let ze=0;ze<O.length;ze++){for(let Le=ze+1;Le<O.length;Le++){const Fe=Jn.categories.find(tt=>tt.id===O[ze]),Me=Jn.categories.find(tt=>tt.id===O[Le]);if(Fe&&Me){const tt=Fe.minTemp-H,Ce=Fe.maxTemp+H,ie=Me.minTemp-H,pt=Me.maxTemp+H;if(Ce<ie||pt<tt){re=!0;break}}}if(re)break}if(re)return{compliant:!1,message:" Categorie incompatibili selezionate",type:"error",color:"red"};let oe=!0,fe=!0,be=[];for(const ze of O){const Le=Jn.categories.find(Fe=>Fe.id===ze);if(Le){const Fe=R>=Le.minTemp&&R<=Le.maxTemp,Me=Le.minTemp-H,tt=Le.maxTemp+H,Ce=R>=Me&&R<=tt;Fe||(oe=!1,Ce||(fe=!1,be.push(Le.name)))}}return oe?{compliant:!0,message:" Valore temperatura valido per tutte le categorie",type:"compliant",color:"green"}:fe?{compliant:!0,message:"Temperatura impostata entro i limiti accettabili (0,5C di differenza) per tutte le categorie",type:"warning",color:"yellow"}:{compliant:!1,message:` Fuori range HACCP per: ${be.join(", ")}`,type:"error",color:"red"}}return R<-30||R>80?{compliant:!1,message:"Range temperatura fuori limiti operativi",type:"error",color:"red"}:{compliant:!0,message:" Valore temperatura valido",type:"compliant",color:"green"}},te=(w,O,R)=>{if(O.includes(w))return"selected";if(w==="abbattitore_menu"||w==="abbattitore_esposizione"||!R||typeof R=="string"&&R.trim()==="")return"neutral";let H,re=!1;if(typeof R=="string"&&R.includes("Ambiente")?(H=20,re=!0):H=parseFloat(R),isNaN(H))return"neutral";let oe=Jn.categories.find(Me=>Me.id===w);if(!oe)return"neutral";const fe=Jn.tolerance,be=oe.minTemp-fe,ze=oe.maxTemp+fe,Le=oe.minTemp,Fe=oe.maxTemp;if(re){const Me={min:15,max:25};return Le<=Me.max&&Fe>=Me.min?"compatible":"incompatible"}else if(H>=Le&&H<=Fe){if(O.length===0)return"compatible";for(const Me of O){const tt=Jn.categories.find(Ce=>Ce.id===Me);if(tt){const Ce=tt.minTemp-fe,ie=tt.maxTemp+fe;if(Ce<=ze&&ie>=be)return"compatible"}}return"incompatible"}else if(H>=be&&H<=ze){if(O.length===0)return"tolerance";for(const Me of O){const tt=Jn.categories.find(Ce=>Ce.id===Me);if(tt){const Ce=tt.minTemp-fe,ie=tt.maxTemp+fe;if(Ce<=ze&&ie>=be)return"tolerance"}}return"incompatible"}return"incompatible"},I=w=>{if(!w.selectedCategories||w.selectedCategories.length===0)return null;const O=parseFloat(w.targetTemp);if(isNaN(O))return null;const R=Jn.categories.find(ze=>ze.id===w.selectedCategories[0]);if(!R)return null;const H=Jn.tolerance,re=R.minTemp,oe=R.maxTemp,fe=re-H,be=oe+H;if(O>=re&&O<=oe)return null;if(O>=fe&&O<=be){const ze=(re+oe)/2;return O<ze?`Aumenta la temperatura verso ${ze.toFixed(1)}C per ottimizzare la conservazione`:`Diminuisci la temperatura verso ${ze.toFixed(1)}C per ottimizzare la conservazione`}return O<fe?`Aumenta la temperatura al range ottimale ${re}-${oe}C`:O>be?`Diminuisci la temperatura al range ottimale ${re}-${oe}C`:null},A=w=>{const O=Jn.categories.find(R=>R.id===w);return O?{min:O.minTemp,max:O.maxTemp}:null},T=w=>{if(!w||w.length===0)return{message:"Seleziona categorie per ottenere suggerimenti sulle temperature ottimali"};const O=[];if(w.forEach(re=>{const oe=A(re);if(oe){const fe=Jn.categories.find(be=>be.id===re);O.push({name:(fe==null?void 0:fe.name)||re,min:oe.min,max:oe.max})}}),O.length===0)return{message:"Nessuna informazione di temperatura disponibile per le categorie selezionate"};const R=Math.max(...O.map(re=>re.min)),H=Math.min(...O.map(re=>re.max));return R<=H?{compatible:!0,message:`Temperatura ottimale per le categorie selezionate: ${Math.round((R+H)/2*10)/10}C`}:{compatible:!1,message:" Conflitto di temperature: Le categorie selezionate hanno range incompatibili. Verifica i requisiti HACCP."}},F=()=>{if(C.name&&C.location&&(C.targetTemp||C.isAmbiente)&&C.selectedCategories.length>0){let w=C.selectedCategories||[];if(C.isAmbiente)w=["dry_goods"];else if(C.isAbbattitore){const re=["abbattitore_menu","abbattitore_esposizione"];w=[...w,...re]}let O=C.targetTemp;C.isAmbiente&&(O="Ambiente (15C - 27C)");const R=J(O,w),H={...C,targetTemp:O,selectedCategories:w,compliance:R};if(v){const re=c.map(oe=>oe.id===v?{...oe,...H}:oe);d(re),e(oe=>({...oe,conservation:{points:re,count:re.length}}))}else{const re={id:Date.now(),...H},oe=[...c,re];d(oe),e(fe=>({...fe,conservation:{points:oe,count:oe.length}}))}z(),p(!1),a(n)}},ne=w=>{const O=c.filter(R=>R.id!==w);De(" ConservationStep - Eliminando punto:",{pointId:w,pointsBefore:c.length,pointsAfter:O.length}),d(O),e(R=>({...R,conservation:{points:O,count:O.length}})),a(n),De(" ConservationStep - Validazione dopo eliminazione:",{remainingPoints:O.length,hasNonCompliant:O.some(R=>!ue(R)),canProceed:O.length>0&&O.every(R=>R.name&&R.location&&R.targetTemp&&R.selectedCategories&&R.selectedCategories.length>0)&&!O.some(R=>!ue(R))})},W=w=>{const O=c.find(R=>R.id===w);O&&(B({name:O.name,location:O.location,targetTemp:O.targetTemp,selectedCategories:O.selectedCategories||[],isAbbattitore:O.isAbbattitore||!1,isAmbiente:O.isAmbiente||!1}),m(w),p(!0))},ue=w=>!w.targetTemp||!w.selectedCategories||w.selectedCategories.length===0?!1:J(w.targetTemp,w.selectedCategories).compliant,P=c.some(w=>!ue(w)),Q=c.length>0&&c.every(w=>w.name&&w.location&&w.targetTemp&&w.selectedCategories&&w.selectedCategories.length>0)&&!P;return q.useEffect(()=>{De(" ConservationStep - Punti aggiornati, ricalcolo validazione:",{pointsCount:c.length,hasNonCompliant:P,canProceed:Q})},[c,P,Q]),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Punti di Conservazione"}),s.jsx("p",{className:"text-gray-600",children:"Configura frigoriferi e aree di stoccaggio"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Punti di Conservazione"}),s.jsxs(le,{onClick:()=>{De(" Pulsante Aggiungi cliccato");try{z(),p(!0),De(" Form resettato e showAddForm impostato a true")}catch(w){rs(" Errore nel pulsante Aggiungi:",w)}},variant:"outline",size:"sm",className:"flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap min-w-fit",children:[s.jsx(pr,{className:"h-4 w-4 flex-shrink-0"}),s.jsx("span",{className:"hidden sm:inline",children:"Aggiungi Nuovo Punto di Conservazione"}),s.jsx("span",{className:"sm:hidden",children:"Aggiungi Punto"})]})]}),f&&s.jsxs("div",{ref:N,id:"conservation-step-form",className:"border rounded-lg p-4 bg-white mb-6",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:v?"Modifica Punto di Conservazione":"Aggiungi Nuovo Punto di Conservazione"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"name",children:"Nome Punto di Conservazione *"}),s.jsx(bt,{id:"name",value:C.name,onChange:w=>{B(O=>({...O,name:w.target.value})),a(n)},placeholder:"Es. Frigo A, Freezer, Abbattitore",className:"mt-1"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"location",children:"Luogo *"}),s.jsxs("select",{id:"location",value:C.location,onChange:w=>{B(O=>({...O,location:w.target.value})),a(n)},className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Seleziona reparto"}),Z.map(w=>s.jsx("option",{value:w,children:w},w))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"targetTemp",children:"Temperatura Punto di Conservazione (C) *"}),s.jsx(bt,{id:"targetTemp",type:"number",min:"-30",max:"80",step:"0.1",value:C.targetTemp||"",onChange:w=>{const O=w.target.value;B(R=>({...R,targetTemp:O})),b&&j(!1),C.selectedCategories&&C.selectedCategories.length>0&&B(R=>({...R,targetTemp:O,selectedCategories:[]})),a(n)},placeholder:"4",className:`mt-1 transition-all duration-300 ${b?"border-red-500 bg-red-50 ring-2 ring-red-200 focus:border-red-500 focus:ring-red-500":C.targetTemp&&C.selectedCategories.length>0?(()=>{const w=J(C.targetTemp,C.selectedCategories);return w.color==="green"?"border-green-500 focus:border-green-500 focus:ring-green-500":w.color==="yellow"?"border-yellow-500 focus:border-yellow-500 focus:ring-yellow-500":w.color==="red"?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300"})():"border-gray-300"}`}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Inserisci la temperatura di conservazione (es. 4 per frigorifero, -18 per freezer)"}),s.jsxs("div",{className:"mt-4 flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"isAmbiente",checked:C.isAmbiente||!1,onChange:w=>{const O=w.target.checked;B(R=>({...R,isAmbiente:O,targetTemp:O?"":R.targetTemp,selectedCategories:O?["dry_goods"]:R.selectedCategories,isAbbattitore:O?!1:R.isAbbattitore})),a(n)},className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),s.jsx(Je,{htmlFor:"isAmbiente",className:"text-sm font-medium text-gray-700",children:"T Ambiente"})]}),(()=>{const w=parseFloat(C.targetTemp);return!isNaN(w)&&w>=-90&&w<=-1?s.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"isAbbattitore",checked:C.isAbbattitore,onChange:R=>B({...C,isAbbattitore:R.target.checked}),className:"h-5 w-5 text-red-600 focus:ring-red-500 border-gray-300 rounded"}),s.jsx(Je,{htmlFor:"isAbbattitore",className:"text-lg font-bold text-red-700",children:"Abbattitore"})]}):null})()]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx(Je,{children:"Categorie Prodotti *"}),s.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-3 gap-2",children:Jn.categories.filter(w=>C.isAmbiente?w.id==="dry_goods"||w.name==="Dispensa Secca":w.id==="abbattitore_menu"||w.id==="abbattitore_esposizione"?C.isAbbattitore===!0:!0).map(w=>{const O=C.selectedCategories.includes(w.id),R=te(w.id,C.selectedCategories,C.targetTemp),H=()=>{switch(R){case"selected":return"bg-blue-100 border-blue-400 text-blue-900 shadow-sm";case"compatible":return"bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300";case"tolerance":return"bg-yellow-200 border-yellow-400 text-yellow-900 shadow-sm";case"incompatible":return"bg-gray-100 border-gray-300 text-gray-400 cursor-not-allowed opacity-60";case"neutral":return"bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300";default:return"bg-white border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300"}};return s.jsx("div",{onClick:()=>{if(R==="incompatible")return;if(!C.targetTemp||C.targetTemp.trim()===""){j(!0);const oe=document.getElementById("targetTemp");oe&&(oe.focus(),oe.scrollIntoView({behavior:"smooth",block:"center"})),setTimeout(()=>j(!1),3e3);return}const re=O?C.selectedCategories.filter(oe=>oe!==w.id):[...C.selectedCategories,w.id];B(oe=>({...oe,selectedCategories:re})),a(n)},className:`p-2 rounded-lg border-2 transition-all duration-200 ${H()}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-medium text-xs truncate",children:w.name}),s.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:w.description})]}),s.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[O&&s.jsx(kn,{className:"h-3 w-3 text-blue-600 flex-shrink-0"}),R==="compatible"&&!O&&s.jsx("span",{className:"text-xs",children:""}),R==="incompatible"&&!O&&s.jsx("span",{className:"text-xs",children:""}),R==="tolerance"&&!O&&s.jsx("span",{className:"text-xs",children:""})]})]})},w.id)})}),C.targetTemp&&C.selectedCategories.length>0&&s.jsx("div",{className:"mt-3 p-3 rounded-lg bg-blue-50 border border-blue-200",children:s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Consigli:"})," ",(()=>{const w=T(C.selectedCategories);return w&&!w.compatible||w?w.message:"Temperatura compatibile con le categorie selezionate"})()]})}),C.selectedCategories.length===0&&s.jsx("p",{className:"text-xs text-red-500 mt-2",children:" Seleziona almeno una categoria per procedere"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[s.jsx(le,{variant:"outline",onClick:()=>{p(!1),m(null),B({name:"",location:"",targetTemp:"",selectedCategories:[],isAbbattitore:!1,isAmbiente:!1})},children:"Annulla"}),s.jsx(le,{onClick:F,disabled:!C.name||!C.location||!C.targetTemp&&!C.isAmbiente||C.selectedCategories.length===0,children:v?"Salva Modifiche":"Aggiungi Punto"})]})]}),c.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(ws,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"Nessun punto di conservazione configurato"}),s.jsx("p",{className:"text-sm",children:'Clicca "Aggiungi Nuovo Punto di Conservazione" per iniziare'})]}):s.jsx("div",{className:"space-y-3",children:c.map(w=>{var O,R,H,re,oe;return s.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[s.jsx("h5",{className:"font-medium",children:w.name||"Nome non disponibile"}),s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:w.location})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Temperatura:"}),s.jsxs("p",{className:"font-medium",children:[w.targetTemp,"C"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"HACCP:"}),s.jsxs("div",{className:`flex items-center gap-1 ${((O=w.compliance)==null?void 0:O.type)==="compliant"?"text-green-600":((R=w.compliance)==null?void 0:R.type)==="warning"?"text-yellow-600":"text-red-600"}`,children:[((H=w.compliance)==null?void 0:H.type)==="compliant"?"":((re=w.compliance)==null?void 0:re.type)==="warning"?"":"",s.jsx("span",{className:"text-xs",children:typeof w.compliance=="object"&&((oe=w.compliance)!=null&&oe.message)?w.compliance.message:"Non validato"})]})]})]}),w.selectedCategories&&w.selectedCategories.length>0&&s.jsxs("div",{className:"mt-2",children:[s.jsx("span",{className:"text-gray-600 text-sm",children:"Categorie:"}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:w.selectedCategories.map(fe=>{const be=Jn.categories.find(ze=>ze.id===fe);return be?s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:be.name||"Categoria non disponibile"},fe):null})})]}),(()=>{const fe=I(w);return fe?s.jsxs("div",{className:"mt-2",children:[s.jsx("span",{className:"text-gray-600 text-sm",children:"Suggerimenti:"}),s.jsx("div",{className:"mt-1 p-2 bg-blue-50 border border-blue-200 rounded text-sm text-blue-700",children:fe})]}):null})()]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{onClick:()=>W(w.id),variant:"outline",size:"sm",className:"text-blue-600 hover:text-blue-700",children:s.jsx(wi,{className:"h-4 w-4"})}),s.jsx(le,{onClick:()=>ne(w.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:s.jsx(un,{className:"h-4 w-4"})})]})]})},w.id)})})]}),s.jsx("div",{className:`p-4 rounded-lg ${Q?"bg-green-50 border border-green-200":P?"bg-red-50 border border-red-200":"bg-yellow-50 border border-yellow-200"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${Q?"bg-green-500":P?"bg-red-500":"bg-yellow-500"} text-white text-sm font-bold`,children:c.length}),s.jsxs("div",{children:[Q&&s.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),s.jsxs("p",{className:`font-medium ${Q?"text-green-900":P?"text-red-900":"text-yellow-900"}`,children:["Punti configurati: ",c.length]}),s.jsx("p",{className:`text-sm ${Q?"text-green-800":"text-red-800"}`,children:Q?" Tutti i punti di conservazione sono HACCP compliant! Puoi procedere al prossimo step.":P?" Non puoi procedere: alcuni punti di conservazione non rispettano i range di temperatura per TUTTE le categorie selezionate. Correggi le temperature o rimuovi le categorie incompatibili.":" Devi configurare almeno un punto di conservazione con tutti i campi obbligatori."})]})]})}),Object.keys(k).length>0&&s.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("p",{className:"font-medium",children:" Errori di validazione:"}),Object.entries(k).map(([w,O])=>s.jsxs("p",{children:[" ",O]},w))]})})]})},$t={TEMPERATURE_MONITORING:"temperature_monitoring",SANITIZATION:"sanitization",DEFROSTING:"defrosting"},xu={[$t.TEMPERATURE_MONITORING]:"Rilevamento Temperatura",[$t.SANITIZATION]:"Sanificazione",[$t.DEFROSTING]:"Sbrinamento"},Yh={[$t.TEMPERATURE_MONITORING]:[{value:"daily",label:"Giornalmente"},{value:"weekly",label:"Settimanale"},{value:"monthly",label:"Mensile"}],[$t.SANITIZATION]:[{value:"daily",label:"Giornalmente"},{value:"weekly",label:"Settimanale"}],[$t.DEFROSTING]:[{value:"semiannual",label:"Semestrale (ogni 6 mesi)"},{value:"annual",label:"Annuale"}]},dA=[{value:"monday",label:"Luned"},{value:"tuesday",label:"Marted"},{value:"wednesday",label:"Mercoled"},{value:"thursday",label:"Gioved"},{value:"friday",label:"Venerd"},{value:"saturday",label:"Sabato"},{value:"sunday",label:"Domenica"}],hA={[$t.TEMPERATURE_MONITORING]:{requiredFields:["frequency"],optionalFields:["assigned_role","assigned_category","assigned_staff_ids","selected_days"],frequencyOptions:[...Yh[$t.TEMPERATURE_MONITORING].map(t=>t.value),"custom_days"]},[$t.SANITIZATION]:{requiredFields:["frequency"],optionalFields:["assigned_role","assigned_category","assigned_staff_ids","selected_days"],frequencyOptions:[...Yh[$t.SANITIZATION].map(t=>t.value),"custom_days"]},[$t.DEFROSTING]:{requiredFields:["frequency"],optionalFields:["assigned_role","assigned_category","assigned_staff_ids","selected_days"],frequencyOptions:Yh[$t.DEFROSTING].map(t=>t.value)}},fA=(t,e)=>{const n=hA[t],r=[];n.requiredFields.forEach(o=>{(!e[o]||Array.isArray(e[o])&&e[o].length===0)&&r.push(`${o}  obbligatorio per ${xu[t]}`)}),e.frequency&&!n.frequencyOptions.includes(e.frequency)&&r.push(`Frequenza non valida per ${xu[t]}`),e.frequency==="custom_days"&&(!e.selected_days||e.selected_days.length===0)&&r.push(`Devi selezionare almeno un giorno per ${xu[t]}`);const i=!!e.assigned_role,a=e.assigned_staff_ids&&e.assigned_staff_ids.length>0;return!i&&!a&&r.push(`Devi selezionare almeno Ruolo o Dipendenti Specifici per ${xu[t]}`),{isValid:r.length===0,errors:r}},mA=t=>Yh[t]||[],Kx=t=>xu[t]||t,pA=t=>!t||t.length===0?[]:[...new Set(t.map(n=>n.role).filter(Boolean))].map(n=>({value:n.toLowerCase().replace(/\s+/g,"_"),label:n})),gA=(t,e=null)=>{if(!t||t.length===0)return[];let n=t;if(e){const i=e.toLowerCase().replace(/\s+/g,"_");n=t.filter(a=>{var l;return((l=a.role)==null?void 0:l.toLowerCase().replace(/\s+/g,"_"))===i})}return[...new Set(n.flatMap(i=>i.categories||[]).filter(Boolean))].map(i=>({value:i.toLowerCase().replace(/\s+/g,"_"),label:i}))},vA=(t,e=null,n=null)=>{if(!t||t.length===0)return[];let r=t;if(e){const i=e.toLowerCase().replace(/\s+/g,"_");r=r.filter(a=>{var l;return((l=a.role)==null?void 0:l.toLowerCase().replace(/\s+/g,"_"))===i})}if(n){const i=n.toLowerCase().replace(/\s+/g,"_");r=r.filter(a=>a.categories&&a.categories.some(o=>(o==null?void 0:o.toLowerCase().replace(/\s+/g,"_"))===i))}return r},Tb=Zs.forwardRef(({conservationPoint:t,staffMembers:e=[],onSave:n,onCancel:r,isOpen:i=!1,existingData:a=null},o)=>{const[l,c]=q.useState({[$t.TEMPERATURE_MONITORING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[$t.SANITIZATION]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[$t.DEFROSTING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]}}),[d,f]=q.useState({[$t.TEMPERATURE_MONITORING]:!1,[$t.SANITIZATION]:!1,[$t.DEFROSTING]:!1}),[p,v]=q.useState({}),[m,N]=q.useState(!1);De(" MaintenanceForm - Available data:",{staffMembers:e.length}),q.useEffect(()=>{var z,J;i&&(De(" MaintenanceForm opened with data:",{conservationPoint:t,staffMembers:e.length,staffMembersData:e,existingData:a}),a?(De(" Caricamento dati esistenti per modifica"),c(a),f({[$t.TEMPERATURE_MONITORING]:((z=a[$t.TEMPERATURE_MONITORING])==null?void 0:z.frequency)==="custom_days",[$t.SANITIZATION]:((J=a[$t.SANITIZATION])==null?void 0:J.frequency)==="custom_days",[$t.DEFROSTING]:!1})):(De(" Reset per nuovo punto di conservazione"),c({[$t.TEMPERATURE_MONITORING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[$t.SANITIZATION]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[$t.DEFROSTING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]}}),f({[$t.TEMPERATURE_MONITORING]:!1,[$t.SANITIZATION]:!1,[$t.DEFROSTING]:!1})),v({}))},[i,t,e,a]);const _=(z,J,te)=>{c(I=>{const T={...I[z],[J]:te};return J==="frequency"?T.selected_days=[]:J==="assigned_role"?(T.assigned_category="",T.assigned_staff_ids=[]):J==="assigned_category"&&(T.assigned_staff_ids=[]),{...I,[z]:T}})},k=(z,J)=>{c(te=>{const I=te[z].assigned_staff_ids||[],A=I.includes(J)?I.filter(T=>T!==J):[...I,J];return{...te,[z]:{...te[z],assigned_staff_ids:A}}})},y=z=>{f(J=>({...J,[z]:!J[z]})),c(J=>({...J,[z]:{...J[z],frequency:"",selected_days:[]}}))},b=(z,J)=>{c(te=>{const I=te[z].selected_days||[],T=I.includes(J)?I.filter(F=>F!==J):[...I,J];return{...te,[z]:{...te[z],selected_days:T,frequency:T.length>0?"custom_days":""}}})},j=z=>{const J=l[z],te=J.assigned_role,I=J.assigned_category;return!te&&!I?e:vA(e,te,I)},C=()=>{const z={};return Object.values($t).forEach(J=>{const te=l[J],I=fA(J,te);I.isValid||(z[J]=I.errors)}),v(z),Object.keys(z).length===0},B=async()=>{if(C()){N(!0);try{const z=Object.values($t).map(J=>{const te=l[J];return{id:`${t.id}_${J}_${Date.now()}`,conservation_point_id:t.id,conservation_point_name:t.name,task_type:J,task_name:Kx(J),frequency:te.frequency,selected_days:te.selected_days||[],assigned_role:te.assigned_role,assigned_category:te.assigned_category,assigned_staff_ids:te.assigned_staff_ids||[],is_active:!0,created_at:new Date().toISOString()}});await n(z)}catch(z){rs("Errore durante il salvataggio:",z)}finally{N(!1)}}},K=z=>{switch(z){case $t.TEMPERATURE_MONITORING:return s.jsx(ws,{className:"w-5 h-5 text-blue-500"});case $t.SANITIZATION:return s.jsx(C4,{className:"w-5 h-5 text-green-500"});case $t.DEFROSTING:return s.jsx(V4,{className:"w-5 h-5 text-cyan-500"});default:return s.jsx(pn,{className:"w-5 h-5 text-gray-500"})}},Z=z=>{const J=l[z],te=p[z]||[],I=mA(z),A=pA(e),T=gA(e,J.assigned_role),F=j(z);return s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[K(z),s.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:Kx(z)}),te.length===0&&J.frequency&&J.assigned_role&&J.assigned_category&&s.jsx(kn,{className:"w-5 h-5 text-green-500"})]}),te.length>0&&s.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(pn,{className:"w-4 h-4 text-red-500"}),s.jsx("span",{className:"text-sm text-red-700 font-medium",children:"Configurazione incompleta"})]}),s.jsx("ul",{className:"mt-2 text-sm text-red-600",children:te.map((ne,W)=>s.jsxs("li",{children:[" ",ne]},W))})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(Je,{htmlFor:`${z}-frequency`,className:"text-sm font-medium text-gray-700",children:"Frequenza *"}),(z===$t.SANITIZATION||z===$t.TEMPERATURE_MONITORING)&&s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[s.jsx("input",{type:"checkbox",id:`${z}-custom-days`,checked:d[z],onChange:()=>y(z),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("label",{htmlFor:`${z}-custom-days`,className:"cursor-pointer",children:"Seleziona giorni della settimana"})]})]}),d[z]?s.jsxs("div",{className:"mt-1 border border-gray-300 rounded-md p-3 bg-gray-50",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Seleziona i giorni:"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:dA.map(ne=>{var W;return s.jsxs("label",{className:"flex items-center space-x-2 text-base",children:[s.jsx("input",{type:"checkbox",checked:((W=J.selected_days)==null?void 0:W.includes(ne.value))||!1,onChange:()=>b(z,ne.value),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-gray-700 font-medium",children:ne.label})]},ne.value)})}),J.selected_days&&J.selected_days.length>0&&s.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:["Giorni selezionati: ",J.selected_days.length]})]}):s.jsxs("select",{id:`${z}-frequency`,value:J.frequency,onChange:ne=>_(z,"frequency",ne.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Seleziona frequenza"}),I.map(ne=>s.jsx("option",{value:ne.value,children:ne.label},ne.value))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:`${z}-role`,className:"text-sm font-medium text-gray-700",children:"Ruolo *"}),s.jsxs("select",{id:`${z}-role`,value:J.assigned_role,onChange:ne=>_(z,"assigned_role",ne.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Seleziona ruolo"}),A.map(ne=>s.jsx("option",{value:ne.value,children:ne.label},ne.value))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:`${z}-category`,className:"text-sm font-medium text-gray-700",children:"Categoria (Opzionale)"}),s.jsxs("select",{id:`${z}-category`,value:J.assigned_category,onChange:ne=>_(z,"assigned_category",ne.target.value),disabled:!J.assigned_role,className:`mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${J.assigned_role?"":"bg-gray-100 cursor-not-allowed"}`,children:[s.jsx("option",{value:"",children:J.assigned_role?"Seleziona categoria":"Prima seleziona ruolo"}),T.map(ne=>s.jsx("option",{value:ne.value,children:ne.label},ne.value))]})]}),s.jsxs("div",{children:[s.jsx(Je,{className:"text-sm font-medium text-gray-700",children:"Dipendenti Specifici *"}),F.length>0?s.jsx("div",{className:"mt-2 max-h-32 overflow-y-auto border border-gray-200 rounded-md p-2 bg-white",children:F.map(ne=>{var W;return s.jsxs("label",{className:"flex items-center gap-2 p-1 hover:bg-gray-50 rounded",children:[s.jsx("input",{type:"checkbox",checked:((W=J.assigned_staff_ids)==null?void 0:W.includes(ne.id))||!1,onChange:()=>k(z,ne.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsxs("span",{className:"text-sm text-gray-700",children:[ne.name," ",ne.surname]})]},ne.id)})}):s.jsx("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md",children:s.jsx("p",{className:"text-sm text-gray-500",children:J.assigned_role&&J.assigned_category?"Nessun dipendente trovato per la combinazione ruolo/categoria selezionata":"Seleziona ruolo e categoria per filtrare i dipendenti, oppure seleziona direttamente i dipendenti"})})]})]})]},z)};return i?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{ref:o,id:"tasks-maintenance-form",className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Configura Manutenzione"}),s.jsxs("p",{className:"text-2xl text-gray-700",children:["Punto di Conservazione: ",s.jsx("span",{className:"font-bold text-blue-600",children:t==null?void 0:t.name})]})]}),s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx(le,{onClick:r,variant:"outline",size:"sm",className:"p-2",children:s.jsx(un,{className:"w-4 h-4"})})}),s.jsxs("div",{className:"space-y-6",children:[Z($t.TEMPERATURE_MONITORING),Z($t.SANITIZATION),Z($t.DEFROSTING),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(pn,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:"Manutenzione Obbligatoria"})]}),s.jsxs("p",{className:"text-sm text-blue-700",children:["Configura le tre attivit di manutenzione obbligatorie per questo punto di conservazione. Ogni attivit deve avere ",s.jsx("strong",{children:"frequenza"})," e ",s.jsx("strong",{children:"almeno uno tra Ruolo o Dipendenti Specifici"})," assegnati.",s.jsx("br",{}),s.jsx("span",{className:"text-xs text-blue-600 mt-1 block",children:" Per Sanificazione e Rilevamento Temperatura puoi selezionare giorni specifici della settimana."})]})]})]}),s.jsxs("div",{className:"flex gap-4 pt-6 border-t border-gray-200 mt-6",children:[s.jsx(le,{onClick:B,disabled:m,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3",children:m?"Salvataggio...":"Salva Manutenzione"}),s.jsx(le,{onClick:r,variant:"outline",className:"flex-1 py-3",disabled:m,children:"Annulla"})]})]})}):null});Tb.displayName="MaintenanceForm";const xA=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>io(()=>Promise.resolve().then(()=>jc),void 0,import.meta.url).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class l1 extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class yA extends l1{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Yx extends l1{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Qx extends l1{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var $g;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})($g||($g={}));var bA=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(r.next(f))}catch(p){o(p)}}function c(f){try{d(r.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};class wA{constructor(e,{headers:n={},customFetch:r,region:i=$g.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=xA(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return bA(this,void 0,void 0,function*(){try{const{headers:i,method:a,body:o}=n;let l={},{region:c}=n;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let f;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",f=o):typeof o=="string"?(l["Content-Type"]="text/plain",f=o):typeof FormData<"u"&&o instanceof FormData?f=o:(l["Content-Type"]="application/json",f=JSON.stringify(o)));const p=yield this.fetch(d.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:f}).catch(_=>{throw new yA(_)}),v=p.headers.get("x-relay-error");if(v&&v==="true")throw new Yx(p);if(!p.ok)throw new Qx(p);let m=((r=p.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),N;return m==="application/json"?N=yield p.json():m==="application/octet-stream"?N=yield p.blob():m==="text/event-stream"?N=p:m==="multipart/form-data"?N=yield p.formData():N=yield p.text(),{data:N,error:null,response:p}}catch(i){return{data:null,error:i,response:i instanceof Qx||i instanceof Yx?i.context:void 0}}})}}var gs={},c1={},sm={},xd={},im={},am={},NA=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},vc=NA();const jA=vc.fetch,zb=vc.fetch.bind(vc),Ob=vc.Headers,SA=vc.Request,_A=vc.Response,jc=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ob,Request:SA,Response:_A,default:zb,fetch:jA},Symbol.toStringTag,{value:"Module"})),kA=Vw(jc);var om={};Object.defineProperty(om,"__esModule",{value:!0});let CA=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};om.default=CA;var Db=Xs&&Xs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(am,"__esModule",{value:!0});const AA=Db(kA),PA=Db(om);let IA=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=AA.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,c,d;let f=null,p=null,v=null,m=a.status,N=a.statusText;if(a.ok){if(this.method!=="HEAD"){const b=await a.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?p=b:p=JSON.parse(b))}const k=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),y=(c=a.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");k&&y&&y.length>1&&(v=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(f={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,v=null,m=406,N="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const k=await a.text();try{f=JSON.parse(k),Array.isArray(f)&&a.status===404&&(p=[],f=null,m=200,N="OK")}catch{a.status===404&&k===""?(m=204,N="No Content"):f={message:k}}if(f&&this.isMaybeSingle&&(!((d=f==null?void 0:f.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,m=200,N="OK"),f&&this.shouldThrowOnError)throw new PA.default(f)}return{error:f,data:p,count:v,status:m,statusText:N}});return this.shouldThrowOnError||(i=i.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};am.default=IA;var EA=Xs&&Xs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(im,"__esModule",{value:!0});const LA=EA(am);let TA=class extends LA.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const a=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:a=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};im.default=TA;var zA=Xs&&Xs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xd,"__esModule",{value:!0});const OA=zA(im);let DA=class extends OA.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};xd.default=DA;var MA=Xs&&Xs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(sm,"__esModule",{value:!0});const uu=MA(xd);let RA=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=i}select(e,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new uu.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var i;const a="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new uu.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:a=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),i&&this.headers.append("Prefer",`count=${i}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(c.length>0){const d=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new uu.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:n}={}){var r;const i="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new uu.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new uu.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};sm.default=RA;var Mb=Xs&&Xs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(c1,"__esModule",{value:!0});const FA=Mb(sm),$A=Mb(xd);let BA=class Rb{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new FA.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Rb(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:a}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let d;r||i?(l=r?"HEAD":"GET",Object.entries(n).filter(([p,v])=>v!==void 0).map(([p,v])=>[p,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([p,v])=>{c.searchParams.append(p,v)})):(l="POST",d=n);const f=new Headers(this.headers);return a&&f.set("Prefer",`count=${a}`),new $A.default({method:l,url:c,headers:f,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};c1.default=BA;var Sc=Xs&&Xs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(gs,"__esModule",{value:!0});gs.PostgrestError=gs.PostgrestBuilder=gs.PostgrestTransformBuilder=gs.PostgrestFilterBuilder=gs.PostgrestQueryBuilder=gs.PostgrestClient=void 0;const Fb=Sc(c1);gs.PostgrestClient=Fb.default;const $b=Sc(sm);gs.PostgrestQueryBuilder=$b.default;const Bb=Sc(xd);gs.PostgrestFilterBuilder=Bb.default;const qb=Sc(im);gs.PostgrestTransformBuilder=qb.default;const Ub=Sc(am);gs.PostgrestBuilder=Ub.default;const Vb=Sc(om);gs.PostgrestError=Vb.default;var qA=gs.default={PostgrestClient:Fb.default,PostgrestQueryBuilder:$b.default,PostgrestFilterBuilder:Bb.default,PostgrestTransformBuilder:qb.default,PostgrestBuilder:Ub.default,PostgrestError:Vb.default};const{PostgrestClient:UA,PostgrestQueryBuilder:sI,PostgrestFilterBuilder:iI,PostgrestTransformBuilder:aI,PostgrestBuilder:oI,PostgrestError:lI}=qA;class VA{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const n=parseInt(process.versions.node.split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const HA="2.15.4",GA=`realtime-js/${HA}`,WA="1.0.0",Bg=1e4,ZA=1e3,JA=100;var Lu;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Lu||(Lu={}));var hr;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(hr||(hr={}));var vi;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(vi||(vi={}));var qg;(function(t){t.websocket="websocket"})(qg||(qg={}));var Oo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Oo||(Oo={}));class KA{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),a=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+i));o=o+i;const c=r.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Hb{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Nn;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Nn||(Nn={}));const Xx=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((a,o)=>(a[o]=YA(o,t,e,i),a),{})},YA=(t,e,n,r)=>{const i=e.find(l=>l.name===t),a=i==null?void 0:i.type,o=n[t];return a&&!r.includes(a)?Gb(a,o):Ug(o)},Gb=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return t8(e,n)}switch(t){case Nn.bool:return QA(e);case Nn.float4:case Nn.float8:case Nn.int2:case Nn.int4:case Nn.int8:case Nn.numeric:case Nn.oid:return XA(e);case Nn.json:case Nn.jsonb:return e8(e);case Nn.timestamp:return n8(e);case Nn.abstime:case Nn.date:case Nn.daterange:case Nn.int4range:case Nn.int8range:case Nn.money:case Nn.reltime:case Nn.text:case Nn.time:case Nn.timestamptz:case Nn.timetz:case Nn.tsrange:case Nn.tstzrange:return Ug(e);default:return Ug(e)}},Ug=t=>t,QA=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},XA=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},e8=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},t8=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let a;const o=t.slice(1,n);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Gb(e,l))}return t},n8=t=>typeof t=="string"?t.replace(" ","T"):t,Wb=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class wp{constructor(e,n,r={},i=Bg){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var e2;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(e2||(e2={}));class Tu{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Tu.syncState(this.state,i,a,o),this.pendingDiffs.forEach(c=>{this.state=Tu.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Tu.syncDiff(this.state,i,a,o),l())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const a=this.cloneDeep(e),o=this.transformState(n),l={},c={};return this.map(a,(d,f)=>{o[d]||(c[d]=f)}),this.map(o,(d,f)=>{const p=a[d];if(p){const v=f.map(k=>k.presence_ref),m=p.map(k=>k.presence_ref),N=f.filter(k=>m.indexOf(k.presence_ref)<0),_=p.filter(k=>v.indexOf(k.presence_ref)<0);N.length>0&&(l[d]=N),_.length>0&&(c[d]=_)}else l[d]=f}),this.syncDiff(a,{joins:l,leaves:c},r,i)}static syncDiff(e,n,r,i){const{joins:a,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(a,(l,c)=>{var d;const f=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),f.length>0){const p=e[l].map(m=>m.presence_ref),v=f.filter(m=>p.indexOf(m.presence_ref)<0);e[l].unshift(...v)}r(l,f,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const f=c.map(p=>p.presence_ref);d=d.filter(p=>f.indexOf(p.presence_ref)<0),e[l]=d,i(l,d,c),d.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var t2;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(t2||(t2={}));var zu;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(zu||(zu={}));var ia;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ia||(ia={}));class u1{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=hr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new wp(this,vi.join,this.params,this.timeout),this.rejoinTimer=new Hb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=hr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=hr.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=hr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(vi.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new Tu(this),this.broadcastEndpointURL=Wb(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==hr.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(m=>m.filter))!==null&&i!==void 0?i:[],f=!!this.bindings[zu.PRESENCE]&&this.bindings[zu.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,p={},v={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:f}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(ia.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(ia.CLOSED)),this.updateJoinPayload(Object.assign({config:v},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:m})=>{var N;if(this.socket.setAuth(),m===void 0){e==null||e(ia.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,k=(N=_==null?void 0:_.length)!==null&&N!==void 0?N:0,y=[];for(let b=0;b<k;b++){const j=_[b],{filter:{event:C,schema:B,table:K,filter:Z}}=j,z=m&&m[b];if(z&&z.event===C&&z.schema===B&&z.table===K&&z.filter===Z)y.push(Object.assign(Object.assign({},j),{id:z.id}));else{this.unsubscribe(),this.state=hr.errored,e==null||e(ia.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(ia.SUBSCRIBED);return}}).receive("error",m=>{this.state=hr.errored,e==null||e(ia.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ia.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===hr.joined&&e===zu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=hr.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(vi.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new wp(this,vi.leave,{},e),r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=hr.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const i=new AbortController,a=setTimeout(()=>i.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(a),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new wp(this,e,n,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>JA){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:f}=vi;if(r&&[l,c,d,f].indexOf(o)>=0&&r!==this._joinRef())return;let v=this._onMessage(o,n,r);if(n&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var N,_,k;return((N=m.filter)===null||N===void 0?void 0:N.event)==="*"||((k=(_=m.filter)===null||_===void 0?void 0:_.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===o}).map(m=>m.callback(v,r)):(a=this.bindings[o])===null||a===void 0||a.filter(m=>{var N,_,k,y,b,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const C=m.id,B=(N=m.filter)===null||N===void 0?void 0:N.event;return C&&((_=n.ids)===null||_===void 0?void 0:_.includes(C))&&(B==="*"||(B==null?void 0:B.toLocaleLowerCase())===((k=n.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const C=(b=(y=m==null?void 0:m.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return C==="*"||C===((j=n==null?void 0:n.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof v=="object"&&"ids"in v){const N=v.data,{schema:_,table:k,commit_timestamp:y,type:b,errors:j}=N;v=Object.assign(Object.assign({},{schema:_,table:k,commit_timestamp:y,eventType:b,new:{},old:{},errors:j}),this._getPayloadRecords(N))}m.callback(v,r)})}_isClosed(){return this.state===hr.closed}_isJoined(){return this.state===hr.joined}_isJoining(){return this.state===hr.joining}_isLeaving(){return this.state===hr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),a={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&u1.isEqual(i.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(vi.close,{},e)}_onError(e){this._on(vi.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=hr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Xx(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Xx(e.columns,e.old_record)),n}}const Np=()=>{},Ph={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},r8=[1e3,2e3,5e3,1e4],s8=1e4,i8=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class a8{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bg,this.transport=null,this.heartbeatIntervalMs=Ph.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Np,this.ref=0,this.reconnectTimer=null,this.logger=Np,this.conn=null,this.sendBuffer=[],this.serializer=new KA,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>io(()=>Promise.resolve().then(()=>jc),void 0,import.meta.url).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${qg.websocket}`,this.httpEndpoint=Wb(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=VA.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:WA}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Lu.connecting:return Oo.Connecting;case Lu.open:return Oo.Open;case Lu.closing:return Oo.Closing;default:return Oo.Closed}}isConnected(){return this.connectionState()===Oo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,i=this.getChannels().find(a=>a.topic===r);if(i)return i;{const a=new u1(`realtime:${e}`,n,this);return this.channels.push(a),a}}push(e){const{topic:n,event:r,payload:i,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(ZA,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Ph.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:i,payload:a,ref:o}=n,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${r} ${i} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(i,a,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(vi.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([i8],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:GA};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(vi.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Hb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ph.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,i,a,o,l,c,d,f;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Bg,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:Ph.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Np,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:p=>r8[p-1]||s8,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(p,v)=>v(JSON.stringify(p)),this.decode=(f=e==null?void 0:e.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class d1 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function fr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class o8 extends d1{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Vg extends d1{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var l8=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(r.next(f))}catch(p){o(p)}}function c(f){try{d(r.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};const Zb=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>io(()=>Promise.resolve().then(()=>jc),void 0,import.meta.url).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},c8=()=>l8(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield io(()=>Promise.resolve().then(()=>jc),void 0,import.meta.url)).Response:Response}),Hg=t=>{if(Array.isArray(t))return t.map(n=>Hg(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[i]=Hg(r)}),e},u8=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var el=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(r.next(f))}catch(p){o(p)}}function c(f){try{d(r.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};const jp=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),d8=(t,e,n)=>el(void 0,void 0,void 0,function*(){const r=yield c8();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{const a=t.status||500,o=(i==null?void 0:i.statusCode)||a+"";e(new o8(jp(i),a,o))}).catch(i=>{e(new Vg(jp(i),i))}):e(new Vg(jp(t),t))}),h8=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?i:(u8(r)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(r)):i.body=r,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),n))};function yd(t,e,n,r,i,a){return el(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,h8(e,r,i,a)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>d8(c,l,r))})})}function Ef(t,e,n,r){return el(this,void 0,void 0,function*(){return yd(t,"GET",e,n,r)})}function Fi(t,e,n,r,i){return el(this,void 0,void 0,function*(){return yd(t,"POST",e,r,i,n)})}function Gg(t,e,n,r,i){return el(this,void 0,void 0,function*(){return yd(t,"PUT",e,r,i,n)})}function f8(t,e,n,r){return el(this,void 0,void 0,function*(){return yd(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function Jb(t,e,n,r,i){return el(this,void 0,void 0,function*(){return yd(t,"DELETE",e,r,i,n)})}var ts=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(r.next(f))}catch(p){o(p)}}function c(f){try{d(r.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};const m8={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},n2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class p8{constructor(e,n={},r,i){this.url=e,this.headers=n,this.bucketId=r,this.fetch=Zb(i)}uploadOrUpdate(e,n,r,i){return ts(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},n2),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(n),f=this._getFinalPath(d),p=yield(e=="PUT"?Gg:Fi)(this.fetch,`${this.url}/object/${f}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(a){if(fr(a))return{data:null,error:a};throw a}})}upload(e,n,r){return ts(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return ts(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let c;const d=Object.assign({upsert:n2.upsert},i),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType);const p=yield Gg(this.fetch,l.toString(),c,{headers:f});return{data:{path:a,fullPath:p.Key},error:null}}catch(c){if(fr(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,n){return ts(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const a=yield Fi(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new d1("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}update(e,n,r){return ts(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return ts(this,void 0,void 0,function*(){try{return{data:yield Fi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(fr(i))return{data:null,error:i};throw i}})}copy(e,n,r){return ts(this,void 0,void 0,function*(){try{return{data:{path:(yield Fi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(fr(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return ts(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),a=yield Fi(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(fr(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return ts(this,void 0,void 0,function*(){try{const i=yield Fi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(fr(i))return{data:null,error:i};throw i}})}download(e,n){return ts(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Ef(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(fr(l))return{data:null,error:l};throw l}})}info(e){return ts(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Ef(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Hg(r),error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}exists(e){return ts(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield f8(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(fr(r)&&r instanceof Vg){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],a=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";a!==""&&i.push(a);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return ts(this,void 0,void 0,function*(){try{return{data:yield Jb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(fr(n))return{data:null,error:n};throw n}})}list(e,n,r){return ts(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},m8),n),{prefix:e||""});return{data:yield Fi(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(fr(i))return{data:null,error:i};throw i}})}listV2(e,n){return ts(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Fi(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const g8="2.11.0",v8={"X-Client-Info":`storage-js/${g8}`};var Cl=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(r.next(f))}catch(p){o(p)}}function c(f){try{d(r.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};class x8{constructor(e,n={},r,i){const a=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},v8),n),this.fetch=Zb(r)}listBuckets(){return Cl(this,void 0,void 0,function*(){try{return{data:yield Ef(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(fr(e))return{data:null,error:e};throw e}})}getBucket(e){return Cl(this,void 0,void 0,function*(){try{return{data:yield Ef(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(fr(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Cl(this,void 0,void 0,function*(){try{return{data:yield Fi(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Cl(this,void 0,void 0,function*(){try{return{data:yield Gg(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Cl(this,void 0,void 0,function*(){try{return{data:yield Fi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(fr(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Cl(this,void 0,void 0,function*(){try{return{data:yield Jb(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(fr(n))return{data:null,error:n};throw n}})}}class y8 extends x8{constructor(e,n={},r,i){super(e,n,r,i)}from(e){return new p8(this.url,this.headers,e,this.fetch)}}const b8="2.57.0";let yu="";typeof Deno<"u"?yu="deno":typeof document<"u"?yu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?yu="react-native":yu="node";const w8={"X-Client-Info":`supabase-js-${yu}/${b8}`},N8={headers:w8},j8={schema:"public"},S8={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_8={};var k8=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(r.next(f))}catch(p){o(p)}}function c(f){try{d(r.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};const C8=t=>{let e;return t?e=t:typeof fetch>"u"?e=zb:e=fetch,(...n)=>e(...n)},A8=()=>typeof Headers>"u"?Ob:Headers,P8=(t,e,n)=>{const r=C8(n),i=A8();return(a,o)=>k8(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let d=new i(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(a,Object.assign(Object.assign({},o),{headers:d}))})};var I8=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(r.next(f))}catch(p){o(p)}}function c(f){try{d(r.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};function E8(t){return t.endsWith("/")?t:t+"/"}function L8(t,e){var n,r;const{db:i,auth:a,realtime:o,global:l}=t,{db:c,auth:d,realtime:f,global:p}=e,v={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},f),o),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(n=p==null?void 0:p.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>I8(this,void 0,void 0,function*(){return""})};return t.accessToken?v.accessToken=t.accessToken:delete v.accessToken,v}const Kb="2.71.1",Dl=30*1e3,Wg=3,Sp=Wg*Dl,T8="http://localhost:9999",z8="supabase.auth.token",O8={"X-Client-Info":`gotrue-js/${Kb}`},Zg="X-Supabase-Api-Version",Yb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},D8=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,M8=10*60*1e3;class h1 extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Ft(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class R8 extends h1{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function F8(t){return Ft(t)&&t.name==="AuthApiError"}class Qb extends h1{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class mo extends h1{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class Ra extends mo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function $8(t){return Ft(t)&&t.name==="AuthSessionMissingError"}class Ih extends mo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Eh extends mo{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Lh extends mo{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function B8(t){return Ft(t)&&t.name==="AuthImplicitGrantRedirectError"}class r2 extends mo{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Jg extends mo{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function _p(t){return Ft(t)&&t.name==="AuthRetryableFetchError"}class s2 extends mo{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Kg extends mo{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Lf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),i2=` 	
\r=`.split(""),q8=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<i2.length;e+=1)t[i2[e].charCodeAt(0)]=-2;for(let e=0;e<Lf.length;e+=1)t[Lf[e].charCodeAt(0)]=e;return t})();function a2(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Lf[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Lf[r]),e.queuedBits-=6}}function Xb(t,e,n){const r=q8[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function o2(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{H8(o,r,n)};for(let o=0;o<t.length;o+=1)Xb(t.charCodeAt(o),i,a);return e.join("")}function U8(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function V8(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}U8(r,e)}}function H8(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function G8(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)Xb(t.charCodeAt(i),n,r);return new Uint8Array(e)}function W8(t){const e=[];return V8(t,n=>e.push(n)),new Uint8Array(e)}function Z8(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};return t.forEach(i=>a2(i,n,r)),a2(null,n,r),e.join("")}function J8(t){return Math.round(Date.now()/1e3)+t}function K8(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const fi=()=>typeof window<"u"&&typeof document<"u",Ao={tested:!1,writable:!1},ew=()=>{if(!fi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ao.tested)return Ao.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ao.tested=!0,Ao.writable=!0}catch{Ao.tested=!0,Ao.writable=!1}return Ao.writable};function Y8(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,a)=>{e[a]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const tw=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>io(()=>Promise.resolve().then(()=>jc),void 0,import.meta.url).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Q8=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ml=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Po=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Da=async(t,e)=>{await t.removeItem(e)};class lm{constructor(){this.promise=new lm.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}lm.promiseConstructor=Promise;function kp(t){const e=t.split(".");if(e.length!==3)throw new Kg("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!D8.test(e[r]))throw new Kg("JWT not in base64url format");return{header:JSON.parse(o2(e[0])),payload:JSON.parse(o2(e[1])),signature:G8(e[2]),raw:{header:e[0],payload:e[1]}}}async function X8(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function eP(t,e){return new Promise((r,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await t(a);if(!e(a,null,o)){r(o);return}}catch(o){if(!e(a,o)){i(o);return}}})()})}function tP(t){return("0"+t.toString(16)).substr(-2)}function nP(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let a=0;a<56;a++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,tP).join("")}async function rP(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function sP(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await rP(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Al(t,e,n=!1){const r=nP();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await Ml(t,`${e}-code-verifier`,i);const a=await sP(r);return[a,r===a?"plain":"s256"]}const iP=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function aP(t){const e=t.headers.get(Zg);if(!e||!e.match(iP))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function oP(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function lP(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const cP=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Pl(t){if(!cP.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Cp(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function l2(t){return JSON.parse(JSON.stringify(t))}var uP=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const To=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),dP=[502,503,504];async function c2(t){var e;if(!Q8(t))throw new Jg(To(t),0);if(dP.includes(t.status))throw new Jg(To(t),t.status);let n;try{n=await t.json()}catch(a){throw new Qb(To(a),a)}let r;const i=aP(t);if(i&&i.getTime()>=Yb["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new s2(To(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ra}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new s2(To(n),t.status,n.weak_password.reasons);throw new R8(To(n),t.status||500,r)}const hP=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function Zt(t,e,n,r){var i;const a=Object.assign({},r==null?void 0:r.headers);a[Zg]||(a[Zg]=Yb["2024-01-01"].name),r!=null&&r.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const o=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await fP(t,e,n+l,{headers:a,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function fP(t,e,n,r,i,a){const o=hP(e,r,i,a);let l;try{l=await t(n,Object.assign({},o))}catch(c){throw console.error(c),new Jg(To(c),0)}if(l.ok||await c2(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await c2(c)}}function ra(t){var e;let n=null;vP(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=J8(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function u2(t){const e=ra(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ua(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function mP(t){return{data:t,error:null}}function pP(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:a}=t,o=uP(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function gP(t){return t}function vP(t){return t.access_token&&t.refresh_token&&t.expires_in}const Ap=["global","local","others"];var xP=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class yP{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=tw(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=Ap[0]){if(Ap.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ap.join(", ")}`);try{return await Zt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ft(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Zt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ua})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=xP(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await Zt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:pP,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Ft(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Zt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ua})}catch(n){if(Ft(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},f=await Zt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(a=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:gP});if(f.error)throw f.error;const p=await f.json(),v=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(N=>{const _=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(N.split(";")[1].split("=")[1]);d[`${k}Page`]=_}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(Ft(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Pl(e);try{return await Zt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ua})}catch(n){if(Ft(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Pl(e);try{return await Zt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ua})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Pl(e);try{return await Zt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ua})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Pl(e.userId);try{const{data:n,error:r}=await Zt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Pl(e.userId),Pl(e.id);try{return{data:await Zt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Ft(n))return{data:null,error:n};throw n}}}function d2(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function bP(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Il={debug:!!(globalThis&&ew()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class nw extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class wP extends nw{}async function NP(t,e,n){Il.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Il.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){Il.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{Il.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Il.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new wP(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Il.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}bP();const jP={url:T8,storageKey:z8,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:O8,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function h2(t,e,n){return await n()}const El={};class ad{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ad.nextInstanceID,ad.nextInstanceID+=1,this.instanceID>0&&fi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},jP),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new yP({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=tw(i.fetch),this.lock=i.lock||h2,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:fi()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=NP:this.lock=h2,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:ew()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=d2(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=d2(this.memoryStorage)),fi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=El[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){El[this.storageKey]=Object.assign(Object.assign({},El[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=El[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){El[this.storageKey]=Object.assign(Object.assign({},El[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Kb}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=Y8(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),fi()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:a}=await this._getSessionFromURL(n,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),B8(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ft(n)?{error:n}:{error:new Qb("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const a=await Zt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:ra}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Ft(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var n,r,i;try{let a;if("email"in e){const{email:f,password:p,options:v}=e;let m=null,N=null;this.flowType==="pkce"&&([m,N]=await Al(this.storage,this.storageKey)),a=await Zt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:f,password:p,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:m,code_challenge_method:N},xform:ra})}else if("phone"in e){const{phone:f,password:p,options:v}=e;a=await Zt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:p,data:(r=v==null?void 0:v.data)!==null&&r!==void 0?r:{},channel:(i=v==null?void 0:v.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:ra})}else throw new Eh("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Ft(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let n;if("email"in e){const{email:a,password:o,options:l}=e;n=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:u2})}else if("phone"in e){const{phone:a,password:o,options:l}=e;n=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:u2})}else throw new Eh("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ih}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(Ft(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,i,a,o,l,c,d,f,p,v,m;let N,_;if("message"in e)N=e.message,_=e.signature;else{const{chain:k,wallet:y,statement:b,options:j}=e;let C;if(fi())if(typeof y=="object")C=y;else{const K=window;if("solana"in K&&typeof K.solana=="object"&&("signIn"in K.solana&&typeof K.solana.signIn=="function"||"signMessage"in K.solana&&typeof K.solana.signMessage=="function"))C=K.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(j!=null&&j.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=y}const B=new URL((n=j==null?void 0:j.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in C&&C.signIn){const K=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},j==null?void 0:j.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),b?{statement:b}:null));let Z;if(Array.isArray(K)&&K[0]&&typeof K[0]=="object")Z=K[0];else if(K&&typeof K=="object"&&"signedMessage"in K&&"signature"in K)Z=K;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Z&&"signature"in Z&&(typeof Z.signedMessage=="string"||Z.signedMessage instanceof Uint8Array)&&Z.signature instanceof Uint8Array)N=typeof Z.signedMessage=="string"?Z.signedMessage:new TextDecoder().decode(Z.signedMessage),_=Z.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${B.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(i=(r=j==null?void 0:j.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=j==null?void 0:j.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${j.signInWithSolana.notBefore}`]:[],...!((o=j==null?void 0:j.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${j.signInWithSolana.expirationTime}`]:[],...!((l=j==null?void 0:j.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${j.signInWithSolana.chainId}`]:[],...!((c=j==null?void 0:j.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${j.signInWithSolana.nonce}`]:[],...!((d=j==null?void 0:j.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${j.signInWithSolana.requestId}`]:[],...!((p=(f=j==null?void 0:j.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||p===void 0)&&p.length?["Resources",...j.signInWithSolana.resources.map(Z=>`- ${Z}`)]:[]].join(`
`);const K=await C.signMessage(new TextEncoder().encode(N),"utf8");if(!K||!(K instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=K}}try{const{data:k,error:y}=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:Z8(_)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:ra});if(y)throw y;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new Ih}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:y})}catch(k){if(Ft(k))return{data:{user:null,session:null},error:k};throw k}}async _exchangeCodeForSession(e){const n=await Po(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:a,error:o}=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ra});if(await Da(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Ih}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(Ft(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:a,nonce:o}=e,l=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ra}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ih}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(n){if(Ft(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,f=null;this.flowType==="pkce"&&([d,f]=await Al(this.storage,this.storageKey));const{error:p}=await Zt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:f}=await Zt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:f}}throw new Eh("You must provide either an email or phone number.")}catch(l){if(Ft(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let i,a;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,a=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await Zt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:ra});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Ft(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await Al(this.storage,this.storageKey)),await Zt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:mP})}catch(a){if(Ft(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Ra;const{error:i}=await Zt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Ft(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:a}=e,{error:o}=await Zt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:i,options:a}=e,{data:o,error:l}=await Zt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Eh("You must provide either an email or phone number and a type")}catch(n){if(Ft(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Po(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Sp:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Po(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Cp()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,f)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,f))})}return{data:{session:e},error:null}}const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Zt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ua}):await this._useSession(async n=>{var r,i,a;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ra}:await Zt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:Ua})})}catch(n){if(Ft(n))return $8(n)&&(await this._removeSession(),await Da(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:a}=r;if(a)throw a;if(!i.session)throw new Ra;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Al(this.storage,this.storageKey));const{data:d,error:f}=await Zt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ua});if(f)throw f;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ra;const n=Date.now()/1e3;let r=n,i=!0,a=null;const{payload:o}=kp(e.access_token);if(o.exp&&(r=o.exp,i=r<=n),i){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(n){if(Ft(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Ra;const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Ft(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!fi())throw new Lh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Lh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new r2("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Lh("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new r2("No code detected.");const{data:b,error:j}=await this._exchangeCodeForSession(e.code);if(j)throw j;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new Lh("No session defined in URL");const f=Math.round(Date.now()/1e3),p=parseInt(l);let v=f+p;c&&(v=parseInt(c));const m=v-f;m*1e3<=Dl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${p}s`);const N=v-p;f-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,v,f):f-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,v,f);const{data:_,error:k}=await this._getUser(a);if(k)throw k;const y={provider_token:r,provider_refresh_token:i,access_token:a,expires_in:p,expires_at:v,refresh_token:o,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(r){if(Ft(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Po(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:a}=n;if(a)return{error:a};const o=(r=i.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(F8(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Da(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=K8(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:a},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Al(this.storage,this.storageKey,!0));try{return await Zt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(a){if(Ft(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:i}=await this._useSession(async a=>{var o,l,c,d,f;const{data:p,error:v}=a;if(v)throw v;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Zt(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return fi()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Ft(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:a,error:o}=n;if(o)throw o;return await Zt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await eP(async i=>(i>0&&await X8(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await Zt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ra})),(i,a)=>{const o=200*Math.pow(2,i);return a&&_p(a)&&Date.now()+o-r<Dl})}catch(r){if(this._debug(n,"error",r),Ft(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),fi()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await Po(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Po(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Ml(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Cp()}else if(i&&!i.user&&!i.user){const o=await Po(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await Da(this.storage,this.storageKey+"-user"),await Ml(this.storage,this.storageKey,i)):i.user=Cp()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const a=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Sp;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${Sp}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),_p(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Ra;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new lm;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new Ra;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(i,"error",a),Ft(a)){const o={session:null,error:a};return _p(a)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Ml(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const a=l2(i);await Ml(this.storage,this.storageKey,a)}else{const i=l2(n);await Ml(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Da(this.storage,this.storageKey),await Da(this.storage,this.storageKey+"-code-verifier"),await Da(this.storage,this.storageKey+"-user"),this.userStorage&&await Da(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&fi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Dl);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/Dl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Dl}ms, refresh threshold is ${Wg} ticks`),i<=Wg&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof nw)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,o]=await Al(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(r!=null&&r.queryParams){const a=new URLSearchParams(r.queryParams);i.push(a.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:a}=n;return a?{data:null,error:a}:await Zt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:a,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await Zt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:a}=n;if(a)return{data:null,error:a};const{data:o,error:l}=await Zt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:a}=n;return a?{data:null,error:a}:await Zt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],i=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:i,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:a}=e;if(a)return{data:null,error:a};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=kp(i.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(p=>p.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const f=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const i=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+M8>i)return r;const{data:a,error:o}=await Zt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,r=a.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:m,error:N}=await this.getSession();if(N||!m.session)return{data:null,error:N};r=m.session.access_token}const{header:i,payload:a,signature:o,raw:{header:l,payload:c}}=kp(r);n!=null&&n.allowExpired||oP(a.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!d){const{error:m}=await this.getUser(r);if(m)throw m;return{data:{claims:a,header:i,signature:o},error:null}}const f=lP(i.alg),p=await crypto.subtle.importKey("jwk",d,f,!0,["verify"]);if(!await crypto.subtle.verify(f,p,o,W8(`${l}.${c}`)))throw new Kg("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(r){if(Ft(r))return{data:null,error:r};throw r}}}ad.nextInstanceID=0;const SP=ad;class _P extends SP{constructor(e){super(e)}}var kP=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(r.next(f))}catch(p){o(p)}}function c(f){try{d(r.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((r=r.apply(t,e||[])).next())})};class CP{constructor(e,n,r){var i,a,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=E8(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:j8,realtime:_8,auth:Object.assign(Object.assign({},S8),{storageKey:d}),global:N8},p=L8(r??{},f);this.storageKey=(i=p.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=p.global.headers)!==null&&a!==void 0?a:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(v,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=p.auth)!==null&&o!==void 0?o:{},this.headers,p.global.fetch),this.fetch=P8(n,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new UA(new URL("rest/v1",c).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new y8(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new wA(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return kP(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:a,storageKey:o,flowType:l,lock:c,debug:d},f,p){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new _P({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),f),storageKey:o,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:a,flowType:l,lock:c,debug:d,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new a8(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const AP=(t,e,n)=>new CP(t,e,n);function PP(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}PP()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const IP={}.VITE_SUPABASE_URL||"https://your-project.supabase.co",EP={}.VITE_SUPABASE_ANON_KEY||"your-anon-key",wn=AP(IP,EP),Bn={COMPANIES:"companies",USERS:"users",DEPARTMENTS:"departments",STAFF:"staff",REFRIGERATORS:"refrigerators",TEMPERATURES:"temperatures",CLEANING:"cleaning",INVENTORY:"inventory",PRODUCT_LABELS:"product_labels",ONBOARDING:"onboarding",MAINTENANCE_TASKS:"maintenance_tasks"},LP=t=>({id:t,name:"",type:"",address:"",email:"",phone:"",vat_number:"",settings:{allow_photo_storage:!0,max_users:25,plan:"free",features:{inventory_sync:!0,temperature_sync:!0,staff_sync:!0,label_sync:!1}},created_at:new Date().toISOString(),updated_at:new Date().toISOString(),last_sync:null}),TP={id:"string",company_id:"string",conservation_point_id:"string",conservation_point_name:"string",task_type:"string",frequency:"string",selected_days:"array",assigned_role:"string",assigned_category:"string",assigned_staff_ids:"array",is_active:"boolean",created_at:"string",updated_at:"string"},zP=(t,e,n="campo")=>{try{switch(e){case"string":if(typeof t!="string")return{isValid:!1,error:`${n} deve essere una stringa`};if(t.trim().length===0)return{isValid:!1,error:`${n} non pu essere vuoto`};break;case"number":if(typeof t!="number"||isNaN(t))return{isValid:!1,error:`${n} deve essere un numero valido`};break;case"boolean":if(typeof t!="boolean")return{isValid:!1,error:`${n} deve essere true o false`};break;case"array":if(!Array.isArray(t))return{isValid:!1,error:`${n} deve essere un array`};break;case"object":if(typeof t!="object"||t===null||Array.isArray(t))return{isValid:!1,error:`${n} deve essere un oggetto`};break;default:return{isValid:!1,error:`Tipo di dato non supportato: ${e}`}}return{isValid:!0}}catch(r){return{isValid:!1,error:`Errore di validazione per ${n}: ${r.message}`}}},OP=(t,e,n="oggetto")=>{const r=[];try{if(!t||typeof t!="object")return{isValid:!1,errors:[`${n} deve essere un oggetto valido`]};for(const[i,a]of Object.entries(e)){const o=t[i];if(o===void 0){r.push(`Campo obbligatorio mancante: ${i}`);continue}const l=zP(o,a,i);l.isValid||r.push(l.error)}for(const i of Object.keys(t))e.hasOwnProperty(i)||r.push(`Campo non riconosciuto: ${i}`);return{isValid:r.length===0,errors:r}}catch(i){return{isValid:!1,errors:[`Errore durante la validazione di ${n}: ${i.message}`]}}},rw=t=>typeof t!="string"?"":t.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim(),DP=t=>Array.isArray(t)?t.filter(e=>e!=null).map(e=>typeof e=="string"?rw(e):e):[],sw=t=>{if(!t||typeof t!="object")return{};const e={};for(const[n,r]of Object.entries(t))typeof r=="string"?e[n]=rw(r):Array.isArray(r)?e[n]=DP(r):typeof r=="object"&&r!==null?e[n]=sw(r):e[n]=r;return e},MP=(t,e,n="dati")=>{try{const r=sw(t),i=OP(r,e,n);return i.isValid?(De(` Validazione e sanitizzazione ${n} completata`),{isValid:!0,errors:[],sanitizedData:r}):(rs(` Validazione ${n} fallita:`,i.errors),{isValid:!1,errors:i.errors,sanitizedData:null})}catch(r){return rs(` Errore durante validazione/sanitizzazione ${n}:`,r),{isValid:!1,errors:[`Errore di validazione: ${r.message}`],sanitizedData:null}}},Th={}.VITE_SUPABASE_URL||"https://your-project.supabase.co";class RP{constructor(){this.companyId=this.getCompanyId()}getCompanyId(){let e=localStorage.getItem("haccp-company-id");return e||(e=`company_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("haccp-company-id",e)),e}handleError(e,n){return console.error(` Supabase ${n} error:`,e),{success:!1,error:e.message,data:null}}handleSuccess(e,n){return console.log(` Supabase ${n} success:`,e),{success:!0,error:null,data:e}}async createCompany(e){try{const n={...LP(this.companyId),...e,id:this.companyId},{data:r,error:i}=await wn.from(Bn.COMPANIES).insert([n]).select();if(i)throw i;return this.handleSuccess(r[0],"createCompany")}catch(n){return this.handleError(n,"createCompany")}}async getCompany(){try{const{data:e,error:n}=await wn.from(Bn.COMPANIES).select("*").eq("id",this.companyId).single();if(n&&n.code!=="PGRST116")throw n;return this.handleSuccess(e,"getCompany")}catch(e){return this.handleError(e,"getCompany")}}async saveUsers(e){try{const{data:n,error:r}=await wn.from(Bn.USERS).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(r)throw r;return this.handleSuccess(n,"saveUsers")}catch(n){return this.handleError(n,"saveUsers")}}async getUsers(){try{const{data:e,error:n}=await wn.from(Bn.USERS).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getUsers")}catch(e){return this.handleError(e,"getUsers")}}async saveDepartments(e){try{const{data:n,error:r}=await wn.from(Bn.DEPARTMENTS).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(r)throw r;return this.handleSuccess(n,"saveDepartments")}catch(n){return this.handleError(n,"saveDepartments")}}async getDepartments(){try{const{data:e,error:n}=await wn.from(Bn.DEPARTMENTS).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getDepartments")}catch(e){return this.handleError(e,"getDepartments")}}async saveStaff(e){try{const{data:n,error:r}=await wn.from(Bn.STAFF).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(r)throw r;return this.handleSuccess(n,"saveStaff")}catch(n){return this.handleError(n,"saveStaff")}}async getStaff(){try{const{data:e,error:n}=await wn.from(Bn.STAFF).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getStaff")}catch(e){return this.handleError(e,"getStaff")}}async saveRefrigerators(e){try{const{data:n,error:r}=await wn.from(Bn.REFRIGERATORS).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(r)throw r;return this.handleSuccess(n,"saveRefrigerators")}catch(n){return this.handleError(n,"saveRefrigerators")}}async getRefrigerators(){try{const{data:e,error:n}=await wn.from(Bn.REFRIGERATORS).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getRefrigerators")}catch(e){return this.handleError(e,"getRefrigerators")}}async saveTemperatures(e){try{const{data:n,error:r}=await wn.from(Bn.TEMPERATURES).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(r)throw r;return this.handleSuccess(n,"saveTemperatures")}catch(n){return this.handleError(n,"saveTemperatures")}}async getTemperatures(){try{const{data:e,error:n}=await wn.from(Bn.TEMPERATURES).select("*").eq("company_id",this.companyId).order("timestamp",{ascending:!1});if(n)throw n;return this.handleSuccess(e||[],"getTemperatures")}catch(e){return this.handleError(e,"getTemperatures")}}async saveCleaning(e){try{const{data:n,error:r}=await wn.from(Bn.CLEANING).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(r)throw r;return this.handleSuccess(n,"saveCleaning")}catch(n){return this.handleError(n,"saveCleaning")}}async getCleaning(){try{const{data:e,error:n}=await wn.from(Bn.CLEANING).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getCleaning")}catch(e){return this.handleError(e,"getCleaning")}}async saveInventory(e){try{const{data:n,error:r}=await wn.from(Bn.INVENTORY).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(r)throw r;return this.handleSuccess(n,"saveInventory")}catch(n){return this.handleError(n,"saveInventory")}}async getInventory(){try{const{data:e,error:n}=await wn.from(Bn.INVENTORY).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getInventory")}catch(e){return this.handleError(e,"getInventory")}}async saveOnboarding(e){try{const{data:n,error:r}=await wn.from(Bn.ONBOARDING).upsert([{id:this.companyId,company_id:this.companyId,data:e,completed:!0,completed_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select();if(r)throw r;return this.handleSuccess(n[0],"saveOnboarding")}catch(n){return this.handleError(n,"saveOnboarding")}}async getOnboarding(){try{const{data:e,error:n}=await wn.from(Bn.ONBOARDING).select("*").eq("company_id",this.companyId).single();if(n&&n.code!=="PGRST116")throw n;return this.handleSuccess(e,"getOnboarding")}catch(e){return this.handleError(e,"getOnboarding")}}async saveMaintenanceTasks(e){try{const n=[];for(const a of e){const o=MP(a,TP,"task di manutenzione");if(o.isValid)n.push(o.sanitizedData);else throw console.error(" Task di manutenzione non valido:",o.errors),new Error(`Task non valido: ${o.errors.join(", ")}`)}if(!wn||Th.includes("your-project.supabase.co")){console.warn(" Supabase non configurato, salvataggio in localStorage");const a=JSON.parse(localStorage.getItem("haccp-maintenance-tasks")||"[]"),o=n.map(c=>({...c,company_id:this.companyId,updated_at:new Date().toISOString()})),l=[...a.filter(c=>!n.some(d=>d.conservation_point_id===c.conservation_point_id)),...o];return localStorage.setItem("haccp-maintenance-tasks",JSON.stringify(l)),this.handleSuccess(o,"saveMaintenanceTasks (localStorage)")}const{data:r,error:i}=await wn.from(Bn.MAINTENANCE_TASKS).upsert(n.map(a=>({...a,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(i)throw i;return this.handleSuccess(r,"saveMaintenanceTasks")}catch(n){return this.handleError(n,"saveMaintenanceTasks")}}async getMaintenanceTasks(){try{if(!wn||Th.includes("your-project.supabase.co")){console.warn(" Supabase non configurato, caricamento da localStorage");const r=JSON.parse(localStorage.getItem("haccp-maintenance-tasks")||"[]");console.log(" Tasks raw from localStorage:",r.length,"task"),console.log(" Company ID corrente:",this.companyId);const i=r.filter(a=>a.company_id===this.companyId);return console.log(" Tasks filtrati per company_id:",i.length,"task"),this.handleSuccess(i,"getMaintenanceTasks (localStorage)")}const{data:e,error:n}=await wn.from(Bn.MAINTENANCE_TASKS).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getMaintenanceTasks")}catch(e){return this.handleError(e,"getMaintenanceTasks")}}async getMaintenanceTasksByConservationPoint(e){try{if(!wn||Th.includes("your-project.supabase.co")){console.warn(" Supabase non configurato, caricamento da localStorage");const a=JSON.parse(localStorage.getItem("haccp-maintenance-tasks")||"[]").filter(o=>o.company_id===this.companyId&&o.conservation_point_id===e);return this.handleSuccess(a,"getMaintenanceTasksByConservationPoint (localStorage)")}const{data:n,error:r}=await wn.from(Bn.MAINTENANCE_TASKS).select("*").eq("company_id",this.companyId).eq("conservation_point_id",e).order("created_at",{ascending:!0});if(r)throw r;return this.handleSuccess(n||[],"getMaintenanceTasksByConservationPoint")}catch(n){return this.handleError(n,"getMaintenanceTasksByConservationPoint")}}async deleteMaintenanceTasksByConservationPoint(e){try{if(!wn||Th.includes("your-project.supabase.co")){console.warn(" Supabase non configurato, eliminazione da localStorage");const a=JSON.parse(localStorage.getItem("haccp-maintenance-tasks")||"[]").filter(o=>!(o.company_id===this.companyId&&o.conservation_point_id===e));return localStorage.setItem("haccp-maintenance-tasks",JSON.stringify(a)),this.handleSuccess(a,"deleteMaintenanceTasksByConservationPoint (localStorage)")}const{data:n,error:r}=await wn.from(Bn.MAINTENANCE_TASKS).delete().eq("company_id",this.companyId).eq("conservation_point_id",e);if(r)throw r;return this.handleSuccess(n,"deleteMaintenanceTasksByConservationPoint")}catch(n){return this.handleError(n,"deleteMaintenanceTasksByConservationPoint")}}async migrateFromLocalStorage(){try{console.log(" Starting migration from localStorage to Supabase...");const e={users:JSON.parse(localStorage.getItem("haccp-users")||"[]"),departments:JSON.parse(localStorage.getItem("haccp-departments")||"[]"),staff:JSON.parse(localStorage.getItem("haccp-staff")||"[]"),refrigerators:JSON.parse(localStorage.getItem("haccp-refrigerators")||"[]"),temperatures:JSON.parse(localStorage.getItem("haccp-temperatures")||"[]"),cleaning:JSON.parse(localStorage.getItem("haccp-cleaning")||"[]"),products:JSON.parse(localStorage.getItem("haccp-products")||"[]"),onboarding:JSON.parse(localStorage.getItem("haccp-onboarding")||"null")},n=await this.getCompany();(!n.success||!n.data)&&await this.createCompany({name:"Migrated Company",type:"pizzeria"});const r=[];e.users.length>0&&r.push(this.saveUsers(e.users)),e.departments.length>0&&r.push(this.saveDepartments(e.departments)),e.staff.length>0&&r.push(this.saveStaff(e.staff)),e.refrigerators.length>0&&r.push(this.saveRefrigerators(e.refrigerators)),e.temperatures.length>0&&r.push(this.saveTemperatures(e.temperatures)),e.cleaning.length>0&&r.push(this.saveCleaning(e.cleaning)),e.products.length>0&&r.push(this.saveInventory(e.products)),e.onboarding&&r.push(this.saveOnboarding(e.onboarding));const i=await Promise.all(r),a=i.filter(l=>!l.success);return a.length>0?(console.error(" Some migrations failed:",a),this.handleError(new Error("Migration failed"),"migrateFromLocalStorage")):(["haccp-users","haccp-departments","haccp-staff","haccp-refrigerators","haccp-temperatures","haccp-cleaning","haccp-products","haccp-onboarding"].forEach(l=>localStorage.removeItem(l)),console.log(" Migration completed successfully!"),this.handleSuccess(i,"migrateFromLocalStorage"))}catch(e){return this.handleError(e,"migrateFromLocalStorage")}}}const Pp=new RP,FP=({formData:t,setFormData:e,currentStep:n,validateStep:r,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{var Ae,Re,he,Ne,He;const[c,d]=q.useState([]),[f,p]=q.useState(!1),[v,m]=q.useState("generic"),[N,_]=q.useState(null),[k,y]=q.useState({}),[b,j]=q.useState({name:"",assignedRole:"",assignedEmployee:"",frequency:""}),[C,B]=q.useState(!1),[K,Z]=q.useState(null),[z,J]=q.useState(null),[te,I]=q.useState([]),[A,T]=q.useState(!1),{formRef:F,scrollToForm:ne}=Zo(f,"tasks-generic-form"),{formRef:W,scrollToForm:ue}=Zo(C,"tasks-maintenance-form");q.useEffect(()=>{f&&ne()},[f,ne]),q.useEffect(()=>{C&&ue()},[C,ue]),q.useEffect(()=>{var pe,ke;De(" TasksStep: Caricamento dati..."),De(" formData.tasks:",t.tasks);const ce=((pe=t.tasks)==null?void 0:pe.list)||((ke=t.tasks)==null?void 0:ke.tasksList)||[];ce.length>0?(De(" Caricando tasks:",ce),d(ce)):De(" Nessun task trovato in formData.tasks")},[t.tasks]);const P=async()=>{T(!0);try{const ce=await Pp.getMaintenanceTasks();if(ce.success){const pe=ce.data.reduce((ye,Ze)=>{const Be=Ze.conservation_point_id;return ye[Be]||(ye[Be]={conservation_point_id:Be,conservation_point_name:Ze.conservation_point_name,tasks:[]}),ye[Be].tasks.push(Ze),ye},{}),ke=Object.values(pe);I(ke),e(ye=>({...ye,savedMaintenances:ke})),au(" Manutenzioni caricate:",ke)}}catch(ce){errorLog(" Errore nel caricamento manutenzioni:",ce)}finally{T(!1)}};q.useEffect(()=>{P(),Q()},[]);const Q=()=>{try{const ce=localStorage.getItem("haccp-maintenance-tasks");if(ce){const ke=JSON.parse(ce).reduce((Ze,Be)=>{const ut=Be.conservation_point_id;return Ze[ut]||(Ze[ut]={conservation_point_id:ut,conservation_point_name:Be.conservation_point_name,tasks:[]}),Ze[ut].tasks.push(Be),Ze},{}),ye=Object.values(ke);I(ye),e(Ze=>({...Ze,savedMaintenances:ye})),au(" Manutenzioni precompilate caricate:",ye)}}catch(ce){errorLog(" Errore nel caricamento manutenzioni precompilate:",ce)}};q.useEffect(()=>{var ce,pe;((pe=(ce=t.conservation)==null?void 0:ce.points)==null?void 0:pe.length)>0&&(De(" Ricaricamento manutenzioni per punti di conservazione..."),P())},[(Ae=t.conservation)==null?void 0:Ae.points]),q.useEffect(()=>{if(f&&(De(" Form aperto, controllando dati disponibili..."),De(" formData.tasks:",t.tasks),De(" tasks locali:",c),c.length>0)){const ce=c[0];De(" Precompilando con task locale:",ce),j({name:ce.name||"",assignedRole:ce.assignedRole||"",assignedEmployee:ce.assignedEmployee||"",frequency:ce.frequency||""})}},[f]);const G=((Re=t.conservation)==null?void 0:Re.count)||0,de=c.filter(ce=>{const pe=ce.name.toLowerCase(),ke=pe.includes("rilevamento temperature")||pe.includes("rilevamento temperatura")||pe.includes("temperature")||pe.includes("temperatura")||pe.includes("monitoraggio");return De(` Task "${ce.name}": isTemperatureTask=${ke}`),ke}).length,w=te.flatMap(ce=>ce.tasks).filter(ce=>ce.task_type==="temperature_monitoring").length,O=de+w;De(` Temperature tasks count: ${O}, Total tasks: ${c.length}`),De(` Generic temperature tasks: ${de}`),De(` Maintenance temperature tasks: ${w}`),De(" All tasks:",c),q.useEffect(()=>{e(ce=>({...ce,tasks:{list:c,count:c.length}}))},[c,e]);const R=["Giornalmente","Settimanalmente","Mensilmente","Annualmente"],H=()=>{j({name:"",assignedRole:"",assignedEmployee:"",frequency:""}),_(null)},re=ce=>v==="generic"?"Sanificazione Superfici Bancone / Chiusura di Cassa alle 23:55 / Pulizia dei Tavoli della Sala":ce?`Rilevamento temperatura ${ce.name}`:"Rilevamento temperatura",oe=()=>{var pe;const ce=((pe=t.conservation)==null?void 0:pe.points)||[];return De(" Conservation points:",ce),ce},fe=ce=>ce?ce.setTemperature&&ce.setTemperature.toString().toLowerCase().trim()==="ambiente"?!0:ce.setTemperatureMin&&ce.setTemperatureMax?ce.setTemperatureMin>=15&&ce.setTemperatureMax<=25:!!(ce.targetTemp&&ce.targetTemp.toString().toLowerCase().trim()==="ambiente"):!1,be=ce=>{if(fe(ce))return De(` Point ${ce.id} (${ce.name}) has ambiente temperature - no maintenance required`),!0;if(De(` Checking point ${ce.id} (${ce.name}) for maintenance tasks...`),De(" Saved maintenances:",te),te.some(ut=>ut.conservation_point_id===ce.id&&ut.tasks.length>=3))return De(` Point ${ce.id} (${ce.name}) has maintenance tasks in database`),!0;De(` Point ${ce.id} (${ce.name}) has NO maintenance tasks in database`);const ke=c.filter(ut=>{const it=ut.name.toLowerCase(),gt=it.includes(ce.id.toString()),Vt=it.includes(ce.name.toLowerCase());return gt||Vt}),ye=ke.some(ut=>{const it=ut.name.toLowerCase();return it.includes("rilevamento temperature")||it.includes("rilevamento temperatura")||it.includes("temperature")||it.includes("temperatura")||it.includes("monitoraggio")}),Ze=ke.some(ut=>{const it=ut.name.toLowerCase();return it.includes("sanificazione")||it.includes("sanitizzazione")||it.includes("pulizia")}),Be=ke.some(ut=>{const it=ut.name.toLowerCase();return it.includes("sbrinamento")||it.includes("sbrinare")||it.includes("defrosting")});return De(` Checking point ${ce.id} (${ce.name}): hasTemperatureTask=${ye}, hasSanitizationTask=${Ze}, hasDefrostingTask=${Be}`),ye&&Ze&&Be},ze=()=>O>=G,Le=()=>c.length>0,Fe=()=>ze()&&Le();q.useEffect(()=>{if(f)if(v==="maintenance"){const pe=oe().filter(ke=>!be(ke));if(pe.length>0){const ke=pe[0];j(ye=>({...ye,name:re(ke)}))}}else j({name:"",assignedRole:"",assignedEmployee:"",frequency:""})},[f,v]);const Me=()=>{if(!b.name||b.name.trim().length<5){y({name:"Nome attivit deve essere di almeno 5 caratteri"});return}if(b.name&&b.assignedRole&&b.frequency){const ce={id:Date.now(),name:b.name.trim(),assignedRole:b.assignedRole,assignedEmployee:b.assignedEmployee||null,frequency:b.frequency};De(" Aggiungendo nuova attivit:",ce),d(pe=>{const ke=[...pe,ce];return De(" Lista attivit aggiornata:",ke),ke}),H(),p(!1),y({})}},tt=ce=>{d(pe=>pe.filter(ke=>ke.id!==ce))},Ce=async ce=>{try{au(" Salvataggio manutenzioni:",ce);const pe=await Pp.saveMaintenanceTasks(ce);pe.success?(au(" Manutenzioni salvate con successo"),await P(),B(!1),Z(null),J(null),alert("Manutenzioni configurate con successo!")):(errorLog(" Errore nel salvataggio:",pe.error),alert("Errore nel salvataggio delle manutenzioni"))}catch(pe){errorLog(" Errore durante il salvataggio:",pe),alert("Errore durante il salvataggio delle manutenzioni")}},ie=()=>{B(!1),Z(null),J(null)},pt=ce=>({Giornalmente:"daily",Settimanale:"weekly",Mensile:"monthly",Semestrale:"semiannual",Annuale:"annual","Giorni specifici":"custom_days"})[ce]||ce,dt=ce=>{Z({id:ce.conservation_point_id,name:ce.conservation_point_name});const pe={[$t.TEMPERATURE_MONITORING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[$t.SANITIZATION]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[$t.DEFROSTING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]}};ce.tasks.forEach(ke=>{const ye=ke.task_type;pe[ye]&&(pe[ye]={frequency:pt(ke.frequency)||"",selected_days:ke.selected_days||[],assigned_role:ke.assigned_role||"",assigned_category:ke.assigned_category||"",assigned_staff_ids:ke.assigned_staff_ids||[]})}),J(pe),B(!0)},Ge=async ce=>{const pe=`Sei sicuro di voler eliminare tutte le manutenzioni per "${ce.conservation_point_name}"?

Questa azione non pu essere annullata.`;if(window.confirm(pe))try{const ke=await Pp.deleteMaintenanceTasksByConservationPoint(ce.conservation_point_id);ke.success?(au(" Manutenzioni eliminate con successo"),await P(),alert("Manutenzioni eliminate con successo!")):(errorLog(" Errore nell'eliminazione:",ke.error),alert("Errore nell'eliminazione delle manutenzioni"))}catch(ke){errorLog(" Errore durante l'eliminazione:",ke),alert("Errore durante l'eliminazione delle manutenzioni")}},Qe=(ce,pe=[])=>{switch(ce){case"daily":return"Giornalmente";case"weekly":return"Settimanale";case"monthly":return"Mensile";case"semiannual":return"Semestrale";case"annual":return"Annuale";case"custom_days":case"Giorni specifici":if(pe&&pe.length>0){const ke={monday:"Luned",tuesday:"Marted",wednesday:"Mercoled",thursday:"Gioved",friday:"Venerd",saturday:"Sabato",sunday:"Domenica"};return pe.map(ye=>ke[ye]).join(", ")}return"Giorni specifici";default:return ce}},st=ce=>{var ye;return!ce||ce.length===0?"":(((ye=t.staff)==null?void 0:ye.staffMembers)||[]).filter(Ze=>ce.includes(Ze.id)).map(Ze=>`${Ze.name} ${Ze.surname}`).join(", ")},ae=Fe();return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Mansioni e Attivit"}),s.jsx("p",{className:"text-gray-600",children:"Assegna compiti al personale"})]}),(()=>{const ce=oe(),pe=ce.filter(ye=>!be(ye)),ke=ce.filter(ye=>fe(ye));return De(" Missing tasks check:",{conservationPoints:ce.map(ye=>({id:ye.id,name:ye.name})),missingTasks:pe.map(ye=>({id:ye.id,name:ye.name})),ambientePoints:ke.map(ye=>({id:ye.id,name:ye.name})),allTasks:c.map(ye=>({name:ye.name,assignedRole:ye.assignedRole}))}),ke.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(pn,{className:"h-5 w-5 text-green-600"}),s.jsx("h4",{className:"font-medium text-green-900",children:"Punti con Temperatura Ambiente"})]}),s.jsxs("p",{className:"text-sm text-green-800 mb-3",children:["I seguenti punti di conservazione hanno temperatura ambiente (15-25C) e ",s.jsx("strong",{children:"non richiedono manutenzione HACCP specifica"}),":"]}),s.jsx("ul",{className:"list-disc list-inside text-sm text-green-700 space-y-1",children:ke.map(ye=>s.jsx("li",{children:ye.name},ye.id))})]}),pe.length>0&&s.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(pn,{className:"h-5 w-5 text-yellow-600"}),s.jsx("h4",{className:"font-medium text-yellow-900",children:"Punti di Conservazione senza Mansioni"})]}),s.jsx("p",{className:"text-sm text-yellow-800 mb-3",children:"I seguenti punti di conservazione necessitano delle 3 mansioni obbligatorie (Rilevamento Temperatura, Sanificazione, Sbrinamento):"}),s.jsx("ul",{className:"list-disc list-inside text-sm text-yellow-700 space-y-1",children:pe.map(ye=>s.jsx("li",{children:ye.name},ye.id))})]})]}):pe.length>0?s.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(pn,{className:"h-5 w-5 text-yellow-600"}),s.jsx("h4",{className:"font-medium text-yellow-900",children:"Punti di Conservazione senza Mansioni"})]}),s.jsx("p",{className:"text-sm text-yellow-800 mb-3",children:"I seguenti punti di conservazione necessitano delle 3 mansioni obbligatorie (Rilevamento Temperatura, Sanificazione, Sbrinamento):"}),s.jsx("div",{className:"space-y-2",children:pe.map(ye=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-yellow-100 rounded",children:[s.jsx("span",{className:"text-sm font-medium",children:ye.name}),s.jsx(le,{onClick:()=>{Z(ye),B(!0)},size:"sm",className:"bg-yellow-600 hover:bg-yellow-700 text-white",children:"Aggiungi Mansione"})]},ye.id))})]}):null})(),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Attivit e Mansioni"}),s.jsxs(le,{onClick:()=>{m("generic"),p(!0)},variant:"outline",size:"sm",children:[s.jsx(pr,{className:"h-4 w-4 mr-1"}),"Aggiungi Nuova Attivit"]})]}),te.length>0&&s.jsx("div",{className:"space-y-3 mb-6",children:te.map(ce=>s.jsx("div",{className:"border rounded-lg p-4 bg-yellow-50 border-yellow-200",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("h4",{className:"text-base font-semibold text-yellow-900 mb-3",children:["Manutenzioni (",ce.conservation_point_name,")"]}),s.jsx("div",{className:"space-y-3",children:ce.tasks.map(pe=>s.jsxs("div",{className:"text-base",children:[s.jsxs("div",{className:"font-medium text-gray-800 mb-2",children:[pe.task_name,":"]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-medium",children:"Frequenza:"}),s.jsx("span",{className:"ml-1 text-gray-700",children:Qe(pe.frequency,pe.selected_days)})]}),pe.assigned_role&&s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-medium",children:"Ruolo:"}),s.jsx("span",{className:"ml-1 text-gray-700",children:pe.assigned_role})]}),pe.assigned_category&&s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-medium",children:"Categoria:"}),s.jsx("span",{className:"ml-1 text-gray-700",children:pe.assigned_category})]}),pe.assigned_staff_ids&&pe.assigned_staff_ids.length>0&&s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-medium",children:"Staff:"}),s.jsx("span",{className:"ml-1 text-gray-700",children:st(pe.assigned_staff_ids)})]})]})]},pe.id))})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{onClick:()=>dt(ce),variant:"outline",size:"sm",className:"text-blue-600 hover:text-blue-700",children:s.jsx(wi,{className:"h-4 w-4"})}),s.jsx(le,{onClick:()=>Ge(ce),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:s.jsx(er,{className:"h-4 w-4"})})]})]})},ce.conservation_point_id))}),c.length===0&&te.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(P5,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"Nessuna attivit configurata"}),s.jsx("p",{className:"text-sm",children:'Clicca "Aggiungi Nuova Attivit" per iniziare'})]}):c.length>0&&s.jsx("div",{className:"space-y-3",children:c.map(ce=>s.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[s.jsx("h5",{className:"font-medium",children:ce.name}),s.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:Qe(ce.frequency)})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Assegnato a:"})," ",ce.assignedRole,ce.assignedEmployee&&s.jsxs("span",{className:"ml-2 text-blue-600",children:["(",ce.assignedEmployee,")"]})]}),ce.name.toLowerCase().includes("rilevamento temperature")&&s.jsx("div",{className:"mt-2 text-sm text-blue-600",children:" Attivit di monitoraggio temperature"})]}),s.jsx("div",{className:"flex gap-2",children:s.jsx(le,{onClick:()=>tt(ce.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:s.jsx(un,{className:"h-4 w-4"})})})]})},ce.id))})]}),f&&s.jsxs("div",{ref:F,id:"tasks-generic-form",className:"border rounded-lg p-4 bg-white",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Aggiungi Nuova Attivit"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx(Je,{htmlFor:"name",children:"Nome Attivit *"}),s.jsx(bt,{id:"name",value:b.name,onChange:ce=>{j(pe=>({...pe,name:ce.target.value})),k.name&&y(pe=>({...pe,name:null}))},placeholder:"",className:`mt-1 ${k.name?"border-red-500 focus:border-red-500 focus:ring-red-500":""}`}),k.name&&s.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" ",k.name]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Suggerimento: ",re()]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"assignedRole",children:"Assegna Mansione a: *"}),s.jsxs("select",{id:"assignedRole",value:b.assignedRole,onChange:ce=>j(pe=>({...pe,assignedRole:ce.target.value,assignedEmployee:""})),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Seleziona categoria"}),s.jsx("option",{value:"Amministratore",children:"Amministratore"}),s.jsx("option",{value:"Cuochi",children:"Cuochi"}),s.jsx("option",{value:"Banconisti",children:"Banconisti"}),s.jsx("option",{value:"Camerieri",children:"Camerieri"}),s.jsx("option",{value:"Responsabile",children:"Responsabile"}),s.jsx("option",{value:"Dipendente",children:"Dipendente"})]}),!b.assignedRole&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:" Seleziona una categoria per procedere"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"assignedEmployee",children:"Dipendente Specifico (Opzionale)"}),s.jsxs("select",{id:"assignedEmployee",value:b.assignedEmployee,onChange:ce=>j(pe=>({...pe,assignedEmployee:ce.target.value})),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:!b.assignedRole,children:[s.jsx("option",{value:"",children:"Seleziona dipendente specifico"}),(Ne=(he=t.staff)==null?void 0:he.staffMembers)==null?void 0:Ne.filter(ce=>{var pe;return["Responsabile","Dipendente","Amministratore"].includes(b.assignedRole)?ce.role===b.assignedRole:((pe=ce.categories)==null?void 0:pe.includes(b.assignedRole))||ce.primaryCategory===b.assignedRole}).map(ce=>{var pe;return s.jsxs("option",{value:ce.fullName||ce.name,children:[ce.fullName||ce.name," - ",ce.role," (",ce.primaryCategory||((pe=ce.categories)==null?void 0:pe[0]),")"]},ce.id)})]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"frequency",children:"Frequenza *"}),s.jsxs("select",{id:"frequency",value:b.frequency,onChange:ce=>j(pe=>({...pe,frequency:ce.target.value})),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Seleziona frequenza"}),R.map(ce=>s.jsx("option",{value:ce,children:ce},ce))]})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[s.jsx(le,{variant:"outline",onClick:()=>{p(!1),H()},children:"Annulla"}),s.jsx(le,{onClick:Me,disabled:!b.name||!b.assignedRole||!b.frequency,children:"Aggiungi Attivit"})]})]}),s.jsx("div",{className:`p-4 rounded-lg ${ae?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${ae?"bg-green-500":"bg-yellow-500"} text-white text-sm font-bold`,children:c.length+te.length}),s.jsxs("div",{children:[ae&&s.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),s.jsxs("p",{className:`font-medium ${ae?"text-green-900":"text-yellow-900"}`,children:["Attivit configurate: ",c.length+te.length]}),s.jsx("p",{className:`text-sm ${ae?"text-green-800":"text-yellow-800"}`,children:ae?" Tutti i requisiti sono soddisfatti! Puoi procedere al prossimo step.":!ze()&&!Le()?" Devi configurare le manutenzioni per tutti i punti di conservazione e aggiungere almeno un'attivit generale.":ze()?" Devi aggiungere almeno un'attivit generale.":" Devi configurare le manutenzioni per tutti i punti di conservazione."})]})]})}),!ae&&s.jsxs("div",{className:"p-4 bg-red-50 border-2 border-red-300 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(pn,{className:"h-5 w-5 text-red-600"}),s.jsx("h4",{className:"font-bold text-red-900",children:"Non puoi procedere al prossimo step"})]}),s.jsx("p",{className:"text-sm text-red-800 mb-2",children:"Ci sono errori che devi correggere prima di poter continuare:"}),s.jsxs("ul",{className:"text-sm text-red-700 list-disc list-inside space-y-1",children:[c.some(ce=>ce.name&&ce.name.trim().length<5)&&s.jsx("li",{children:"Alcune attivit hanno nomi troppo corti (minimo 5 caratteri)"}),!ze()&&s.jsx("li",{children:"Devi configurare le manutenzioni per tutti i punti di conservazione"}),!Le()&&s.jsx("li",{children:"Devi aggiungere almeno un'attivit generale"})]})]}),c.some(ce=>ce.name&&ce.name.trim().length<5)&&s.jsxs("div",{className:"p-4 bg-red-50 border-2 border-red-300 rounded-lg mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(pn,{className:"h-6 w-6 text-red-600"}),s.jsx("h4",{className:"text-lg font-bold text-red-900",children:" ERRORE DI VALIDAZIONE"})]}),s.jsxs("div",{className:"bg-red-100 p-3 rounded-md mb-3",children:[s.jsx("p",{className:"text-base font-semibold text-red-900 mb-2",children:"Non puoi procedere al prossimo step perch alcune attivit hanno nomi troppo corti!"}),s.jsx("p",{className:"text-sm text-red-800 mb-2",children:"Per procedere, devi correggere i seguenti problemi:"}),s.jsxs("ul",{className:"text-sm text-red-700 list-disc list-inside space-y-1 font-medium",children:[s.jsx("li",{children:"Il nome di ogni attivit deve essere di almeno 5 caratteri"}),s.jsx("li",{children:"Modifica o elimina le attivit con nomi troppo corti"}),s.jsx("li",{children:'Esempio di nome valido: "Pulizia bancone cucina"'})]})]}),s.jsxs("div",{className:"text-sm text-red-700",children:[s.jsx("strong",{children:"Attivit con problemi:"}),s.jsx("ul",{className:"list-disc list-inside mt-1",children:c.filter(ce=>ce.name&&ce.name.trim().length<5).map((ce,pe)=>s.jsxs("li",{children:['"',ce.name,'" (solo ',ce.name.trim().length," caratteri - ne servono almeno 5)"]},pe))})]})]}),Object.keys(k).length>0&&s.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("p",{className:"font-medium",children:" Errori di validazione:"}),Object.entries(k).map(([ce,pe])=>s.jsxs("p",{children:[" ",pe]},ce))]})}),s.jsx(Tb,{ref:W,conservationPoint:K,staffMembers:((He=t.staff)==null?void 0:He.staffMembers)||[],onSave:Ce,onCancel:ie,isOpen:C,existingData:z})]})},$P=({formData:t,setFormData:e,currentStep:n,validateStep:r,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{var F,ne;const[c,d]=q.useState([]),[f,p]=q.useState(!1),[v,m]=q.useState(null),{formRef:N,scrollToForm:_}=Zo(f,"inventory-step-form");q.useEffect(()=>{f&&_()},[f,_]);const[k,y]=q.useState({}),[b,j]=q.useState({name:"",type:"",expiryDate:"",position:"",allergens:[]}),C=()=>{var W;return(W=t.conservation)!=null&&W.points&&t.conservation.points.length>0?t.conservation.points:[{id:1,name:"Frigo A",minTemp:2,maxTemp:4},{id:2,name:"Freezer",minTemp:-18,maxTemp:-15},{id:3,name:"Abbattitore",minTemp:0,maxTemp:3}]};q.useEffect(()=>{var ue,P;let W=[];if((ue=t.products)!=null&&ue.productsList&&t.products.productsList.length>0?W=t.products.productsList:(P=t.inventory)!=null&&P.products&&t.inventory.products.length>0&&(W=t.inventory.products),W.length>0){const Q=W.map(G=>!G.compliance&&G.type&&G.position?{...G,compliance:z(G.type,G.position)}:G);d(Q)}},[]),q.useEffect(()=>{var W;if(c.length>0&&((W=t.conservation)!=null&&W.points)&&c.some(P=>P.type&&P.position&&!P.compliance)){const P=c.map(Q=>Q.type&&Q.position&&!Q.compliance?{...Q,compliance:z(Q.type,Q.position)}:Q);d(P)}},[(F=t.conservation)==null?void 0:F.points]),q.useEffect(()=>{e(W=>({...W,products:{productsList:c,count:c.length}}))},[c,e]);const B=["Latticini e Formaggi","Carni Fresche","Pesce e Frutti di Mare","Verdure e Ortaggi","Frutta","Prodotti da Forno","Bevande","Altro"],K=[{id:"glutine",name:"Glutine",icon:""},{id:"latte",name:"Latte",icon:""},{id:"uova",name:"Uova",icon:""},{id:"pesce",name:"Pesce",icon:""},{id:"crostacei",name:"Crostacei",icon:""},{id:"frutta_secca",name:"Frutta a guscio",icon:""},{id:"arachidi",name:"Arachidi",icon:""},{id:"soia",name:"Soia",icon:""},{id:"sedano",name:"Sedano",icon:""},{id:"senape",name:"Senape",icon:""},{id:"sesamo",name:"Sesamo",icon:""},{id:"solfiti",name:"Solfiti",icon:""},{id:"lupini",name:"Lupini",icon:""},{id:"molluschi",name:"Molluschi",icon:""}],Z=()=>{j({name:"",type:"",expiryDate:"",position:"",allergens:[]}),m(null)},z=q.useCallback((W,ue)=>{const P=C().find(Q=>Q.id===parseInt(ue)||Q.name===ue);return P?W==="Latticini e Formaggi"&&(P.minTemp>5||P.maxTemp>5)?{compliant:!1,message:"Temperatura troppo alta per latticini"}:W==="Carni Fresche"&&(P.minTemp>7||P.maxTemp>7)?{compliant:!1,message:"Temperatura troppo alta per carni fresche"}:W==="Pesce e Frutti di Mare"&&(P.minTemp>2||P.maxTemp>2)?{compliant:!1,message:"Temperatura troppo alta per pesce"}:{compliant:!0,message:"Posizione conforme HACCP per questo tipo di prodotto"}:{compliant:!1,message:"Posizione non valida"}},[(ne=t.conservation)==null?void 0:ne.points]),J=()=>{if(b.name&&b.type&&b.expiryDate&&b.position){const W=z(b.type,b.position);if(v)d(ue=>ue.map(P=>P.id===v?{...P,...b,compliance:W}:P));else{const ue={id:Date.now(),...b,compliance:W};d(P=>[...P,ue])}Z(),p(!1)}},te=W=>{d(ue=>ue.filter(P=>P.id!==W))},I=W=>{const ue=c.find(P=>P.id===W);ue&&(j({name:ue.name,type:ue.type,expiryDate:ue.expiryDate,position:ue.position,allergens:ue.allergens||[]}),m(W),p(!0))},A=W=>{j(ue=>({...ue,allergens:ue.allergens.includes(W)?ue.allergens.filter(P=>P!==W):[...ue.allergens,W]}))},T=c.length>0&&c.every(W=>W.name&&W.type&&W.expiryDate&&W.position);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Inventario Prodotti"}),s.jsx("p",{className:"text-gray-600",children:"Gestisci prodotti e allergeni"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Prodotti nell'Inventario"}),s.jsxs(le,{onClick:()=>{Z(),p(!0)},variant:"outline",size:"sm",children:[s.jsx(pr,{className:"h-4 w-4 mr-1"}),"Aggiungi Prodotto"]})]}),f&&s.jsxs("div",{ref:N,id:"inventory-step-form",className:"border rounded-lg p-4 bg-white mb-6",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:v?"Modifica Prodotto":"Aggiungi Nuovo Prodotto"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"name",children:"Nome Prodotto *"}),s.jsx(bt,{id:"name",value:b.name,onChange:W=>{j(ue=>({...ue,name:W.target.value})),a(n)},placeholder:"Es. Mozzarella, Prosciutto, Pomodori",className:"mt-1"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"type",children:"Tipo Prodotto *"}),s.jsxs("select",{id:"type",value:b.type,onChange:W=>{j(ue=>({...ue,type:W.target.value})),a(n)},className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Seleziona tipo"}),B.map(W=>s.jsx("option",{value:W,children:W},W))]})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"expiryDate",children:"Data di Scadenza *"}),s.jsx(bt,{id:"expiryDate",type:"date",value:b.expiryDate,onChange:W=>{j(ue=>({...ue,expiryDate:W.target.value})),a(n)},className:"mt-1"})]}),s.jsxs("div",{children:[s.jsx(Je,{htmlFor:"position",children:"Posizione di Conservazione *"}),s.jsxs("select",{id:"position",value:b.position,onChange:W=>{j(ue=>({...ue,position:W.target.value})),a(n)},className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Seleziona posizione"}),C().map(W=>s.jsxs("option",{value:W.id,children:[W.name," (",W.targetTemp,"C)"]},W.id))]})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx(Je,{children:"Allergeni"}),s.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-2",children:K.map(W=>s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:b.allergens.includes(W.id),onChange:()=>A(W.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsxs("span",{className:"text-sm",children:[W.icon," ",W.name]})]},W.id))})]})]}),b.type&&b.position&&s.jsxs("div",{className:"mt-4 p-3 rounded-lg bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(pn,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium",children:"Validazione HACCP:"})]}),(()=>{const W=z(b.type,b.position);return s.jsxs("div",{className:`mt-2 flex items-center gap-2 ${W.compliant?"text-green-600":"text-red-600"}`,children:[W.compliant?"":"",s.jsx("span",{className:"text-sm",children:W.message})]})})()]}),s.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[s.jsx(le,{variant:"outline",onClick:()=>{p(!1),Z()},children:"Annulla"}),s.jsx(le,{onClick:J,disabled:!b.name||!b.type||!b.expiryDate||!b.position,children:v?"Salva Modifiche":"Aggiungi Prodotto"})]})]}),c.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Vn,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"Nessun prodotto registrato"}),s.jsx("p",{className:"text-sm",children:'Clicca "Aggiungi Prodotto" per iniziare'})]}):s.jsx("div",{className:"space-y-3",children:c.map(W=>{var ue,P,Q;return s.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[s.jsx("h5",{className:"font-medium",children:W.name}),s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:W.type})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Scadenza:"}),s.jsx("p",{className:"font-medium",children:W.expiryDate})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Posizione:"}),s.jsx("p",{className:"font-medium",children:W.position})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Allergeni:"}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:W.allergens.map(G=>{const de=K.find(w=>w.id===G);return de?s.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:[de.icon," ",de.name]},G):null})})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"HACCP:"}),s.jsxs("div",{className:`flex items-center gap-1 ${(ue=W.compliance)!=null&&ue.compliant?"text-green-600":"text-red-600"}`,children:[(P=W.compliance)!=null&&P.compliant?"":"",s.jsx("span",{className:"text-xs",children:((Q=W.compliance)==null?void 0:Q.message)||"Non validato"})]})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(le,{onClick:()=>I(W.id),variant:"outline",size:"sm",className:"text-blue-600 hover:text-blue-700",title:"Modifica prodotto",children:s.jsx(wi,{className:"h-4 w-4"})}),s.jsx(le,{onClick:()=>te(W.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",title:"Elimina prodotto",children:s.jsx(un,{className:"h-4 w-4"})})]})]})},W.id)})})]}),s.jsx("div",{className:`p-4 rounded-lg ${T?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${T?"bg-green-500":"bg-yellow-500"} text-white text-sm font-bold`,children:c.length}),s.jsxs("div",{children:[T&&s.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),s.jsxs("p",{className:`font-medium ${T?"text-green-900":"text-yellow-900"}`,children:["Prodotti registrati: ",c.length]}),s.jsx("p",{className:`text-sm ${T?"text-green-800":"text-yellow-800"}`,children:T?" Tutti i prodotti hanno i campi obbligatori compilati!":" Devi registrare almeno un prodotto con tutti i campi obbligatori."})]})]})}),Object.keys(k).length>0&&s.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"text-sm text-red-800",children:[s.jsx("p",{className:"font-medium",children:" Errori di validazione:"}),Object.entries(k).map(([W,ue])=>s.jsxs("p",{children:[" ",ue]},W))]})})]})},BP=(t,e)=>{if(typeof t=="string"&&t.includes("Ambiente"))return e.includes("dry_goods")?{compliant:!0,message:"Temperatura ambiente valida per Dispensa Secca"}:{compliant:!1,message:'Per temperatura ambiente seleziona solo "Dispensa Secca"'};const n=parseFloat(t);if(isNaN(n))return{compliant:!1,message:"Temperatura non valida"};if(e.length>0){const r=Jn.tolerance;let i=!1;for(let l=0;l<e.length;l++){for(let c=l+1;c<e.length;c++){const d=Jn.categories.find(p=>p.id===e[l]),f=Jn.categories.find(p=>p.id===e[c]);if(d&&f){const p=d.minTemp-r,v=d.maxTemp+r,m=f.minTemp-r,N=f.maxTemp+r;if(v<m||N<p){i=!0;break}}}if(i)break}if(i)return{compliant:!1,message:"Categorie incompatibili selezionate"};let a=!0,o=!0;for(const l of e){const c=Jn.categories.find(d=>d.id===l);if(c){const d=n>=c.minTemp&&n<=c.maxTemp,f=c.minTemp-r,p=c.maxTemp+r,v=n>=f&&n<=p;d||(a=!1),v||(o=!1)}}return a?{compliant:!0,message:"Conforme HACCP"}:o?{compliant:!0,message:"Temperatura impostata entro i limiti accettabili (0,5C di differenza)"}:{compliant:!1,message:"Fuori range HACCP per le categorie selezionate"}}return{compliant:!0,message:"Conforme HACCP"}},Ma=[{id:"business",title:"Informazioni Attivit",description:"Configura i dati base della tua attivit",icon:Wa,component:oA},{id:"departments",title:"Reparti",description:"Organizza la struttura operativa",icon:Wa,component:lA},{id:"staff",title:"Staff e Ruoli",description:"Registra il personale e assegna responsabilit",icon:Er,component:cA},{id:"conservation",title:"Punti di Conservazione",description:"Configura frigoriferi e aree di stoccaggio",icon:ws,component:uA},{id:"tasks",title:"Mansioni e Attivit",description:"Assegna compiti al personale",icon:P5,component:FP},{id:"inventory",title:"Inventario Prodotti",description:"Gestisci prodotti e allergeni",icon:Vn,component:$P}];function qP({isOpen:t,onClose:e,onComplete:n}){const[r,i]=q.useState(0),a=G=>{De(` setCurrentStep chiamato: ${r}  ${G}`),De(" Stack trace:",new Error().stack),i(G)},[o,l]=q.useState(new Set),[c,d]=q.useState(new Set),[f,p]=q.useState({business:{},departments:{},staff:{},conservation:{},tasks:{},inventory:{}}),{alertModal:v,confirmModal:m,promptModal:N,closeAlert:_,closeConfirm:k,closePrompt:y,alertSuccess:b,alertError:j,alertWarning:C,confirmDelete:B,confirmAction:K}=md(),Z=(G,de)=>{var O,R,H,re,oe,fe,be,ze,Le,Fe,Me,tt,Ce,ie,pt,dt,Ge,Qe,st,ae,Ae,Re,he,Ne;const w={};if(G===0&&((R=(O=de.business)==null?void 0:O.companyName)!=null&&R.trim()||(w.businessName="Il nome attivit  obbligatorio"),(re=(H=de.business)==null?void 0:H.address)!=null&&re.trim()||(w.address="L'indirizzo  obbligatorio"),(fe=(oe=de.business)==null?void 0:oe.email)!=null&&fe.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(de.business.email)||(w.email="Inserisci una email valida (formato: nome@dominio.com)"):w.email="L'email  obbligatoria",(ze=(be=de.business)==null?void 0:be.companyName)!=null&&ze.trim()&&de.business.companyName.trim().length<3&&(w.businessName="Il nome attivit deve essere di almeno 3 caratteri"),(Fe=(Le=de.business)==null?void 0:Le.address)!=null&&Fe.trim()&&de.business.address.trim().length<10&&(w.address="L'indirizzo deve essere di almeno 10 caratteri"),(tt=(Me=de.business)==null?void 0:Me.companyName)!=null&&tt.trim()&&de.business.companyName.trim().toLowerCase().length<3&&(w.businessName="Il nome attivit deve essere di almeno 3 caratteri"),!((ie=(Ce=de.business)==null?void 0:Ce.phone)!=null&&ie.trim())&&!((dt=(pt=de.business)==null?void 0:pt.email)!=null&&dt.trim())&&(w.contactInfo="Devi fornire almeno un metodo di contatto (telefono o email)")),G===1){const ce=(((Ge=de.departments)==null?void 0:Ge.list)||[]).filter(pe=>pe.enabled);if(ce.length<1)w.departments="Devi attivare almeno 1 reparto per procedere";else{ce.forEach((ye,Ze)=>{var Be;(!((Be=ye.name)!=null&&Be.trim())||ye.name.trim().length<2)&&(w[`department_${Ze}_name`]="Nome reparto deve essere di almeno 2 caratteri")});const pe=ce.map(ye=>ye.name.toLowerCase().trim()),ke=new Set(pe);pe.length!==ke.size&&(w.departmentNames="I nomi dei reparti devono essere unici")}}if(G===2){const He=((Qe=de.staff)==null?void 0:Qe.staffMembers)||[];if(He.length===0)w.staff="Devi aggiungere almeno un membro dello staff";else{He.forEach((ke,ye)=>{var Be;(Be=ke.fullName)!=null&&Be.trim()?ke.fullName.trim().length<3&&(w[`staff_${ye}_name`]="Nome deve essere di almeno 3 caratteri"):w[`staff_${ye}_name`]="Nome obbligatorio",ke.role?["Amministratore","Responsabile","Dipendente","Collaboratore Occasionale / Part-time"].includes(ke.role)||(w[`staff_${ye}_role`]="Ruolo non valido - seleziona un ruolo valido"):w[`staff_${ye}_role`]="Ruolo obbligatorio";const Ze=ke.categories&&ke.categories.length>0?ke.categories:ke.category?[ke.category]:[];if(Ze.length===0)w[`staff_${ye}_category`]="Categoria obbligatoria";else{const ut=["Cuochi","Banconisti","Camerieri","Social & Media Manager","Amministratore","Altro"];Ze.forEach(it=>{ut.includes(it)||(w[`staff_${ye}_category`]="Categoria non valida - seleziona una categoria valida")})}});const ce=He.map(ke=>ke.fullName.toLowerCase().trim()),pe=new Set(ce);ce.length!==pe.size&&(w.staffNames="I nomi dei membri dello staff devono essere unici")}}if(G===3){const He=((st=de.conservation)==null?void 0:st.points)||[];if(De(" OnboardingWizard: Validating step 3 (Conservation)"),De(" OnboardingWizard: data.conservation:",de.conservation),De(" OnboardingWizard: conservationPoints:",He),He.length===0)De(" OnboardingWizard: No conservation points found, adding error"),w.conservation="Devi aggiungere almeno un punto di conservazione";else{He.forEach((ke,ye)=>{var Ze,Be;if((Ze=ke.name)!=null&&Ze.trim()?ke.name.trim().length<2&&(w[`conservation_${ye}_name`]="Nome deve essere di almeno 2 caratteri"):w[`conservation_${ye}_name`]="Nome obbligatorio",ke.location?(((Be=de.departments)==null?void 0:Be.list)||[]).find(gt=>gt.name===ke.location&&gt.enabled)||(w[`conservation_${ye}_location`]="Posizione non valida - seleziona un reparto attivo"):w[`conservation_${ye}_location`]="Posizione obbligatoria",!ke.targetTemp)w[`conservation_${ye}_temperature`]="Temperatura target obbligatoria";else if(typeof ke.targetTemp=="string"&&ke.targetTemp.includes("Ambiente"))De(" Ambiente temperature detected, skipping numeric validation");else{const ut=parseFloat(ke.targetTemp);isNaN(ut)&&(w[`conservation_${ye}_temperature`]="Temperatura non valida")}if(!ke.selectedCategories||ke.selectedCategories.length===0)w[`conservation_${ye}_categories`]="Categorie prodotti obbligatorie";else{const ut=["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","frozen","deep_frozen","dry_goods","hot_holding","chilled_ready","fresh_beverages"];if(ke.selectedCategories.forEach(it=>{ut.includes(it)||(w[`conservation_${ye}_categories`]="Categoria non valida - seleziona categorie valide")}),ke.targetTemp&&ke.selectedCategories.length>0){const it=BP(ke.targetTemp,ke.selectedCategories);it.compliant||(w[`conservation_${ye}_haccp`]=`Non conforme HACCP: ${it.message}. La temperatura deve essere compatibile con TUTTE le categorie selezionate.`)}}});const ce=He.map(ke=>ke.name.toLowerCase().trim()),pe=new Set(ce);ce.length!==pe.size&&(w.conservationNames="I nomi dei punti di conservazione devono essere unici")}}if(G===4){const He=((ae=de.tasks)==null?void 0:ae.list)||[],ce=de.savedMaintenances||[],pe=((Ae=de.conservation)==null?void 0:Ae.points)||[];De(" OnboardingWizard Step 4 Validation:"),De(" tasksList:",He.length,"tasks"),De(" savedMaintenances:",ce.length,"groups"),De(" conservationPoints:",pe.length);const ke=ce.flatMap(Be=>Be.tasks).filter(Be=>Be.task_type==="temperature_monitoring"),ye=ke.length>=pe.length,Ze=He.length>0;if(De(" Maintenance validation:"),De(" temperatureMaintenances:",ke.length),De(" conservationPoints:",pe.length),De(" hasAllMaintenanceTasks:",ye),De(" hasGeneralTasks:",Ze),!ye&&!Ze?w.tasks="Devi configurare le manutenzioni per tutti i punti di conservazione e aggiungere almeno un'attivit generale":ye?Ze?De(" Step 4 validation passed!"):w.tasks="Devi aggiungere almeno un'attivit generale":w.tasks="Devi configurare le manutenzioni per tutti i punti di conservazione",He.length>0){He.forEach((it,gt)=>{var Vt;(Vt=it.name)!=null&&Vt.trim()?it.name.trim().length<5&&(w[`task_${gt}_name`]="Nome attivit deve essere di almeno 5 caratteri"):w[`task_${gt}_name`]="Nome attivit obbligatorio",it.assignedRole||(w[`task_${gt}_assigned`]="Assegnazione obbligatoria"),it.frequency?["Giornalmente","Settimanalmente","Mensilmente","Annualmente"].includes(it.frequency)||(w[`task_${gt}_frequency`]="Frequenza non valida - seleziona una frequenza valida"):w[`task_${gt}_frequency`]="Frequenza obbligatoria"});const Be=He.map(it=>it.name.toLowerCase().trim()),ut=new Set(Be);if(De(" Debug nomi attivit generali:"),De(" taskNames (generiche):",Be),De(" uniqueTaskNames:",Array.from(ut)),De(" taskNames.length:",Be.length),De(" uniqueTaskNames.size:",ut.size),Be.length!==ut.size){De(" NOMI DUPLICATI TROVATI NELLE ATTIVIT GENERALI!");const it=Be.filter((gt,Vt)=>Be.indexOf(gt)!==Vt);De(" Duplicati:",it),w.taskNames="I nomi delle attivit generali devono essere unici"}}}if(G===5){const He=((Re=de.products)==null?void 0:Re.productsList)||((he=de.inventory)==null?void 0:he.products)||[];if(De(" OnboardingWizard: Validating step 5 (Inventory)"),De(" OnboardingWizard: data.products:",de.products),De(" OnboardingWizard: productsList:",He),He.length===0)De(" OnboardingWizard: No products found, adding error"),w.inventory="Devi aggiungere almeno un prodotto";else{He.forEach((ye,Ze)=>{var Be;if((Be=ye.name)!=null&&Be.trim()?ye.name.trim().length<2&&(w[`product_${Ze}_name`]="Nome prodotto deve essere di almeno 2 caratteri"):w[`product_${Ze}_name`]="Nome prodotto obbligatorio",ye.type?["Latticini e Formaggi","Carni Fresche","Pesce e Frutti di Mare","Verdure e Ortaggi","Frutta","Prodotti da Forno","Bevande","Altro"].includes(ye.type)||(w[`product_${Ze}_type`]="Tipologia non valida - seleziona una tipologia valida"):w[`product_${Ze}_type`]="Tipologia obbligatoria",!ye.expiryDate)w[`product_${Ze}_expiry`]="Data scadenza obbligatoria";else{const ut=new Date(ye.expiryDate),it=new Date;it.setHours(0,0,0,0),ut<it&&(w[`product_${Ze}_expiry`]="La data di scadenza deve essere nel futuro")}ye.position||(w[`product_${Ze}_position`]="Posizione obbligatoria")});const ce=((Ne=de.conservation)==null?void 0:Ne.points)||[];ce.length===0?w.conservationRequired="Devi prima configurare i punti di conservazione per assegnare i prodotti":He.forEach((ye,Ze)=>{ce.find(ut=>ut.id===parseInt(ye.position)||ut.name===ye.position)||(w[`product_${Ze}_position`]="Posizione non valida - seleziona un punto di conservazione esistente")});const pe=He.map(ye=>ye.name.toLowerCase().trim()),ke=new Set(pe);pe.length!==ke.size&&(w.productNames="I nomi dei prodotti devono essere unici")}}return w},z=G=>{var O,R,H,re,oe;const de=Z(G,f),w=Object.keys(de).length===0;if(G===4&&(De(" DEBUG PULSANTE AVANTI - Step 4 (Mansioni e Attivit):"),De(" errors:",de),De(" errors.length:",Object.keys(de).length),De(" isValid:",w),De(" formData.tasks:",f.tasks),De(" formData.savedMaintenances:",f.savedMaintenances),De(" formData.conservation:",f.conservation),Object.keys(de).length>0&&(De(" ERRORI DETTAGLIATI STEP 4:"),Object.entries(de).forEach(([fe,be])=>{De(` ${fe}: ${be}`)}))),G===3&&(De(" DEBUG PULSANTE AVANTI - Step 3 (Punti di Conservazione):"),De(" errors:",de),De(" errors.length:",Object.keys(de).length),De(" isValid:",w),De(" formData.conservation:",f.conservation),De(" conservation.points:",(O=f.conservation)==null?void 0:O.points),De(" conservation.count:",(R=f.conservation)==null?void 0:R.count),Object.keys(de).length>0&&(De(" ERRORI DETTAGLIATI:"),Object.entries(de).forEach(([fe,be])=>{De(` ${fe}: ${be}`)}),(re=(H=f.conservation)==null?void 0:H.points)!=null&&re[0]))){const fe=f.conservation.points[0];De(" PUNTO DI CONSERVAZIONE DETTAGLIATO:"),De(" point.name:",fe.name),De(" point.location:",fe.location),De(" point.targetTemp:",fe.targetTemp),De(" point.selectedCategories:",fe.selectedCategories),De(" point.selectedCategories type:",typeof fe.selectedCategories),De(" point.selectedCategories length:",(oe=fe.selectedCategories)==null?void 0:oe.length);const be=["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","frozen","deep_frozen","dry_goods","hot_holding","chilled_ready","fresh_beverages"];De(" CATEGORIE VALIDE:",be),De(" CATEGORIE SELEZIONATE:",fe.selectedCategories),fe.selectedCategories.forEach((ze,Le)=>{const Fe=be.includes(ze);De(` Categoria ${Le}: "${ze}" - ${Fe?"VALIDA":"NON VALIDA"}`)})}return w},J=G=>{const de=Z(G,f);return Object.keys(de).length===0},te=G=>c.has(G),I=G=>(De(` confirmStep chiamato per step ${G}`),De(` Stato prima: currentStep=${r}, confirmedSteps=${Array.from(c)}`),z(G)?(De(` Step ${G} valido, marcando come confermato`),d(de=>new Set([...de,G])),De(` Step ${G} confermato con successo`),!0):(De(` Step ${G} non valido`),!1)),A=G=>{d(de=>{const w=new Set(de);return w.delete(G),w})},T=()=>{const G={currentStep:r,completedSteps:Array.from(o),confirmedSteps:Array.from(c),formData:f,lastActivity:new Date().toISOString()};localStorage.setItem("haccp-onboarding-new",JSON.stringify(G))},F=G=>{De(` goToStep chiamato per step ${G}`),G>=0&&G<Ma.length?(a(G),T(),De(` Navigazione diretta completata a step ${G+1}`)):De(` Step ${G} non valido`)},ne=()=>{var G,de;if(De(" nextStep chiamato"),De(` Stato: currentStep=${r}`),r<Ma.length-1){const w=Z(r,f);Object.keys(w).length===0?(De(` Step ${r} valido, navigando al prossimo`),l(O=>new Set([...O,r])),d(O=>new Set([...O,r])),a(r+1),T(),De(` Navigazione completata a step ${r+1}`)):(De(` Step ${r} non valido:`,w),De(" Errori dettagliati:",Object.entries(w).map(([O,R])=>`${O}: ${R}`)),De(" Errori completi:",w),De(` FormData per step ${r}:`,f),r===3&&(De(" DEBUG STEP 3 (Punti di Conservazione):"),De(" data.conservation:",f.conservation),De(" conservation.points:",(G=f.conservation)==null?void 0:G.points),De(" conservation.count:",(de=f.conservation)==null?void 0:de.count)),j(`Ci sono errori di validazione:
${Object.values(w).join(`
`)}`))}else De(" Ultimo step raggiunto, navigazione non possibile")},W=()=>{r>0&&(a(r-1),T())},ue=()=>{const G=Z(r,f);Object.keys(G).length===0?(De(" Ultimo step valido, completando onboarding"),l(de=>new Set([...de,r])),T(),n&&n(f)):(De(" Ultimo step non valido:",G),j(`Ci sono errori di validazione:
${Object.values(G).join(`
`)}`))};if(Zs.useEffect(()=>{const G=localStorage.getItem("haccp-onboarding-new");if(G)try{const de=JSON.parse(G);a(de.currentStep||0),l(new Set(de.completedSteps||[])),d(new Set(de.confirmedSteps||[])),p(de.formData||f)}catch(de){rd("Errore nel caricamento progresso onboarding:",de)}},[]),!t)return null;const P=Ma[r].component,Q=r===Ma.length-1;return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"p-6 border-b",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Configurazione Iniziale HACCP"}),s.jsx(le,{variant:"outline",onClick:e,children:"Chiudi"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[s.jsxs("span",{children:["Progresso: ",Math.round(Math.min(o.size/Ma.length*100,100)),"%"]}),s.jsxs("span",{children:["Step ",r+1," di ",Ma.length]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(o.size/Ma.length*100,100)}%`}})})]}),s.jsx("div",{className:"mt-4",children:s.jsx(aA,{currentStep:r,completedSteps:o,onStepClick:F,steps:Ma})})]}),s.jsx("div",{className:"p-6",children:s.jsx(P,{formData:f,setFormData:p,currentStep:r,setCurrentStep:a,onComplete:n,validateStep:Z,confirmStep:I,markStepAsUnconfirmed:A,isStepConfirmed:te,canConfirmStep:J})}),s.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-between",children:[s.jsxs(le,{variant:"outline",onClick:W,disabled:r===0,children:[s.jsx(N4,{className:"h-4 w-4 mr-2"}),"Precedente"]}),s.jsx("div",{className:"flex gap-2",children:Q?s.jsxs(le,{onClick:ue,className:"bg-green-600 hover:bg-green-700",children:[s.jsx(kn,{className:"h-4 w-4 mr-2"}),"Completa Configurazione"]}):s.jsxs(le,{onClick:ne,disabled:!z(r),className:`${z(r)?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:["Avanti",s.jsx(k5,{className:"h-4 w-4 ml-2"})]})})]}),s.jsx(pd,{isOpen:v.isOpen,onClose:_,title:v.title,message:v.message,type:v.type,confirmText:v.confirmText,onConfirm:v.onConfirm}),s.jsx(gd,{isOpen:m.isOpen,onClose:k,title:m.title,message:m.message,type:m.type,confirmText:m.confirmText,cancelText:m.cancelText,onConfirm:m.onConfirm,onCancel:m.onCancel}),s.jsx(vd,{isOpen:N.isOpen,onClose:y,title:N.title,message:N.message,placeholder:N.placeholder,defaultValue:N.defaultValue,type:N.type,confirmText:N.confirmText,cancelText:N.cancelText,validation:N.validation,onConfirm:N.onConfirm,onCancel:N.onCancel})]})})}function UP({isOpen:t,onClose:e,missingRequirements:n=[],suggestions:r=[],onFixRequirement:i}){if(!t)return null;const a=o=>{i&&i(o),e()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:e}),s.jsxs("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl shadow-2xl transform transition-transform duration-300 ease-out",children:[s.jsx("div",{className:"flex justify-center pt-3 pb-2",children:s.jsx("div",{className:"w-12 h-1 bg-gray-300 rounded-full"})}),s.jsx("div",{className:"px-6 pb-4 border-b",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(pn,{className:"h-6 w-6 text-orange-500"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Prerequisiti Richiesti"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Completa questi passaggi per accedere alla sezione"})]})]}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx(un,{className:"h-5 w-5"})})]})}),s.jsxs("div",{className:"px-6 py-4 max-h-96 overflow-y-auto",children:[s.jsx("div",{className:"space-y-4",children:n.map((o,l)=>{const c=r.find(d=>d.requirement===o);return s.jsx(ot,{className:"border-orange-200 bg-orange-50",children:s.jsx(et,{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:s.jsx("span",{className:"text-sm font-medium text-orange-600",children:l+1})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-orange-900 mb-2",children:(c==null?void 0:c.action)||`Completa ${o}`}),(c==null?void 0:c.description)&&s.jsx("p",{className:"text-sm text-orange-800 mb-3",children:c.description}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(le,{size:"sm",onClick:()=>a(o),className:"bg-orange-600 hover:bg-orange-700 text-white",children:[s.jsx(k5,{className:"h-4 w-4 mr-1"}),"Risolvi"]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-orange-700",children:[s.jsx(Qs,{className:"h-3 w-3"}),s.jsxs("span",{children:["Priorit: ",(c==null?void 0:c.priority)==="high"?"Alta":"Media"]})]})]})]})]})})},l)})}),s.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qs,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"Perch questi prerequisiti sono importanti?"}),s.jsx("p",{className:"text-sm text-blue-800",children:"I prerequisiti garantiscono che la tua struttura HACCP sia completa e funzionale. Ogni elemento contribuisce alla sicurezza alimentare e alla compliance normativa."})]})]})})]}),s.jsx("div",{className:"px-6 py-4 border-t bg-gray-50",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx(le,{variant:"outline",onClick:e,className:"flex-1",children:"Chiudi"}),s.jsxs(le,{onClick:()=>{i&&i("onboarding"),e()},className:"flex-1",children:[s.jsx(kn,{className:"h-4 w-4 mr-2"}),"Avvia Onboarding"]})]})})]})]})}const VP=({onResetApp:t,onOpenOnboarding:e,showResetApp:n=!1})=>s.jsxs("div",{className:"flex gap-2",children:[n&&s.jsxs(le,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Reset completo dell'app (solo sviluppo)",children:[s.jsx(L5,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Reset App"}),s.jsx("span",{className:"sm:hidden",children:"Reset"})]}),s.jsxs(le,{onClick:e,variant:"outline",size:"sm",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Riapri l'onboarding",children:[s.jsx(Er,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Riapri Onboarding"}),s.jsx("span",{className:"sm:hidden",children:"Onboarding"})]})]}),HP=({onPrefillOnboarding:t,onResetOnboarding:e,onCompleteOnboarding:n,isDevMode:r=!1})=>s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2 text-green-600 hover:text-green-700 hover:bg-green-50 flex-1 sm:flex-none",title:"Precompila onboarding con dati di test",children:[s.jsx(Er,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Precompila"}),s.jsx("span",{className:"sm:hidden",children:"Precompila"})]}),s.jsxs(le,{onClick:n,variant:"outline",size:"sm",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 flex-1 sm:flex-none",title:"Completa onboarding automaticamente",children:[s.jsx(kn,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Completa Onboarding"}),s.jsx("span",{className:"sm:hidden",children:"Completa"})]}),s.jsxs(le,{onClick:e,variant:"outline",size:"sm",className:"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50 flex-1 sm:flex-none",title:"Reset completo onboarding e app",children:[s.jsx(L5,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Reset Onboarding"}),s.jsx("span",{className:"sm:hidden",children:"Reset"})]})]}),GP=({onExportData:t,onImportData:e})=>s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(le,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(Ys,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Esporta"}),s.jsx("span",{className:"sm:hidden",children:"Export"})]}),s.jsxs("label",{className:"cursor-pointer",children:[s.jsx(le,{variant:"outline",size:"sm",className:"flex items-center gap-2",asChild:!0,children:s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Iu,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Importa"}),s.jsx("span",{className:"sm:hidden",children:"Import"})]})}),s.jsx("input",{type:"file",accept:".json",onChange:e,className:"hidden"})]})]});function WP(){var Re;const[t,e]=q.useState("dashboard"),[n,r]=q.useState([]),[i,a]=q.useState([]),[o,l]=q.useState([]),[c,d]=q.useState([]),[f,p]=q.useState([]),[v,m]=q.useState([]),[N,_]=q.useState([]),[k,y]=q.useState(null),[b,j]=q.useState([]),[C,B]=q.useState(!1),[K,Z]=q.useState(!0),[z,J]=q.useState(()=>{const he=localStorage.getItem("haccp-last-check");return he?JSON.parse(he):{}}),[te,I]=q.useState([]);q.useState(()=>localStorage.getItem("haccp-last-sync")||null);const[A,T]=q.useState(()=>localStorage.getItem("haccp-company-id")||"demo-pizzeria"),[F,ne]=q.useState(!1),[W,ue]=q.useState(!1),[P,Q]=q.useState(!1),[G,de]=q.useState({users:[],departments:[],refrigerators:[],staff:[],cleaning:[],inventory:[]}),w={isOnboardingComplete:!0,currentSectionAccess:{isEnabled:!0,message:null},missingRequirements:[],onboardingProgress:100,canAccessSection:()=>({isEnabled:!0,message:null}),areRequirementsMet:()=>!0,getMissingRequirements:()=>[],getNextOnboardingStep:()=>null,getOnboardingProgress:()=>100,validateField:()=>null,getEducationalMessage:()=>"",getSuggestions:()=>[],validateConservationPoint:()=>({isValid:!0,errors:[],warnings:[]}),getEducationalMessages:()=>[],onboardingStatus:{isComplete:!0,progress:100,nextStep:null},sectionAccess:{isEnabled:!0,message:null}},O=()=>{var Be,ut,it,gt,Vt;const he=JSON.parse(localStorage.getItem("haccp-users")||"[]");let Ne=[];const He=JSON.parse(localStorage.getItem("haccp-refrigerators")||"[]"),ce=JSON.parse(localStorage.getItem("haccp-staff")||"[]"),pe=JSON.parse(localStorage.getItem("haccp-cleaning")||"[]"),ke=JSON.parse(localStorage.getItem("haccp-products")||"[]");try{Ne=JSON.parse(localStorage.getItem("haccp-departments")||"[]")}catch(vt){console.warn("Errore nel parsing departments:",vt),Ne=[]}if(Ne.some(vt=>vt&&vt.name&&(vt.name==="Amministratori"||vt.name==="Responsabili"||vt.name==="Dipendenti"||vt.name==="Collaboratore Occasionale"||/^\d+$/.test(vt.name)||vt.name.length<3))||Ne.length===0){console.log(" Ricaricamento reparti dall'onboarding...");const vt=localStorage.getItem("haccp-onboarding-new")||localStorage.getItem("haccp-onboarding");if(vt)try{let Yt;if(typeof vt=="string")try{vt==="[object Object]"?(console.warn(" Dati corrotti rilevati, pulizia in corso..."),Yt={formData:{departments:{list:[]}}}):Yt=JSON.parse(vt)}catch{console.warn(" Errore parsing JSON, pulizia in corso..."),Yt={formData:{departments:{list:[]}}}}else Yt=vt;const Bt=((Be=Yt.departments)==null?void 0:Be.list)||((it=(ut=Yt.formData)==null?void 0:ut.departments)==null?void 0:it.list);Bt&&(Ne=Bt.filter(wt=>wt&&wt.enabled).map(wt=>({id:wt.id||Date.now()+Math.random(),name:wt.name||"Reparto non disponibile",enabled:!0,isCustom:wt.isCustom||!1,createdAt:new Date().toISOString()})),m(Ne),localStorage.setItem("haccp-departments",JSON.stringify(Ne)),console.log(" Reparti caricati:",Ne.length,"elementi"))}catch(Yt){console.warn("Errore nel caricamento reparti dall'onboarding:",Yt)}}const Ze=localStorage.getItem("haccp-onboarding-new");if(Ze)try{let vt;if(typeof Ze=="string")try{vt=JSON.parse(Ze)}catch(Bt){console.warn("Errore parsing JSON, usando oggetto vuoto:",Bt),vt={formData:{departments:{list:[]}}}}else vt=Ze;const Yt=(Vt=(gt=vt.formData)==null?void 0:gt.departments)==null?void 0:Vt.list;if(Yt&&Yt.length>0){const Bt=Yt.filter(wt=>wt&&wt.enabled).map(wt=>({id:wt.id||Date.now()+Math.random(),name:wt.name||"Reparto non disponibile",enabled:!0,isCustom:wt.isCustom||!1,createdAt:new Date().toISOString()}));(Ne.length===0||JSON.stringify(Ne)!==JSON.stringify(Bt))&&(m(Bt),localStorage.setItem("haccp-departments",JSON.stringify(Bt)),console.log(" Reparti precompilati caricati:",Bt))}}catch(vt){console.warn("Errore nel caricamento reparti precompilati:",vt)}de({users:he,departments:Ne,refrigerators:He,staff:ce,cleaning:pe,inventory:ke})},R=()=>{window.confirm(` ATTENZIONE: Questo canceller TUTTI i dati dell'app!

Sei sicuro di voler procedere?`)&&(localStorage.clear(),sessionStorage.clear(),localStorage.removeItem("haccp-onboarding"),localStorage.removeItem("haccp-onboarding-new"),window.location.reload())},H=()=>{console.log(" Precompilazione onboarding..."),localStorage.clear(),sessionStorage.clear(),localStorage.removeItem("haccp-onboarding"),localStorage.removeItem("haccp-onboarding-new"),localStorage.removeItem("haccp-departments"),localStorage.removeItem("haccp-staff"),localStorage.removeItem("haccp-refrigerators"),localStorage.removeItem("haccp-cleaning"),localStorage.removeItem("haccp-products"),localStorage.removeItem("haccp-temperatures"),localStorage.removeItem("haccp-product-labels"),localStorage.removeItem("haccp-users"),localStorage.removeItem("haccp-current-user");const he={business:{companyName:"Al Ritrovo SRL",address:"Via centotrecento 1/1b Bologna 40128",vatNumber:"001255668899101",email:"000@gmail.com",phone:"0511234567"},departments:{list:[{id:"cucina",name:"Cucina",description:"Area di preparazione e cottura",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Reparto principale",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"bancone",name:"Bancone",description:"Area di servizio e preparazione",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Area servizio",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"sala",name:"Sala",description:"Area di servizio clienti",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Area clienti",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"magazzino",name:"Magazzino",description:"Area di stoccaggio e conservazione",location:"Seminterrato",manager:"Matteo Cavallaro",notes:"Magazzino principale",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"magazzino-b",name:"Magazzino B",description:"Magazzino secondario",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Magazzino secondario",enabled:!0,isCustom:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"sala-b",name:"Sala B",description:"Sala secondaria",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Sala secondaria",enabled:!0,isCustom:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"}],enabledCount:6},staff:{staffMembers:[{id:"staff_001",name:"Matteo",surname:"Cavallaro",fullName:"Matteo Cavallaro",role:"Responsabile",categories:["Banconisti","Amministratore"],certification:"HACCP Avanzato",notes:"Responsabile generale",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")},{id:"staff_002",name:"Fabrizio",surname:"Dettori",fullName:"Fabrizio Dettori",role:"Responsabile",categories:["Amministratore","Camerieri"],certification:"HACCP Base",notes:"Responsabile sala e amministrazione",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")},{id:"staff_003",name:"Paolo",surname:"Dettori",fullName:"Paolo Dettori",role:"Amministratore",categories:["Amministratore","Cuochi"],certification:"HACCP Avanzato",notes:"Amministratore e responsabile cucina",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")},{id:"staff_004",name:"Eddy",surname:"TheQueen",fullName:"Eddy TheQueen",role:"Dipendente",categories:["Banconisti"],certification:"HACCP Base",notes:"Addetto bancone",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")},{id:"staff_005",name:"Elena",surname:"Guaitoli",fullName:"Elena Guaitoli",role:"Dipendente",categories:["Social & Media Manager","Banconisti"],certification:"HACCP Base",notes:"Social media e bancone",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")}]},conservation:{points:[{id:"conservation-1",name:"Frigo A",location:"Cucina",targetTemp:2,selectedCategories:["fresh_dairy","fresh_produce","fresh_meat"]},{id:"conservation-2",name:"Frigo Bancone 1",location:"Bancone",targetTemp:6,selectedCategories:["fresh_beverages","chilled_ready"]},{id:"conservation-3",name:"Frigo Bancone 2",location:"Bancone",targetTemp:5,selectedCategories:["fresh_beverages","chilled_ready"]},{id:"conservation-4",name:"Frigo Bancone 3",location:"Bancone",targetTemp:5,selectedCategories:["fresh_beverages","chilled_ready"]},{id:"conservation-5",name:"Frigo B",location:"Cucina",targetTemp:-18,selectedCategories:["frozen"]},{id:"conservation-6",name:"Frigo C",location:"Cucina",targetTemp:-22,selectedCategories:["deep_frozen"]},{id:"conservation-7",name:"Frigo D",location:"Cucina",targetTemp:-18,selectedCategories:["frozen"]}],count:7},tasks:{list:[{id:"task_001",name:"Carico Frigoriferi Bancone",assignedRole:"Banconisti",assignedEmployee:null,frequency:"Giornalmente"}],count:1},products:{productsList:[{id:"product_001",name:"Acqua nat 0,5",type:"Bevande",expiryDate:"2030-03-22",position:"Frigo A",allergens:[]}],count:1}},Ne={currentStep:0,completedSteps:[0,1,2,3,4,5],confirmedSteps:[0,1,2,3,4,5],formData:he,lastActivity:new Date().toISOString()};localStorage.setItem("haccp-onboarding-new",JSON.stringify(Ne));const He={id:"admin_001",name:"Admin",pin:"0000",role:"admin",department:"Amministrazione",createdAt:new Date().toISOString()};localStorage.setItem("haccp-users",JSON.stringify([He])),localStorage.setItem("haccp-current-user",JSON.stringify(He));const pe=[{id:"conservation-1_temperature_monitoring_001",conservation_point_id:"conservation-1",conservation_point_name:"Frigo A",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Responsabile",assigned_category:"Banconisti",assigned_staff_ids:["staff_001"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-1_sanitization_001",conservation_point_id:"conservation-1",conservation_point_name:"Frigo A",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["tuesday","thursday"],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-1_defrosting_001",conservation_point_id:"conservation-1",conservation_point_name:"Frigo A",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Semestrale (ogni 6 mesi)",selected_days:[],assigned_role:"Responsabile",assigned_category:"Amministratore",assigned_staff_ids:["staff_002"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-2_temperature_monitoring_001",conservation_point_id:"conservation-2",conservation_point_name:"Frigo Bancone 1",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Dipendente",assigned_category:"Banconisti",assigned_staff_ids:["staff_004"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-2_sanitization_001",conservation_point_id:"conservation-2",conservation_point_name:"Frigo Bancone 1",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["monday","wednesday"],assigned_role:"Dipendente",assigned_category:"Social & Media Manager",assigned_staff_ids:["staff_005"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-2_defrosting_001",conservation_point_id:"conservation-2",conservation_point_name:"Frigo Bancone 1",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Annuale",selected_days:[],assigned_role:"Dipendente",assigned_category:"Banconisti",assigned_staff_ids:["staff_004"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-3_temperature_monitoring_001",conservation_point_id:"conservation-3",conservation_point_name:"Frigo Bancone 2",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Responsabile",assigned_category:"Banconisti",assigned_staff_ids:["staff_001"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-3_sanitization_001",conservation_point_id:"conservation-3",conservation_point_name:"Frigo Bancone 2",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["friday"],assigned_role:"Dipendente",assigned_category:"Banconisti",assigned_staff_ids:["staff_004"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-3_defrosting_001",conservation_point_id:"conservation-3",conservation_point_name:"Frigo Bancone 2",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Annuale",selected_days:[],assigned_role:"Dipendente",assigned_category:"Social & Media Manager",assigned_staff_ids:["staff_005"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-4_temperature_monitoring_001",conservation_point_id:"conservation-4",conservation_point_name:"Frigo Bancone 3",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Dipendente",assigned_category:"Social & Media Manager",assigned_staff_ids:["staff_005"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-4_sanitization_001",conservation_point_id:"conservation-4",conservation_point_name:"Frigo Bancone 3",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["thursday"],assigned_role:"Responsabile",assigned_category:"Banconisti",assigned_staff_ids:["staff_001"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-4_defrosting_001",conservation_point_id:"conservation-4",conservation_point_name:"Frigo Bancone 3",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Annuale",selected_days:[],assigned_role:"Dipendente",assigned_category:"Banconisti",assigned_staff_ids:["staff_004"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-5_temperature_monitoring_001",conservation_point_id:"conservation-5",conservation_point_name:"Frigo B",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"custom_days",selected_days:["monday"],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-5_sanitization_001",conservation_point_id:"conservation-5",conservation_point_name:"Frigo B",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["monday","thursday"],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-5_defrosting_001",conservation_point_id:"conservation-5",conservation_point_name:"Frigo B",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Semestrale (ogni 6 mesi)",selected_days:[],assigned_role:"Responsabile",assigned_category:"Amministratore",assigned_staff_ids:["staff_002"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-6_temperature_monitoring_001",conservation_point_id:"conservation-6",conservation_point_name:"Frigo C",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-6_sanitization_001",conservation_point_id:"conservation-6",conservation_point_name:"Frigo C",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["wednesday"],assigned_role:"Responsabile",assigned_category:"Amministratore",assigned_staff_ids:["staff_002"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-6_defrosting_001",conservation_point_id:"conservation-6",conservation_point_name:"Frigo C",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Semestrale (ogni 6 mesi)",selected_days:[],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-7_temperature_monitoring_001",conservation_point_id:"conservation-7",conservation_point_name:"Frigo D",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-7_sanitization_001",conservation_point_id:"conservation-7",conservation_point_name:"Frigo D",task_type:"sanitization",task_name:"Sanificazione",frequency:"Settimanale",selected_days:[],assigned_role:"Dipendente",assigned_category:"Social & Media Manager",assigned_staff_ids:["staff_005"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-7_defrosting_001",conservation_point_id:"conservation-7",conservation_point_name:"Frigo D",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Annuale",selected_days:[],assigned_role:"Responsabile",assigned_category:"Amministratore",assigned_staff_ids:["staff_002"],is_active:!0,created_at:new Date().toISOString()}].map(ke=>({...ke,company_id:A}));localStorage.setItem("haccp-maintenance-tasks",JSON.stringify(pe)),console.log(" Onboarding precompilato:",{departments:6,staff:5,conservation:7,maintenance:pe.length,companyId:A}),alert(` Onboarding precompilato con successo!

Dati caricati:
- Al Ritrovo SRL
- 6 Reparti
- 5 Membri staff (Matteo, Fabrizio, Paolo, Eddy, Elena)
- 7 Punti di conservazione (Frigo A, Bancone 1-3, Frigo B-D)
- 21 Attivit di manutenzione preconfigurate
- 1 Attivit generica (Carico Frigoriferi Bancone)
- Acqua nat 0,5L

Clicca "Riapri Onboarding" per vedere i dati!`)},re=()=>{if(window.confirm(` ATTENZIONE: Questo canceller TUTTI i dati dell'onboarding e dell'app!

Sei sicuro di voler procedere?`)){localStorage.removeItem("haccp-onboarding"),localStorage.removeItem("haccp-onboarding-new"),localStorage.removeItem("haccp-departments"),localStorage.removeItem("haccp-staff"),localStorage.removeItem("haccp-refrigerators"),localStorage.removeItem("haccp-cleaning"),localStorage.removeItem("haccp-products"),localStorage.removeItem("haccp-users"),localStorage.removeItem("haccp-temperatures"),localStorage.removeItem("haccp-product-labels"),localStorage.removeItem("haccp-maintenance-tasks"),m([]),d([]),l([]),a([]),p([]),j([]),r([]),_([]),ue(!1),console.log(" Onboarding e app completamente resettati");const he=[{id:"admin-1",name:"Admin",pin:"0000",role:"admin",department:"Amministrazione",createdAt:new Date().toISOString(),isActive:!0}];localStorage.setItem("haccp-users",JSON.stringify(he)),localStorage.setItem("haccp-current-user",JSON.stringify(he[0])),console.log(" Dati di accesso ricreati: Admin / 0000"),window.location.reload()}},oe=()=>{var he,Ne,He,ce,pe,ke,ye,Ze,Be,ut,it,gt,Vt,vt,Yt,Bt;if(window.confirm(` Completa l'onboarding automaticamente?

Questo salver tutti i dati attuali come se l'onboarding fosse stato completato manualmente.`)){console.log(" Completamento onboarding automatico...");const wt=localStorage.getItem("haccp-onboarding-new");if(!wt){console.error(' Nessun dato di onboarding trovato! Esegui prima "Precompila" per creare i dati di test.'),alert(` Nessun dato di onboarding trovato!

Esegui prima "Precompila" per creare i dati di test.`);return}let Qt;try{Qt=JSON.parse(wt),console.log(" Dati onboarding caricati")}catch(fn){console.error(" Errore nel parsing dei dati onboarding:",fn),alert(" Errore nel caricamento dei dati di onboarding!");return}const Et=Qt.formData||{};console.log(" Stato app:",{user:(k==null?void 0:k.name)||"Nessuno",departments:v.length,staff:c.length,refrigerators:o.length,cleaning:i.length,products:f.length});const rt={business:Et.business||{name:"Azienda Configurata",address:"Indirizzo configurato",phone:"Telefono configurato",email:"email@azienda.com"},departments:Et.departments||{list:[]},conservation:Et.conservation||{points:[]},staff:Et.staff||{staffMembers:[]},tasks:Et.tasks||{list:[]},inventory:{products:((he=Et.products)==null?void 0:he.productsList)||[]}};console.log(" Dati onboarding creati:",{business:!!rt.business,departments:((He=(Ne=rt.departments)==null?void 0:Ne.list)==null?void 0:He.length)||0,conservation:((pe=(ce=rt.conservation)==null?void 0:ce.points)==null?void 0:pe.length)||0,staff:((ye=(ke=rt.staff)==null?void 0:ke.staffMembers)==null?void 0:ye.length)||0,tasks:((Be=(Ze=rt.tasks)==null?void 0:Ze.list)==null?void 0:Be.length)||0,products:((it=(ut=rt.inventory)==null?void 0:ut.products)==null?void 0:it.length)||0});try{const fn=((gt=Et.departments)==null?void 0:gt.list)||[],Ht=((Vt=Et.staff)==null?void 0:Vt.staffMembers)||[],nr=((vt=Et.conservation)==null?void 0:vt.points)||[],Sr=((Yt=Et.tasks)==null?void 0:Yt.list)||[],Nt=((Bt=Et.products)==null?void 0:Bt.productsList)||[];console.log(" Compliance:",{departments:fn.length,staff:Ht.length,conservation:nr.length,tasks:Sr.length,products:Nt.length})}catch(fn){console.error(" Errore nella verifica compliance:",fn)}try{ae(rt),console.log(" Onboarding completato con successo")}catch(fn){console.error(" Errore in handleOnboardingComplete:",fn),alert(" Errore durante il completamento dell'onboarding: "+fn.message);return}console.log(" Stato finale:",{onboardingCompleted:W,departments:JSON.parse(localStorage.getItem("haccp-departments")||"[]").length,staff:JSON.parse(localStorage.getItem("haccp-staff")||"[]").length,refrigerators:JSON.parse(localStorage.getItem("haccp-refrigerators")||"[]").length,cleaning:JSON.parse(localStorage.getItem("haccp-cleaning")||"[]").length,products:JSON.parse(localStorage.getItem("haccp-products")||"[]").length});const yt=localStorage.getItem("haccp-onboarding");if(yt)try{const fn=JSON.parse(yt);console.log(" Onboarding salvato correttamente con completed:",fn.completed)}catch(fn){console.error(" Errore nel parsing dell'onboarding salvato:",fn)}alert(` Onboarding completato automaticamente!

Tutti i dati sono stati migrati alle sezioni principali dell'app.`)}};q.useEffect(()=>{},[]),q.useEffect(()=>{const he=XC();Object.entries(he).forEach(([gt,Vt])=>{localStorage.getItem(gt)||localStorage.setItem(gt,Vt)}),eA(),O();const Ne=localStorage.getItem("haccp-temperatures"),He=localStorage.getItem("haccp-cleaning"),ce=localStorage.getItem("haccp-refrigerators"),pe=localStorage.getItem("haccp-staff"),ke=localStorage.getItem("haccp-products"),ye=localStorage.getItem("haccp-departments"),Ze=localStorage.getItem("haccp-product-labels"),Be=localStorage.getItem("haccp-users");localStorage.getItem("haccp-current-user");try{Ne&&r(JSON.parse(Ne)),He&&a(JSON.parse(He)),ce&&l(JSON.parse(ce)),pe&&d(JSON.parse(pe)),ke&&p(JSON.parse(ke)),ye&&m(JSON.parse(ye)),Ze&&_(JSON.parse(Ze))}catch(gt){console.warn("Errore nel parsing dei dati:",gt),localStorage.removeItem("haccp-temperatures"),localStorage.removeItem("haccp-cleaning"),localStorage.removeItem("haccp-refrigerators"),localStorage.removeItem("haccp-staff"),localStorage.removeItem("haccp-products"),localStorage.removeItem("haccp-departments"),localStorage.removeItem("haccp-product-labels")}if(Be)try{j(JSON.parse(Be))}catch(gt){console.warn("Errore nel parsing users:",gt),localStorage.removeItem("haccp-users")}else{const gt={id:"admin_001",name:"Admin",pin:"0000",role:"admin",department:"Amministrazione",createdAt:new Date().toISOString()};j([gt]),localStorage.setItem("haccp-users",JSON.stringify([gt]))}const ut=localStorage.getItem("haccp-show-chat-icon");if(ut!==null)try{Z(JSON.parse(ut))}catch(gt){console.warn("Errore nel parsing chat icon pref:",gt),localStorage.removeItem("haccp-show-chat-icon")}const it=gt=>{if(gt.key==="haccp-show-chat-icon")try{Z(JSON.parse(gt.newValue))}catch(Vt){console.warn("Errore nel parsing chat icon pref change:",Vt)}};return window.addEventListener("storage",it),()=>{window.removeEventListener("storage",it)}},[]),q.useEffect(()=>{},[f,n,i,c,N]),q.useEffect(()=>{localStorage.setItem("haccp-temperatures",JSON.stringify(n))},[n]),q.useEffect(()=>{localStorage.setItem("haccp-refrigerators",JSON.stringify(o))},[o]),q.useEffect(()=>{localStorage.setItem("haccp-cleaning",JSON.stringify(i))},[i]),q.useEffect(()=>{localStorage.setItem("haccp-staff",JSON.stringify(c))},[c]),q.useEffect(()=>{localStorage.setItem("haccp-products",JSON.stringify(f))},[f]),q.useEffect(()=>{localStorage.setItem("haccp-departments",JSON.stringify(v))},[v]),q.useEffect(()=>{localStorage.setItem("haccp-product-labels",JSON.stringify(N))},[N]);const fe=he=>{y(he),B(!1),localStorage.setItem("haccp-current-user",JSON.stringify(he));const Ne={id:Date.now(),timestamp:new Date().toISOString(),user:he.id,userName:he.name,type:"login",description:`Accesso di ${he.name}`};try{const He=JSON.parse(localStorage.getItem("haccp-actions")||"[]");He.push(Ne),localStorage.setItem("haccp-actions",JSON.stringify(He))}catch(He){console.warn("Errore nel parsing actions:",He),localStorage.removeItem("haccp-actions")}},be=()=>{const he={dashboard:0,cleaning:0,inventory:0,labels:0,staff:0,refrigerators:0},Ne=z.cleaning||"2000-01-01T00:00:00.000Z",He=i.filter(wt=>new Date(wt.createdAt||wt.timestamp)>new Date(Ne)).length;he.cleaning+=He;const ce=z.inventory||"2000-01-01T00:00:00.000Z",pe=new Date,ke=new Date(pe.getTime()+3*24*60*60*1e3),ye=new Date(pe.getTime()+4*24*60*60*1e3),Ze=f.filter(wt=>{const Qt=new Date(wt.expiryDate);return Qt>=ke&&Qt<=ye}).length,Be=f.filter(wt=>new Date(wt.createdAt||wt.addedDate)>new Date(ce)).length;he.inventory+=Ze+Be;const ut=z.labels||"2000-01-01T00:00:00.000Z",it=N.filter(wt=>new Date(wt.createdAt||"2000-01-01")>new Date(ut)).length;he.labels+=it;const gt=z.staff||"2000-01-01T00:00:00.000Z",Vt=c&&Array.isArray(c)?c.filter(wt=>wt&&new Date(wt.addedDate||wt.createdAt||"2000-01-01")>new Date(gt)).length:0;he.staff+=Vt;const vt=z.refrigerators||"2000-01-01T00:00:00.000Z",Yt=n.filter(wt=>{const Et=new Date(wt.timestamp)>new Date(vt),rt=wt.status==="warning"||wt.status==="danger";return Et&&rt}).length;he.refrigerators+=Yt;const Bt=f.filter(wt=>{const Qt=new Date(wt.expiryDate),Et=new Date;return Qt.setHours(0,0,0,0),Et.setHours(0,0,0,0),Qt.getTime()===Et.getTime()}).length;return he.dashboard=Bt+Yt,he},ze=he=>{const Ne={...z,[he]:new Date().toISOString()};J(Ne),localStorage.setItem("haccp-last-check",JSON.stringify(Ne))},Le=be(),Fe=({hasNotification:he,className:Ne=""})=>he?s.jsx("div",{className:`absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full ${Ne}`}):null,Me=(he,Ne,He=null)=>{const ce={id:He||`${he}_${Date.now()}`,type:he,data:Ne,timestamp:new Date().toISOString(),userId:k==null?void 0:k.id,userName:k==null?void 0:k.name};I(pe=>[...pe.filter(ye=>!(ye.type===he&&ye.id===ce.id)),ce])},tt=(he,Ne,He)=>{console.log(" TRACKING:",he,"with",(Ne==null?void 0:Ne.length)||0,"items"),Me(he,Ne,He)};q.useEffect(()=>{f.length>0&&k&&(console.log(" Products changed:",f.length,"items"),tt("inventory",f,"auto-inventory"))},[f,k]),q.useEffect(()=>{n.length>0&&k&&(console.log(" Temperatures changed:",n.length,"items"),tt("temperatures",n,"auto-temperatures"))},[n,k]),q.useEffect(()=>{i.length>0&&k&&(console.log(" Cleaning changed:",i.length,"items"),tt("cleaning",i,"auto-cleaning"))},[i,k]),q.useEffect(()=>{c.length>0&&k&&(console.log(" Staff changed:",c.length,"items"),tt("staff",c,"auto-staff"))},[c,k]),q.useEffect(()=>{console.log(" PENDING CHANGES:",te.length,te)},[te]);const Ce=()=>{if(k){const he={id:Date.now(),timestamp:new Date().toISOString(),user:k.id,userName:k.name,type:"logout",description:`Disconnessione di ${k.name}`};try{const Ne=JSON.parse(localStorage.getItem("haccp-actions")||"[]");Ne.push(he),localStorage.setItem("haccp-actions",JSON.stringify(Ne))}catch(Ne){console.warn("Errore nel parsing actions logout:",Ne),localStorage.removeItem("haccp-actions")}}y(null),e("dashboard"),localStorage.removeItem("haccp-current-user")},ie=he=>{const Ne={...he,id:`user_${Date.now()}`,createdAt:new Date().toISOString()},He=[...b,Ne];j(He),localStorage.setItem("haccp-users",JSON.stringify(He));const ce={id:`staff_${Date.now()}`,name:he.name,role:he.role==="admin"?"Amministratore":he.role==="dipendente"?"Dipendente":he.role==="responsabile"?"Responsabile":he.role==="collaboratore"?"Collaboratore Occasionale":"Dipendente",department:he.department||"Non assegnato",certification:"",notes:`Utente registrato il ${new Date().toLocaleDateString("it-IT")}`,addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT"),isRegisteredUser:!0,userId:Ne.id},pe=[...c,ce];d(pe),localStorage.setItem("haccp-staff",JSON.stringify(pe))},pt=()=>k&&k.role==="admin",Ge=(()=>{const he=n.filter(ke=>ke.status==="ok").length,Ne=n.filter(ke=>ke.status==="danger").length,He=i.filter(ke=>!ke.completed).length,ce=new Date,pe=f.filter(ke=>{const Ze=new Date(ke.expiryDate)-ce,Be=Math.ceil(Ze/(1e3*60*60*24));return Be<=7&&Be>=0}).length;return{temperatureOk:he,temperatureProblems:Ne,cleaningPending:He,expiringToday:pe}})(),Qe=()=>{const he={temperatures:n,cleaningTasks:i,staff:c,products:f,departments:v,productLabels:N,exportDate:new Date().toISOString()},Ne=new Blob([JSON.stringify(he,null,2)],{type:"application/json"}),He=URL.createObjectURL(Ne),ce=document.createElement("a");ce.href=He,ce.download=`haccp-data-${new Date().toISOString().split("T")[0]}.json`,ce.click(),URL.revokeObjectURL(He)},st=he=>{const Ne=he.target.files[0];if(!Ne)return;const He=new FileReader;He.onload=ce=>{try{const pe=JSON.parse(ce.target.result);pe.temperatures&&(r(pe.temperatures),localStorage.setItem("haccp-temperatures",JSON.stringify(pe.temperatures))),pe.cleaningTasks&&(a(pe.cleaningTasks),localStorage.setItem("haccp-cleaning",JSON.stringify(pe.cleaningTasks))),pe.staff&&(d(pe.staff),localStorage.setItem("haccp-staff",JSON.stringify(pe.staff))),pe.products&&(p(pe.products),localStorage.setItem("haccp-products",JSON.stringify(pe.products))),pe.departments&&(m(pe.departments),localStorage.setItem("haccp-departments",JSON.stringify(pe.departments))),pe.productLabels&&(_(pe.productLabels),localStorage.setItem("haccp-product-labels",JSON.stringify(pe.productLabels))),alert("Dati importati con successo!")}catch(pe){alert("Errore durante l'importazione del file"),console.error("Import error:",pe)}},He.readAsText(Ne)};q.useEffect(()=>{if(k&&!W){if(nA()){ue(!0);return}const he=localStorage.getItem("haccp-onboarding");if(he&&he!=="undefined"&&he!=="null"&&he!=="[object Object]")try{const Ne=JSON.parse(he);if(Ne&&typeof Ne=="object"&&Ne.completed){ue(!0);return}}catch(Ne){console.warn("Errore nel parsing onboarding:",Ne),localStorage.removeItem("haccp-onboarding")}ne(!0)}},[k,W]);const ae=he=>{var He,ce,pe,ke,ye;console.log(" ===== INIZIO handleOnboardingComplete ====="),console.log(" Dati ricevuti:",he),ne(!1),ue(!0);const Ne={...he,completed:!0,completedAt:new Date().toISOString()};if(localStorage.setItem("haccp-onboarding",JSON.stringify(Ne)),console.log(" Onboarding salvato in localStorage"),console.log(" INIZIO MIGRAZIONE DATI..."),he.business&&(localStorage.setItem("haccp-business-info",JSON.stringify(he.business)),console.log(" Business info salvata:",he.business)),(He=he.departments)!=null&&He.list){const Ze=he.departments.list.filter(Be=>Be&&Be.enabled).map(Be=>({id:Be.id||Date.now()+Math.random(),name:Be.name||"Reparto non disponibile",enabled:!0,isCustom:Be.isCustom||!1,createdAt:new Date().toISOString()}));console.log(" Dipartimenti da migrare:",Ze),m(Ze),localStorage.setItem("haccp-departments",JSON.stringify(Ze)),console.log(" Dipartimenti migrati e salvati")}else console.warn(" Nessun dipartimento da migrare");if((ce=he.staff)!=null&&ce.staffMembers){const Ze=he.staff.staffMembers.map(Be=>({...Be,id:Be.id||Date.now()+Math.random(),createdAt:new Date().toISOString()}));console.log(" Staff da migrare:",Ze),d(Ze),localStorage.setItem("haccp-staff",JSON.stringify(Ze)),console.log(" Staff migrato e salvato")}else console.warn(" Nessuno staff da migrare");if((pe=he.conservation)!=null&&pe.points){const Ze=he.conservation.points.map(Be=>({...Be,id:Be.id||Date.now()+Math.random(),createdAt:new Date().toISOString()}));console.log(" Punti conservazione da migrare:",Ze),l(Ze),localStorage.setItem("haccp-refrigerators",JSON.stringify(Ze)),console.log(" Punti conservazione migrati e salvati")}else console.warn(" Nessun punto di conservazione da migrare");if((ke=he.tasks)!=null&&ke.list){const Ze=he.tasks.list.map(Be=>({...Be,id:Be.id||Date.now()+Math.random(),createdAt:new Date().toISOString()}));console.log(" Attivit da migrare:",Ze),a(Ze),localStorage.setItem("haccp-cleaning",JSON.stringify(Ze)),console.log(" Attivit migrate e salvate")}else console.warn(" Nessuna attivit da migrare");if((ye=he.inventory)!=null&&ye.products){const Ze=he.inventory.products.map(Be=>({...Be,id:Be.id||Date.now()+Math.random(),createdAt:new Date().toISOString()}));console.log(" Prodotti da migrare:",Ze),p(Ze),localStorage.setItem("haccp-products",JSON.stringify(Ze)),console.log(" Prodotti migrati e salvati")}else console.warn(" Nessun prodotto da migrare");he.preset&&(localStorage.setItem("haccp-presets",JSON.stringify({selected:he.preset,applied:!0,appliedAt:new Date().toISOString()})),console.log(" Preset applicato:",he.preset)),console.log(" ===== FINE handleOnboardingComplete ====="),console.log(" MIGRAZIONE COMPLETATA - Tutti i dati sono stati salvati e gli stati aggiornati"),O()};q.useEffect(()=>{},[]);const Ae=he=>{if(he==="onboarding")ne(!0);else switch(he){case"departments":e("staff");break;case"refrigerators":e("refrigerators");break;case"staff":e("staff");break;default:e("dashboard")}};return k?s.jsx(N6,{children:s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(Jx,{}),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Business HACCP Manager"}),s.jsxs("p",{className:"text-gray-600",children:["Benvenuto, ",s.jsxs("span",{className:"font-['Dancing_Script'] font-semibold text-2xl text-purple-600",children:[k.name," - ",k.role==="admin"?"Admin":"Dipendente"]})]}),(()=>{var He;const he=localStorage.getItem("haccp-onboarding-new");if(!he||he==="[object Object]")return null;let Ne={};try{Ne=((He=JSON.parse(he).formData)==null?void 0:He.business)||{}}catch(ce){return console.error("Errore parsing onboarding data:",ce),null}return Ne.companyName?s.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[s.jsx("p",{className:"font-medium text-gray-900",children:Ne.companyName}),Ne.address&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Ne.address}),Ne.email&&s.jsx("p",{className:"text-xs text-gray-500",children:Ne.email}),Ne.phone&&s.jsx("p",{className:"text-xs text-gray-500",children:Ne.phone})]}):null})()]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[s.jsx(VP,{onResetApp:R,onOpenOnboarding:()=>ne(!0),showResetApp:!1}),s.jsx(HP,{onPrefillOnboarding:H,onResetOnboarding:re,onCompleteOnboarding:oe,isDevMode:!1}),s.jsx(GP,{onExportData:Qe,onImportData:st})]})]}),s.jsxs(n1,{value:t,onValueChange:he=>{e(he),ze(he)},children:[s.jsxs(Xf,{className:`grid w-full ${pt()?"grid-cols-3 sm:grid-cols-5 md:grid-cols-7":"grid-cols-3 sm:grid-cols-5 md:grid-cols-6"} gap-1 mb-8`,children:[s.jsxs(ms,{value:"dashboard",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Home",children:[s.jsx(Wo,{className:"h-4 w-4"}),s.jsx("span",{className:"sm:hidden",children:"Home"}),s.jsx("span",{className:"hidden sm:inline",children:"Home"}),s.jsx(Fe,{hasNotification:Le.dashboard>0})]}),s.jsxs(ms,{value:"refrigerators",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Punti di Conservazione",children:[s.jsx(ws,{className:"h-4 w-4"}),s.jsx("span",{className:"sm:hidden text-xs",children:"Frigo"}),s.jsx("span",{className:"hidden sm:inline",children:"Punti di Conservazione"}),s.jsx(Fe,{hasNotification:Le.refrigerators>0})]}),s.jsxs(ms,{value:"cleaning",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Attivit e Mansioni",children:[s.jsx(hd,{className:"h-4 w-4"}),s.jsx("span",{className:"sm:hidden text-xs",children:"Attivit"}),s.jsx("span",{className:"hidden sm:inline",children:"Attivit e Mansioni"}),s.jsx(Fe,{hasNotification:Le.cleaning>0})]}),s.jsxs(ms,{value:"inventory",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Inventario",children:[s.jsx(Vn,{className:"h-4 w-4"}),s.jsx("span",{className:"sm:hidden text-xs",children:"Stock"}),s.jsx("span",{className:"hidden sm:inline",children:"Inventario"}),s.jsx(Fe,{hasNotification:Le.inventory>0})]}),s.jsxs(ms,{value:"data-settings",className:"flex items-center gap-1 md:gap-2 text-sm",title:"Impostazioni e Dati",children:[s.jsx(Wr,{className:"h-4 w-4"}),s.jsx("span",{className:"sm:hidden text-xs",children:"Settings"}),s.jsx("span",{className:"hidden sm:inline",children:"Impostazioni e Dati"})]}),pt()&&s.jsxs(ms,{value:"staff",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Gestione",children:[s.jsx(Er,{className:"h-4 w-4"}),s.jsx("span",{className:"sm:hidden text-xs",children:"Staff"}),s.jsx("span",{className:"hidden sm:inline",children:"Gestione"}),s.jsx(Fe,{hasNotification:Le.staff>0})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[pt()&&s.jsxs(le,{variant:"outline",size:"sm",onClick:()=>e("staff"),className:"flex items-center gap-1 md:gap-2 text-sm h-9 px-3",title:"Impostazioni",children:[s.jsx(Wr,{className:"h-4 w-4"}),s.jsx("span",{className:"sm:hidden text-xs",children:"Settings"}),s.jsx("span",{className:"hidden sm:inline",children:"Impostazioni"})]}),s.jsxs(le,{variant:"outline",size:"sm",onClick:Ce,className:"flex items-center gap-1 md:gap-2 text-sm h-9 px-3",title:"Esci",children:[s.jsx(z4,{className:"h-4 w-4"}),s.jsx("span",{className:"sm:hidden text-xs",children:"Exit"}),s.jsx("span",{className:"hidden sm:inline",children:"Esci"})]})]})]}),s.jsx(ps,{value:"dashboard",children:s.jsx("div",{className:"space-y-6",children:s.jsx(K4,{temperatures:n,cleaning:i,products:f,staff:c,currentUser:k})})}),s.jsx(ps,{value:"refrigerators",children:s.jsx(A6,{temperatures:n,setTemperatures:he=>{r(he),tt("temperatures",he)},currentUser:k,refrigerators:o,setRefrigerators:he=>{l(he),tt("refrigerators",he)},departments:v,setDepartments:he=>{m(he),tt("departments",he)},staff:c})}),s.jsx(ps,{value:"cleaning",children:s.jsx(Y4,{cleaning:i,setCleaning:he=>{a(he),tt("cleaning",he)},currentUser:k,departments:v})}),s.jsx(ps,{value:"inventory",children:s.jsx($C,{products:f,setProducts:he=>{p(he),tt("inventory",he)},currentUser:k,refrigerators:o})}),s.jsx(ps,{value:"data-settings",children:s.jsx(KC,{currentUser:k,isAdmin:pt(),onSettingsChange:he=>{console.log(" Impostazioni dati aggiornate:",he)}})}),pt()&&s.jsx(ps,{value:"staff",children:s.jsxs("div",{className:"space-y-6",children:[s.jsx(O6,{staff:c,setStaff:he=>{d(he),tt("staff",he)},users:b,setUsers:j,currentUser:k,isAdmin:pt(),departments:W?v:[],setDepartments:he=>{m(he),tt("departments",he)},productLabels:N,setProductLabels:_,products:f,temperatures:n,cleaning:i,onAction:he=>{console.log("AI Action:",he)}}),s.jsx(UC,{temperatures:n,setTemperatures:r,cleaning:i,setCleaning:a,products:f,setProducts:p,refrigerators:o,setRefrigerators:l})]})})]}),s.jsx(QC,{activeTab:t,temperatures:n}),k&&K&&s.jsx(BC,{currentUser:k,currentSection:t,products:f,temperatures:n,cleaning:i,staff:c,onAction:he=>{console.log("AI Action:",he)}}),k&&s.jsx(qC,{products:f,onRecipeSuggestion:he=>{console.log("Recipe suggestions:",he)}}),s.jsx(VC,{}),F&&s.jsx(qP,{isOpen:F,onClose:()=>ne(!1),onComplete:ae,currentData:G}),s.jsx(UP,{isOpen:P,onClose:()=>Q(!1),missingRequirements:w.missingRequirements,suggestions:w.getSuggestions(),onFixRequirement:Ae})]})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(Jx,{}),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Business HACCP Manager"}),s.jsx("p",{className:"text-gray-600",children:"Sistema di Gestione HACCP per Ristoranti"})]}),s.jsx("div",{className:"max-w-4xl mx-auto mb-8",children:s.jsxs(ot,{children:[s.jsx(Ut,{children:s.jsxs(Gt,{className:"flex items-center gap-2",children:[s.jsx(Wo,{className:"h-5 w-5"}),"Report Giornalieri - ",new Date().toLocaleDateString("it-IT")]})}),s.jsx(et,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:Ge.temperatureOk}),s.jsx("div",{className:"text-sm text-green-700",children:"Temperature OK"})]}),s.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:Ge.temperatureProblems}),s.jsx("div",{className:"text-sm text-red-700",children:"Problemi Temp."})]}),s.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Ge.cleaningPending}),s.jsx("div",{className:"text-sm text-yellow-700",children:"Pulizie Pending"})]}),s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Ge.expiringToday}),s.jsx("div",{className:"text-sm text-blue-700",children:"Scadenze Prodotti"})]})]})})]})}),s.jsx("div",{className:"max-w-md mx-auto mb-4",children:s.jsx(ot,{children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"flex gap-2 justify-center",children:[s.jsxs(le,{onClick:Qe,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(Ys,{className:"h-4 w-4"}),"Esporta"]}),s.jsxs("label",{className:"cursor-pointer",children:[s.jsx(le,{variant:"outline",size:"sm",className:"flex items-center gap-2",asChild:!0,children:s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Iu,{className:"h-4 w-4"}),"Importa"]})}),s.jsx("input",{type:"file",accept:".json",onChange:st,className:"hidden"})]})]})})})}),s.jsxs("div",{className:"max-w-md mx-auto",children:[b.length>1&&s.jsx(ot,{className:"mb-4",children:s.jsx(et,{className:"pt-6",children:s.jsxs("div",{className:"text-center text-gray-600",children:[s.jsx("div",{className:"text-sm",children:"Ultimo accesso:"}),s.jsx("div",{className:"font-semibold",children:(Re=b[b.length-1])==null?void 0:Re.name})]})})}),s.jsx("div",{className:"text-center",children:s.jsxs(le,{size:"lg",className:"text-lg px-8 py-4",onClick:()=>B(!0),children:[s.jsx(T4,{className:"mr-2 h-5 w-5"})," INIZIA TURNO"]})})]})]}),s.jsx(YC,{isOpen:C,onClose:()=>B(!1),onLogin:fe,users:b,onAddUser:ie})]})}function iw(t,e){if(!t||!t.entities){console.warn("[integrity] State or entities is undefined, skipping validation");return}if(e.includes("conservationPoints")&&t.entities.conservationPoints)for(const[n,r]of Object.entries(t.entities.conservationPoints))r.label||console.warn("[integrity] cp missing label:",n),(!r.range||r.range.min>=r.range.max)&&console.warn("[integrity] cp invalid range:",n);if(e.includes("staff")&&t.entities.staff)for(const[n,r]of Object.entries(t.entities.staff))r.departmentId&&t.entities.departments&&!t.entities.departments[r.departmentId]&&console.warn("[integrity] staff with orphan departmentId:",n,r.departmentId)}function ZP(t){const e=t.entities.conservationPoints;for(const n in e){const r=e[n];r&&r.tempMin!==void 0&&r.tempMax!==void 0&&!r.range&&(e[n]={...r,range:{min:r.tempMin,max:r.tempMax}},delete e[n].tempMin,delete e[n].tempMax)}return t}const f2={2:t=>(t=ZP(t),iw(t,["conservationPoints","staff","departments"]),t.meta.schemaVersion=2,t)};function JP(t){var n;let e=((n=t.meta)==null?void 0:n.schemaVersion)??1;for(;f2[e+1];)t=f2[e+1](t),e=t.meta.schemaVersion;return t}const Yg="bhm-app-state";function KP(){const t=localStorage.getItem(Yg);if(!t)return null;const e=JSON.parse(t);return JP(e)}function YP(t){const e=localStorage.getItem(Yg),r={...e?JSON.parse(e):null,...t};localStorage.setItem(Yg,JSON.stringify(r))}function QP(){return{}}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered: ",t),t.addEventListener("updatefound",()=>{const e=t.installing;e.addEventListener("statechange",()=>{e.state==="installed"&&navigator.serviceWorker.controller&&confirm("Nuova versione disponibile. Ricaricare la pagina?")&&window.location.reload()})})}).catch(t=>{console.log("SW registration failed: ",t)})});(function(){const e=QP(),r=KP()??e;r&&(iw(r,["conservationPoints","staff","departments"]),sc.setState(r,!0)),sc.subscribe(i=>YP(i))})();Ip.createRoot(document.getElementById("root")).render(s.jsx(Zs.StrictMode,{children:s.jsx(WP,{})}));export{dn as _,Xs as c,Uw as g};
