(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var qs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function R5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function F5(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var i=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:function(){return t[s]}})}),n}var Fx={exports:{}},Wh={},Bx={exports:{}},Yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mu=Symbol.for("react.element"),B5=Symbol.for("react.portal"),$5=Symbol.for("react.fragment"),q5=Symbol.for("react.strict_mode"),U5=Symbol.for("react.profiler"),H5=Symbol.for("react.provider"),V5=Symbol.for("react.context"),G5=Symbol.for("react.forward_ref"),W5=Symbol.for("react.suspense"),J5=Symbol.for("react.memo"),K5=Symbol.for("react.lazy"),M0=Symbol.iterator;function Y5(t){return t===null||typeof t!="object"?null:(t=M0&&t[M0]||t["@@iterator"],typeof t=="function"?t:null)}var $x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qx=Object.assign,Ux={};function ec(t,e,n){this.props=t,this.context=e,this.refs=Ux,this.updater=n||$x}ec.prototype.isReactComponent={};ec.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ec.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Hx(){}Hx.prototype=ec.prototype;function rg(t,e,n){this.props=t,this.context=e,this.refs=Ux,this.updater=n||$x}var sg=rg.prototype=new Hx;sg.constructor=rg;qx(sg,ec.prototype);sg.isPureReactComponent=!0;var R0=Array.isArray,Vx=Object.prototype.hasOwnProperty,ig={current:null},Gx={key:!0,ref:!0,__self:!0,__source:!0};function Wx(t,e,n){var s,i={},a=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)Vx.call(e,s)&&!Gx.hasOwnProperty(s)&&(i[s]=e[s]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)i[s]===void 0&&(i[s]=l[s]);return{$$typeof:Mu,type:t,key:a,ref:o,props:i,_owner:ig.current}}function Q5(t,e){return{$$typeof:Mu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ag(t){return typeof t=="object"&&t!==null&&t.$$typeof===Mu}function X5(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var F0=/\/+/g;function Kf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?X5(""+t.key):e.toString(36)}function Zd(t,e,n,s,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Mu:case B5:o=!0}}if(o)return o=t,i=i(o),t=s===""?"."+Kf(o,0):s,R0(i)?(n="",t!=null&&(n=t.replace(F0,"$&/")+"/"),Zd(i,e,n,"",function(d){return d})):i!=null&&(ag(i)&&(i=Q5(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(F0,"$&/")+"/")+t)),e.push(i)),1;if(o=0,s=s===""?".":s+":",R0(t))for(var l=0;l<t.length;l++){a=t[l];var c=s+Kf(a,l);o+=Zd(a,e,n,c,i)}else if(c=Y5(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=s+Kf(a,l++),o+=Zd(a,e,n,c,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Sd(t,e,n){if(t==null)return t;var s=[],i=0;return Zd(t,s,"","",function(a){return e.call(n,a,i++)}),s}function Z5(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Kr={current:null},eh={transition:null},eb={ReactCurrentDispatcher:Kr,ReactCurrentBatchConfig:eh,ReactCurrentOwner:ig};function Jx(){throw Error("act(...) is not supported in production builds of React.")}Yt.Children={map:Sd,forEach:function(t,e,n){Sd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Sd(t,function(){e++}),e},toArray:function(t){return Sd(t,function(e){return e})||[]},only:function(t){if(!ag(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Yt.Component=ec;Yt.Fragment=$5;Yt.Profiler=U5;Yt.PureComponent=rg;Yt.StrictMode=q5;Yt.Suspense=W5;Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eb;Yt.act=Jx;Yt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=qx({},t.props),i=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=ig.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Vx.call(e,c)&&!Gx.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:Mu,type:t.type,key:i,ref:a,props:s,_owner:o}};Yt.createContext=function(t){return t={$$typeof:V5,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:H5,_context:t},t.Consumer=t};Yt.createElement=Wx;Yt.createFactory=function(t){var e=Wx.bind(null,t);return e.type=t,e};Yt.createRef=function(){return{current:null}};Yt.forwardRef=function(t){return{$$typeof:G5,render:t}};Yt.isValidElement=ag;Yt.lazy=function(t){return{$$typeof:K5,_payload:{_status:-1,_result:t},_init:Z5}};Yt.memo=function(t,e){return{$$typeof:J5,type:t,compare:e===void 0?null:e}};Yt.startTransition=function(t){var e=eh.transition;eh.transition={};try{t()}finally{eh.transition=e}};Yt.unstable_act=Jx;Yt.useCallback=function(t,e){return Kr.current.useCallback(t,e)};Yt.useContext=function(t){return Kr.current.useContext(t)};Yt.useDebugValue=function(){};Yt.useDeferredValue=function(t){return Kr.current.useDeferredValue(t)};Yt.useEffect=function(t,e){return Kr.current.useEffect(t,e)};Yt.useId=function(){return Kr.current.useId()};Yt.useImperativeHandle=function(t,e,n){return Kr.current.useImperativeHandle(t,e,n)};Yt.useInsertionEffect=function(t,e){return Kr.current.useInsertionEffect(t,e)};Yt.useLayoutEffect=function(t,e){return Kr.current.useLayoutEffect(t,e)};Yt.useMemo=function(t,e){return Kr.current.useMemo(t,e)};Yt.useReducer=function(t,e,n){return Kr.current.useReducer(t,e,n)};Yt.useRef=function(t){return Kr.current.useRef(t)};Yt.useState=function(t){return Kr.current.useState(t)};Yt.useSyncExternalStore=function(t,e,n){return Kr.current.useSyncExternalStore(t,e,n)};Yt.useTransition=function(){return Kr.current.useTransition()};Yt.version="18.3.1";Bx.exports=Yt;var W=Bx.exports;const Da=R5(W);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tb=W,nb=Symbol.for("react.element"),rb=Symbol.for("react.fragment"),sb=Object.prototype.hasOwnProperty,ib=tb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ab={key:!0,ref:!0,__self:!0,__source:!0};function Kx(t,e,n){var s,i={},a=null,o=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)sb.call(e,s)&&!ab.hasOwnProperty(s)&&(i[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:nb,type:t,key:a,ref:o,props:i,_owner:ib.current}}Wh.Fragment=rb;Wh.jsx=Kx;Wh.jsxs=Kx;Fx.exports=Wh;var r=Fx.exports,Fm={},Yx={exports:{}},js={},Qx={exports:{}},Xx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,Y){var G=L.length;L.push(Y);e:for(;0<G;){var ce=G-1>>>1,_=L[ce];if(0<i(_,Y))L[ce]=Y,L[G]=_,G=ce;else break e}}function n(L){return L.length===0?null:L[0]}function s(L){if(L.length===0)return null;var Y=L[0],G=L.pop();if(G!==Y){L[0]=G;e:for(var ce=0,_=L.length,J=_>>>1;ce<J;){var M=2*(ce+1)-1,I=L[M],q=M+1,oe=L[q];if(0>i(I,G))q<_&&0>i(oe,I)?(L[ce]=oe,L[q]=G,ce=q):(L[ce]=I,L[M]=G,ce=M);else if(q<_&&0>i(oe,G))L[ce]=oe,L[q]=G,ce=q;else break e}}return Y}function i(L,Y){var G=L.sortIndex-Y.sortIndex;return G!==0?G:L.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,p=null,v=3,m=!1,N=!1,S=!1,k=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(L){for(var Y=n(d);Y!==null;){if(Y.callback===null)s(d);else if(Y.startTime<=L)s(d),Y.sortIndex=Y.expirationTime,e(c,Y);else break;Y=n(d)}}function z(L){if(S=!1,j(L),!N)if(n(c)!==null)N=!0,Q(H);else{var Y=n(d);Y!==null&&te(z,Y.startTime-L)}}function H(L,Y){N=!1,S&&(S=!1,y(P),P=-1),m=!0;var G=v;try{for(j(Y),p=n(c);p!==null&&(!(p.expirationTime>Y)||L&&!A());){var ce=p.callback;if(typeof ce=="function"){p.callback=null,v=p.priorityLevel;var _=ce(p.expirationTime<=Y);Y=t.unstable_now(),typeof _=="function"?p.callback=_:p===n(c)&&s(c),j(Y)}else s(c);p=n(c)}if(p!==null)var J=!0;else{var M=n(d);M!==null&&te(z,M.startTime-Y),J=!1}return J}finally{p=null,v=G,m=!1}}var Z=!1,K=null,P=-1,$=5,re=-1;function A(){return!(t.unstable_now()-re<$)}function C(){if(K!==null){var L=t.unstable_now();re=L;var Y=!0;try{Y=K(!0,L)}finally{Y?R():(Z=!1,K=null)}}else Z=!1}var R;if(typeof b=="function")R=function(){b(C)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,ie=V.port2;V.port1.onmessage=C,R=function(){ie.postMessage(null)}}else R=function(){k(C,0)};function Q(L){K=L,Z||(Z=!0,R())}function te(L,Y){P=k(function(){L(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){N||m||(N=!0,Q(H))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(L){switch(v){case 1:case 2:case 3:var Y=3;break;default:Y=v}var G=v;v=Y;try{return L()}finally{v=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,Y){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var G=v;v=L;try{return Y()}finally{v=G}},t.unstable_scheduleCallback=function(L,Y,G){var ce=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?ce+G:ce):G=ce,L){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=G+_,L={id:f++,callback:Y,priorityLevel:L,startTime:G,expirationTime:_,sortIndex:-1},G>ce?(L.sortIndex=G,e(d,L),n(c)===null&&L===n(d)&&(S?(y(P),P=-1):S=!0,te(z,G-ce))):(L.sortIndex=_,e(c,L),N||m||(N=!0,Q(H))),L},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(L){var Y=v;return function(){var G=v;v=Y;try{return L.apply(this,arguments)}finally{v=G}}}})(Xx);Qx.exports=Xx;var ob=Qx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lb=W,Ns=ob;function Qe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Zx=new Set,pu={};function zo(t,e){Gl(t,e),Gl(t+"Capture",e)}function Gl(t,e){for(pu[t]=e,t=0;t<e.length;t++)Zx.add(e[t])}var Zi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bm=Object.prototype.hasOwnProperty,cb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B0={},$0={};function ub(t){return Bm.call($0,t)?!0:Bm.call(B0,t)?!1:cb.test(t)?$0[t]=!0:(B0[t]=!0,!1)}function db(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function hb(t,e,n,s){if(e===null||typeof e>"u"||db(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Yr(t,e,n,s,i,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var jr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){jr[t]=new Yr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];jr[e]=new Yr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){jr[t]=new Yr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){jr[t]=new Yr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){jr[t]=new Yr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){jr[t]=new Yr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){jr[t]=new Yr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){jr[t]=new Yr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){jr[t]=new Yr(t,5,!1,t.toLowerCase(),null,!1,!1)});var og=/[\-:]([a-z])/g;function lg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(og,lg);jr[e]=new Yr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(og,lg);jr[e]=new Yr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(og,lg);jr[e]=new Yr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){jr[t]=new Yr(t,1,!1,t.toLowerCase(),null,!1,!1)});jr.xlinkHref=new Yr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){jr[t]=new Yr(t,1,!1,t.toLowerCase(),null,!0,!0)});function cg(t,e,n,s){var i=jr.hasOwnProperty(e)?jr[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(hb(e,n,i,s)&&(n=null),s||i===null?ub(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,s=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var ra=lb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_d=Symbol.for("react.element"),Nl=Symbol.for("react.portal"),jl=Symbol.for("react.fragment"),ug=Symbol.for("react.strict_mode"),$m=Symbol.for("react.profiler"),ev=Symbol.for("react.provider"),tv=Symbol.for("react.context"),dg=Symbol.for("react.forward_ref"),qm=Symbol.for("react.suspense"),Um=Symbol.for("react.suspense_list"),hg=Symbol.for("react.memo"),Aa=Symbol.for("react.lazy"),nv=Symbol.for("react.offscreen"),q0=Symbol.iterator;function Dc(t){return t===null||typeof t!="object"?null:(t=q0&&t[q0]||t["@@iterator"],typeof t=="function"?t:null)}var Dn=Object.assign,Yf;function Jc(t){if(Yf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Yf=e&&e[1]||""}return`
`+Yf+t}var Qf=!1;function Xf(t,e){if(!t||Qf)return"";Qf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),a=s.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Qf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Jc(t):""}function fb(t){switch(t.tag){case 5:return Jc(t.type);case 16:return Jc("Lazy");case 13:return Jc("Suspense");case 19:return Jc("SuspenseList");case 0:case 2:case 15:return t=Xf(t.type,!1),t;case 11:return t=Xf(t.type.render,!1),t;case 1:return t=Xf(t.type,!0),t;default:return""}}function Hm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case jl:return"Fragment";case Nl:return"Portal";case $m:return"Profiler";case ug:return"StrictMode";case qm:return"Suspense";case Um:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case tv:return(t.displayName||"Context")+".Consumer";case ev:return(t._context.displayName||"Context")+".Provider";case dg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case hg:return e=t.displayName||null,e!==null?e:Hm(t.type)||"Memo";case Aa:e=t._payload,t=t._init;try{return Hm(t(e))}catch{}}return null}function mb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hm(e);case 8:return e===ug?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Va(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function rv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function pb(t){var e=rv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){s=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Cd(t){t._valueTracker||(t._valueTracker=pb(t))}function sv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=rv(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function xh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Vm(t,e){var n=e.checked;return Dn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function U0(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Va(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function iv(t,e){e=e.checked,e!=null&&cg(t,"checked",e,!1)}function Gm(t,e){iv(t,e);var n=Va(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wm(t,e.type,Va(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function H0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wm(t,e,n){(e!=="number"||xh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Kc=Array.isArray;function Dl(t,e,n,s){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Va(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,s&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Jm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Qe(91));return Dn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function V0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Qe(92));if(Kc(n)){if(1<n.length)throw Error(Qe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Va(n)}}function av(t,e){var n=Va(e.value),s=Va(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function G0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ov(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Km(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ov(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var kd,lv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(kd=kd||document.createElement("div"),kd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function gu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var tu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gb=["Webkit","ms","Moz","O"];Object.keys(tu).forEach(function(t){gb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),tu[e]=tu[t]})});function cv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||tu.hasOwnProperty(t)&&tu[t]?(""+e).trim():e+"px"}function uv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,i=cv(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,i):t[n]=i}}var xb=Dn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ym(t,e){if(e){if(xb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Qe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Qe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Qe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Qe(62))}}function Qm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xm=null;function fg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Zm=null,Ml=null,Rl=null;function W0(t){if(t=Bu(t)){if(typeof Zm!="function")throw Error(Qe(280));var e=t.stateNode;e&&(e=Xh(e),Zm(t.stateNode,t.type,e))}}function dv(t){Ml?Rl?Rl.push(t):Rl=[t]:Ml=t}function hv(){if(Ml){var t=Ml,e=Rl;if(Rl=Ml=null,W0(t),e)for(t=0;t<e.length;t++)W0(e[t])}}function fv(t,e){return t(e)}function mv(){}var Zf=!1;function pv(t,e,n){if(Zf)return t(e,n);Zf=!0;try{return fv(t,e,n)}finally{Zf=!1,(Ml!==null||Rl!==null)&&(mv(),hv())}}function xu(t,e){var n=t.stateNode;if(n===null)return null;var s=Xh(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Qe(231,e,typeof n));return n}var ep=!1;if(Zi)try{var Mc={};Object.defineProperty(Mc,"passive",{get:function(){ep=!0}}),window.addEventListener("test",Mc,Mc),window.removeEventListener("test",Mc,Mc)}catch{ep=!1}function vb(t,e,n,s,i,a,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var nu=!1,vh=null,yh=!1,tp=null,yb={onError:function(t){nu=!0,vh=t}};function bb(t,e,n,s,i,a,o,l,c){nu=!1,vh=null,vb.apply(yb,arguments)}function wb(t,e,n,s,i,a,o,l,c){if(bb.apply(this,arguments),nu){if(nu){var d=vh;nu=!1,vh=null}else throw Error(Qe(198));yh||(yh=!0,tp=d)}}function Oo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function gv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function J0(t){if(Oo(t)!==t)throw Error(Qe(188))}function Nb(t){var e=t.alternate;if(!e){if(e=Oo(t),e===null)throw Error(Qe(188));return e!==t?null:t}for(var n=t,s=e;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(s=i.return,s!==null){n=s;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return J0(i),t;if(a===s)return J0(i),e;a=a.sibling}throw Error(Qe(188))}if(n.return!==s.return)n=i,s=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,s=a;break}if(l===s){o=!0,s=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,s=i;break}if(l===s){o=!0,s=a,n=i;break}l=l.sibling}if(!o)throw Error(Qe(189))}}if(n.alternate!==s)throw Error(Qe(190))}if(n.tag!==3)throw Error(Qe(188));return n.stateNode.current===n?t:e}function xv(t){return t=Nb(t),t!==null?vv(t):null}function vv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=vv(t);if(e!==null)return e;t=t.sibling}return null}var yv=Ns.unstable_scheduleCallback,K0=Ns.unstable_cancelCallback,jb=Ns.unstable_shouldYield,Sb=Ns.unstable_requestPaint,Wn=Ns.unstable_now,_b=Ns.unstable_getCurrentPriorityLevel,mg=Ns.unstable_ImmediatePriority,bv=Ns.unstable_UserBlockingPriority,bh=Ns.unstable_NormalPriority,Cb=Ns.unstable_LowPriority,wv=Ns.unstable_IdlePriority,Jh=null,Li=null;function kb(t){if(Li&&typeof Li.onCommitFiberRoot=="function")try{Li.onCommitFiberRoot(Jh,t,void 0,(t.current.flags&128)===128)}catch{}}var oi=Math.clz32?Math.clz32:Lb,Ab=Math.log,Pb=Math.LN2;function Lb(t){return t>>>=0,t===0?32:31-(Ab(t)/Pb|0)|0}var Ad=64,Pd=4194304;function Yc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function wh(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,i=t.suspendedLanes,a=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?s=Yc(l):(a&=o,a!==0&&(s=Yc(a)))}else o=n&~i,o!==0?s=Yc(o):a!==0&&(s=Yc(a));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-oi(e),i=1<<n,s|=t[n],e&=~i;return s}function Ib(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tb(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-oi(a),l=1<<o,c=i[o];c===-1?(!(l&n)||l&s)&&(i[o]=Ib(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function np(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Nv(){var t=Ad;return Ad<<=1,!(Ad&4194240)&&(Ad=64),t}function em(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ru(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-oi(e),t[e]=n}function Eb(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-oi(n),a=1<<i;e[i]=0,s[i]=-1,t[i]=-1,n&=~a}}function pg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-oi(n),i=1<<s;i&e|t[s]&e&&(t[s]|=e),n&=~i}}var fn=0;function jv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Sv,gg,_v,Cv,kv,rp=!1,Ld=[],Ma=null,Ra=null,Fa=null,vu=new Map,yu=new Map,La=[],zb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Y0(t,e){switch(t){case"focusin":case"focusout":Ma=null;break;case"dragenter":case"dragleave":Ra=null;break;case"mouseover":case"mouseout":Fa=null;break;case"pointerover":case"pointerout":vu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":yu.delete(e.pointerId)}}function Rc(t,e,n,s,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:a,targetContainers:[i]},e!==null&&(e=Bu(e),e!==null&&gg(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Ob(t,e,n,s,i){switch(e){case"focusin":return Ma=Rc(Ma,t,e,n,s,i),!0;case"dragenter":return Ra=Rc(Ra,t,e,n,s,i),!0;case"mouseover":return Fa=Rc(Fa,t,e,n,s,i),!0;case"pointerover":var a=i.pointerId;return vu.set(a,Rc(vu.get(a)||null,t,e,n,s,i)),!0;case"gotpointercapture":return a=i.pointerId,yu.set(a,Rc(yu.get(a)||null,t,e,n,s,i)),!0}return!1}function Av(t){var e=No(t.target);if(e!==null){var n=Oo(e);if(n!==null){if(e=n.tag,e===13){if(e=gv(n),e!==null){t.blockedOn=e,kv(t.priority,function(){_v(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function th(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=sp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Xm=s,n.target.dispatchEvent(s),Xm=null}else return e=Bu(n),e!==null&&gg(e),t.blockedOn=n,!1;e.shift()}return!0}function Q0(t,e,n){th(t)&&n.delete(e)}function Db(){rp=!1,Ma!==null&&th(Ma)&&(Ma=null),Ra!==null&&th(Ra)&&(Ra=null),Fa!==null&&th(Fa)&&(Fa=null),vu.forEach(Q0),yu.forEach(Q0)}function Fc(t,e){t.blockedOn===e&&(t.blockedOn=null,rp||(rp=!0,Ns.unstable_scheduleCallback(Ns.unstable_NormalPriority,Db)))}function bu(t){function e(i){return Fc(i,t)}if(0<Ld.length){Fc(Ld[0],t);for(var n=1;n<Ld.length;n++){var s=Ld[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Ma!==null&&Fc(Ma,t),Ra!==null&&Fc(Ra,t),Fa!==null&&Fc(Fa,t),vu.forEach(e),yu.forEach(e),n=0;n<La.length;n++)s=La[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<La.length&&(n=La[0],n.blockedOn===null);)Av(n),n.blockedOn===null&&La.shift()}var Fl=ra.ReactCurrentBatchConfig,Nh=!0;function Mb(t,e,n,s){var i=fn,a=Fl.transition;Fl.transition=null;try{fn=1,xg(t,e,n,s)}finally{fn=i,Fl.transition=a}}function Rb(t,e,n,s){var i=fn,a=Fl.transition;Fl.transition=null;try{fn=4,xg(t,e,n,s)}finally{fn=i,Fl.transition=a}}function xg(t,e,n,s){if(Nh){var i=sp(t,e,n,s);if(i===null)um(t,e,s,jh,n),Y0(t,s);else if(Ob(i,t,e,n,s))s.stopPropagation();else if(Y0(t,s),e&4&&-1<zb.indexOf(t)){for(;i!==null;){var a=Bu(i);if(a!==null&&Sv(a),a=sp(t,e,n,s),a===null&&um(t,e,s,jh,n),a===i)break;i=a}i!==null&&s.stopPropagation()}else um(t,e,s,null,n)}}var jh=null;function sp(t,e,n,s){if(jh=null,t=fg(s),t=No(t),t!==null)if(e=Oo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=gv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return jh=t,null}function Pv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_b()){case mg:return 1;case bv:return 4;case bh:case Cb:return 16;case wv:return 536870912;default:return 16}default:return 16}}var Ea=null,vg=null,nh=null;function Lv(){if(nh)return nh;var t,e=vg,n=e.length,s,i="value"in Ea?Ea.value:Ea.textContent,a=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===i[a-s];s++);return nh=i.slice(t,1<s?1-s:void 0)}function rh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Id(){return!0}function X0(){return!1}function Ss(t){function e(n,s,i,a,o){this._reactName=n,this._targetInst=i,this.type=s,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Id:X0,this.isPropagationStopped=X0,this}return Dn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Id)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Id)},persist:function(){},isPersistent:Id}),e}var tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yg=Ss(tc),Fu=Dn({},tc,{view:0,detail:0}),Fb=Ss(Fu),tm,nm,Bc,Kh=Dn({},Fu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bc&&(Bc&&t.type==="mousemove"?(tm=t.screenX-Bc.screenX,nm=t.screenY-Bc.screenY):nm=tm=0,Bc=t),tm)},movementY:function(t){return"movementY"in t?t.movementY:nm}}),Z0=Ss(Kh),Bb=Dn({},Kh,{dataTransfer:0}),$b=Ss(Bb),qb=Dn({},Fu,{relatedTarget:0}),rm=Ss(qb),Ub=Dn({},tc,{animationName:0,elapsedTime:0,pseudoElement:0}),Hb=Ss(Ub),Vb=Dn({},tc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Gb=Ss(Vb),Wb=Dn({},tc,{data:0}),e1=Ss(Wb),Jb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Yb[t])?!!e[t]:!1}function bg(){return Qb}var Xb=Dn({},Fu,{key:function(t){if(t.key){var e=Jb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=rh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Kb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bg,charCode:function(t){return t.type==="keypress"?rh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?rh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Zb=Ss(Xb),ew=Dn({},Kh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t1=Ss(ew),tw=Dn({},Fu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bg}),nw=Ss(tw),rw=Dn({},tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),sw=Ss(rw),iw=Dn({},Kh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),aw=Ss(iw),ow=[9,13,27,32],wg=Zi&&"CompositionEvent"in window,ru=null;Zi&&"documentMode"in document&&(ru=document.documentMode);var lw=Zi&&"TextEvent"in window&&!ru,Iv=Zi&&(!wg||ru&&8<ru&&11>=ru),n1=String.fromCharCode(32),r1=!1;function Tv(t,e){switch(t){case"keyup":return ow.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ev(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Sl=!1;function cw(t,e){switch(t){case"compositionend":return Ev(e);case"keypress":return e.which!==32?null:(r1=!0,n1);case"textInput":return t=e.data,t===n1&&r1?null:t;default:return null}}function uw(t,e){if(Sl)return t==="compositionend"||!wg&&Tv(t,e)?(t=Lv(),nh=vg=Ea=null,Sl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Iv&&e.locale!=="ko"?null:e.data;default:return null}}var dw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function s1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!dw[t.type]:e==="textarea"}function zv(t,e,n,s){dv(s),e=Sh(e,"onChange"),0<e.length&&(n=new yg("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var su=null,wu=null;function hw(t){Vv(t,0)}function Yh(t){var e=kl(t);if(sv(e))return t}function fw(t,e){if(t==="change")return e}var Ov=!1;if(Zi){var sm;if(Zi){var im="oninput"in document;if(!im){var i1=document.createElement("div");i1.setAttribute("oninput","return;"),im=typeof i1.oninput=="function"}sm=im}else sm=!1;Ov=sm&&(!document.documentMode||9<document.documentMode)}function a1(){su&&(su.detachEvent("onpropertychange",Dv),wu=su=null)}function Dv(t){if(t.propertyName==="value"&&Yh(wu)){var e=[];zv(e,wu,t,fg(t)),pv(hw,e)}}function mw(t,e,n){t==="focusin"?(a1(),su=e,wu=n,su.attachEvent("onpropertychange",Dv)):t==="focusout"&&a1()}function pw(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Yh(wu)}function gw(t,e){if(t==="click")return Yh(e)}function xw(t,e){if(t==="input"||t==="change")return Yh(e)}function vw(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ui=typeof Object.is=="function"?Object.is:vw;function Nu(t,e){if(ui(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var i=n[s];if(!Bm.call(e,i)||!ui(t[i],e[i]))return!1}return!0}function o1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function l1(t,e){var n=o1(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=o1(n)}}function Mv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Mv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Rv(){for(var t=window,e=xh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=xh(t.document)}return e}function Ng(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function yw(t){var e=Rv(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Mv(n.ownerDocument.documentElement,n)){if(s!==null&&Ng(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(s.start,i);s=s.end===void 0?a:Math.min(s.end,i),!t.extend&&a>s&&(i=s,s=a,a=i),i=l1(n,a);var o=l1(n,s);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var bw=Zi&&"documentMode"in document&&11>=document.documentMode,_l=null,ip=null,iu=null,ap=!1;function c1(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ap||_l==null||_l!==xh(s)||(s=_l,"selectionStart"in s&&Ng(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),iu&&Nu(iu,s)||(iu=s,s=Sh(ip,"onSelect"),0<s.length&&(e=new yg("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=_l)))}function Td(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Cl={animationend:Td("Animation","AnimationEnd"),animationiteration:Td("Animation","AnimationIteration"),animationstart:Td("Animation","AnimationStart"),transitionend:Td("Transition","TransitionEnd")},am={},Fv={};Zi&&(Fv=document.createElement("div").style,"AnimationEvent"in window||(delete Cl.animationend.animation,delete Cl.animationiteration.animation,delete Cl.animationstart.animation),"TransitionEvent"in window||delete Cl.transitionend.transition);function Qh(t){if(am[t])return am[t];if(!Cl[t])return t;var e=Cl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Fv)return am[t]=e[n];return t}var Bv=Qh("animationend"),$v=Qh("animationiteration"),qv=Qh("animationstart"),Uv=Qh("transitionend"),Hv=new Map,u1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qa(t,e){Hv.set(t,e),zo(e,[t])}for(var om=0;om<u1.length;om++){var lm=u1[om],ww=lm.toLowerCase(),Nw=lm[0].toUpperCase()+lm.slice(1);Qa(ww,"on"+Nw)}Qa(Bv,"onAnimationEnd");Qa($v,"onAnimationIteration");Qa(qv,"onAnimationStart");Qa("dblclick","onDoubleClick");Qa("focusin","onFocus");Qa("focusout","onBlur");Qa(Uv,"onTransitionEnd");Gl("onMouseEnter",["mouseout","mouseover"]);Gl("onMouseLeave",["mouseout","mouseover"]);Gl("onPointerEnter",["pointerout","pointerover"]);Gl("onPointerLeave",["pointerout","pointerover"]);zo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));zo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));zo("onBeforeInput",["compositionend","keypress","textInput","paste"]);zo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));zo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));zo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qc));function d1(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,wb(s,e,void 0,t),t.currentTarget=null}function Vv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],i=s.event;s=s.listeners;e:{var a=void 0;if(e)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==a&&i.isPropagationStopped())break e;d1(i,l,d),a=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==a&&i.isPropagationStopped())break e;d1(i,l,d),a=c}}}if(yh)throw t=tp,yh=!1,tp=null,t}function _n(t,e){var n=e[dp];n===void 0&&(n=e[dp]=new Set);var s=t+"__bubble";n.has(s)||(Gv(e,t,2,!1),n.add(s))}function cm(t,e,n){var s=0;e&&(s|=4),Gv(n,t,s,e)}var Ed="_reactListening"+Math.random().toString(36).slice(2);function ju(t){if(!t[Ed]){t[Ed]=!0,Zx.forEach(function(n){n!=="selectionchange"&&(jw.has(n)||cm(n,!1,t),cm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ed]||(e[Ed]=!0,cm("selectionchange",!1,e))}}function Gv(t,e,n,s){switch(Pv(e)){case 1:var i=Mb;break;case 4:i=Rb;break;default:i=xg}n=i.bind(null,e,n,t),i=void 0,!ep||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function um(t,e,n,s,i){var a=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=No(l),o===null)return;if(c=o.tag,c===5||c===6){s=a=o;continue e}l=l.parentNode}}s=s.return}pv(function(){var d=a,f=fg(n),p=[];e:{var v=Hv.get(t);if(v!==void 0){var m=yg,N=t;switch(t){case"keypress":if(rh(n)===0)break e;case"keydown":case"keyup":m=Zb;break;case"focusin":N="focus",m=rm;break;case"focusout":N="blur",m=rm;break;case"beforeblur":case"afterblur":m=rm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Z0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=$b;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=nw;break;case Bv:case $v:case qv:m=Hb;break;case Uv:m=sw;break;case"scroll":m=Fb;break;case"wheel":m=aw;break;case"copy":case"cut":case"paste":m=Gb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=t1}var S=(e&4)!==0,k=!S&&t==="scroll",y=S?v!==null?v+"Capture":null:v;S=[];for(var b=d,j;b!==null;){j=b;var z=j.stateNode;if(j.tag===5&&z!==null&&(j=z,y!==null&&(z=xu(b,y),z!=null&&S.push(Su(b,z,j)))),k)break;b=b.return}0<S.length&&(v=new m(v,N,null,n,f),p.push({event:v,listeners:S}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",v&&n!==Xm&&(N=n.relatedTarget||n.fromElement)&&(No(N)||N[ea]))break e;if((m||v)&&(v=f.window===f?f:(v=f.ownerDocument)?v.defaultView||v.parentWindow:window,m?(N=n.relatedTarget||n.toElement,m=d,N=N?No(N):null,N!==null&&(k=Oo(N),N!==k||N.tag!==5&&N.tag!==6)&&(N=null)):(m=null,N=d),m!==N)){if(S=Z0,z="onMouseLeave",y="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(S=t1,z="onPointerLeave",y="onPointerEnter",b="pointer"),k=m==null?v:kl(m),j=N==null?v:kl(N),v=new S(z,b+"leave",m,n,f),v.target=k,v.relatedTarget=j,z=null,No(f)===d&&(S=new S(y,b+"enter",N,n,f),S.target=j,S.relatedTarget=k,z=S),k=z,m&&N)t:{for(S=m,y=N,b=0,j=S;j;j=il(j))b++;for(j=0,z=y;z;z=il(z))j++;for(;0<b-j;)S=il(S),b--;for(;0<j-b;)y=il(y),j--;for(;b--;){if(S===y||y!==null&&S===y.alternate)break t;S=il(S),y=il(y)}S=null}else S=null;m!==null&&h1(p,v,m,S,!1),N!==null&&k!==null&&h1(p,k,N,S,!0)}}e:{if(v=d?kl(d):window,m=v.nodeName&&v.nodeName.toLowerCase(),m==="select"||m==="input"&&v.type==="file")var H=fw;else if(s1(v))if(Ov)H=xw;else{H=pw;var Z=mw}else(m=v.nodeName)&&m.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(H=gw);if(H&&(H=H(t,d))){zv(p,H,n,f);break e}Z&&Z(t,v,d),t==="focusout"&&(Z=v._wrapperState)&&Z.controlled&&v.type==="number"&&Wm(v,"number",v.value)}switch(Z=d?kl(d):window,t){case"focusin":(s1(Z)||Z.contentEditable==="true")&&(_l=Z,ip=d,iu=null);break;case"focusout":iu=ip=_l=null;break;case"mousedown":ap=!0;break;case"contextmenu":case"mouseup":case"dragend":ap=!1,c1(p,n,f);break;case"selectionchange":if(bw)break;case"keydown":case"keyup":c1(p,n,f)}var K;if(wg)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Sl?Tv(t,n)&&(P="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&(Iv&&n.locale!=="ko"&&(Sl||P!=="onCompositionStart"?P==="onCompositionEnd"&&Sl&&(K=Lv()):(Ea=f,vg="value"in Ea?Ea.value:Ea.textContent,Sl=!0)),Z=Sh(d,P),0<Z.length&&(P=new e1(P,t,null,n,f),p.push({event:P,listeners:Z}),K?P.data=K:(K=Ev(n),K!==null&&(P.data=K)))),(K=lw?cw(t,n):uw(t,n))&&(d=Sh(d,"onBeforeInput"),0<d.length&&(f=new e1("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=K))}Vv(p,e)})}function Su(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Sh(t,e){for(var n=e+"Capture",s=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=xu(t,n),a!=null&&s.unshift(Su(t,a,i)),a=xu(t,e),a!=null&&s.push(Su(t,a,i))),t=t.return}return s}function il(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function h1(t,e,n,s,i){for(var a=e._reactName,o=[];n!==null&&n!==s;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,i?(c=xu(n,a),c!=null&&o.unshift(Su(n,c,l))):i||(c=xu(n,a),c!=null&&o.push(Su(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Sw=/\r\n?/g,_w=/\u0000|\uFFFD/g;function f1(t){return(typeof t=="string"?t:""+t).replace(Sw,`
`).replace(_w,"")}function zd(t,e,n){if(e=f1(e),f1(t)!==e&&n)throw Error(Qe(425))}function _h(){}var op=null,lp=null;function cp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var up=typeof setTimeout=="function"?setTimeout:void 0,Cw=typeof clearTimeout=="function"?clearTimeout:void 0,m1=typeof Promise=="function"?Promise:void 0,kw=typeof queueMicrotask=="function"?queueMicrotask:typeof m1<"u"?function(t){return m1.resolve(null).then(t).catch(Aw)}:up;function Aw(t){setTimeout(function(){throw t})}function dm(t,e){var n=e,s=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(s===0){t.removeChild(i),bu(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=i}while(n);bu(e)}function Ba(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function p1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var nc=Math.random().toString(36).slice(2),ki="__reactFiber$"+nc,_u="__reactProps$"+nc,ea="__reactContainer$"+nc,dp="__reactEvents$"+nc,Pw="__reactListeners$"+nc,Lw="__reactHandles$"+nc;function No(t){var e=t[ki];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ea]||n[ki]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=p1(t);t!==null;){if(n=t[ki])return n;t=p1(t)}return e}t=n,n=t.parentNode}return null}function Bu(t){return t=t[ki]||t[ea],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function kl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Qe(33))}function Xh(t){return t[_u]||null}var hp=[],Al=-1;function Xa(t){return{current:t}}function An(t){0>Al||(t.current=hp[Al],hp[Al]=null,Al--)}function jn(t,e){Al++,hp[Al]=t.current,t.current=e}var Ga={},Mr=Xa(Ga),ls=Xa(!1),Po=Ga;function Wl(t,e){var n=t.type.contextTypes;if(!n)return Ga;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=e[a];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function cs(t){return t=t.childContextTypes,t!=null}function Ch(){An(ls),An(Mr)}function g1(t,e,n){if(Mr.current!==Ga)throw Error(Qe(168));jn(Mr,e),jn(ls,n)}function Wv(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(Qe(108,mb(t)||"Unknown",i));return Dn({},n,s)}function kh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ga,Po=Mr.current,jn(Mr,t),jn(ls,ls.current),!0}function x1(t,e,n){var s=t.stateNode;if(!s)throw Error(Qe(169));n?(t=Wv(t,e,Po),s.__reactInternalMemoizedMergedChildContext=t,An(ls),An(Mr),jn(Mr,t)):An(ls),jn(ls,n)}var Ji=null,Zh=!1,hm=!1;function Jv(t){Ji===null?Ji=[t]:Ji.push(t)}function Iw(t){Zh=!0,Jv(t)}function Za(){if(!hm&&Ji!==null){hm=!0;var t=0,e=fn;try{var n=Ji;for(fn=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Ji=null,Zh=!1}catch(i){throw Ji!==null&&(Ji=Ji.slice(t+1)),yv(mg,Za),i}finally{fn=e,hm=!1}}return null}var Pl=[],Ll=0,Ah=null,Ph=0,Os=[],Ds=0,Lo=null,Ki=1,Yi="";function go(t,e){Pl[Ll++]=Ph,Pl[Ll++]=Ah,Ah=t,Ph=e}function Kv(t,e,n){Os[Ds++]=Ki,Os[Ds++]=Yi,Os[Ds++]=Lo,Lo=t;var s=Ki;t=Yi;var i=32-oi(s)-1;s&=~(1<<i),n+=1;var a=32-oi(e)+i;if(30<a){var o=i-i%5;a=(s&(1<<o)-1).toString(32),s>>=o,i-=o,Ki=1<<32-oi(e)+i|n<<i|s,Yi=a+t}else Ki=1<<a|n<<i|s,Yi=t}function jg(t){t.return!==null&&(go(t,1),Kv(t,1,0))}function Sg(t){for(;t===Ah;)Ah=Pl[--Ll],Pl[Ll]=null,Ph=Pl[--Ll],Pl[Ll]=null;for(;t===Lo;)Lo=Os[--Ds],Os[Ds]=null,Yi=Os[--Ds],Os[Ds]=null,Ki=Os[--Ds],Os[Ds]=null}var ws=null,ys=null,In=!1,ai=null;function Yv(t,e){var n=Rs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function v1(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ws=t,ys=Ba(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ws=t,ys=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Lo!==null?{id:Ki,overflow:Yi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Rs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ws=t,ys=null,!0):!1;default:return!1}}function fp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function mp(t){if(In){var e=ys;if(e){var n=e;if(!v1(t,e)){if(fp(t))throw Error(Qe(418));e=Ba(n.nextSibling);var s=ws;e&&v1(t,e)?Yv(s,n):(t.flags=t.flags&-4097|2,In=!1,ws=t)}}else{if(fp(t))throw Error(Qe(418));t.flags=t.flags&-4097|2,In=!1,ws=t}}}function y1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ws=t}function Od(t){if(t!==ws)return!1;if(!In)return y1(t),In=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!cp(t.type,t.memoizedProps)),e&&(e=ys)){if(fp(t))throw Qv(),Error(Qe(418));for(;e;)Yv(t,e),e=Ba(e.nextSibling)}if(y1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Qe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ys=Ba(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ys=null}}else ys=ws?Ba(t.stateNode.nextSibling):null;return!0}function Qv(){for(var t=ys;t;)t=Ba(t.nextSibling)}function Jl(){ys=ws=null,In=!1}function _g(t){ai===null?ai=[t]:ai.push(t)}var Tw=ra.ReactCurrentBatchConfig;function $c(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Qe(309));var s=n.stateNode}if(!s)throw Error(Qe(147,t));var i=s,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(Qe(284));if(!n._owner)throw Error(Qe(290,t))}return t}function Dd(t,e){throw t=Object.prototype.toString.call(e),Error(Qe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function b1(t){var e=t._init;return e(t._payload)}function Xv(t){function e(y,b){if(t){var j=y.deletions;j===null?(y.deletions=[b],y.flags|=16):j.push(b)}}function n(y,b){if(!t)return null;for(;b!==null;)e(y,b),b=b.sibling;return null}function s(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function i(y,b){return y=Ha(y,b),y.index=0,y.sibling=null,y}function a(y,b,j){return y.index=j,t?(j=y.alternate,j!==null?(j=j.index,j<b?(y.flags|=2,b):j):(y.flags|=2,b)):(y.flags|=1048576,b)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,b,j,z){return b===null||b.tag!==6?(b=ym(j,y.mode,z),b.return=y,b):(b=i(b,j),b.return=y,b)}function c(y,b,j,z){var H=j.type;return H===jl?f(y,b,j.props.children,z,j.key):b!==null&&(b.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Aa&&b1(H)===b.type)?(z=i(b,j.props),z.ref=$c(y,b,j),z.return=y,z):(z=uh(j.type,j.key,j.props,null,y.mode,z),z.ref=$c(y,b,j),z.return=y,z)}function d(y,b,j,z){return b===null||b.tag!==4||b.stateNode.containerInfo!==j.containerInfo||b.stateNode.implementation!==j.implementation?(b=bm(j,y.mode,z),b.return=y,b):(b=i(b,j.children||[]),b.return=y,b)}function f(y,b,j,z,H){return b===null||b.tag!==7?(b=Co(j,y.mode,z,H),b.return=y,b):(b=i(b,j),b.return=y,b)}function p(y,b,j){if(typeof b=="string"&&b!==""||typeof b=="number")return b=ym(""+b,y.mode,j),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case _d:return j=uh(b.type,b.key,b.props,null,y.mode,j),j.ref=$c(y,null,b),j.return=y,j;case Nl:return b=bm(b,y.mode,j),b.return=y,b;case Aa:var z=b._init;return p(y,z(b._payload),j)}if(Kc(b)||Dc(b))return b=Co(b,y.mode,j,null),b.return=y,b;Dd(y,b)}return null}function v(y,b,j,z){var H=b!==null?b.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return H!==null?null:l(y,b,""+j,z);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case _d:return j.key===H?c(y,b,j,z):null;case Nl:return j.key===H?d(y,b,j,z):null;case Aa:return H=j._init,v(y,b,H(j._payload),z)}if(Kc(j)||Dc(j))return H!==null?null:f(y,b,j,z,null);Dd(y,j)}return null}function m(y,b,j,z,H){if(typeof z=="string"&&z!==""||typeof z=="number")return y=y.get(j)||null,l(b,y,""+z,H);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case _d:return y=y.get(z.key===null?j:z.key)||null,c(b,y,z,H);case Nl:return y=y.get(z.key===null?j:z.key)||null,d(b,y,z,H);case Aa:var Z=z._init;return m(y,b,j,Z(z._payload),H)}if(Kc(z)||Dc(z))return y=y.get(j)||null,f(b,y,z,H,null);Dd(b,z)}return null}function N(y,b,j,z){for(var H=null,Z=null,K=b,P=b=0,$=null;K!==null&&P<j.length;P++){K.index>P?($=K,K=null):$=K.sibling;var re=v(y,K,j[P],z);if(re===null){K===null&&(K=$);break}t&&K&&re.alternate===null&&e(y,K),b=a(re,b,P),Z===null?H=re:Z.sibling=re,Z=re,K=$}if(P===j.length)return n(y,K),In&&go(y,P),H;if(K===null){for(;P<j.length;P++)K=p(y,j[P],z),K!==null&&(b=a(K,b,P),Z===null?H=K:Z.sibling=K,Z=K);return In&&go(y,P),H}for(K=s(y,K);P<j.length;P++)$=m(K,y,P,j[P],z),$!==null&&(t&&$.alternate!==null&&K.delete($.key===null?P:$.key),b=a($,b,P),Z===null?H=$:Z.sibling=$,Z=$);return t&&K.forEach(function(A){return e(y,A)}),In&&go(y,P),H}function S(y,b,j,z){var H=Dc(j);if(typeof H!="function")throw Error(Qe(150));if(j=H.call(j),j==null)throw Error(Qe(151));for(var Z=H=null,K=b,P=b=0,$=null,re=j.next();K!==null&&!re.done;P++,re=j.next()){K.index>P?($=K,K=null):$=K.sibling;var A=v(y,K,re.value,z);if(A===null){K===null&&(K=$);break}t&&K&&A.alternate===null&&e(y,K),b=a(A,b,P),Z===null?H=A:Z.sibling=A,Z=A,K=$}if(re.done)return n(y,K),In&&go(y,P),H;if(K===null){for(;!re.done;P++,re=j.next())re=p(y,re.value,z),re!==null&&(b=a(re,b,P),Z===null?H=re:Z.sibling=re,Z=re);return In&&go(y,P),H}for(K=s(y,K);!re.done;P++,re=j.next())re=m(K,y,P,re.value,z),re!==null&&(t&&re.alternate!==null&&K.delete(re.key===null?P:re.key),b=a(re,b,P),Z===null?H=re:Z.sibling=re,Z=re);return t&&K.forEach(function(C){return e(y,C)}),In&&go(y,P),H}function k(y,b,j,z){if(typeof j=="object"&&j!==null&&j.type===jl&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case _d:e:{for(var H=j.key,Z=b;Z!==null;){if(Z.key===H){if(H=j.type,H===jl){if(Z.tag===7){n(y,Z.sibling),b=i(Z,j.props.children),b.return=y,y=b;break e}}else if(Z.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Aa&&b1(H)===Z.type){n(y,Z.sibling),b=i(Z,j.props),b.ref=$c(y,Z,j),b.return=y,y=b;break e}n(y,Z);break}else e(y,Z);Z=Z.sibling}j.type===jl?(b=Co(j.props.children,y.mode,z,j.key),b.return=y,y=b):(z=uh(j.type,j.key,j.props,null,y.mode,z),z.ref=$c(y,b,j),z.return=y,y=z)}return o(y);case Nl:e:{for(Z=j.key;b!==null;){if(b.key===Z)if(b.tag===4&&b.stateNode.containerInfo===j.containerInfo&&b.stateNode.implementation===j.implementation){n(y,b.sibling),b=i(b,j.children||[]),b.return=y,y=b;break e}else{n(y,b);break}else e(y,b);b=b.sibling}b=bm(j,y.mode,z),b.return=y,y=b}return o(y);case Aa:return Z=j._init,k(y,b,Z(j._payload),z)}if(Kc(j))return N(y,b,j,z);if(Dc(j))return S(y,b,j,z);Dd(y,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,b!==null&&b.tag===6?(n(y,b.sibling),b=i(b,j),b.return=y,y=b):(n(y,b),b=ym(j,y.mode,z),b.return=y,y=b),o(y)):n(y,b)}return k}var Kl=Xv(!0),Zv=Xv(!1),Lh=Xa(null),Ih=null,Il=null,Cg=null;function kg(){Cg=Il=Ih=null}function Ag(t){var e=Lh.current;An(Lh),t._currentValue=e}function pp(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Bl(t,e){Ih=t,Cg=Il=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(as=!0),t.firstContext=null)}function Us(t){var e=t._currentValue;if(Cg!==t)if(t={context:t,memoizedValue:e,next:null},Il===null){if(Ih===null)throw Error(Qe(308));Il=t,Ih.dependencies={lanes:0,firstContext:t}}else Il=Il.next=t;return e}var jo=null;function Pg(t){jo===null?jo=[t]:jo.push(t)}function e2(t,e,n,s){var i=e.interleaved;return i===null?(n.next=n,Pg(e)):(n.next=i.next,i.next=n),e.interleaved=n,ta(t,s)}function ta(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pa=!1;function Lg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function t2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $a(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,rn&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,ta(t,n)}return i=s.interleaved,i===null?(e.next=e,Pg(s)):(e.next=i.next,i.next=e),s.interleaved=e,ta(t,n)}function sh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,pg(t,n)}}function w1(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=e:a=a.next=e}else i=a=e;n={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Th(t,e,n,s){var i=t.updateQueue;Pa=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?a=d:o.next=d,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(a!==null){var p=i.baseState;o=0,f=d=c=null,l=a;do{var v=l.lane,m=l.eventTime;if((s&v)===v){f!==null&&(f=f.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var N=t,S=l;switch(v=e,m=n,S.tag){case 1:if(N=S.payload,typeof N=="function"){p=N.call(m,p,v);break e}p=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=S.payload,v=typeof N=="function"?N.call(m,p,v):N,v==null)break e;p=Dn({},p,v);break e;case 2:Pa=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,v=i.effects,v===null?i.effects=[l]:v.push(l))}else m={eventTime:m,lane:v,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=m,c=p):f=f.next=m,o|=v;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;v=l,l=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(1);if(f===null&&(c=p),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);To|=o,t.lanes=o,t.memoizedState=p}}function N1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],i=s.callback;if(i!==null){if(s.callback=null,s=n,typeof i!="function")throw Error(Qe(191,i));i.call(s)}}}var $u={},Ii=Xa($u),Cu=Xa($u),ku=Xa($u);function So(t){if(t===$u)throw Error(Qe(174));return t}function Ig(t,e){switch(jn(ku,e),jn(Cu,t),jn(Ii,$u),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Km(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Km(e,t)}An(Ii),jn(Ii,e)}function Yl(){An(Ii),An(Cu),An(ku)}function n2(t){So(ku.current);var e=So(Ii.current),n=Km(e,t.type);e!==n&&(jn(Cu,t),jn(Ii,n))}function Tg(t){Cu.current===t&&(An(Ii),An(Cu))}var zn=Xa(0);function Eh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var fm=[];function Eg(){for(var t=0;t<fm.length;t++)fm[t]._workInProgressVersionPrimary=null;fm.length=0}var ih=ra.ReactCurrentDispatcher,mm=ra.ReactCurrentBatchConfig,Io=0,On=null,ar=null,fr=null,zh=!1,au=!1,Au=0,Ew=0;function Ar(){throw Error(Qe(321))}function zg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ui(t[n],e[n]))return!1;return!0}function Og(t,e,n,s,i,a){if(Io=a,On=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ih.current=t===null||t.memoizedState===null?Mw:Rw,t=n(s,i),au){a=0;do{if(au=!1,Au=0,25<=a)throw Error(Qe(301));a+=1,fr=ar=null,e.updateQueue=null,ih.current=Fw,t=n(s,i)}while(au)}if(ih.current=Oh,e=ar!==null&&ar.next!==null,Io=0,fr=ar=On=null,zh=!1,e)throw Error(Qe(300));return t}function Dg(){var t=Au!==0;return Au=0,t}function _i(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?On.memoizedState=fr=t:fr=fr.next=t,fr}function Hs(){if(ar===null){var t=On.alternate;t=t!==null?t.memoizedState:null}else t=ar.next;var e=fr===null?On.memoizedState:fr.next;if(e!==null)fr=e,ar=t;else{if(t===null)throw Error(Qe(310));ar=t,t={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},fr===null?On.memoizedState=fr=t:fr=fr.next=t}return fr}function Pu(t,e){return typeof e=="function"?e(t):e}function pm(t){var e=Hs(),n=e.queue;if(n===null)throw Error(Qe(311));n.lastRenderedReducer=t;var s=ar,i=s.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}s.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,s=s.baseState;var l=o=null,c=null,d=a;do{var f=d.lane;if((Io&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=s):c=c.next=p,On.lanes|=f,To|=f}d=d.next}while(d!==null&&d!==a);c===null?o=s:c.next=l,ui(s,e.memoizedState)||(as=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,n.lastRenderedState=s}if(t=n.interleaved,t!==null){i=t;do a=i.lane,On.lanes|=a,To|=a,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function gm(t){var e=Hs(),n=e.queue;if(n===null)throw Error(Qe(311));n.lastRenderedReducer=t;var s=n.dispatch,i=n.pending,a=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=t(a,o.action),o=o.next;while(o!==i);ui(a,e.memoizedState)||(as=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,s]}function r2(){}function s2(t,e){var n=On,s=Hs(),i=e(),a=!ui(s.memoizedState,i);if(a&&(s.memoizedState=i,as=!0),s=s.queue,Mg(o2.bind(null,n,s,t),[t]),s.getSnapshot!==e||a||fr!==null&&fr.memoizedState.tag&1){if(n.flags|=2048,Lu(9,a2.bind(null,n,s,i,e),void 0,null),pr===null)throw Error(Qe(349));Io&30||i2(n,e,i)}return i}function i2(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=On.updateQueue,e===null?(e={lastEffect:null,stores:null},On.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function a2(t,e,n,s){e.value=n,e.getSnapshot=s,l2(e)&&c2(t)}function o2(t,e,n){return n(function(){l2(e)&&c2(t)})}function l2(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ui(t,n)}catch{return!0}}function c2(t){var e=ta(t,1);e!==null&&li(e,t,1,-1)}function j1(t){var e=_i();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pu,lastRenderedState:t},e.queue=t,t=t.dispatch=Dw.bind(null,On,t),[e.memoizedState,t]}function Lu(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=On.updateQueue,e===null?(e={lastEffect:null,stores:null},On.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function u2(){return Hs().memoizedState}function ah(t,e,n,s){var i=_i();On.flags|=t,i.memoizedState=Lu(1|e,n,void 0,s===void 0?null:s)}function ef(t,e,n,s){var i=Hs();s=s===void 0?null:s;var a=void 0;if(ar!==null){var o=ar.memoizedState;if(a=o.destroy,s!==null&&zg(s,o.deps)){i.memoizedState=Lu(e,n,a,s);return}}On.flags|=t,i.memoizedState=Lu(1|e,n,a,s)}function S1(t,e){return ah(8390656,8,t,e)}function Mg(t,e){return ef(2048,8,t,e)}function d2(t,e){return ef(4,2,t,e)}function h2(t,e){return ef(4,4,t,e)}function f2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function m2(t,e,n){return n=n!=null?n.concat([t]):null,ef(4,4,f2.bind(null,e,t),n)}function Rg(){}function p2(t,e){var n=Hs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&zg(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function g2(t,e){var n=Hs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&zg(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function x2(t,e,n){return Io&21?(ui(n,e)||(n=Nv(),On.lanes|=n,To|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,as=!0),t.memoizedState=n)}function zw(t,e){var n=fn;fn=n!==0&&4>n?n:4,t(!0);var s=mm.transition;mm.transition={};try{t(!1),e()}finally{fn=n,mm.transition=s}}function v2(){return Hs().memoizedState}function Ow(t,e,n){var s=Ua(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},y2(t))b2(e,n);else if(n=e2(t,e,n,s),n!==null){var i=Jr();li(n,t,s,i),w2(n,e,s)}}function Dw(t,e,n){var s=Ua(t),i={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(y2(t))b2(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,n);if(i.hasEagerState=!0,i.eagerState=l,ui(l,o)){var c=e.interleaved;c===null?(i.next=i,Pg(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=e2(t,e,i,s),n!==null&&(i=Jr(),li(n,t,s,i),w2(n,e,s))}}function y2(t){var e=t.alternate;return t===On||e!==null&&e===On}function b2(t,e){au=zh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function w2(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,pg(t,n)}}var Oh={readContext:Us,useCallback:Ar,useContext:Ar,useEffect:Ar,useImperativeHandle:Ar,useInsertionEffect:Ar,useLayoutEffect:Ar,useMemo:Ar,useReducer:Ar,useRef:Ar,useState:Ar,useDebugValue:Ar,useDeferredValue:Ar,useTransition:Ar,useMutableSource:Ar,useSyncExternalStore:Ar,useId:Ar,unstable_isNewReconciler:!1},Mw={readContext:Us,useCallback:function(t,e){return _i().memoizedState=[t,e===void 0?null:e],t},useContext:Us,useEffect:S1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ah(4194308,4,f2.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ah(4194308,4,t,e)},useInsertionEffect:function(t,e){return ah(4,2,t,e)},useMemo:function(t,e){var n=_i();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=_i();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=Ow.bind(null,On,t),[s.memoizedState,t]},useRef:function(t){var e=_i();return t={current:t},e.memoizedState=t},useState:j1,useDebugValue:Rg,useDeferredValue:function(t){return _i().memoizedState=t},useTransition:function(){var t=j1(!1),e=t[0];return t=zw.bind(null,t[1]),_i().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=On,i=_i();if(In){if(n===void 0)throw Error(Qe(407));n=n()}else{if(n=e(),pr===null)throw Error(Qe(349));Io&30||i2(s,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,S1(o2.bind(null,s,a,t),[t]),s.flags|=2048,Lu(9,a2.bind(null,s,a,n,e),void 0,null),n},useId:function(){var t=_i(),e=pr.identifierPrefix;if(In){var n=Yi,s=Ki;n=(s&~(1<<32-oi(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Au++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Ew++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Rw={readContext:Us,useCallback:p2,useContext:Us,useEffect:Mg,useImperativeHandle:m2,useInsertionEffect:d2,useLayoutEffect:h2,useMemo:g2,useReducer:pm,useRef:u2,useState:function(){return pm(Pu)},useDebugValue:Rg,useDeferredValue:function(t){var e=Hs();return x2(e,ar.memoizedState,t)},useTransition:function(){var t=pm(Pu)[0],e=Hs().memoizedState;return[t,e]},useMutableSource:r2,useSyncExternalStore:s2,useId:v2,unstable_isNewReconciler:!1},Fw={readContext:Us,useCallback:p2,useContext:Us,useEffect:Mg,useImperativeHandle:m2,useInsertionEffect:d2,useLayoutEffect:h2,useMemo:g2,useReducer:gm,useRef:u2,useState:function(){return gm(Pu)},useDebugValue:Rg,useDeferredValue:function(t){var e=Hs();return ar===null?e.memoizedState=t:x2(e,ar.memoizedState,t)},useTransition:function(){var t=gm(Pu)[0],e=Hs().memoizedState;return[t,e]},useMutableSource:r2,useSyncExternalStore:s2,useId:v2,unstable_isNewReconciler:!1};function ni(t,e){if(t&&t.defaultProps){e=Dn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function gp(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Dn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var tf={isMounted:function(t){return(t=t._reactInternals)?Oo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Jr(),i=Ua(t),a=Xi(s,i);a.payload=e,n!=null&&(a.callback=n),e=$a(t,a,i),e!==null&&(li(e,t,i,s),sh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Jr(),i=Ua(t),a=Xi(s,i);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=$a(t,a,i),e!==null&&(li(e,t,i,s),sh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Jr(),s=Ua(t),i=Xi(n,s);i.tag=2,e!=null&&(i.callback=e),e=$a(t,i,s),e!==null&&(li(e,t,s,n),sh(e,t,s))}};function _1(t,e,n,s,i,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,a,o):e.prototype&&e.prototype.isPureReactComponent?!Nu(n,s)||!Nu(i,a):!0}function N2(t,e,n){var s=!1,i=Ga,a=e.contextType;return typeof a=="object"&&a!==null?a=Us(a):(i=cs(e)?Po:Mr.current,s=e.contextTypes,a=(s=s!=null)?Wl(t,i):Ga),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=tf,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function C1(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&tf.enqueueReplaceState(e,e.state,null)}function xp(t,e,n,s){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Lg(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=Us(a):(a=cs(e)?Po:Mr.current,i.context=Wl(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(gp(t,e,a,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&tf.enqueueReplaceState(i,i.state,null),Th(t,n,i,s),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ql(t,e){try{var n="",s=e;do n+=fb(s),s=s.return;while(s);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function xm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function vp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Bw=typeof WeakMap=="function"?WeakMap:Map;function j2(t,e,n){n=Xi(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){Mh||(Mh=!0,Ap=s),vp(t,e)},n}function S2(t,e,n){n=Xi(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;n.payload=function(){return s(i)},n.callback=function(){vp(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){vp(t,e),typeof s!="function"&&(qa===null?qa=new Set([this]):qa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function k1(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new Bw;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(n)||(i.add(n),t=eN.bind(null,t,e,n),e.then(t,t))}function A1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function P1(t,e,n,s,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Xi(-1,1),e.tag=2,$a(n,e,1))),n.lanes|=1),t)}var $w=ra.ReactCurrentOwner,as=!1;function Hr(t,e,n,s){e.child=t===null?Zv(e,null,n,s):Kl(e,t.child,n,s)}function L1(t,e,n,s,i){n=n.render;var a=e.ref;return Bl(e,i),s=Og(t,e,n,s,a,i),n=Dg(),t!==null&&!as?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,na(t,e,i)):(In&&n&&jg(e),e.flags|=1,Hr(t,e,s,i),e.child)}function I1(t,e,n,s,i){if(t===null){var a=n.type;return typeof a=="function"&&!Gg(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,_2(t,e,a,s,i)):(t=uh(n.type,null,s,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Nu,n(o,s)&&t.ref===e.ref)return na(t,e,i)}return e.flags|=1,t=Ha(a,s),t.ref=e.ref,t.return=e,e.child=t}function _2(t,e,n,s,i){if(t!==null){var a=t.memoizedProps;if(Nu(a,s)&&t.ref===e.ref)if(as=!1,e.pendingProps=s=a,(t.lanes&i)!==0)t.flags&131072&&(as=!0);else return e.lanes=t.lanes,na(t,e,i)}return yp(t,e,n,s,i)}function C2(t,e,n){var s=e.pendingProps,i=s.children,a=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},jn(El,vs),vs|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,jn(El,vs),vs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:n,jn(El,vs),vs|=s}else a!==null?(s=a.baseLanes|n,e.memoizedState=null):s=n,jn(El,vs),vs|=s;return Hr(t,e,i,n),e.child}function k2(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function yp(t,e,n,s,i){var a=cs(n)?Po:Mr.current;return a=Wl(e,a),Bl(e,i),n=Og(t,e,n,s,a,i),s=Dg(),t!==null&&!as?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,na(t,e,i)):(In&&s&&jg(e),e.flags|=1,Hr(t,e,n,i),e.child)}function T1(t,e,n,s,i){if(cs(n)){var a=!0;kh(e)}else a=!1;if(Bl(e,i),e.stateNode===null)oh(t,e),N2(e,n,s),xp(e,n,s,i),s=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Us(d):(d=cs(n)?Po:Mr.current,d=Wl(e,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==d)&&C1(e,o,s,d),Pa=!1;var v=e.memoizedState;o.state=v,Th(e,s,o,i),c=e.memoizedState,l!==s||v!==c||ls.current||Pa?(typeof f=="function"&&(gp(e,n,f,s),c=e.memoizedState),(l=Pa||_1(e,n,l,s,v,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=d,s=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,t2(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:ni(e.type,l),o.props=d,p=e.pendingProps,v=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Us(c):(c=cs(n)?Po:Mr.current,c=Wl(e,c));var m=n.getDerivedStateFromProps;(f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||v!==c)&&C1(e,o,s,c),Pa=!1,v=e.memoizedState,o.state=v,Th(e,s,o,i);var N=e.memoizedState;l!==p||v!==N||ls.current||Pa?(typeof m=="function"&&(gp(e,n,m,s),N=e.memoizedState),(d=Pa||_1(e,n,d,s,v,N,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,N,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,N,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=N),o.props=s,o.state=N,o.context=c,s=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),s=!1)}return bp(t,e,n,s,a,i)}function bp(t,e,n,s,i,a){k2(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return i&&x1(e,n,!1),na(t,e,a);s=e.stateNode,$w.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=Kl(e,t.child,null,a),e.child=Kl(e,null,l,a)):Hr(t,e,l,a),e.memoizedState=s.state,i&&x1(e,n,!0),e.child}function A2(t){var e=t.stateNode;e.pendingContext?g1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&g1(t,e.context,!1),Ig(t,e.containerInfo)}function E1(t,e,n,s,i){return Jl(),_g(i),e.flags|=256,Hr(t,e,n,s),e.child}var wp={dehydrated:null,treeContext:null,retryLane:0};function Np(t){return{baseLanes:t,cachePool:null,transitions:null}}function P2(t,e,n){var s=e.pendingProps,i=zn.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),jn(zn,i&1),t===null)return mp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,a?(s=e.mode,a=e.child,o={mode:"hidden",children:o},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=sf(o,s,0,null),t=Co(t,s,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Np(n),e.memoizedState=wp,t):Fg(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return qw(t,e,o,s,l,i,n);if(a){a=s.fallback,o=e.mode,i=t.child,l=i.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Ha(i,c),s.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=Ha(l,a):(a=Co(a,o,n,null),a.flags|=2),a.return=e,s.return=e,s.sibling=a,e.child=s,s=a,a=e.child,o=t.child.memoizedState,o=o===null?Np(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~n,e.memoizedState=wp,s}return a=t.child,t=a.sibling,s=Ha(a,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Fg(t,e){return e=sf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Md(t,e,n,s){return s!==null&&_g(s),Kl(e,t.child,null,n),t=Fg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function qw(t,e,n,s,i,a,o){if(n)return e.flags&256?(e.flags&=-257,s=xm(Error(Qe(422))),Md(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=s.fallback,i=e.mode,s=sf({mode:"visible",children:s.children},i,0,null),a=Co(a,i,o,null),a.flags|=2,s.return=e,a.return=e,s.sibling=a,e.child=s,e.mode&1&&Kl(e,t.child,null,o),e.child.memoizedState=Np(o),e.memoizedState=wp,a);if(!(e.mode&1))return Md(t,e,o,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var l=s.dgst;return s=l,a=Error(Qe(419)),s=xm(a,s,void 0),Md(t,e,o,s)}if(l=(o&t.childLanes)!==0,as||l){if(s=pr,s!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,ta(t,i),li(s,t,i,-1))}return Vg(),s=xm(Error(Qe(421))),Md(t,e,o,s)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=tN.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,ys=Ba(i.nextSibling),ws=e,In=!0,ai=null,t!==null&&(Os[Ds++]=Ki,Os[Ds++]=Yi,Os[Ds++]=Lo,Ki=t.id,Yi=t.overflow,Lo=e),e=Fg(e,s.children),e.flags|=4096,e)}function z1(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),pp(t.return,e,n)}function vm(t,e,n,s,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=i)}function L2(t,e,n){var s=e.pendingProps,i=s.revealOrder,a=s.tail;if(Hr(t,e,s.children,n),s=zn.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&z1(t,n,e);else if(t.tag===19)z1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(jn(zn,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Eh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),vm(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Eh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}vm(e,!0,n,null,a);break;case"together":vm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function oh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function na(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),To|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Qe(153));if(e.child!==null){for(t=e.child,n=Ha(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ha(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Uw(t,e,n){switch(e.tag){case 3:A2(e),Jl();break;case 5:n2(e);break;case 1:cs(e.type)&&kh(e);break;case 4:Ig(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;jn(Lh,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(jn(zn,zn.current&1),e.flags|=128,null):n&e.child.childLanes?P2(t,e,n):(jn(zn,zn.current&1),t=na(t,e,n),t!==null?t.sibling:null);jn(zn,zn.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return L2(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),jn(zn,zn.current),s)break;return null;case 22:case 23:return e.lanes=0,C2(t,e,n)}return na(t,e,n)}var I2,jp,T2,E2;I2=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jp=function(){};T2=function(t,e,n,s){var i=t.memoizedProps;if(i!==s){t=e.stateNode,So(Ii.current);var a=null;switch(n){case"input":i=Vm(t,i),s=Vm(t,s),a=[];break;case"select":i=Dn({},i,{value:void 0}),s=Dn({},s,{value:void 0}),a=[];break;case"textarea":i=Jm(t,i),s=Jm(t,s),a=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=_h)}Ym(n,s);var o;n=null;for(d in i)if(!s.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(pu.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in s){var c=s[d];if(l=i!=null?i[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(pu.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&_n("scroll",t),a||l===c||(a=[])):(a=a||[]).push(d,c))}n&&(a=a||[]).push("style",n);var d=a;(e.updateQueue=d)&&(e.flags|=4)}};E2=function(t,e,n,s){n!==s&&(e.flags|=4)};function qc(t,e){if(!In)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Pr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function Hw(t,e,n){var s=e.pendingProps;switch(Sg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pr(e),null;case 1:return cs(e.type)&&Ch(),Pr(e),null;case 3:return s=e.stateNode,Yl(),An(ls),An(Mr),Eg(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Od(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ai!==null&&(Ip(ai),ai=null))),jp(t,e),Pr(e),null;case 5:Tg(e);var i=So(ku.current);if(n=e.type,t!==null&&e.stateNode!=null)T2(t,e,n,s,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(Qe(166));return Pr(e),null}if(t=So(Ii.current),Od(e)){s=e.stateNode,n=e.type;var a=e.memoizedProps;switch(s[ki]=e,s[_u]=a,t=(e.mode&1)!==0,n){case"dialog":_n("cancel",s),_n("close",s);break;case"iframe":case"object":case"embed":_n("load",s);break;case"video":case"audio":for(i=0;i<Qc.length;i++)_n(Qc[i],s);break;case"source":_n("error",s);break;case"img":case"image":case"link":_n("error",s),_n("load",s);break;case"details":_n("toggle",s);break;case"input":U0(s,a),_n("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},_n("invalid",s);break;case"textarea":V0(s,a),_n("invalid",s)}Ym(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?s.textContent!==l&&(a.suppressHydrationWarning!==!0&&zd(s.textContent,l,t),i=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&zd(s.textContent,l,t),i=["children",""+l]):pu.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&_n("scroll",s)}switch(n){case"input":Cd(s),H0(s,a,!0);break;case"textarea":Cd(s),G0(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=_h)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ov(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[ki]=e,t[_u]=s,I2(t,e,!1,!1),e.stateNode=t;e:{switch(o=Qm(n,s),n){case"dialog":_n("cancel",t),_n("close",t),i=s;break;case"iframe":case"object":case"embed":_n("load",t),i=s;break;case"video":case"audio":for(i=0;i<Qc.length;i++)_n(Qc[i],t);i=s;break;case"source":_n("error",t),i=s;break;case"img":case"image":case"link":_n("error",t),_n("load",t),i=s;break;case"details":_n("toggle",t),i=s;break;case"input":U0(t,s),i=Vm(t,s),_n("invalid",t);break;case"option":i=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},i=Dn({},s,{value:void 0}),_n("invalid",t);break;case"textarea":V0(t,s),i=Jm(t,s),_n("invalid",t);break;default:i=s}Ym(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?uv(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&lv(t,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&gu(t,c):typeof c=="number"&&gu(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(pu.hasOwnProperty(a)?c!=null&&a==="onScroll"&&_n("scroll",t):c!=null&&cg(t,a,c,o))}switch(n){case"input":Cd(t),H0(t,s,!1);break;case"textarea":Cd(t),G0(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Va(s.value));break;case"select":t.multiple=!!s.multiple,a=s.value,a!=null?Dl(t,!!s.multiple,a,!1):s.defaultValue!=null&&Dl(t,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=_h)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Pr(e),null;case 6:if(t&&e.stateNode!=null)E2(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(Qe(166));if(n=So(ku.current),So(Ii.current),Od(e)){if(s=e.stateNode,n=e.memoizedProps,s[ki]=e,(a=s.nodeValue!==n)&&(t=ws,t!==null))switch(t.tag){case 3:zd(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zd(s.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[ki]=e,e.stateNode=s}return Pr(e),null;case 13:if(An(zn),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(In&&ys!==null&&e.mode&1&&!(e.flags&128))Qv(),Jl(),e.flags|=98560,a=!1;else if(a=Od(e),s!==null&&s.dehydrated!==null){if(t===null){if(!a)throw Error(Qe(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Qe(317));a[ki]=e}else Jl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Pr(e),a=!1}else ai!==null&&(Ip(ai),ai=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||zn.current&1?lr===0&&(lr=3):Vg())),e.updateQueue!==null&&(e.flags|=4),Pr(e),null);case 4:return Yl(),jp(t,e),t===null&&ju(e.stateNode.containerInfo),Pr(e),null;case 10:return Ag(e.type._context),Pr(e),null;case 17:return cs(e.type)&&Ch(),Pr(e),null;case 19:if(An(zn),a=e.memoizedState,a===null)return Pr(e),null;if(s=(e.flags&128)!==0,o=a.rendering,o===null)if(s)qc(a,!1);else{if(lr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Eh(t),o!==null){for(e.flags|=128,qc(a,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)a=n,t=s,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return jn(zn,zn.current&1|2),e.child}t=t.sibling}a.tail!==null&&Wn()>Xl&&(e.flags|=128,s=!0,qc(a,!1),e.lanes=4194304)}else{if(!s)if(t=Eh(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),qc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!In)return Pr(e),null}else 2*Wn()-a.renderingStartTime>Xl&&n!==1073741824&&(e.flags|=128,s=!0,qc(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(n=a.last,n!==null?n.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Wn(),e.sibling=null,n=zn.current,jn(zn,s?n&1|2:n&1),e):(Pr(e),null);case 22:case 23:return Hg(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?vs&1073741824&&(Pr(e),e.subtreeFlags&6&&(e.flags|=8192)):Pr(e),null;case 24:return null;case 25:return null}throw Error(Qe(156,e.tag))}function Vw(t,e){switch(Sg(e),e.tag){case 1:return cs(e.type)&&Ch(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yl(),An(ls),An(Mr),Eg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Tg(e),null;case 13:if(An(zn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Qe(340));Jl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return An(zn),null;case 4:return Yl(),null;case 10:return Ag(e.type._context),null;case 22:case 23:return Hg(),null;case 24:return null;default:return null}}var Rd=!1,Or=!1,Gw=typeof WeakSet=="function"?WeakSet:Set,ft=null;function Tl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){qn(t,e,s)}else n.current=null}function Sp(t,e,n){try{n()}catch(s){qn(t,e,s)}}var O1=!1;function Ww(t,e){if(op=Nh,t=Rv(),Ng(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var i=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,p=t,v=null;t:for(;;){for(var m;p!==n||i!==0&&p.nodeType!==3||(l=o+i),p!==a||s!==0&&p.nodeType!==3||(c=o+s),p.nodeType===3&&(o+=p.nodeValue.length),(m=p.firstChild)!==null;)v=p,p=m;for(;;){if(p===t)break t;if(v===n&&++d===i&&(l=o),v===a&&++f===s&&(c=o),(m=p.nextSibling)!==null)break;p=v,v=p.parentNode}p=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(lp={focusedElem:t,selectionRange:n},Nh=!1,ft=e;ft!==null;)if(e=ft,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ft=t;else for(;ft!==null;){e=ft;try{var N=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var S=N.memoizedProps,k=N.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?S:ni(e.type,S),k);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var j=e.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Qe(163))}}catch(z){qn(e,e.return,z)}if(t=e.sibling,t!==null){t.return=e.return,ft=t;break}ft=e.return}return N=O1,O1=!1,N}function ou(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&Sp(e,n,a)}i=i.next}while(i!==s)}}function nf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function _p(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function z2(t){var e=t.alternate;e!==null&&(t.alternate=null,z2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ki],delete e[_u],delete e[dp],delete e[Pw],delete e[Lw])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function O2(t){return t.tag===5||t.tag===3||t.tag===4}function D1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||O2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Cp(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=_h));else if(s!==4&&(t=t.child,t!==null))for(Cp(t,e,n),t=t.sibling;t!==null;)Cp(t,e,n),t=t.sibling}function kp(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(kp(t,e,n),t=t.sibling;t!==null;)kp(t,e,n),t=t.sibling}var wr=null,si=!1;function Na(t,e,n){for(n=n.child;n!==null;)D2(t,e,n),n=n.sibling}function D2(t,e,n){if(Li&&typeof Li.onCommitFiberUnmount=="function")try{Li.onCommitFiberUnmount(Jh,n)}catch{}switch(n.tag){case 5:Or||Tl(n,e);case 6:var s=wr,i=si;wr=null,Na(t,e,n),wr=s,si=i,wr!==null&&(si?(t=wr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):wr.removeChild(n.stateNode));break;case 18:wr!==null&&(si?(t=wr,n=n.stateNode,t.nodeType===8?dm(t.parentNode,n):t.nodeType===1&&dm(t,n),bu(t)):dm(wr,n.stateNode));break;case 4:s=wr,i=si,wr=n.stateNode.containerInfo,si=!0,Na(t,e,n),wr=s,si=i;break;case 0:case 11:case 14:case 15:if(!Or&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Sp(n,e,o),i=i.next}while(i!==s)}Na(t,e,n);break;case 1:if(!Or&&(Tl(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(l){qn(n,e,l)}Na(t,e,n);break;case 21:Na(t,e,n);break;case 22:n.mode&1?(Or=(s=Or)||n.memoizedState!==null,Na(t,e,n),Or=s):Na(t,e,n);break;default:Na(t,e,n)}}function M1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Gw),e.forEach(function(s){var i=nN.bind(null,t,s);n.has(s)||(n.add(s),s.then(i,i))})}}function Xs(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var i=n[s];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:wr=l.stateNode,si=!1;break e;case 3:wr=l.stateNode.containerInfo,si=!0;break e;case 4:wr=l.stateNode.containerInfo,si=!0;break e}l=l.return}if(wr===null)throw Error(Qe(160));D2(a,o,i),wr=null,si=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){qn(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)M2(e,t),e=e.sibling}function M2(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xs(e,t),Ni(t),s&4){try{ou(3,t,t.return),nf(3,t)}catch(S){qn(t,t.return,S)}try{ou(5,t,t.return)}catch(S){qn(t,t.return,S)}}break;case 1:Xs(e,t),Ni(t),s&512&&n!==null&&Tl(n,n.return);break;case 5:if(Xs(e,t),Ni(t),s&512&&n!==null&&Tl(n,n.return),t.flags&32){var i=t.stateNode;try{gu(i,"")}catch(S){qn(t,t.return,S)}}if(s&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,o=n!==null?n.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&iv(i,a),Qm(l,o);var d=Qm(l,a);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?uv(i,p):f==="dangerouslySetInnerHTML"?lv(i,p):f==="children"?gu(i,p):cg(i,f,p,d)}switch(l){case"input":Gm(i,a);break;case"textarea":av(i,a);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Dl(i,!!a.multiple,m,!1):v!==!!a.multiple&&(a.defaultValue!=null?Dl(i,!!a.multiple,a.defaultValue,!0):Dl(i,!!a.multiple,a.multiple?[]:"",!1))}i[_u]=a}catch(S){qn(t,t.return,S)}}break;case 6:if(Xs(e,t),Ni(t),s&4){if(t.stateNode===null)throw Error(Qe(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(S){qn(t,t.return,S)}}break;case 3:if(Xs(e,t),Ni(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{bu(e.containerInfo)}catch(S){qn(t,t.return,S)}break;case 4:Xs(e,t),Ni(t);break;case 13:Xs(e,t),Ni(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(qg=Wn())),s&4&&M1(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Or=(d=Or)||f,Xs(e,t),Or=d):Xs(e,t),Ni(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(ft=t,f=t.child;f!==null;){for(p=ft=f;ft!==null;){switch(v=ft,m=v.child,v.tag){case 0:case 11:case 14:case 15:ou(4,v,v.return);break;case 1:Tl(v,v.return);var N=v.stateNode;if(typeof N.componentWillUnmount=="function"){s=v,n=v.return;try{e=s,N.props=e.memoizedProps,N.state=e.memoizedState,N.componentWillUnmount()}catch(S){qn(s,n,S)}}break;case 5:Tl(v,v.return);break;case 22:if(v.memoizedState!==null){F1(p);continue}}m!==null?(m.return=v,ft=m):F1(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,d?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=cv("display",o))}catch(S){qn(t,t.return,S)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(S){qn(t,t.return,S)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Xs(e,t),Ni(t),s&4&&M1(t);break;case 21:break;default:Xs(e,t),Ni(t)}}function Ni(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(O2(n)){var s=n;break e}n=n.return}throw Error(Qe(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(gu(i,""),s.flags&=-33);var a=D1(t);kp(t,a,i);break;case 3:case 4:var o=s.stateNode.containerInfo,l=D1(t);Cp(t,l,o);break;default:throw Error(Qe(161))}}catch(c){qn(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Jw(t,e,n){ft=t,R2(t)}function R2(t,e,n){for(var s=(t.mode&1)!==0;ft!==null;){var i=ft,a=i.child;if(i.tag===22&&s){var o=i.memoizedState!==null||Rd;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Or;l=Rd;var d=Or;if(Rd=o,(Or=c)&&!d)for(ft=i;ft!==null;)o=ft,c=o.child,o.tag===22&&o.memoizedState!==null?B1(i):c!==null?(c.return=o,ft=c):B1(i);for(;a!==null;)ft=a,R2(a),a=a.sibling;ft=i,Rd=l,Or=d}R1(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,ft=a):R1(t)}}function R1(t){for(;ft!==null;){var e=ft;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Or||nf(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Or)if(n===null)s.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ni(e.type,n.memoizedProps);s.componentDidUpdate(i,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&N1(e,a,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}N1(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&bu(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Qe(163))}Or||e.flags&512&&_p(e)}catch(v){qn(e,e.return,v)}}if(e===t){ft=null;break}if(n=e.sibling,n!==null){n.return=e.return,ft=n;break}ft=e.return}}function F1(t){for(;ft!==null;){var e=ft;if(e===t){ft=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ft=n;break}ft=e.return}}function B1(t){for(;ft!==null;){var e=ft;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{nf(4,e)}catch(c){qn(e,n,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){qn(e,i,c)}}var a=e.return;try{_p(e)}catch(c){qn(e,a,c)}break;case 5:var o=e.return;try{_p(e)}catch(c){qn(e,o,c)}}}catch(c){qn(e,e.return,c)}if(e===t){ft=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ft=l;break}ft=e.return}}var Kw=Math.ceil,Dh=ra.ReactCurrentDispatcher,Bg=ra.ReactCurrentOwner,Fs=ra.ReactCurrentBatchConfig,rn=0,pr=null,er=null,Nr=0,vs=0,El=Xa(0),lr=0,Iu=null,To=0,rf=0,$g=0,lu=null,rs=null,qg=0,Xl=1/0,Gi=null,Mh=!1,Ap=null,qa=null,Fd=!1,za=null,Rh=0,cu=0,Pp=null,lh=-1,ch=0;function Jr(){return rn&6?Wn():lh!==-1?lh:lh=Wn()}function Ua(t){return t.mode&1?rn&2&&Nr!==0?Nr&-Nr:Tw.transition!==null?(ch===0&&(ch=Nv()),ch):(t=fn,t!==0||(t=window.event,t=t===void 0?16:Pv(t.type)),t):1}function li(t,e,n,s){if(50<cu)throw cu=0,Pp=null,Error(Qe(185));Ru(t,n,s),(!(rn&2)||t!==pr)&&(t===pr&&(!(rn&2)&&(rf|=n),lr===4&&Ia(t,Nr)),us(t,s),n===1&&rn===0&&!(e.mode&1)&&(Xl=Wn()+500,Zh&&Za()))}function us(t,e){var n=t.callbackNode;Tb(t,e);var s=wh(t,t===pr?Nr:0);if(s===0)n!==null&&K0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&K0(n),e===1)t.tag===0?Iw($1.bind(null,t)):Jv($1.bind(null,t)),kw(function(){!(rn&6)&&Za()}),n=null;else{switch(jv(s)){case 1:n=mg;break;case 4:n=bv;break;case 16:n=bh;break;case 536870912:n=wv;break;default:n=bh}n=G2(n,F2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function F2(t,e){if(lh=-1,ch=0,rn&6)throw Error(Qe(327));var n=t.callbackNode;if($l()&&t.callbackNode!==n)return null;var s=wh(t,t===pr?Nr:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Fh(t,s);else{e=s;var i=rn;rn|=2;var a=$2();(pr!==t||Nr!==e)&&(Gi=null,Xl=Wn()+500,_o(t,e));do try{Xw();break}catch(l){B2(t,l)}while(1);kg(),Dh.current=a,rn=i,er!==null?e=0:(pr=null,Nr=0,e=lr)}if(e!==0){if(e===2&&(i=np(t),i!==0&&(s=i,e=Lp(t,i))),e===1)throw n=Iu,_o(t,0),Ia(t,s),us(t,Wn()),n;if(e===6)Ia(t,s);else{if(i=t.current.alternate,!(s&30)&&!Yw(i)&&(e=Fh(t,s),e===2&&(a=np(t),a!==0&&(s=a,e=Lp(t,a))),e===1))throw n=Iu,_o(t,0),Ia(t,s),us(t,Wn()),n;switch(t.finishedWork=i,t.finishedLanes=s,e){case 0:case 1:throw Error(Qe(345));case 2:xo(t,rs,Gi);break;case 3:if(Ia(t,s),(s&130023424)===s&&(e=qg+500-Wn(),10<e)){if(wh(t,0)!==0)break;if(i=t.suspendedLanes,(i&s)!==s){Jr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=up(xo.bind(null,t,rs,Gi),e);break}xo(t,rs,Gi);break;case 4:if(Ia(t,s),(s&4194240)===s)break;for(e=t.eventTimes,i=-1;0<s;){var o=31-oi(s);a=1<<o,o=e[o],o>i&&(i=o),s&=~a}if(s=i,s=Wn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Kw(s/1960))-s,10<s){t.timeoutHandle=up(xo.bind(null,t,rs,Gi),s);break}xo(t,rs,Gi);break;case 5:xo(t,rs,Gi);break;default:throw Error(Qe(329))}}}return us(t,Wn()),t.callbackNode===n?F2.bind(null,t):null}function Lp(t,e){var n=lu;return t.current.memoizedState.isDehydrated&&(_o(t,e).flags|=256),t=Fh(t,e),t!==2&&(e=rs,rs=n,e!==null&&Ip(e)),t}function Ip(t){rs===null?rs=t:rs.push.apply(rs,t)}function Yw(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var i=n[s],a=i.getSnapshot;i=i.value;try{if(!ui(a(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ia(t,e){for(e&=~$g,e&=~rf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-oi(e),s=1<<n;t[n]=-1,e&=~s}}function $1(t){if(rn&6)throw Error(Qe(327));$l();var e=wh(t,0);if(!(e&1))return us(t,Wn()),null;var n=Fh(t,e);if(t.tag!==0&&n===2){var s=np(t);s!==0&&(e=s,n=Lp(t,s))}if(n===1)throw n=Iu,_o(t,0),Ia(t,e),us(t,Wn()),n;if(n===6)throw Error(Qe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xo(t,rs,Gi),us(t,Wn()),null}function Ug(t,e){var n=rn;rn|=1;try{return t(e)}finally{rn=n,rn===0&&(Xl=Wn()+500,Zh&&Za())}}function Eo(t){za!==null&&za.tag===0&&!(rn&6)&&$l();var e=rn;rn|=1;var n=Fs.transition,s=fn;try{if(Fs.transition=null,fn=1,t)return t()}finally{fn=s,Fs.transition=n,rn=e,!(rn&6)&&Za()}}function Hg(){vs=El.current,An(El)}function _o(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Cw(n)),er!==null)for(n=er.return;n!==null;){var s=n;switch(Sg(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ch();break;case 3:Yl(),An(ls),An(Mr),Eg();break;case 5:Tg(s);break;case 4:Yl();break;case 13:An(zn);break;case 19:An(zn);break;case 10:Ag(s.type._context);break;case 22:case 23:Hg()}n=n.return}if(pr=t,er=t=Ha(t.current,null),Nr=vs=e,lr=0,Iu=null,$g=rf=To=0,rs=lu=null,jo!==null){for(e=0;e<jo.length;e++)if(n=jo[e],s=n.interleaved,s!==null){n.interleaved=null;var i=s.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,s.next=o}n.pending=s}jo=null}return t}function B2(t,e){do{var n=er;try{if(kg(),ih.current=Oh,zh){for(var s=On.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}zh=!1}if(Io=0,fr=ar=On=null,au=!1,Au=0,Bg.current=null,n===null||n.return===null){lr=1,Iu=e,er=null;break}e:{var a=t,o=n.return,l=n,c=e;if(e=Nr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var v=f.alternate;v?(f.updateQueue=v.updateQueue,f.memoizedState=v.memoizedState,f.lanes=v.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=A1(o);if(m!==null){m.flags&=-257,P1(m,o,l,a,e),m.mode&1&&k1(a,d,e),e=m,c=d;var N=e.updateQueue;if(N===null){var S=new Set;S.add(c),e.updateQueue=S}else N.add(c);break e}else{if(!(e&1)){k1(a,d,e),Vg();break e}c=Error(Qe(426))}}else if(In&&l.mode&1){var k=A1(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),P1(k,o,l,a,e),_g(Ql(c,l));break e}}a=c=Ql(c,l),lr!==4&&(lr=2),lu===null?lu=[a]:lu.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var y=j2(a,c,e);w1(a,y);break e;case 1:l=c;var b=a.type,j=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(qa===null||!qa.has(j)))){a.flags|=65536,e&=-e,a.lanes|=e;var z=S2(a,l,e);w1(a,z);break e}}a=a.return}while(a!==null)}U2(n)}catch(H){e=H,er===n&&n!==null&&(er=n=n.return);continue}break}while(1)}function $2(){var t=Dh.current;return Dh.current=Oh,t===null?Oh:t}function Vg(){(lr===0||lr===3||lr===2)&&(lr=4),pr===null||!(To&268435455)&&!(rf&268435455)||Ia(pr,Nr)}function Fh(t,e){var n=rn;rn|=2;var s=$2();(pr!==t||Nr!==e)&&(Gi=null,_o(t,e));do try{Qw();break}catch(i){B2(t,i)}while(1);if(kg(),rn=n,Dh.current=s,er!==null)throw Error(Qe(261));return pr=null,Nr=0,lr}function Qw(){for(;er!==null;)q2(er)}function Xw(){for(;er!==null&&!jb();)q2(er)}function q2(t){var e=V2(t.alternate,t,vs);t.memoizedProps=t.pendingProps,e===null?U2(t):er=e,Bg.current=null}function U2(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Vw(n,e),n!==null){n.flags&=32767,er=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{lr=6,er=null;return}}else if(n=Hw(n,e,vs),n!==null){er=n;return}if(e=e.sibling,e!==null){er=e;return}er=e=t}while(e!==null);lr===0&&(lr=5)}function xo(t,e,n){var s=fn,i=Fs.transition;try{Fs.transition=null,fn=1,Zw(t,e,n,s)}finally{Fs.transition=i,fn=s}return null}function Zw(t,e,n,s){do $l();while(za!==null);if(rn&6)throw Error(Qe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Qe(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(Eb(t,a),t===pr&&(er=pr=null,Nr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Fd||(Fd=!0,G2(bh,function(){return $l(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Fs.transition,Fs.transition=null;var o=fn;fn=1;var l=rn;rn|=4,Bg.current=null,Ww(t,n),M2(n,t),yw(lp),Nh=!!op,lp=op=null,t.current=n,Jw(n),Sb(),rn=l,fn=o,Fs.transition=a}else t.current=n;if(Fd&&(Fd=!1,za=t,Rh=i),a=t.pendingLanes,a===0&&(qa=null),kb(n.stateNode),us(t,Wn()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],s(i.value,{componentStack:i.stack,digest:i.digest});if(Mh)throw Mh=!1,t=Ap,Ap=null,t;return Rh&1&&t.tag!==0&&$l(),a=t.pendingLanes,a&1?t===Pp?cu++:(cu=0,Pp=t):cu=0,Za(),null}function $l(){if(za!==null){var t=jv(Rh),e=Fs.transition,n=fn;try{if(Fs.transition=null,fn=16>t?16:t,za===null)var s=!1;else{if(t=za,za=null,Rh=0,rn&6)throw Error(Qe(331));var i=rn;for(rn|=4,ft=t.current;ft!==null;){var a=ft,o=a.child;if(ft.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ft=d;ft!==null;){var f=ft;switch(f.tag){case 0:case 11:case 15:ou(8,f,a)}var p=f.child;if(p!==null)p.return=f,ft=p;else for(;ft!==null;){f=ft;var v=f.sibling,m=f.return;if(z2(f),f===d){ft=null;break}if(v!==null){v.return=m,ft=v;break}ft=m}}}var N=a.alternate;if(N!==null){var S=N.child;if(S!==null){N.child=null;do{var k=S.sibling;S.sibling=null,S=k}while(S!==null)}}ft=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,ft=o;else e:for(;ft!==null;){if(a=ft,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ou(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,ft=y;break e}ft=a.return}}var b=t.current;for(ft=b;ft!==null;){o=ft;var j=o.child;if(o.subtreeFlags&2064&&j!==null)j.return=o,ft=j;else e:for(o=b;ft!==null;){if(l=ft,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:nf(9,l)}}catch(H){qn(l,l.return,H)}if(l===o){ft=null;break e}var z=l.sibling;if(z!==null){z.return=l.return,ft=z;break e}ft=l.return}}if(rn=i,Za(),Li&&typeof Li.onPostCommitFiberRoot=="function")try{Li.onPostCommitFiberRoot(Jh,t)}catch{}s=!0}return s}finally{fn=n,Fs.transition=e}}return!1}function q1(t,e,n){e=Ql(n,e),e=j2(t,e,1),t=$a(t,e,1),e=Jr(),t!==null&&(Ru(t,1,e),us(t,e))}function qn(t,e,n){if(t.tag===3)q1(t,t,n);else for(;e!==null;){if(e.tag===3){q1(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(qa===null||!qa.has(s))){t=Ql(n,t),t=S2(e,t,1),e=$a(e,t,1),t=Jr(),e!==null&&(Ru(e,1,t),us(e,t));break}}e=e.return}}function eN(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Jr(),t.pingedLanes|=t.suspendedLanes&n,pr===t&&(Nr&n)===n&&(lr===4||lr===3&&(Nr&130023424)===Nr&&500>Wn()-qg?_o(t,0):$g|=n),us(t,e)}function H2(t,e){e===0&&(t.mode&1?(e=Pd,Pd<<=1,!(Pd&130023424)&&(Pd=4194304)):e=1);var n=Jr();t=ta(t,e),t!==null&&(Ru(t,e,n),us(t,n))}function tN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),H2(t,n)}function nN(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(Qe(314))}s!==null&&s.delete(e),H2(t,n)}var V2;V2=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ls.current)as=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return as=!1,Uw(t,e,n);as=!!(t.flags&131072)}else as=!1,In&&e.flags&1048576&&Kv(e,Ph,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;oh(t,e),t=e.pendingProps;var i=Wl(e,Mr.current);Bl(e,n),i=Og(null,e,s,t,i,n);var a=Dg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cs(s)?(a=!0,kh(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Lg(e),i.updater=tf,e.stateNode=i,i._reactInternals=e,xp(e,s,t,n),e=bp(null,e,s,!0,a,n)):(e.tag=0,In&&a&&jg(e),Hr(null,e,i,n),e=e.child),e;case 16:s=e.elementType;e:{switch(oh(t,e),t=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=sN(s),t=ni(s,t),i){case 0:e=yp(null,e,s,t,n);break e;case 1:e=T1(null,e,s,t,n);break e;case 11:e=L1(null,e,s,t,n);break e;case 14:e=I1(null,e,s,ni(s.type,t),n);break e}throw Error(Qe(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ni(s,i),yp(t,e,s,i,n);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ni(s,i),T1(t,e,s,i,n);case 3:e:{if(A2(e),t===null)throw Error(Qe(387));s=e.pendingProps,a=e.memoizedState,i=a.element,t2(t,e),Th(e,s,null,n);var o=e.memoizedState;if(s=o.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=Ql(Error(Qe(423)),e),e=E1(t,e,s,n,i);break e}else if(s!==i){i=Ql(Error(Qe(424)),e),e=E1(t,e,s,n,i);break e}else for(ys=Ba(e.stateNode.containerInfo.firstChild),ws=e,In=!0,ai=null,n=Zv(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Jl(),s===i){e=na(t,e,n);break e}Hr(t,e,s,n)}e=e.child}return e;case 5:return n2(e),t===null&&mp(e),s=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,o=i.children,cp(s,i)?o=null:a!==null&&cp(s,a)&&(e.flags|=32),k2(t,e),Hr(t,e,o,n),e.child;case 6:return t===null&&mp(e),null;case 13:return P2(t,e,n);case 4:return Ig(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Kl(e,null,s,n):Hr(t,e,s,n),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ni(s,i),L1(t,e,s,i,n);case 7:return Hr(t,e,e.pendingProps,n),e.child;case 8:return Hr(t,e,e.pendingProps.children,n),e.child;case 12:return Hr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,a=e.memoizedProps,o=i.value,jn(Lh,s._currentValue),s._currentValue=o,a!==null)if(ui(a.value,o)){if(a.children===i.children&&!ls.current){e=na(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(a.tag===1){c=Xi(-1,n&-n),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),pp(a.return,n,e),l.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Qe(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),pp(o,n,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Hr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,Bl(e,n),i=Us(i),s=s(i),e.flags|=1,Hr(t,e,s,n),e.child;case 14:return s=e.type,i=ni(s,e.pendingProps),i=ni(s.type,i),I1(t,e,s,i,n);case 15:return _2(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ni(s,i),oh(t,e),e.tag=1,cs(s)?(t=!0,kh(e)):t=!1,Bl(e,n),N2(e,s,i),xp(e,s,i,n),bp(null,e,s,!0,t,n);case 19:return L2(t,e,n);case 22:return C2(t,e,n)}throw Error(Qe(156,e.tag))};function G2(t,e){return yv(t,e)}function rN(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rs(t,e,n,s){return new rN(t,e,n,s)}function Gg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sN(t){if(typeof t=="function")return Gg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dg)return 11;if(t===hg)return 14}return 2}function Ha(t,e){var n=t.alternate;return n===null?(n=Rs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function uh(t,e,n,s,i,a){var o=2;if(s=t,typeof t=="function")Gg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case jl:return Co(n.children,i,a,e);case ug:o=8,i|=8;break;case $m:return t=Rs(12,n,e,i|2),t.elementType=$m,t.lanes=a,t;case qm:return t=Rs(13,n,e,i),t.elementType=qm,t.lanes=a,t;case Um:return t=Rs(19,n,e,i),t.elementType=Um,t.lanes=a,t;case nv:return sf(n,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ev:o=10;break e;case tv:o=9;break e;case dg:o=11;break e;case hg:o=14;break e;case Aa:o=16,s=null;break e}throw Error(Qe(130,t==null?t:typeof t,""))}return e=Rs(o,n,e,i),e.elementType=t,e.type=s,e.lanes=a,e}function Co(t,e,n,s){return t=Rs(7,t,s,e),t.lanes=n,t}function sf(t,e,n,s){return t=Rs(22,t,s,e),t.elementType=nv,t.lanes=n,t.stateNode={isHidden:!1},t}function ym(t,e,n){return t=Rs(6,t,null,e),t.lanes=n,t}function bm(t,e,n){return e=Rs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function iN(t,e,n,s,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=em(0),this.expirationTimes=em(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=em(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Wg(t,e,n,s,i,a,o,l,c){return t=new iN(t,e,n,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Rs(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lg(a),t}function aN(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Nl,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function W2(t){if(!t)return Ga;t=t._reactInternals;e:{if(Oo(t)!==t||t.tag!==1)throw Error(Qe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Qe(171))}if(t.tag===1){var n=t.type;if(cs(n))return Wv(t,n,e)}return e}function J2(t,e,n,s,i,a,o,l,c){return t=Wg(n,s,!0,t,i,a,o,l,c),t.context=W2(null),n=t.current,s=Jr(),i=Ua(n),a=Xi(s,i),a.callback=e??null,$a(n,a,i),t.current.lanes=i,Ru(t,i,s),us(t,s),t}function af(t,e,n,s){var i=e.current,a=Jr(),o=Ua(i);return n=W2(n),e.context===null?e.context=n:e.pendingContext=n,e=Xi(a,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=$a(i,e,o),t!==null&&(li(t,i,o,a),sh(t,i,o)),o}function Bh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function U1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Jg(t,e){U1(t,e),(t=t.alternate)&&U1(t,e)}function oN(){return null}var K2=typeof reportError=="function"?reportError:function(t){console.error(t)};function Kg(t){this._internalRoot=t}of.prototype.render=Kg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Qe(409));af(t,e,null,null)};of.prototype.unmount=Kg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Eo(function(){af(null,t,null,null)}),e[ea]=null}};function of(t){this._internalRoot=t}of.prototype.unstable_scheduleHydration=function(t){if(t){var e=Cv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<La.length&&e!==0&&e<La[n].priority;n++);La.splice(n,0,t),n===0&&Av(t)}};function Yg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function lf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function H1(){}function lN(t,e,n,s,i){if(i){if(typeof s=="function"){var a=s;s=function(){var d=Bh(o);a.call(d)}}var o=J2(e,s,t,0,null,!1,!1,"",H1);return t._reactRootContainer=o,t[ea]=o.current,ju(t.nodeType===8?t.parentNode:t),Eo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof s=="function"){var l=s;s=function(){var d=Bh(c);l.call(d)}}var c=Wg(t,0,!1,null,null,!1,!1,"",H1);return t._reactRootContainer=c,t[ea]=c.current,ju(t.nodeType===8?t.parentNode:t),Eo(function(){af(e,c,n,s)}),c}function cf(t,e,n,s,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var c=Bh(o);l.call(c)}}af(e,o,t,i)}else o=lN(n,e,t,i,s);return Bh(o)}Sv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Yc(e.pendingLanes);n!==0&&(pg(e,n|1),us(e,Wn()),!(rn&6)&&(Xl=Wn()+500,Za()))}break;case 13:Eo(function(){var s=ta(t,1);if(s!==null){var i=Jr();li(s,t,1,i)}}),Jg(t,1)}};gg=function(t){if(t.tag===13){var e=ta(t,134217728);if(e!==null){var n=Jr();li(e,t,134217728,n)}Jg(t,134217728)}};_v=function(t){if(t.tag===13){var e=Ua(t),n=ta(t,e);if(n!==null){var s=Jr();li(n,t,e,s)}Jg(t,e)}};Cv=function(){return fn};kv=function(t,e){var n=fn;try{return fn=t,e()}finally{fn=n}};Zm=function(t,e,n){switch(e){case"input":if(Gm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var i=Xh(s);if(!i)throw Error(Qe(90));sv(s),Gm(s,i)}}}break;case"textarea":av(t,n);break;case"select":e=n.value,e!=null&&Dl(t,!!n.multiple,e,!1)}};fv=Ug;mv=Eo;var cN={usingClientEntryPoint:!1,Events:[Bu,kl,Xh,dv,hv,Ug]},Uc={findFiberByHostInstance:No,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uN={bundleType:Uc.bundleType,version:Uc.version,rendererPackageName:Uc.rendererPackageName,rendererConfig:Uc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ra.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=xv(t),t===null?null:t.stateNode},findFiberByHostInstance:Uc.findFiberByHostInstance||oN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bd.isDisabled&&Bd.supportsFiber)try{Jh=Bd.inject(uN),Li=Bd}catch{}}js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cN;js.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yg(e))throw Error(Qe(200));return aN(t,e,null,n)};js.createRoot=function(t,e){if(!Yg(t))throw Error(Qe(299));var n=!1,s="",i=K2;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Wg(t,1,!1,null,null,n,!1,s,i),t[ea]=e.current,ju(t.nodeType===8?t.parentNode:t),new Kg(e)};js.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Qe(188)):(t=Object.keys(t).join(","),Error(Qe(268,t)));return t=xv(e),t=t===null?null:t.stateNode,t};js.flushSync=function(t){return Eo(t)};js.hydrate=function(t,e,n){if(!lf(e))throw Error(Qe(200));return cf(null,t,e,!0,n)};js.hydrateRoot=function(t,e,n){if(!Yg(t))throw Error(Qe(405));var s=n!=null&&n.hydratedSources||null,i=!1,a="",o=K2;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=J2(e,null,t,1,n??null,i,!1,a,o),t[ea]=e.current,ju(t),s)for(t=0;t<s.length;t++)n=s[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new of(e)};js.render=function(t,e,n){if(!lf(e))throw Error(Qe(200));return cf(null,t,e,!1,n)};js.unmountComponentAtNode=function(t){if(!lf(t))throw Error(Qe(40));return t._reactRootContainer?(Eo(function(){cf(null,null,t,!1,function(){t._reactRootContainer=null,t[ea]=null})}),!0):!1};js.unstable_batchedUpdates=Ug;js.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!lf(n))throw Error(Qe(200));if(t==null||t._reactInternals===void 0)throw Error(Qe(38));return cf(t,e,n,!1,s)};js.version="18.3.1-next-f1338f8080-20240426";function Y2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Y2)}catch(t){console.error(t)}}Y2(),Yx.exports=js;var dN=Yx.exports,V1=dN;Fm.createRoot=V1.createRoot,Fm.hydrateRoot=V1.hydrateRoot;var hN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const fN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mN=(t,e)=>{const n=W.forwardRef(({color:s="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,children:l,...c},d)=>W.createElement("svg",{ref:d,...hN,width:i,height:i,stroke:s,strokeWidth:o?Number(a)*24/Number(i):a,className:`lucide lucide-${fN(t)}`,...c},[...e.map(([f,p])=>W.createElement(f,p)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n};var ot=mN;const pN=ot("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),xn=ot("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),G1=ot("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]]),gN=ot("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Q2=ot("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Tp=ot("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),$h=ot("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Qi=ot("Bot",[["rect",{width:"18",height:"10",x:"3",y:"11",rx:"2",key:"1ofdy3"}],["circle",{cx:"12",cy:"5",r:"2",key:"f1ur92"}],["path",{d:"M12 7v4",key:"xawao1"}],["line",{x1:"8",x2:"8",y1:"16",y2:"16",key:"h6x27f"}],["line",{x1:"16",x2:"16",y1:"16",y2:"16",key:"5lty7f"}]]),Tu=ot("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),xN=ot("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),X2=ot("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),Cn=ot("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),W1=ot("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),$d=ot("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),vN=ot("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]),Z2=ot("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),yN=ot("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ey=ot("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),Eu=ot("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),bN=ot("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Bs=ot("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),wN=ot("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),NN=ot("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Ep=ot("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),jN=ot("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),SN=ot("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),ty=ot("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),J1=ot("FolderPlus",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["line",{x1:"12",x2:"12",y1:"10",y2:"16",key:"3c25pp"}],["line",{x1:"9",x2:"15",y1:"13",y2:"13",key:"10hoct"}]]),ji=ot("Folder",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}]]),Xc=ot("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),Qg=ot("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),pl=ot("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),$s=ot("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),_N=ot("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),CN=ot("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),kN=ot("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),AN=ot("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),PN=ot("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),ny=ot("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),qh=ot("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),LN=ot("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),IN=ot("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]),Un=ot("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),ci=ot("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),TN=ot("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),or=ot("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),zl=ot("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),dh=ot("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ry=ot("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),EN=ot("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),K1=ot("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]),gl=ot("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),sy=ot("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),os=ot("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Y1=ot("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),zN=ot("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),ON=ot("Snowflake",[["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"m20 16-4-4 4-4",key:"rquw4f"}],["path",{d:"m4 8 4 4-4 4",key:"12s3z9"}],["path",{d:"m16 4-4 4-4-4",key:"1tumq1"}],["path",{d:"m8 20 4-4 4 4",key:"9p200w"}]]),uf=ot("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),qd=ot("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),ds=ot("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),DN=ot("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]),MN=ot("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),tr=ot("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ko=ot("Truck",[["path",{d:"M10 17h4V5H2v12h3",key:"1jq12e"}],["path",{d:"M20 17h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5",key:"1xb3ft"}],["path",{d:"M14 17h1",key:"nufu4t"}],["circle",{cx:"7.5",cy:"17.5",r:"2.5",key:"a7aife"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),uu=ot("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),RN=ot("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ai=ot("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Q1=ot("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]),iy=ot("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),dn=ot("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),FN=ot("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Je({className:t,...e}){return r.jsx("div",{className:`rounded-lg border bg-white text-card-foreground shadow-sm ${t}`,...e})}function yt({className:t,...e}){return r.jsx("div",{className:`flex flex-col space-y-1.5 p-6 ${t}`,...e})}function Nt({className:t,...e}){return r.jsx("h3",{className:`text-2xl font-semibold leading-none tracking-tight ${t}`,...e})}function Xe({className:t,...e}){return r.jsx("div",{className:`p-6 pt-0 ${t}`,...e})}const ay=localStorage.getItem("haccp:debug")==="true"||window.location.search.includes("debug=true"),Se=(...t)=>{ay&&console.log(...t)},is=(...t)=>{console.error(...t)},zp=(...t)=>{console.warn(...t)},xl=(t,e=null)=>{ay&&console.log(`🔧 MAINT: ${t}`,e||"")};function BN({temperatures:t=[],cleaning:e=[],staff:n=[],products:s=[],currentUser:i}){const a=t.filter(c=>c.status==="ok").length,o=t.filter(c=>c.status==="danger").length,l=e.filter(c=>!c.completed).length;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsx(Je,{children:r.jsx(Xe,{className:"p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Cn,{className:"h-8 w-8 text-green-600"}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:a}),r.jsx("p",{className:"text-sm text-gray-600",children:"Temperature OK"})]})]})})}),r.jsx(Je,{children:r.jsx(Xe,{className:"p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(xn,{className:"h-8 w-8 text-red-600"}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-2xl font-bold text-red-600",children:o}),r.jsx("p",{className:"text-sm text-gray-600",children:"Problemi Temp."})]})]})})}),r.jsx(Je,{children:r.jsx(Xe,{className:"p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Un,{className:"h-8 w-8 text-blue-600"}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l}),r.jsx("p",{className:"text-sm text-gray-600",children:"Pulizie Pending"})]})]})})}),r.jsx(Je,{children:r.jsx(Xe,{className:"p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(xN,{className:"h-8 w-8 text-purple-600"}),r.jsxs("div",{className:"ml-4",children:[r.jsx("p",{className:"text-2xl font-bold text-purple-600",children:s.length}),r.jsx("p",{className:"text-sm text-gray-600",children:"Prodotti"})]})]})})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{children:["Benvenuto, ",i==null?void 0:i.name,"!"]})}),r.jsxs(Xe,{children:[r.jsx("p",{className:"text-gray-600",children:"Dashboard Business HACCP Manager"}),r.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Ruolo: ",(i==null?void 0:i.role)==="admin"?"Amministratore":"Dipendente"," • Reparto: ",i==null?void 0:i.department]}),(()=>{const c=localStorage.getItem("haccp-onboarding");if(!c||c==="[object Object]")return null;let d={};try{d=JSON.parse(c)}catch(f){return is("Errore parsing onboarding data:",f),null}return d.businessInfo?r.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[r.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Informazioni Azienda"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[d.businessInfo.businessName&&r.jsxs("div",{children:[r.jsx("span",{className:"text-blue-700 font-medium",children:"Nome Azienda:"}),r.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.businessName})]}),d.businessInfo.businessType&&r.jsxs("div",{children:[r.jsx("span",{className:"text-blue-700 font-medium",children:"Tipo Attività:"}),r.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.businessType})]}),d.businessInfo.address&&r.jsxs("div",{children:[r.jsx("span",{className:"text-blue-700 font-medium",children:"Indirizzo:"}),r.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.address})]}),d.businessInfo.phone&&r.jsxs("div",{children:[r.jsx("span",{className:"text-blue-700 font-medium",children:"Telefono:"}),r.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.phone})]}),d.businessInfo.email&&r.jsxs("div",{children:[r.jsx("span",{className:"text-blue-700 font-medium",children:"Email:"}),r.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.email})]}),d.businessInfo.vatNumber&&r.jsxs("div",{children:[r.jsx("span",{className:"text-blue-700 font-medium",children:"P.IVA:"}),r.jsx("span",{className:"ml-2 text-blue-600",children:d.businessInfo.vatNumber})]})]})]}):null})()]})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(xn,{className:"h-5 w-5 text-blue-600"}),"🆕 Nuove Funzionalità HACCP"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[r.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Validazione Automatica Prodotti-Frigoriferi"}),r.jsx("p",{className:"text-sm text-blue-700",children:"L'applicazione ora verifica automaticamente la compatibilità tra categorie di prodotti e punti di conservazione, prevenendo errori di conservazione e migliorando la sicurezza alimentare."})]}),r.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[r.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Gestione Categorie Personalizzate"}),r.jsx("p",{className:"text-sm text-green-700",children:"Puoi creare nuove categorie di prodotti direttamente dall'interfaccia, rendendo il sistema più flessibile e adattabile alle tue esigenze specifiche."})]}),r.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[r.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Prevenzione Contaminazioni"}),r.jsx("p",{className:"text-sm text-purple-700",children:"I frigoriferi possono essere dedicati a categorie specifiche, riducendo il rischio di contaminazioni incrociate e migliorando la tracciabilità."})]})]})})]})]})}const $N={default:"bg-primary-500 text-white hover:bg-primary-600",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-gray-300 bg-white hover:bg-gray-50",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100",link:"text-primary-500 underline-offset-4 hover:underline"},qN={default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-8",icon:"h-10 w-10"};function le({className:t,variant:e="default",size:n="default",asChild:s=!1,...i}){const a=s?"span":"button";return r.jsx(a,{className:`
        inline-flex items-center justify-center rounded-md text-sm font-medium
        ring-offset-background transition-colors focus-visible:outline-none
        focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2
        disabled:pointer-events-none disabled:opacity-50
        ${$N[e]}
        ${qN[n]}
        ${t}
      `,...i})}function At({className:t,type:e,...n}){return r.jsx("input",{type:e,className:`
        flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2
        text-sm ring-offset-background file:border-0 file:bg-transparent
        file:text-sm file:font-medium placeholder:text-gray-500
        focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500
        focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50
        ${t}
      `,...n})}function Ke({className:t,...e}){return r.jsx("label",{className:`
        text-sm font-medium leading-none peer-disabled:cursor-not-allowed
        peer-disabled:opacity-70 ${t}
      `,...e})}function oy({label:t="Range Temperatura (°C)",minValue:e,maxValue:n,onMinChange:s,onMaxChange:i,minPlaceholder:a="min",maxPlaceholder:o="max",required:l=!1,showValidation:c=!0,showSuggestions:d=!0,compactMode:f=!1,className:p="",id:v="temperature-range"}){const[m,N]=W.useState(!1),S=parseFloat(e),k=parseFloat(n),y=e&&n&&!isNaN(S)&&!isNaN(k),b=y&&S<k,j=(H,Z)=>{const K=(H+Z)/2;return K<=-13.5?"Surgelato":K>=15?"Temperatura Ambiente":"Refrigerato"},z=(H,Z)=>{const K=(H+Z)/2;return K<0||K>8?"danger":K>=6&&K<=8?"warning":"ok"};return f?r.jsxs("div",{className:p,children:[r.jsxs(Ke,{htmlFor:v,children:[t," ",l&&"*"]}),r.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg border",children:[r.jsx("span",{className:"text-gray-700 font-medium text-xs whitespace-nowrap",children:"da"}),r.jsx(At,{id:`${v}-min`,type:"number",step:"0.1",value:e||"",onChange:s,placeholder:a,className:"w-20 text-center font-medium text-sm",required:l}),r.jsx("span",{className:"text-gray-700 font-medium text-xs whitespace-nowrap",children:"°C"}),r.jsx("span",{className:"text-gray-700 font-medium text-xs whitespace-nowrap",children:"a"}),r.jsx(At,{id:`${v}-max`,type:"number",step:"0.1",value:n||"",onChange:i,placeholder:o,className:"w-20 text-center font-medium text-sm",required:l}),r.jsx("span",{className:"text-gray-700 font-medium text-xs whitespace-nowrap",children:"°C"})]}),c&&y&&!b&&r.jsx("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-red-700 text-xs",children:"⚠️ Min < Max"}),d&&r.jsx("div",{className:"mt-1 text-xs text-gray-500",children:"💡 Carne (2-4°C), Pesce (0-2°C), Surgelati (-18°C)"})]}):r.jsxs("div",{className:p,children:[r.jsxs(Ke,{htmlFor:v,children:[t," ",l&&"*"]}),r.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border",children:[r.jsx("span",{className:"text-gray-700 font-medium text-sm whitespace-nowrap",children:"da"}),r.jsx(At,{id:`${v}-min`,type:"number",step:"0.1",value:e||"",onChange:s,placeholder:a,className:"w-24 text-center font-medium",required:l}),r.jsx("span",{className:"text-gray-700 font-medium text-sm whitespace-nowrap",children:"°C"}),r.jsx("span",{className:"text-gray-700 font-medium text-sm whitespace-nowrap",children:"a"}),r.jsx(At,{id:`${v}-max`,type:"number",step:"0.1",value:n||"",onChange:i,placeholder:o,className:"w-24 text-center font-medium",required:l}),r.jsx("span",{className:"text-gray-700 font-medium text-sm whitespace-nowrap",children:"°C"})]}),c&&y&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("button",{type:"button",onClick:()=>N(!m),className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 transition-colors",children:[m?r.jsx(yN,{className:"h-4 w-4"}):r.jsx(Z2,{className:"h-4 w-4"}),r.jsx($s,{className:"h-4 w-4"}),"Dettagli temperatura"]}),m&&r.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:r.jsxs("div",{className:"text-sm text-blue-700 space-y-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Tipo: "}),r.jsx("span",{children:j(S,k)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Stato: "}),r.jsx("span",{children:z(S,k)==="ok"?"✅ Normale":z(S,k)==="warning"?"⚠️ Attenzione":"🚨 Critica"})]}),!b&&r.jsx("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-red-700 text-xs",children:"⚠️ La temperatura minima deve essere inferiore alla massima"})]})})]}),d&&r.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"💡 Suggerimenti: Carne fresca (2-4°C), Pesce (0-2°C), Surgelati (-18°C), Ambiente (15-25°C)"})]})}const rc=()=>{const[t,e]=W.useState({isOpen:!1,title:"",message:"",type:"info",confirmText:"OK",onConfirm:null}),[n,s]=W.useState({isOpen:!1,title:"",message:"",confirmText:"Conferma",cancelText:"Annulla",type:"warning",onConfirm:null,onCancel:null}),[i,a]=W.useState({isOpen:!1,title:"",message:"",placeholder:"",defaultValue:"",type:"text",confirmText:"Conferma",cancelText:"Annulla",validation:null,onConfirm:null,onCancel:null}),o=W.useCallback(z=>{e({isOpen:!0,title:z.title||"",message:z.message||"",type:z.type||"info",confirmText:z.confirmText||"OK",onConfirm:z.onConfirm||null})},[]),l=W.useCallback(z=>{s({isOpen:!0,title:z.title||"",message:z.message||"",confirmText:z.confirmText||"Conferma",cancelText:z.cancelText||"Annulla",type:z.type||"warning",onConfirm:z.onConfirm||null,onCancel:z.onCancel||null})},[]),c=W.useCallback(z=>{a({isOpen:!0,title:z.title||"",message:z.message||"",placeholder:z.placeholder||"",defaultValue:z.defaultValue||"",type:z.type||"text",confirmText:z.confirmText||"Conferma",cancelText:z.cancelText||"Annulla",validation:z.validation||null,onConfirm:z.onConfirm||null,onCancel:z.onCancel||null})},[]),d=W.useCallback(()=>{e(z=>({...z,isOpen:!1}))},[]),f=W.useCallback(()=>{s(z=>({...z,isOpen:!1}))},[]),p=W.useCallback(()=>{a(z=>({...z,isOpen:!1}))},[]),v=W.useCallback((z,H="Successo")=>{o({title:H,message:z,type:"success"})},[o]),m=W.useCallback((z,H="Errore")=>{o({title:H,message:z,type:"error"})},[o]),N=W.useCallback((z,H="Attenzione")=>{o({title:H,message:z,type:"warning"})},[o]),S=W.useCallback((z,H="Informazione")=>{o({title:H,message:z,type:"info"})},[o]),k=W.useCallback((z,H,Z="Conferma eliminazione")=>{l({title:Z,message:z,type:"danger",confirmText:"Elimina",cancelText:"Annulla",onConfirm:H})},[l]),y=W.useCallback((z,H,Z="Conferma azione")=>{l({title:Z,message:z,type:"warning",confirmText:"Conferma",cancelText:"Annulla",onConfirm:H})},[l]),b=W.useCallback((z,H,Z={})=>{c({title:Z.title||"Inserisci testo",message:z,type:"text",placeholder:Z.placeholder||"",defaultValue:Z.defaultValue||"",validation:Z.validation||null,onConfirm:H})},[c]),j=W.useCallback((z,H,Z={})=>{c({title:Z.title||"Inserisci numero",message:z,type:"number",placeholder:Z.placeholder||"",defaultValue:Z.defaultValue||"",validation:Z.validation||null,onConfirm:H})},[c]);return{alertModal:t,confirmModal:n,promptModal:i,showAlert:o,showConfirm:l,showPrompt:c,closeAlert:d,closeConfirm:f,closePrompt:p,alertSuccess:v,alertError:m,alertWarning:N,alertInfo:S,confirmDelete:k,confirmAction:y,promptText:b,promptNumber:j}},Xg=({isOpen:t,onClose:e,title:n,children:s,size:i="md",showCloseButton:a=!0,className:o=""})=>{if(!t)return null;const l={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-6xl"};return r.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:r.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:e}),r.jsx("div",{className:`relative w-full ${l[i]} ${o}`,children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl",children:[n&&r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n}),a&&r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(dn,{className:"h-6 w-6"})})]}),r.jsx("div",{className:"p-6",children:s})]})})]})})},sc=({isOpen:t,onClose:e,title:n,message:s,type:i="info",confirmText:a="OK",onConfirm:o=null})=>{const l=()=>{o&&o(),e()},c=()=>{switch(i){case"success":return r.jsx(Cn,{className:"h-6 w-6 text-green-600"});case"warning":return r.jsx(xn,{className:"h-6 w-6 text-yellow-600"});case"error":return r.jsx(iy,{className:"h-6 w-6 text-red-600"});default:return r.jsx($s,{className:"h-6 w-6 text-blue-600"})}},d=()=>{switch(i){case"success":return"text-green-600";case"warning":return"text-yellow-600";case"error":return"text-red-600";default:return"text-blue-600"}};return r.jsxs(Xg,{isOpen:t,onClose:e,size:"sm",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:`flex-shrink-0 ${d()}`,children:c()}),r.jsxs("div",{className:"flex-1",children:[n&&r.jsx("h3",{className:`text-lg font-semibold ${d()} mb-2`,children:n}),r.jsx("div",{className:"text-gray-700 whitespace-pre-line",children:s})]})]}),r.jsx("div",{className:"flex justify-end mt-6",children:r.jsx(le,{onClick:l,variant:"primary",children:a})})]})},ic=({isOpen:t,onClose:e,title:n,message:s,confirmText:i="Conferma",cancelText:a="Annulla",type:o="warning",onConfirm:l=null,onCancel:c=null})=>{const d=()=>{l&&l(),e()},f=()=>{c&&c(),e()},p=()=>{switch(o){case"warning":return r.jsx(xn,{className:"h-6 w-6 text-yellow-600"});case"danger":return r.jsx(xn,{className:"h-6 w-6 text-red-600"});default:return r.jsx(Qg,{className:"h-6 w-6 text-blue-600"})}},v=()=>{switch(o){case"warning":return"text-yellow-600";case"danger":return"text-red-600";default:return"text-blue-600"}};return r.jsxs(Xg,{isOpen:t,onClose:e,size:"sm",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:`flex-shrink-0 ${v()}`,children:p()}),r.jsxs("div",{className:"flex-1",children:[n&&r.jsx("h3",{className:`text-lg font-semibold ${v()} mb-2`,children:n}),r.jsx("div",{className:"text-gray-700 whitespace-pre-line",children:s})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[r.jsx(le,{onClick:f,variant:"secondary",children:a}),r.jsx(le,{onClick:d,variant:o==="danger"?"danger":"primary",children:i})]})]})},ac=({isOpen:t,onClose:e,title:n,message:s,placeholder:i="",defaultValue:a="",type:o="text",confirmText:l="Conferma",cancelText:c="Annulla",onConfirm:d=null,onCancel:f=null,validation:p=null})=>{const[v,m]=W.useState(a),[N,S]=W.useState("");W.useEffect(()=>{t&&(m(a),S(""))},[t,a]);const k=()=>{if(p){const j=p(v);if(!j.isValid){S(j.error);return}}d&&d(v),e()},y=()=>{f&&f(),e()},b=j=>{j.key==="Enter"&&k()};return r.jsxs(Xg,{isOpen:t,onClose:e,size:"sm",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"flex-shrink-0 text-blue-600",children:r.jsx(Qg,{className:"h-6 w-6"})}),r.jsxs("div",{className:"flex-1",children:[n&&r.jsx("h3",{className:"text-lg font-semibold text-blue-600 mb-2",children:n}),r.jsx("div",{className:"text-gray-700 whitespace-pre-line mb-4",children:s}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"prompt-input",className:"text-sm font-medium text-gray-700",children:"Inserisci il valore:"}),r.jsx(At,{id:"prompt-input",type:o,value:v,onChange:j=>m(j.target.value),onKeyPress:b,placeholder:i,className:`mt-1 ${N?"border-red-500 focus:border-red-500 focus:ring-red-500":""}`,autoFocus:!0}),N&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:N})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[r.jsx(le,{onClick:y,variant:"secondary",children:c}),r.jsx(le,{onClick:k,variant:"primary",children:l})]})]})};function UN({cleaning:t,setCleaning:e,temperatures:n,setTemperatures:s,currentUser:i,refrigerators:a=[],setRefrigerators:o}){const l=t||[],c=n||[],{alertModal:d,confirmModal:f,promptModal:p,closeAlert:v,closeConfirm:m,closePrompt:N,alertSuccess:S,alertError:k,alertWarning:y,confirmDelete:b,confirmAction:j}=rc();W.useEffect(()=>{if(l.some(I=>!I.date||!I.frequency)){const I=l.map(q=>({...q,date:q.date||new Date().toLocaleDateString("it-IT"),frequency:q.frequency||"daily",completed:q.completed||!1,completedAt:q.completedAt||null,completedBy:q.completedBy||null}));e(I)}},[]);const[z,H]=W.useState({task:"",assignee:"",frequency:""}),[Z,K]=W.useState({location:"",temperatureMin:"",temperatureMax:""}),[P,$]=W.useState("daily");W.useEffect(()=>{localStorage.setItem("haccp-cleaning",JSON.stringify(l))},[l]),W.useEffect(()=>{localStorage.setItem("haccp-temperatures",JSON.stringify(c))},[c]);const re=(M,I)=>{const q=(M+I)/2;return q<0||q>8?"danger":q>=6&&q<=8?"warning":"ok"},A=M=>{if(M.preventDefault(),!z.task||!z.assignee||!z.frequency){k(`⚠️ Attenzione: Per aggiungere una nuova attività devi compilare tutti i campi richiesti.

• Attività: descrivi cosa fare
• Assegnato a: chi è responsabile
• Frequenza: ogni quanto ripetere`);return}const I={id:Date.now().toString(),task:z.task,assignee:z.assignee,frequency:z.frequency,date:new Date().toLocaleDateString("it-IT"),completed:!1,completedAt:null,completedBy:null},q=[...l,I];e(q),localStorage.setItem("haccp-cleaning",JSON.stringify(q)),H({task:"",assignee:"",frequency:""}),S(`✅ Perfetto! La nuova attività è stata aggiunta con successo.

Ora apparirà nella lista delle attività da svolgere e potrai monitorarne il progresso.`)},C=M=>{if(M.preventDefault(),!Z.location||!Z.temperatureMin||!Z.temperatureMax){k(`🌡️ Attenzione: Per registrare una temperatura devi compilare tutti i campi richiesti.

• Frigorifero/Freezer: seleziona il punto di conservazione
• Range Temperatura: inserisci i valori minimo e massimo`);return}const I=parseFloat(Z.temperatureMin),q=parseFloat(Z.temperatureMax);if(isNaN(I)||isNaN(q)){k(`❌ Errore: I valori delle temperature devono essere numeri validi.

Esempi corretti:
• Min: -2, Max: 4
• Min: 0, Max: 8
• Min: -18, Max: -15`);return}if(I>q){k(`⚠️ Attenzione: La temperatura minima non può essere maggiore della massima.

Correggi i valori:
• Min: deve essere inferiore o uguale a Max
• Esempio: Min: -2, Max: 4`);return}const oe={id:Date.now().toString(),temperature:(I+q)/2,temperatureMin:I,temperatureMax:q,refrigeratorId:Z.location,refrigeratorName:Z.location,date:new Date().toLocaleString("it-IT"),status:re(I,q),recordedBy:(i==null?void 0:i.name)||"Unknown"},fe=[...c,oe];s(fe),localStorage.setItem("haccp-temperatures",JSON.stringify(fe)),K({location:"",temperatureMin:"",temperatureMax:""});const ge=oe.status==="ok"?"✅ Temperatura nella norma":oe.status==="warning"?"⚠️ Attenzione: temperatura al limite":"🚨 Attenzione: temperatura critica";S(`🌡️ Temperatura registrata con successo!

${ge}

• Frigorifero: ${oe.refrigeratorName}
• Range: ${I}°C - ${q}°C
• Data: ${oe.date}`)},R=M=>{const I=l.map(q=>q.id===M?{...q,completed:!q.completed,completedAt:q.completed?null:new Date().toLocaleString("it-IT"),completedBy:q.completed?null:(i==null?void 0:i.name)||"Unknown"}:q);e(I),localStorage.setItem("haccp-cleaning",JSON.stringify(I))},V=M=>{const I=l.filter(q=>q.id!==M);e(I),localStorage.setItem("haccp-cleaning",JSON.stringify(I))},ie=l.filter(M=>!M.completed),Q=l.filter(M=>M.completed),L=(()=>{const M=new Date,I=new Date(M.getFullYear(),M.getMonth(),M.getDate());return l.filter(q=>{if(q.completed||!q.date||typeof q.date!="string")return!1;const oe=new Date(q.date.split("/").reverse().join("-"));switch(q.frequency){case"daily":const fe=new Date(I);return fe.setDate(fe.getDate()-1),oe<=fe;case"weekly":const ge=new Date(I);return ge.setDate(ge.getDate()-7),oe<=ge;case"monthly":const Te=new Date(I);return Te.setMonth(Te.getMonth()-1),oe<=Te;case"yearly":const Ee=new Date(I);return Ee.setFullYear(Ee.getFullYear()-1),oe<=Ee;default:const Fe=new Date(I);return Fe.setDate(Fe.getDate()-7),oe<=Fe}})})(),Y=(ie||[]).filter(M=>M.frequency==="daily"),G=(ie||[]).filter(M=>M.frequency==="weekly"),ce=(ie||[]).filter(M=>M.frequency==="monthly"),_=(ie||[]).filter(M=>M.frequency==="yearly"),J=(i==null?void 0:i.role)==="admin";return r.jsxs("div",{className:"space-y-6",children:[r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(uf,{className:"h-5 w-5"}),"Nuove Attività / Mansioni"]}),r.jsx("p",{className:"text-sm text-gray-600",children:"📋 Crea nuove attività di pulizia e sanificazione per mantenere la conformità HACCP"})]}),r.jsx(Xe,{children:r.jsxs("form",{onSubmit:A,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Ke,{htmlFor:"task",className:"flex items-center gap-2",children:["Attività",r.jsx("span",{className:"text-xs text-gray-500",title:"Descrivi in modo chiaro e specifico l'attività da svolgere",children:"ℹ️"})]}),r.jsx(At,{id:"task",placeholder:"Es: Pulizia frigorifero, Sanificazione piano lavoro...",value:z.task,onChange:M=>H({...z,task:M.target.value}),required:!0}),r.jsx("p",{className:"text-xs text-gray-500",children:'💡 Suggerimento: Sii specifico (es. "Pulizia mensile frigorifero principale" invece di solo "Pulizia")'})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Ke,{htmlFor:"assignee",className:"flex items-center gap-2",children:["Assegnato a",r.jsx("span",{className:"text-xs text-gray-500",title:"Specifica chi è responsabile dell'esecuzione dell'attività",children:"ℹ️"})]}),r.jsx(At,{id:"assignee",placeholder:"Nome del responsabile",value:z.assignee,onChange:M=>H({...z,assignee:M.target.value}),required:!0}),r.jsx("p",{className:"text-xs text-gray-500",children:'👤 Esempio: "Mario Rossi" o "Team Cucina"'})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Ke,{htmlFor:"frequency",className:"flex items-center gap-2",children:["Frequenza",r.jsx("span",{className:"text-xs text-gray-500",title:"Seleziona con quale frequenza l'attività deve essere ripetuta",children:"ℹ️"})]}),r.jsxs("select",{id:"frequency",value:z.frequency,onChange:M=>H({...z,frequency:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[r.jsx("option",{value:"",children:"-- Seleziona Frequenza --"}),r.jsx("option",{value:"daily",children:"🔄 Giornalmente"}),r.jsx("option",{value:"weekly",children:"📅 Settimanalmente"}),r.jsx("option",{value:"monthly",children:"📆 Mensilmente"}),r.jsx("option",{value:"yearly",children:"📅 Annualmente"}),(i==null?void 0:i.role)==="admin"&&r.jsx("option",{value:"all",children:"🔧 Tutti"})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"📊 La frequenza aiuta a pianificare e monitorare le attività"})]})]}),r.jsx(le,{type:"submit",className:"w-full",children:"✨ Aggiungi Attività"})]})})]}),r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Eu,{className:"h-5 w-5 text-yellow-600"}),"Attività da Svolgere (",ie.length,")"]}),r.jsx("p",{className:"text-sm text-gray-600",children:"📋 Organizza e monitora le attività di pulizia e sanificazione per mantenere la conformità HACCP"})]}),r.jsx(Xe,{children:ie.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Cn,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{className:"text-lg font-medium",children:"🎉 Nessuna attività da svolgere"}),r.jsx("p",{className:"text-sm",children:"Tutte le attività sono completate! Ottimo lavoro nel mantenere la conformità HACCP."}),r.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"💡 Suggerimento: Crea nuove attività per mantenere sempre aggiornato il piano di pulizia"})]}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("button",{onClick:()=>$("daily"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${P==="daily"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["🔄 Giornaliere (",Y.length,")"]}),r.jsxs("button",{onClick:()=>$("weekly"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${P==="weekly"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["📅 Settimanali (",G.length,")"]}),r.jsxs("button",{onClick:()=>$("monthly"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${P==="monthly"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["📆 Mensili (",ce.length,")"]}),r.jsxs("button",{onClick:()=>$("yearly"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${P==="yearly"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["📅 Annuali (",_.length,")"]}),(i==null?void 0:i.role)==="admin"&&r.jsxs("button",{onClick:()=>$("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${P==="all"?"bg-white text-gray-700 border-2 border-blue-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["🔧 Tutti (",ie.length,")"]})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"💡 Clicca sulle schede per filtrare le attività per frequenza e organizzare meglio il lavoro"}),r.jsx("div",{className:"space-y-3",children:(()=>{let M=[];switch(P){case"daily":M=Y;break;case"weekly":M=G;break;case"monthly":M=ce;break;case"yearly":M=_;break;case"all":M=ie;break;default:M=Y}return M.map(I=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-medium",children:I.task}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Assegnato a: ",I.assignee," • ",I.date]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{size:"sm",onClick:()=>R(I.id),className:"bg-green-600 hover:bg-green-700 p-2 md:p-1",children:[r.jsx(Cn,{className:"h-6 w-6 md:h-4 md:w-4 mr-1"}),r.jsx("span",{className:"hidden sm:inline",children:"Completata"})]}),J&&r.jsx(le,{size:"sm",variant:"outline",onClick:()=>V(I.id),className:"text-red-600 hover:text-red-700 p-2 md:p-1",children:r.jsx(tr,{className:"h-6 w-6 md:h-4 md:w-4"})})]})]},I.id))})()})]})})]}),Q.length>0&&r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center justify-between",children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx(Cn,{className:"h-5 w-5 text-green-600"}),"Attività Completate (",Q.length,")"]}),J&&r.jsxs(le,{variant:"outline",size:"sm",onClick:()=>{b(`⚠️ Attenzione: Sei sicuro di voler eliminare tutte le attività completate?

Questa azione non può essere annullata e rimuoverà la cronologia delle attività svolte.`,()=>{e(l.filter(M=>!M.completed))})},className:"text-red-600 hover:text-red-700",children:[r.jsx(tr,{className:"h-4 w-4 mr-2"}),"Elimina Tutte"]})]}),r.jsx("p",{className:"text-sm text-gray-600",children:"📊 Storico delle attività completate - Mantiene traccia di tutto il lavoro svolto per la conformità HACCP"})]}),r.jsx(Xe,{children:r.jsx("div",{className:"space-y-3",children:Q.map(M=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-green-50",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-medium line-through",children:M.task}),r.jsxs("p",{className:"text-sm text-gray-600",children:["👤 Assegnato a: ",M.assignee," • 📅 Completata: ",M.completedAt,M.completedBy&&r.jsxs("span",{className:"ml-2 text-blue-600",children:["• ✅ Completata da: ",M.completedBy]})]})]}),J&&r.jsx(le,{size:"sm",variant:"outline",onClick:()=>V(M.id),className:"text-red-600 hover:text-red-700 p-2 md:p-1",children:r.jsx(tr,{className:"h-6 w-6 md:h-4 md:w-4"})})]},M.id))})})]}),r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(ds,{className:"h-5 w-5"}),"Registra Temperatura Frigorifero/Freezer"]}),r.jsx("p",{className:"text-sm text-gray-600",children:"🌡️ Monitora le temperature per garantire la sicurezza alimentare e la conformità HACCP"}),i&&r.jsxs("p",{className:"text-sm text-gray-600",children:["📝 Registrando come: ",r.jsx("span",{className:"font-medium",children:i.name})," (",i.department,")"]})]}),r.jsx(Xe,{children:r.jsxs("form",{onSubmit:C,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs(Ke,{htmlFor:"temp-location",className:"flex items-center gap-2",children:["Frigorifero / Freezer",r.jsx("span",{className:"text-xs text-gray-500",title:"Seleziona il punto di conservazione dove hai misurato la temperatura",children:"ℹ️"})]}),a.length===0?r.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[r.jsx("p",{className:"text-sm text-yellow-800",children:"⚠️ Nessun punto di conservazione registrato."}),r.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:'💡 Per registrare le temperature, devi prima aggiungere un frigorifero o freezer nella sezione "Punti di Conservazione".'})]}):r.jsxs("select",{id:"temp-location",value:Z.location,onChange:M=>K({...Z,location:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[r.jsx("option",{value:"",children:"-- Seleziona Frigorifero/Freezer --"}),a.map(M=>r.jsxs("option",{value:M.name,children:[M.name," (",M.location||"Posizione non specificata",")"]},M.id))]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"🏷️ Seleziona il frigorifero o freezer dove hai misurato la temperatura"})]}),r.jsxs("div",{children:[r.jsxs(Ke,{htmlFor:"temp-temperature-range",className:"flex items-center gap-2",children:["Range Temperatura (°C)",r.jsx("span",{className:"text-xs text-gray-500",title:"Inserisci la temperatura minima e massima rilevata nel punto di conservazione",children:"ℹ️"})]}),r.jsx(oy,{label:"Range Temperatura (°C)",minValue:Z.temperatureMin,maxValue:Z.temperatureMax,onMinChange:M=>K({...Z,temperatureMin:M.target.value}),onMaxChange:M=>K({...Z,temperatureMax:M.target.value}),required:!0,showValidation:!0,showSuggestions:!0,className:"w-full",id:"temp-temperature-range"}),r.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-y-1",children:[r.jsxs("p",{children:["🌡️ ",r.jsx("strong",{children:"Frigoriferi:"})," 0°C - 8°C (ideale: 2°C - 6°C)"]}),r.jsxs("p",{children:["❄️ ",r.jsx("strong",{children:"Freezer:"})," -18°C o inferiore"]}),r.jsxs("p",{children:["💡 ",r.jsx("strong",{children:"Suggerimento:"})," Misura in diversi punti per avere un range completo"]})]})]})]}),r.jsxs(le,{type:"submit",className:"w-full md:w-auto",disabled:a.length===0,children:[r.jsx(ds,{className:"mr-2 h-4 w-4"}),"📊 Registra Temperatura"]})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(Je,{children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Mansioni da Svolgere"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:ie.length}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:ie.length===0?"🎉 Tutto sotto controllo!":"⏰ Richiedono la tua attenzione"})]}),r.jsx(Eu,{className:"h-10 w-10 md:h-8 md:w-8 text-yellow-500"})]})})}),r.jsx(Je,{children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Mansioni Completate"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:Q.length}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Q.length===0?"🚀 Inizia con la prima attività!":"✅ Buon lavoro!"})]}),r.jsx(Cn,{className:"h-10 w-10 md:h-8 md:w-8 text-green-500"})]})})}),r.jsx(Je,{children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Mansioni Mancate"}),r.jsx("p",{className:`text-2xl font-bold ${L.length>0?"text-red-600":"text-green-600"}`,children:L.length}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:L.length===0?"🎯 Perfetto! Nessuna scadenza mancata":"⚠️ Richiedono attenzione immediata"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"(ultimi 7 giorni)"})]}),L.length>0?r.jsx(xn,{className:"h-10 w-10 md:h-8 md:w-8 text-red-500"}):r.jsx(Cn,{className:"h-10 w-10 md:h-8 md:w-8 text-green-500"})]})})}),r.jsx(Je,{children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Temperature da Monitorare"}),r.jsx("p",{className:"text-2xl font-bold text-red-600",children:c.filter(M=>M.status==="danger"||M.status==="warning").length}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:c.filter(M=>M.status==="danger"||M.status==="warning").length===0?"🌡️ Temperature nella norma":"🚨 Richiedono verifica"})]}),r.jsx(xn,{className:"h-10 w-10 md:h-8 md:w-8 text-red-500"})]})})})]}),r.jsx(sc,{isOpen:d.isOpen,onClose:v,title:d.title,message:d.message,type:d.type,confirmText:d.confirmText,onConfirm:d.onConfirm}),r.jsx(ic,{isOpen:f.isOpen,onClose:m,title:f.title,message:f.message,type:f.type,confirmText:f.confirmText,cancelText:f.cancelText,onConfirm:f.onConfirm,onCancel:f.onCancel}),r.jsx(ac,{isOpen:p.isOpen,onClose:N,title:p.title,message:p.message,placeholder:p.placeholder,defaultValue:p.defaultValue,type:p.type,confirmText:p.confirmText,cancelText:p.cancelText,validation:p.validation,onConfirm:p.onConfirm,onCancel:p.onCancel})]})}const HN={latticini:7,carne:3,pesce:2,verdura:7,frutta:7,conserva:365,pane:3,bevande:30},zr={INVENTORY:"haccp:inventory",REFRIGERATORS:"haccp:refrigerators",USED_INGREDIENTS:"haccp:used-ingredients",ONBOARDING:"haccp:onboarding",SUPPLIERS:"haccp:suppliers",ORDERS:"haccp:orders",MIGRATED:"haccp:migrated"},Es={FIXED:"fixed",RANGE:"range",AMBIENT:"ambient"},Vr={categories:[{id:"fresh_dairy",name:"Latticini e Formaggi",minTemp:2,maxTemp:4,description:"Latte, formaggi freschi, yogurt",incompatibleWith:["frozen","dry_goods","hot_holding"]},{id:"fresh_meat",name:"Carni Fresche",minTemp:0,maxTemp:4,description:"Carni crude, pollame, salumi freschi",incompatibleWith:["frozen","dry_goods","hot_holding"]},{id:"fresh_fish",name:"Pesce Fresco",minTemp:0,maxTemp:2,description:"Pesce fresco, molluschi, crostacei",incompatibleWith:["frozen","dry_goods","hot_holding"]},{id:"fresh_produce",name:"Verdure e Ortaggi",minTemp:2,maxTemp:8,description:"Verdure fresche, insalate, ortaggi",incompatibleWith:["frozen","hot_holding"]},{id:"fresh_fruits",name:"Frutta Fresca",minTemp:2,maxTemp:8,description:"Frutta fresca di stagione",incompatibleWith:["frozen","hot_holding"]},{id:"frozen",name:"Surgelati",minTemp:-20,maxTemp:-16,description:"Tutti i prodotti surgelati",incompatibleWith:["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","hot_holding","fresh_beverages"]},{id:"deep_frozen",name:"Ultra Surgelati",minTemp:-25,maxTemp:-18,description:"Prodotti ultra surgelati (es. gelati)",incompatibleWith:["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","hot_holding","fresh_beverages"]},{id:"dry_goods",name:"Dispensa Secca",minTemp:15,maxTemp:25,description:"Pasta, riso, farina, conserve",incompatibleWith:["fresh_dairy","fresh_meat","fresh_fish","frozen","deep_frozen"]},{id:"hot_holding",name:"Mantenimento Caldo",minTemp:60,maxTemp:70,description:"Piatti pronti caldi, mantenuti a temperatura",incompatibleWith:["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","frozen","deep_frozen","fresh_beverages"]},{id:"chilled_ready",name:"Pronti Freddi",minTemp:2,maxTemp:8,description:"Piatti pronti freddi, insalate pronte",incompatibleWith:["frozen","deep_frozen","hot_holding"]},{id:"fresh_beverages",name:"Bevande Fresche",minTemp:2,maxTemp:10,description:"Bibite, succhi, acqua, bevande fresche",incompatibleWith:["frozen","deep_frozen","hot_holding"]},{id:"abbattitore_menu",name:"Prodotti per Menù / Scorte",minTemp:-80,maxTemp:-10,description:"Prodotti per menù e scorte in abbattitore",incompatibleWith:["hot_holding","fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","fresh_beverages","chilled_ready"]},{id:"abbattitore_esposizione",name:"Prodotti per Esposizione / Vendita",minTemp:-80,maxTemp:-10,description:"Prodotti per esposizione e vendita in abbattitore",incompatibleWith:["hot_holding","fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","fresh_beverages","chilled_ready"]}],tolerance:.5,validateConservationPoint:t=>{var n;const e=[];if((n=t.name)!=null&&n.trim()||e.push("Nome punto di conservazione obbligatorio"),t.location||e.push("Posizione obbligatoria"),(!t.minTemp||!t.maxTemp)&&e.push("Range temperature obbligatorio"),t.assignedRole||e.push("Ruolo assegnato obbligatorio"),t.minTemp&&t.maxTemp){const s=parseFloat(t.minTemp),i=parseFloat(t.maxTemp);isNaN(s)||isNaN(i)?e.push("Temperature non valide"):s>=i&&e.push("Temperatura minima deve essere inferiore alla massima")}return{isValid:e.length===0,errors:e}},validateTemperatureCompatibility:(t,e,n)=>{if(!n||n.length===0)return{compatible:!0,message:"Nessuna categoria selezionata"};const s=parseFloat(t),i=parseFloat(e);if(isNaN(s)||isNaN(i))return{compatible:!1,message:"Temperature non valide"};const a=Vr.tolerance;for(const o of n){const l=Vr.categories.find(f=>f.id===o);if(!l)continue;const c=l.minTemp-a,d=l.maxTemp+a;if(s<c||i>d)return{compatible:!1,message:`Temperature non compatibili con ${l.name}. Range consentito: ${l.minTemp}°C - ${l.maxTemp}°C (±${a}°C)`,category:l.name,requiredRange:{min:l.minTemp,max:l.maxTemp}}}return{compatible:!0,message:"Temperature compatibili con tutte le categorie selezionate"}},getOptimalTemperatureSuggestions:t=>{if(!t||t.length===0)return null;const e=Vr.categories.filter(o=>t.includes(o.id));if(e.length===0)return null;if(e.length===1){const o=e[0];return{minTemp:o.minTemp,maxTemp:o.maxTemp,message:`Range ottimale per ${o.name}: ${o.minTemp}°C - ${o.maxTemp}°C`}}const n=e.map(o=>o.minTemp),s=e.map(o=>o.maxTemp),i=Math.max(...n),a=Math.min(...s);return i<=a?{minTemp:i,maxTemp:a,message:`Range ottimale per tutte le categorie: ${i}°C - ${a}°C`}:{compatible:!1,message:"Le categorie selezionate richiedono range di temperatura incompatibili",categories:e.map(o=>o.name)}}},Gt={TEMPERATURE_MONITORING:"temperature_monitoring",SANITIZATION:"sanitization",DEFROSTING:"defrosting"},Zc={[Gt.TEMPERATURE_MONITORING]:"Rilevamento Temperatura",[Gt.SANITIZATION]:"Sanificazione",[Gt.DEFROSTING]:"Sbrinamento"},hh={[Gt.TEMPERATURE_MONITORING]:[{value:"daily",label:"Giornalmente"},{value:"weekly",label:"Settimanale"},{value:"monthly",label:"Mensile"}],[Gt.SANITIZATION]:[{value:"daily",label:"Giornalmente"},{value:"weekly",label:"Settimanale"}],[Gt.DEFROSTING]:[{value:"semiannual",label:"Semestrale (ogni 6 mesi)"},{value:"annual",label:"Annuale"}]},VN=[{value:"monday",label:"Lunedì"},{value:"tuesday",label:"Martedì"},{value:"wednesday",label:"Mercoledì"},{value:"thursday",label:"Giovedì"},{value:"friday",label:"Venerdì"},{value:"saturday",label:"Sabato"},{value:"sunday",label:"Domenica"}],GN={[Gt.TEMPERATURE_MONITORING]:{requiredFields:["frequency"],optionalFields:["assigned_role","assigned_category","assigned_staff_ids","selected_days"],frequencyOptions:[...hh[Gt.TEMPERATURE_MONITORING].map(t=>t.value),"custom_days"]},[Gt.SANITIZATION]:{requiredFields:["frequency"],optionalFields:["assigned_role","assigned_category","assigned_staff_ids","selected_days"],frequencyOptions:[...hh[Gt.SANITIZATION].map(t=>t.value),"custom_days"]},[Gt.DEFROSTING]:{requiredFields:["frequency"],optionalFields:["assigned_role","assigned_category","assigned_staff_ids","selected_days"],frequencyOptions:hh[Gt.DEFROSTING].map(t=>t.value)}},WN=(t,e)=>{const n=GN[t],s=[];n.requiredFields.forEach(o=>{(!e[o]||Array.isArray(e[o])&&e[o].length===0)&&s.push(`${o} è obbligatorio per ${Zc[t]}`)}),e.frequency&&!n.frequencyOptions.includes(e.frequency)&&s.push(`Frequenza non valida per ${Zc[t]}`),e.frequency==="custom_days"&&(!e.selected_days||e.selected_days.length===0)&&s.push(`Devi selezionare almeno un giorno per ${Zc[t]}`);const i=!!e.assigned_role,a=e.assigned_staff_ids&&e.assigned_staff_ids.length>0;return!i&&!a&&s.push(`Devi selezionare almeno Ruolo o Dipendenti Specifici per ${Zc[t]}`),{isValid:s.length===0,errors:s}},JN=t=>hh[t]||[],X1=t=>Zc[t]||t,KN="modulepreload",YN=function(t,e){return new URL(t,e).href},Z1={},Wa=function(e,n,s){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(a=>{if(a=YN(a,s),a in Z1)return;Z1[a]=!0;const o=a.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!s)for(let f=i.length-1;f>=0;f--){const p=i[f];if(p.href===a&&(!o||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":KN,o||(d.as="script",d.crossOrigin=""),d.href=a,document.head.appendChild(d),o)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})},QN=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Wa(()=>Promise.resolve().then(()=>oc),void 0,import.meta.url).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)};class Zg extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class XN extends Zg{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ex extends Zg{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class tx extends Zg{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Op;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Op||(Op={}));var ZN=globalThis&&globalThis.__awaiter||function(t,e,n,s){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(s.next(f))}catch(p){o(p)}}function c(f){try{d(s.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class ej{constructor(e,{headers:n={},customFetch:s,region:i=Op.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=QN(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var s;return ZN(this,void 0,void 0,function*(){try{const{headers:i,method:a,body:o}=n;let l={},{region:c}=n;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let f;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",f=o):typeof o=="string"?(l["Content-Type"]="text/plain",f=o):typeof FormData<"u"&&o instanceof FormData?f=o:(l["Content-Type"]="application/json",f=JSON.stringify(o)));const p=yield this.fetch(d.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:f}).catch(S=>{throw new XN(S)}),v=p.headers.get("x-relay-error");if(v&&v==="true")throw new ex(p);if(!p.ok)throw new tx(p);let m=((s=p.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),N;return m==="application/json"?N=yield p.json():m==="application/octet-stream"?N=yield p.blob():m==="text/event-stream"?N=p:m==="multipart/form-data"?N=yield p.formData():N=yield p.text(),{data:N,error:null,response:p}}catch(i){return{data:null,error:i,response:i instanceof tx||i instanceof ex?i.context:void 0}}})}}var ss={},e0={},df={},qu={},hf={},ff={},tj=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Zl=tj();const nj=Zl.fetch,ly=Zl.fetch.bind(Zl),cy=Zl.Headers,rj=Zl.Request,sj=Zl.Response,oc=Object.freeze(Object.defineProperty({__proto__:null,Headers:cy,Request:rj,Response:sj,default:ly,fetch:nj},Symbol.toStringTag,{value:"Module"})),ij=F5(oc);var mf={};Object.defineProperty(mf,"__esModule",{value:!0});let aj=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};mf.default=aj;var uy=qs&&qs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ff,"__esModule",{value:!0});const oj=uy(ij),lj=uy(mf);let cj=class{constructor(e){var n,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(s=e.isMaybeSingle)!==null&&s!==void 0?s:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=oj.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let i=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,c,d;let f=null,p=null,v=null,m=a.status,N=a.statusText;if(a.ok){if(this.method!=="HEAD"){const b=await a.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?p=b:p=JSON.parse(b))}const k=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),y=(c=a.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");k&&y&&y.length>1&&(v=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(f={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,v=null,m=406,N="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const k=await a.text();try{f=JSON.parse(k),Array.isArray(f)&&a.status===404&&(p=[],f=null,m=200,N="OK")}catch{a.status===404&&k===""?(m=204,N="No Content"):f={message:k}}if(f&&this.isMaybeSingle&&(!((d=f==null?void 0:f.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,m=200,N="OK"),f&&this.shouldThrowOnError)throw new lj.default(f)}return{error:f,data:p,count:v,status:m,statusText:N}});return this.shouldThrowOnError||(i=i.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};ff.default=cj;var uj=qs&&qs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(hf,"__esModule",{value:!0});const dj=uj(ff);let hj=class extends dj.default{select(e){let n=!1;const s=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:s,foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:s,referencedTable:i=s}={}){const a=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:s=!1,buffers:i=!1,wal:a=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,n?"verbose":null,s?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};hf.default=hj;var fj=qs&&qs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(qu,"__esModule",{value:!0});const mj=fj(hf);let pj=class extends mj.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const s=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:s,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${a}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,s])=>{this.url.searchParams.append(n,`eq.${s}`)}),this}not(e,n,s){return this.url.searchParams.append(e,`not.${n}.${s}`),this}or(e,{foreignTable:n,referencedTable:s=n}={}){const i=s?`${s}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,s){return this.url.searchParams.append(e,`${n}.${s}`),this}};qu.default=pj;var gj=qs&&qs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(df,"__esModule",{value:!0});const Hc=gj(qu);let xj=class{constructor(e,{headers:n={},schema:s,fetch:i}){this.url=e,this.headers=new Headers(n),this.schema=s,this.fetch=i}select(e,{head:n=!1,count:s}={}){const i=n?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new Hc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:s=!0}={}){var i;const a="POST";if(n&&this.headers.append("Prefer",`count=${n}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Hc.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:s=!1,count:i,defaultToNull:a=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),i&&this.headers.append("Prefer",`count=${i}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(c.length>0){const d=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new Hc.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:n}={}){var s;const i="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new Hc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:e}={}){var n;const s="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Hc.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};df.default=xj;var dy=qs&&qs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e0,"__esModule",{value:!0});const vj=dy(df),yj=dy(qu);let bj=class hy{constructor(e,{headers:n={},schema:s,fetch:i}={}){this.url=e,this.headers=new Headers(n),this.schemaName=s,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new vj.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new hy(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:i=!1,count:a}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let d;s||i?(l=s?"HEAD":"GET",Object.entries(n).filter(([p,v])=>v!==void 0).map(([p,v])=>[p,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([p,v])=>{c.searchParams.append(p,v)})):(l="POST",d=n);const f=new Headers(this.headers);return a&&f.set("Prefer",`count=${a}`),new yj.default({method:l,url:c,headers:f,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};e0.default=bj;var lc=qs&&qs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ss,"__esModule",{value:!0});ss.PostgrestError=ss.PostgrestBuilder=ss.PostgrestTransformBuilder=ss.PostgrestFilterBuilder=ss.PostgrestQueryBuilder=ss.PostgrestClient=void 0;const fy=lc(e0);ss.PostgrestClient=fy.default;const my=lc(df);ss.PostgrestQueryBuilder=my.default;const py=lc(qu);ss.PostgrestFilterBuilder=py.default;const gy=lc(hf);ss.PostgrestTransformBuilder=gy.default;const xy=lc(ff);ss.PostgrestBuilder=xy.default;const vy=lc(mf);ss.PostgrestError=vy.default;var wj=ss.default={PostgrestClient:fy.default,PostgrestQueryBuilder:my.default,PostgrestFilterBuilder:py.default,PostgrestTransformBuilder:gy.default,PostgrestBuilder:xy.default,PostgrestError:vy.default};const{PostgrestClient:Nj,PostgrestQueryBuilder:i_,PostgrestFilterBuilder:a_,PostgrestTransformBuilder:o_,PostgrestBuilder:l_,PostgrestError:c_}=wj;class jj{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const n=parseInt(process.versions.node.split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Sj="2.15.4",_j=`realtime-js/${Sj}`,Cj="1.0.0",Dp=1e4,kj=1e3,Aj=100;var du;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(du||(du={}));var sr;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(sr||(sr={}));var ii;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ii||(ii={}));var Mp;(function(t){t.websocket="websocket"})(Mp||(Mp={}));var bo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(bo||(bo={}));class Pj{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,n,s)}_decodeBroadcast(e,n,s){const i=n.getUint8(1),a=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+i));o=o+i;const c=s.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class yy{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Nn;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Nn||(Nn={}));const nx=(t,e,n={})=>{var s;const i=(s=n.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((a,o)=>(a[o]=Lj(o,t,e,i),a),{})},Lj=(t,e,n,s)=>{const i=e.find(l=>l.name===t),a=i==null?void 0:i.type,o=n[t];return a&&!s.includes(a)?by(a,o):Rp(o)},by=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return zj(e,n)}switch(t){case Nn.bool:return Ij(e);case Nn.float4:case Nn.float8:case Nn.int2:case Nn.int4:case Nn.int8:case Nn.numeric:case Nn.oid:return Tj(e);case Nn.json:case Nn.jsonb:return Ej(e);case Nn.timestamp:return Oj(e);case Nn.abstime:case Nn.date:case Nn.daterange:case Nn.int4range:case Nn.int8range:case Nn.money:case Nn.reltime:case Nn.text:case Nn.time:case Nn.timestamptz:case Nn.timetz:case Nn.tsrange:case Nn.tstzrange:return Rp(e);default:return Rp(e)}},Rp=t=>t,Ij=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Tj=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Ej=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},zj=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let a;const o=t.slice(1,n);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>by(e,l))}return t},Oj=t=>typeof t=="string"?t.replace(" ","T"):t,wy=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class wm{constructor(e,n,s={},i=Dp){this.channel=e,this.event=n,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var rx;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(rx||(rx={}));class hu{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hu.syncState(this.state,i,a,o),this.pendingDiffs.forEach(c=>{this.state=hu.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=hu.syncDiff(this.state,i,a,o),l())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,i){const a=this.cloneDeep(e),o=this.transformState(n),l={},c={};return this.map(a,(d,f)=>{o[d]||(c[d]=f)}),this.map(o,(d,f)=>{const p=a[d];if(p){const v=f.map(k=>k.presence_ref),m=p.map(k=>k.presence_ref),N=f.filter(k=>m.indexOf(k.presence_ref)<0),S=p.filter(k=>v.indexOf(k.presence_ref)<0);N.length>0&&(l[d]=N),S.length>0&&(c[d]=S)}else l[d]=f}),this.syncDiff(a,{joins:l,leaves:c},s,i)}static syncDiff(e,n,s,i){const{joins:a,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(a,(l,c)=>{var d;const f=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),f.length>0){const p=e[l].map(m=>m.presence_ref),v=f.filter(m=>p.indexOf(m.presence_ref)<0);e[l].unshift(...v)}s(l,f,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const f=c.map(p=>p.presence_ref);d=d.filter(p=>f.indexOf(p.presence_ref)<0),e[l]=d,i(l,d,c),d.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const i=e[s];return"metas"in i?n[s]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):n[s]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var sx;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(sx||(sx={}));var fu;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(fu||(fu={}));var Wi;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Wi||(Wi={}));class t0{constructor(e,n={config:{}},s){this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=sr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new wm(this,ii.join,this.params,this.timeout),this.rejoinTimer=new yy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=sr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=sr.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=sr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=sr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=sr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ii.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new hu(this),this.broadcastEndpointURL=wy(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var s,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==sr.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&i!==void 0?i:[],f=!!this.bindings[fu.PRESENCE]&&this.bindings[fu.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,p={},v={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:f}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(Wi.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(Wi.CLOSED)),this.updateJoinPayload(Object.assign({config:v},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:m})=>{var N;if(this.socket.setAuth(),m===void 0){e==null||e(Wi.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,k=(N=S==null?void 0:S.length)!==null&&N!==void 0?N:0,y=[];for(let b=0;b<k;b++){const j=S[b],{filter:{event:z,schema:H,table:Z,filter:K}}=j,P=m&&m[b];if(P&&P.event===z&&P.schema===H&&P.table===Z&&P.filter===K)y.push(Object.assign(Object.assign({},j),{id:P.id}));else{this.unsubscribe(),this.state=sr.errored,e==null||e(Wi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(Wi.SUBSCRIBED);return}}).receive("error",m=>{this.state=sr.errored,e==null||e(Wi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Wi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===sr.joined&&e===fu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,s)}async send(e,n={}){var s,i;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=sr.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ii.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new wm(this,ii.leave,{},e),s.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=sr.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const i=new AbortController,a=setTimeout(()=>i.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(a),o}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new wm(this,e,n,s);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Aj){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var i,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:f}=ii;if(s&&[l,c,d,f].indexOf(o)>=0&&s!==this._joinRef())return;let v=this._onMessage(o,n,s);if(n&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var N,S,k;return((N=m.filter)===null||N===void 0?void 0:N.event)==="*"||((k=(S=m.filter)===null||S===void 0?void 0:S.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===o}).map(m=>m.callback(v,s)):(a=this.bindings[o])===null||a===void 0||a.filter(m=>{var N,S,k,y,b,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const z=m.id,H=(N=m.filter)===null||N===void 0?void 0:N.event;return z&&((S=n.ids)===null||S===void 0?void 0:S.includes(z))&&(H==="*"||(H==null?void 0:H.toLocaleLowerCase())===((k=n.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const z=(b=(y=m==null?void 0:m.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return z==="*"||z===((j=n==null?void 0:n.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof v=="object"&&"ids"in v){const N=v.data,{schema:S,table:k,commit_timestamp:y,type:b,errors:j}=N;v=Object.assign(Object.assign({},{schema:S,table:k,commit_timestamp:y,eventType:b,new:{},old:{},errors:j}),this._getPayloadRecords(N))}m.callback(v,s)})}_isClosed(){return this.state===sr.closed}_isJoined(){return this.state===sr.joined}_isJoining(){return this.state===sr.joining}_isLeaving(){return this.state===sr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const i=e.toLocaleLowerCase(),a={type:i,filter:n,callback:s};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&t0.isEqual(i.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ii.close,{},e)}_onError(e){this._on(ii.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=sr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=nx(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=nx(e.columns,e.old_record)),n}}const Nm=()=>{},Ud={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Dj=[1e3,2e3,5e3,1e4],Mj=1e4,Rj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Fj{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Dp,this.transport=null,this.heartbeatIntervalMs=Ud.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Nm,this.ref=0,this.reconnectTimer=null,this.logger=Nm,this.conn=null,this.sendBuffer=[],this.serializer=new Pj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Wa(()=>Promise.resolve().then(()=>oc),void 0,import.meta.url).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((s=n==null?void 0:n.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Mp.websocket}`,this.httpEndpoint=wy(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=jj.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Cj}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case du.connecting:return bo.Connecting;case du.open:return bo.Open;case du.closing:return bo.Closing;default:return bo.Closed}}isConnected(){return this.connectionState()===bo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,i=this.getChannels().find(a=>a.topic===s);if(i)return i;{const a=new t0(`realtime:${e}`,n,this);return this.channels.push(a),a}}push(e){const{topic:n,event:s,payload:i,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${s} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(kj,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Ud.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:i,payload:a,ref:o}=n,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${i} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(i,a,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ii.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${s}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([Rj],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const i={access_token:n,version:_j};n&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(ii.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new yy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ud.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,i,a,o,l,c,d,f;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Dp,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:Ud.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Nm,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:p=>Dj[p-1]||Mj,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(p,v)=>v(JSON.stringify(p)),this.decode=(f=e==null?void 0:e.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class n0 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ir(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Bj extends n0{constructor(e,n,s){super(e),this.name="StorageApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Fp extends n0{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var $j=globalThis&&globalThis.__awaiter||function(t,e,n,s){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(s.next(f))}catch(p){o(p)}}function c(f){try{d(s.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const Ny=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Wa(()=>Promise.resolve().then(()=>oc),void 0,import.meta.url).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},qj=()=>$j(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Wa(()=>Promise.resolve().then(()=>oc),void 0,import.meta.url)).Response:Response}),Bp=t=>{if(Array.isArray(t))return t.map(n=>Bp(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const i=n.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[i]=Bp(s)}),e},Uj=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Do=globalThis&&globalThis.__awaiter||function(t,e,n,s){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(s.next(f))}catch(p){o(p)}}function c(f){try{d(s.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const jm=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Hj=(t,e,n)=>Do(void 0,void 0,void 0,function*(){const s=yield qj();t instanceof s&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{const a=t.status||500,o=(i==null?void 0:i.statusCode)||a+"";e(new Bj(jm(i),a,o))}).catch(i=>{e(new Fp(jm(i),i))}):e(new Fp(jm(t),t))}),Vj=(t,e,n,s)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?i:(Uj(s)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s)):i.body=s,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),n))};function Uu(t,e,n,s,i,a){return Do(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,Vj(e,s,i,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Hj(c,l,s))})})}function Uh(t,e,n,s){return Do(this,void 0,void 0,function*(){return Uu(t,"GET",e,n,s)})}function Ci(t,e,n,s,i){return Do(this,void 0,void 0,function*(){return Uu(t,"POST",e,s,i,n)})}function $p(t,e,n,s,i){return Do(this,void 0,void 0,function*(){return Uu(t,"PUT",e,s,i,n)})}function Gj(t,e,n,s){return Do(this,void 0,void 0,function*(){return Uu(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function jy(t,e,n,s,i){return Do(this,void 0,void 0,function*(){return Uu(t,"DELETE",e,s,i,n)})}var Ur=globalThis&&globalThis.__awaiter||function(t,e,n,s){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(s.next(f))}catch(p){o(p)}}function c(f){try{d(s.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const Wj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ix={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Jj{constructor(e,n={},s,i){this.url=e,this.headers=n,this.bucketId=s,this.fetch=Ny(i)}uploadOrUpdate(e,n,s,i){return Ur(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},ix),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(n),f=this._getFinalPath(d),p=yield(e=="PUT"?$p:Ci)(this.fetch,`${this.url}/object/${f}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(a){if(ir(a))return{data:null,error:a};throw a}})}upload(e,n,s){return Ur(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,s)})}uploadToSignedUrl(e,n,s,i){return Ur(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let c;const d=Object.assign({upsert:ix.upsert},i),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType);const p=yield $p(this.fetch,l.toString(),c,{headers:f});return{data:{path:a,fullPath:p.Key},error:null}}catch(c){if(ir(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,n){return Ur(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const a=yield Ci(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new n0("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(ir(s))return{data:null,error:s};throw s}})}update(e,n,s){return Ur(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,s)})}move(e,n,s){return Ur(this,void 0,void 0,function*(){try{return{data:yield Ci(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ir(i))return{data:null,error:i};throw i}})}copy(e,n,s){return Ur(this,void 0,void 0,function*(){try{return{data:{path:(yield Ci(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ir(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,s){return Ur(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),a=yield Ci(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(ir(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,s){return Ur(this,void 0,void 0,function*(){try{const i=yield Ci(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(ir(i))return{data:null,error:i};throw i}})}download(e,n){return Ur(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Uh(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(ir(l))return{data:null,error:l};throw l}})}info(e){return Ur(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const s=yield Uh(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Bp(s),error:null}}catch(s){if(ir(s))return{data:null,error:s};throw s}})}exists(e){return Ur(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield Gj(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(ir(s)&&s instanceof Fp){const i=s.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,n){const s=this._getFinalPath(e),i=[],a=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";a!==""&&i.push(a);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return Ur(this,void 0,void 0,function*(){try{return{data:yield jy(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(ir(n))return{data:null,error:n};throw n}})}list(e,n,s){return Ur(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Wj),n),{prefix:e||""});return{data:yield Ci(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(ir(i))return{data:null,error:i};throw i}})}listV2(e,n){return Ur(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Ci(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(ir(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Kj="2.11.0",Yj={"X-Client-Info":`storage-js/${Kj}`};var al=globalThis&&globalThis.__awaiter||function(t,e,n,s){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(s.next(f))}catch(p){o(p)}}function c(f){try{d(s.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class Qj{constructor(e,n={},s,i){const a=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},Yj),n),this.fetch=Ny(s)}listBuckets(){return al(this,void 0,void 0,function*(){try{return{data:yield Uh(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ir(e))return{data:null,error:e};throw e}})}getBucket(e){return al(this,void 0,void 0,function*(){try{return{data:yield Uh(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(ir(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return al(this,void 0,void 0,function*(){try{return{data:yield Ci(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(ir(s))return{data:null,error:s};throw s}})}updateBucket(e,n){return al(this,void 0,void 0,function*(){try{return{data:yield $p(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(ir(s))return{data:null,error:s};throw s}})}emptyBucket(e){return al(this,void 0,void 0,function*(){try{return{data:yield Ci(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(ir(n))return{data:null,error:n};throw n}})}deleteBucket(e){return al(this,void 0,void 0,function*(){try{return{data:yield jy(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(ir(n))return{data:null,error:n};throw n}})}}class Xj extends Qj{constructor(e,n={},s,i){super(e,n,s,i)}from(e){return new Jj(this.url,this.headers,e,this.fetch)}}const Zj="2.57.0";let eu="";typeof Deno<"u"?eu="deno":typeof document<"u"?eu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?eu="react-native":eu="node";const e4={"X-Client-Info":`supabase-js-${eu}/${Zj}`},t4={headers:e4},n4={schema:"public"},r4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},s4={};var i4=globalThis&&globalThis.__awaiter||function(t,e,n,s){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(s.next(f))}catch(p){o(p)}}function c(f){try{d(s.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const a4=t=>{let e;return t?e=t:typeof fetch>"u"?e=ly:e=fetch,(...n)=>e(...n)},o4=()=>typeof Headers>"u"?cy:Headers,l4=(t,e,n)=>{const s=a4(n),i=o4();return(a,o)=>i4(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let d=new i(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},o),{headers:d}))})};var c4=globalThis&&globalThis.__awaiter||function(t,e,n,s){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(s.next(f))}catch(p){o(p)}}function c(f){try{d(s.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};function u4(t){return t.endsWith("/")?t:t+"/"}function d4(t,e){var n,s;const{db:i,auth:a,realtime:o,global:l}=t,{db:c,auth:d,realtime:f,global:p}=e,v={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},f),o),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(n=p==null?void 0:p.headers)!==null&&n!==void 0?n:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>c4(this,void 0,void 0,function*(){return""})};return t.accessToken?v.accessToken=t.accessToken:delete v.accessToken,v}const Sy="2.71.1",vl=30*1e3,qp=3,Sm=qp*vl,h4="http://localhost:9999",f4="supabase.auth.token",m4={"X-Client-Info":`gotrue-js/${Sy}`},Up="X-Supabase-Api-Version",_y={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},p4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,g4=10*60*1e3;class r0 extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Vt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class x4 extends r0{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function v4(t){return Vt(t)&&t.name==="AuthApiError"}class Cy extends r0{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class eo extends r0{constructor(e,n,s,i){super(e,s,i),this.name=n,this.status=s}}class ka extends eo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function y4(t){return Vt(t)&&t.name==="AuthSessionMissingError"}class Hd extends eo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Vd extends eo{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Gd extends eo{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function b4(t){return Vt(t)&&t.name==="AuthImplicitGrantRedirectError"}class ax extends eo{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Hp extends eo{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function _m(t){return Vt(t)&&t.name==="AuthRetryableFetchError"}class ox extends eo{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class Vp extends eo{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Hh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),lx=` 	
\r=`.split(""),w4=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<lx.length;e+=1)t[lx[e].charCodeAt(0)]=-2;for(let e=0;e<Hh.length;e+=1)t[Hh[e].charCodeAt(0)]=e;return t})();function cx(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Hh[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Hh[s]),e.queuedBits-=6}}function ky(t,e,n){const s=w4[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function ux(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{S4(o,s,n)};for(let o=0;o<t.length;o+=1)ky(t.charCodeAt(o),i,a);return e.join("")}function N4(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function j4(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}N4(s,e)}}function S4(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function _4(t){const e=[],n={queue:0,queuedBits:0},s=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)ky(t.charCodeAt(i),n,s);return new Uint8Array(e)}function C4(t){const e=[];return j4(t,n=>e.push(n)),new Uint8Array(e)}function k4(t){const e=[],n={queue:0,queuedBits:0},s=i=>{e.push(i)};return t.forEach(i=>cx(i,n,s)),cx(null,n,s),e.join("")}function A4(t){return Math.round(Date.now()/1e3)+t}function P4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const ti=()=>typeof window<"u"&&typeof document<"u",mo={tested:!1,writable:!1},Ay=()=>{if(!ti())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(mo.tested)return mo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),mo.tested=!0,mo.writable=!0}catch{mo.tested=!0,mo.writable=!1}return mo.writable};function L4(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,a)=>{e[a]=i})}catch{}return n.searchParams.forEach((s,i)=>{e[i]=s}),e}const Py=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Wa(()=>Promise.resolve().then(()=>oc),void 0,import.meta.url).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},I4=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",yl=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},po=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},ja=async(t,e)=>{await t.removeItem(e)};class pf{constructor(){this.promise=new pf.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}pf.promiseConstructor=Promise;function Cm(t){const e=t.split(".");if(e.length!==3)throw new Vp("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!p4.test(e[s]))throw new Vp("JWT not in base64url format");return{header:JSON.parse(ux(e[0])),payload:JSON.parse(ux(e[1])),signature:_4(e[2]),raw:{header:e[0],payload:e[1]}}}async function T4(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function E4(t,e){return new Promise((s,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await t(a);if(!e(a,null,o)){s(o);return}}catch(o){if(!e(a,o)){i(o);return}}})()})}function z4(t){return("0"+t.toString(16)).substr(-2)}function O4(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let i="";for(let a=0;a<56;a++)i+=n.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(e),Array.from(e,z4).join("")}async function D4(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(s);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function M4(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await D4(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ol(t,e,n=!1){const s=O4();let i=s;n&&(i+="/PASSWORD_RECOVERY"),await yl(t,`${e}-code-verifier`,i);const a=await M4(s);return[a,s===a?"plain":"s256"]}const R4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function F4(t){const e=t.headers.get(Up);if(!e||!e.match(R4))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function B4(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function $4(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const q4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ll(t){if(!q4.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function km(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function dx(t){return JSON.parse(JSON.stringify(t))}var U4=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n};const vo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),H4=[502,503,504];async function hx(t){var e;if(!I4(t))throw new Hp(vo(t),0);if(H4.includes(t.status))throw new Hp(vo(t),t.status);let n;try{n=await t.json()}catch(a){throw new Cy(vo(a),a)}let s;const i=F4(t);if(i&&i.getTime()>=_y["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new ox(vo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new ka}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new ox(vo(n),t.status,n.weak_password.reasons);throw new x4(vo(n),t.status||500,s)}const V4=(t,e,n,s)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),n))};async function Kt(t,e,n,s){var i;const a=Object.assign({},s==null?void 0:s.headers);a[Up]||(a[Up]=_y["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const o=(i=s==null?void 0:s.query)!==null&&i!==void 0?i:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await G4(t,e,n+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function G4(t,e,n,s,i,a){const o=V4(e,s,i,a);let l;try{l=await t(n,Object.assign({},o))}catch(c){throw console.error(c),new Hp(vo(c),0)}if(l.ok||await hx(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await hx(c)}}function Vi(t){var e;let n=null;Y4(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=A4(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function fx(t){const e=Vi(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ta(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function W4(t){return{data:t,error:null}}function J4(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:i,verification_type:a}=t,o=U4(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:s,redirect_to:i,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function K4(t){return t}function Y4(t){return t.access_token&&t.refresh_token&&t.expires_in}const Am=["global","local","others"];var Q4=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n};class X4{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=Py(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=Am[0]){if(Am.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Am.join(", ")}`);try{return await Kt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await Kt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ta})}catch(s){if(Vt(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=Q4(e,["options"]),i=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(i.new_email=s==null?void 0:s.newEmail,delete i.newEmail),await Kt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:J4,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Vt(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Kt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ta})}catch(n){if(Vt(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,i,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},f=await Kt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(a=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:K4});if(f.error)throw f.error;const p=await f.json(),v=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(N=>{const S=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(N.split(";")[1].split("=")[1]);d[`${k}Page`]=S}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(Vt(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){ll(e);try{return await Kt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ta})}catch(n){if(Vt(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){ll(e);try{return await Kt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ta})}catch(s){if(Vt(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){ll(e);try{return await Kt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ta})}catch(s){if(Vt(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){ll(e.userId);try{const{data:n,error:s}=await Kt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:s}}catch(n){if(Vt(n))return{data:null,error:n};throw n}}async _deleteFactor(e){ll(e.userId),ll(e.id);try{return{data:await Kt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}}}function mx(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function Z4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const cl={debug:!!(globalThis&&Ay()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ly extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class eS extends Ly{}async function tS(t,e,n){cl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),cl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){cl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{cl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw cl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new eS(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(cl.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}Z4();const nS={url:h4,storageKey:f4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:m4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function px(t,e,n){return await n()}const ul={};class zu{constructor(e){var n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=zu.nextInstanceID,zu.nextInstanceID+=1,this.instanceID>0&&ti()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},nS),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new X4({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Py(i.fetch),this.lock=i.lock||px,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:ti()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=tS:this.lock=px,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Ay()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=mx(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=mx(this.memoryStorage)),ti()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=ul[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){ul[this.storageKey]=Object.assign(Object.assign({},ul[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=ul[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ul[this.storageKey]=Object.assign(Object.assign({},ul[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Sy}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=L4(window.location.href);let s="none";if(this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce"),ti()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:a}=await this._getSessionFromURL(n,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),b4(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Vt(n)?{error:n}:{error:new Cy("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,i;try{const a=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Vi}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Vt(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var n,s,i;try{let a;if("email"in e){const{email:f,password:p,options:v}=e;let m=null,N=null;this.flowType==="pkce"&&([m,N]=await ol(this.storage,this.storageKey)),a=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:f,password:p,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:m,code_challenge_method:N},xform:Vi})}else if("phone"in e){const{phone:f,password:p,options:v}=e;a=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:p,data:(s=v==null?void 0:v.data)!==null&&s!==void 0?s:{},channel:(i=v==null?void 0:v.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:Vi})}else throw new Vd("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Vt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let n;if("email"in e){const{email:a,password:o,options:l}=e;n=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:fx})}else if("phone"in e){const{phone:a,password:o,options:l}=e;n=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:fx})}else throw new Vd("You must provide either an email or phone number and a password");const{data:s,error:i}=n;return i?{data:{user:null,session:null},error:i}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Hd}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(n){if(Vt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,s,i,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,s,i,a,o,l,c,d,f,p,v,m;let N,S;if("message"in e)N=e.message,S=e.signature;else{const{chain:k,wallet:y,statement:b,options:j}=e;let z;if(ti())if(typeof y=="object")z=y;else{const Z=window;if("solana"in Z&&typeof Z.solana=="object"&&("signIn"in Z.solana&&typeof Z.solana.signIn=="function"||"signMessage"in Z.solana&&typeof Z.solana.signMessage=="function"))z=Z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(j!=null&&j.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");z=y}const H=new URL((n=j==null?void 0:j.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in z&&z.signIn){const Z=await z.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},j==null?void 0:j.signInWithSolana),{version:"1",domain:H.host,uri:H.href}),b?{statement:b}:null));let K;if(Array.isArray(Z)&&Z[0]&&typeof Z[0]=="object")K=Z[0];else if(Z&&typeof Z=="object"&&"signedMessage"in Z&&"signature"in Z)K=Z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in K&&"signature"in K&&(typeof K.signedMessage=="string"||K.signedMessage instanceof Uint8Array)&&K.signature instanceof Uint8Array)N=typeof K.signedMessage=="string"?K.signedMessage:new TextDecoder().decode(K.signedMessage),S=K.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in z)||typeof z.signMessage!="function"||!("publicKey"in z)||typeof z!="object"||!z.publicKey||!("toBase58"in z.publicKey)||typeof z.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${H.host} wants you to sign in with your Solana account:`,z.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${H.href}`,`Issued At: ${(i=(s=j==null?void 0:j.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=j==null?void 0:j.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${j.signInWithSolana.notBefore}`]:[],...!((o=j==null?void 0:j.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${j.signInWithSolana.expirationTime}`]:[],...!((l=j==null?void 0:j.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${j.signInWithSolana.chainId}`]:[],...!((c=j==null?void 0:j.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${j.signInWithSolana.nonce}`]:[],...!((d=j==null?void 0:j.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${j.signInWithSolana.requestId}`]:[],...!((p=(f=j==null?void 0:j.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||p===void 0)&&p.length?["Resources",...j.signInWithSolana.resources.map(K=>`- ${K}`)]:[]].join(`
`);const Z=await z.signMessage(new TextEncoder().encode(N),"utf8");if(!Z||!(Z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=Z}}try{const{data:k,error:y}=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:k4(S)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Vi});if(y)throw y;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new Hd}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:y})}catch(k){if(Vt(k))return{data:{user:null,session:null},error:k};throw k}}async _exchangeCodeForSession(e){const n=await po(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(n??"").split("/");try{const{data:a,error:o}=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Vi});if(await ja(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Hd}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(Vt(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:n,provider:s,token:i,access_token:a,nonce:o}=e,l=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Vi}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Hd}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(n){if(Vt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,s,i,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,f=null;this.flowType==="pkce"&&([d,f]=await ol(this.storage,this.storageKey));const{error:p}=await Kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:f}=await Kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:f}}throw new Vd("You must provide either an email or phone number.")}catch(l){if(Vt(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,s;try{let i,a;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await Kt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:Vi});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Vt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,s,i;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await ol(this.storage,this.storageKey)),await Kt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:W4})}catch(a){if(Vt(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new ka;const{error:i}=await Kt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Vt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:a}=e,{error:o}=await Kt(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:i,options:a}=e,{data:o,error:l}=await Kt(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Vd("You must provide either an email or phone number and a type")}catch(n){if(Vt(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await po(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Sm:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await po(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=km()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,f)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,f))})}return{data:{session:e},error:null}}const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ta}):await this._useSession(async n=>{var s,i,a;const{data:o,error:l}=n;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ka}:await Kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:Ta})})}catch(n){if(Vt(n))return y4(n)&&(await this._removeSession(),await ja(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:i,error:a}=s;if(a)throw a;if(!i.session)throw new ka;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await ol(this.storage,this.storageKey));const{data:d,error:f}=await Kt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ta});if(f)throw f;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(Vt(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ka;const n=Date.now()/1e3;let s=n,i=!0,a=null;const{payload:o}=Cm(e.access_token);if(o.exp&&(s=o.exp,i=s<=n),i){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(n){if(Vt(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new ka;const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Vt(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!ti())throw new Gd("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Gd(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new ax("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Gd("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ax("No code detected.");const{data:b,error:j}=await this._exchangeCodeForSession(e.code);if(j)throw j;const z=new URL(window.location.href);return z.searchParams.delete("code"),window.history.replaceState(window.history.state,"",z.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new Gd("No session defined in URL");const f=Math.round(Date.now()/1e3),p=parseInt(l);let v=f+p;c&&(v=parseInt(c));const m=v-f;m*1e3<=vl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${p}s`);const N=v-p;f-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,v,f):f-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,v,f);const{data:S,error:k}=await this._getUser(a);if(k)throw k;const y={provider_token:s,provider_refresh_token:i,access_token:a,expires_in:p,expires_at:v,refresh_token:o,token_type:d,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(s){if(Vt(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await po(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:i,error:a}=n;if(a)return{error:a};const o=(s=i.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(v4(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await ja(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=P4(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,i;try{const{data:{session:a},error:o}=n;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,n={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await ol(this.storage,this.storageKey,!0));try{return await Kt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(a){if(Vt(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:s,error:i}=await this._useSession(async a=>{var o,l,c,d,f;const{data:p,error:v}=a;if(v)throw v;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Kt(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return ti()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(Vt(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,i;const{data:a,error:o}=n;if(o)throw o;return await Kt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(Vt(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await E4(async i=>(i>0&&await T4(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await Kt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Vi})),(i,a)=>{const o=200*Math.pow(2,i);return a&&_m(a)&&Date.now()+o-s<vl})}catch(s){if(this._debug(n,"error",s),Vt(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),ti()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await po(this.storage,this.storageKey);if(i&&this.userStorage){let o=await po(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await yl(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:km()}else if(i&&!i.user&&!i.user){const o=await po(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await ja(this.storage,this.storageKey+"-user"),await yl(this.storage,this.storageKey,i)):i.user=km()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const a=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Sm;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${Sm}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),_m(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i),console.error(i);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new ka;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new pf;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new ka;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(i,"error",a),Vt(a)){const o={session:null,error:a};return _m(a)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await yl(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const a=dx(i);await yl(this.storage,this.storageKey,a)}else{const i=dx(n);await yl(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await ja(this.storage,this.storageKey),await ja(this.storage,this.storageKey+"-code-verifier"),await ja(this.storage,this.storageKey+"-user"),this.userStorage&&await ja(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ti()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),vl);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-e)/vl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${vl}ms, refresh threshold is ${qp} ticks`),i<=qp&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ly)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ti()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const i=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,o]=await ol(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);i.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:i,error:a}=n;return a?{data:null,error:a}:await Kt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Vt(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,i;const{data:a,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await Kt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(Vt(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:i,error:a}=n;if(a)return{data:null,error:a};const{data:o,error:l}=await Kt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:i,error:a}=n;return a?{data:null,error:a}:await Kt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const s=(e==null?void 0:e.factors)||[],i=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:i,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,s;const{data:{session:i},error:a}=e;if(a)return{data:null,error:a};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Cm(i.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((s=(n=i.user.factors)===null||n===void 0?void 0:n.filter(p=>p.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const f=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(l=>l.kid===e);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+g4>i)return s;const{data:a,error:o}=await Kt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,s=a.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:m,error:N}=await this.getSession();if(N||!m.session)return{data:null,error:N};s=m.session.access_token}const{header:i,payload:a,signature:o,raw:{header:l,payload:c}}=Cm(s);n!=null&&n.allowExpired||B4(a.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!d){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:a,header:i,signature:o},error:null}}const f=$4(i.alg),p=await crypto.subtle.importKey("jwk",d,f,!0,["verify"]);if(!await crypto.subtle.verify(f,p,o,C4(`${l}.${c}`)))throw new Vp("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}}}zu.nextInstanceID=0;const rS=zu;class sS extends rS{constructor(e){super(e)}}var iS=globalThis&&globalThis.__awaiter||function(t,e,n,s){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(f){try{d(s.next(f))}catch(p){o(p)}}function c(f){try{d(s.throw(f))}catch(p){o(p)}}function d(f){f.done?a(f.value):i(f.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class aS{constructor(e,n,s){var i,a,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=u4(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:n4,realtime:s4,auth:Object.assign(Object.assign({},r4),{storageKey:d}),global:t4},p=d4(s??{},f);this.storageKey=(i=p.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=p.global.headers)!==null&&a!==void 0?a:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(v,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=p.auth)!==null&&o!==void 0?o:{},this.headers,p.global.fetch),this.fetch=l4(n,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new Nj(new URL("rest/v1",c).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new Xj(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new ej(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},s={}){return this.rest.rpc(e,n,s)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return iS(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(n=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:i,userStorage:a,storageKey:o,flowType:l,lock:c,debug:d},f,p){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new sS({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),f),storageKey:o,autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:i,userStorage:a,flowType:l,lock:c,debug:d,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Fj(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,n,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const oS=(t,e,n)=>new aS(t,e,n);function lS(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}lS()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const cS={}.VITE_SUPABASE_URL||"https://your-project.supabase.co",uS={}.VITE_SUPABASE_ANON_KEY||"your-anon-key",wn=oS(cS,uS),Bn={COMPANIES:"companies",USERS:"users",DEPARTMENTS:"departments",STAFF:"staff",REFRIGERATORS:"refrigerators",TEMPERATURES:"temperatures",CLEANING:"cleaning",INVENTORY:"inventory",PRODUCT_LABELS:"product_labels",ONBOARDING:"onboarding",MAINTENANCE_TASKS:"maintenance_tasks"},dS=t=>({id:t,name:"",type:"",address:"",email:"",phone:"",vat_number:"",settings:{allow_photo_storage:!0,max_users:25,plan:"free",features:{inventory_sync:!0,temperature_sync:!0,staff_sync:!0,label_sync:!1}},created_at:new Date().toISOString(),updated_at:new Date().toISOString(),last_sync:null}),Wd={}.VITE_SUPABASE_URL||"https://your-project.supabase.co";class hS{constructor(){this.companyId=this.getCompanyId()}getCompanyId(){let e=localStorage.getItem("haccp-company-id");return e||(e=`company_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("haccp-company-id",e)),e}handleError(e,n){return console.error(`❌ Supabase ${n} error:`,e),{success:!1,error:e.message,data:null}}handleSuccess(e,n){return console.log(`✅ Supabase ${n} success:`,e),{success:!0,error:null,data:e}}async createCompany(e){try{const n={...dS(this.companyId),...e,id:this.companyId},{data:s,error:i}=await wn.from(Bn.COMPANIES).insert([n]).select();if(i)throw i;return this.handleSuccess(s[0],"createCompany")}catch(n){return this.handleError(n,"createCompany")}}async getCompany(){try{const{data:e,error:n}=await wn.from(Bn.COMPANIES).select("*").eq("id",this.companyId).single();if(n&&n.code!=="PGRST116")throw n;return this.handleSuccess(e,"getCompany")}catch(e){return this.handleError(e,"getCompany")}}async saveUsers(e){try{const{data:n,error:s}=await wn.from(Bn.USERS).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(s)throw s;return this.handleSuccess(n,"saveUsers")}catch(n){return this.handleError(n,"saveUsers")}}async getUsers(){try{const{data:e,error:n}=await wn.from(Bn.USERS).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getUsers")}catch(e){return this.handleError(e,"getUsers")}}async saveDepartments(e){try{const{data:n,error:s}=await wn.from(Bn.DEPARTMENTS).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(s)throw s;return this.handleSuccess(n,"saveDepartments")}catch(n){return this.handleError(n,"saveDepartments")}}async getDepartments(){try{const{data:e,error:n}=await wn.from(Bn.DEPARTMENTS).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getDepartments")}catch(e){return this.handleError(e,"getDepartments")}}async saveStaff(e){try{const{data:n,error:s}=await wn.from(Bn.STAFF).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(s)throw s;return this.handleSuccess(n,"saveStaff")}catch(n){return this.handleError(n,"saveStaff")}}async getStaff(){try{const{data:e,error:n}=await wn.from(Bn.STAFF).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getStaff")}catch(e){return this.handleError(e,"getStaff")}}async saveRefrigerators(e){try{const{data:n,error:s}=await wn.from(Bn.REFRIGERATORS).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(s)throw s;return this.handleSuccess(n,"saveRefrigerators")}catch(n){return this.handleError(n,"saveRefrigerators")}}async getRefrigerators(){try{const{data:e,error:n}=await wn.from(Bn.REFRIGERATORS).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getRefrigerators")}catch(e){return this.handleError(e,"getRefrigerators")}}async saveTemperatures(e){try{const{data:n,error:s}=await wn.from(Bn.TEMPERATURES).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(s)throw s;return this.handleSuccess(n,"saveTemperatures")}catch(n){return this.handleError(n,"saveTemperatures")}}async getTemperatures(){try{const{data:e,error:n}=await wn.from(Bn.TEMPERATURES).select("*").eq("company_id",this.companyId).order("timestamp",{ascending:!1});if(n)throw n;return this.handleSuccess(e||[],"getTemperatures")}catch(e){return this.handleError(e,"getTemperatures")}}async saveCleaning(e){try{const{data:n,error:s}=await wn.from(Bn.CLEANING).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(s)throw s;return this.handleSuccess(n,"saveCleaning")}catch(n){return this.handleError(n,"saveCleaning")}}async getCleaning(){try{const{data:e,error:n}=await wn.from(Bn.CLEANING).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getCleaning")}catch(e){return this.handleError(e,"getCleaning")}}async saveInventory(e){try{const{data:n,error:s}=await wn.from(Bn.INVENTORY).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(s)throw s;return this.handleSuccess(n,"saveInventory")}catch(n){return this.handleError(n,"saveInventory")}}async getInventory(){try{const{data:e,error:n}=await wn.from(Bn.INVENTORY).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getInventory")}catch(e){return this.handleError(e,"getInventory")}}async saveOnboarding(e){try{const{data:n,error:s}=await wn.from(Bn.ONBOARDING).upsert([{id:this.companyId,company_id:this.companyId,data:e,completed:!0,completed_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select();if(s)throw s;return this.handleSuccess(n[0],"saveOnboarding")}catch(n){return this.handleError(n,"saveOnboarding")}}async getOnboarding(){try{const{data:e,error:n}=await wn.from(Bn.ONBOARDING).select("*").eq("company_id",this.companyId).single();if(n&&n.code!=="PGRST116")throw n;return this.handleSuccess(e,"getOnboarding")}catch(e){return this.handleError(e,"getOnboarding")}}async saveMaintenanceTasks(e){try{if(!wn||Wd.includes("your-project.supabase.co")){console.warn("⚠️ Supabase non configurato, salvataggio in localStorage");const i=JSON.parse(localStorage.getItem("haccp-maintenance-tasks")||"[]"),a=e.map(l=>({...l,company_id:this.companyId,updated_at:new Date().toISOString()})),o=[...i.filter(l=>!e.some(c=>c.conservation_point_id===l.conservation_point_id)),...a];return localStorage.setItem("haccp-maintenance-tasks",JSON.stringify(o)),this.handleSuccess(a,"saveMaintenanceTasks (localStorage)")}const{data:n,error:s}=await wn.from(Bn.MAINTENANCE_TASKS).upsert(e.map(i=>({...i,company_id:this.companyId,updated_at:new Date().toISOString()}))).select();if(s)throw s;return this.handleSuccess(n,"saveMaintenanceTasks")}catch(n){return this.handleError(n,"saveMaintenanceTasks")}}async getMaintenanceTasks(){try{if(!wn||Wd.includes("your-project.supabase.co")){console.warn("⚠️ Supabase non configurato, caricamento da localStorage");const s=JSON.parse(localStorage.getItem("haccp-maintenance-tasks")||"[]");console.log("🔍 Tasks raw from localStorage:",s.length,"task"),console.log("🔍 Company ID corrente:",this.companyId);const i=s.filter(a=>a.company_id===this.companyId);return console.log("🔍 Tasks filtrati per company_id:",i.length,"task"),this.handleSuccess(i,"getMaintenanceTasks (localStorage)")}const{data:e,error:n}=await wn.from(Bn.MAINTENANCE_TASKS).select("*").eq("company_id",this.companyId).order("created_at",{ascending:!0});if(n)throw n;return this.handleSuccess(e||[],"getMaintenanceTasks")}catch(e){return this.handleError(e,"getMaintenanceTasks")}}async getMaintenanceTasksByConservationPoint(e){try{if(!wn||Wd.includes("your-project.supabase.co")){console.warn("⚠️ Supabase non configurato, caricamento da localStorage");const a=JSON.parse(localStorage.getItem("haccp-maintenance-tasks")||"[]").filter(o=>o.company_id===this.companyId&&o.conservation_point_id===e);return this.handleSuccess(a,"getMaintenanceTasksByConservationPoint (localStorage)")}const{data:n,error:s}=await wn.from(Bn.MAINTENANCE_TASKS).select("*").eq("company_id",this.companyId).eq("conservation_point_id",e).order("created_at",{ascending:!0});if(s)throw s;return this.handleSuccess(n||[],"getMaintenanceTasksByConservationPoint")}catch(n){return this.handleError(n,"getMaintenanceTasksByConservationPoint")}}async deleteMaintenanceTasksByConservationPoint(e){try{if(!wn||Wd.includes("your-project.supabase.co")){console.warn("⚠️ Supabase non configurato, eliminazione da localStorage");const a=JSON.parse(localStorage.getItem("haccp-maintenance-tasks")||"[]").filter(o=>!(o.company_id===this.companyId&&o.conservation_point_id===e));return localStorage.setItem("haccp-maintenance-tasks",JSON.stringify(a)),this.handleSuccess(a,"deleteMaintenanceTasksByConservationPoint (localStorage)")}const{data:n,error:s}=await wn.from(Bn.MAINTENANCE_TASKS).delete().eq("company_id",this.companyId).eq("conservation_point_id",e);if(s)throw s;return this.handleSuccess(n,"deleteMaintenanceTasksByConservationPoint")}catch(n){return this.handleError(n,"deleteMaintenanceTasksByConservationPoint")}}async migrateFromLocalStorage(){try{console.log("🔄 Starting migration from localStorage to Supabase...");const e={users:JSON.parse(localStorage.getItem("haccp-users")||"[]"),departments:JSON.parse(localStorage.getItem("haccp-departments")||"[]"),staff:JSON.parse(localStorage.getItem("haccp-staff")||"[]"),refrigerators:JSON.parse(localStorage.getItem("haccp-refrigerators")||"[]"),temperatures:JSON.parse(localStorage.getItem("haccp-temperatures")||"[]"),cleaning:JSON.parse(localStorage.getItem("haccp-cleaning")||"[]"),products:JSON.parse(localStorage.getItem("haccp-products")||"[]"),onboarding:JSON.parse(localStorage.getItem("haccp-onboarding")||"null")},n=await this.getCompany();(!n.success||!n.data)&&await this.createCompany({name:"Migrated Company",type:"pizzeria"});const s=[];e.users.length>0&&s.push(this.saveUsers(e.users)),e.departments.length>0&&s.push(this.saveDepartments(e.departments)),e.staff.length>0&&s.push(this.saveStaff(e.staff)),e.refrigerators.length>0&&s.push(this.saveRefrigerators(e.refrigerators)),e.temperatures.length>0&&s.push(this.saveTemperatures(e.temperatures)),e.cleaning.length>0&&s.push(this.saveCleaning(e.cleaning)),e.products.length>0&&s.push(this.saveInventory(e.products)),e.onboarding&&s.push(this.saveOnboarding(e.onboarding));const i=await Promise.all(s),a=i.filter(l=>!l.success);return a.length>0?(console.error("❌ Some migrations failed:",a),this.handleError(new Error("Migration failed"),"migrateFromLocalStorage")):(["haccp-users","haccp-departments","haccp-staff","haccp-refrigerators","haccp-temperatures","haccp-cleaning","haccp-products","haccp-onboarding"].forEach(l=>localStorage.removeItem(l)),console.log("✅ Migration completed successfully!"),this.handleSuccess(i,"migrateFromLocalStorage"))}catch(e){return this.handleError(e,"migrateFromLocalStorage")}}}const Pm=new hS,fS={"haccp-inventory":zr.INVENTORY,"haccp-refrigerators":zr.REFRIGERATORS,"haccp-used-ingredients":zr.USED_INGREDIENTS,"haccp-onboarding":zr.ONBOARDING,"haccp-suppliers":zr.SUPPLIERS,"haccp-orders":zr.ORDERS},mS=()=>{if(localStorage.getItem(zr.MIGRATED)==="true")return;console.log("🔄 Iniziando migrazione chiavi localStorage...");let e=0;Object.entries(fS).forEach(([n,s])=>{const i=localStorage.getItem(n);if(i)try{JSON.parse(i),localStorage.setItem(s,i),console.log(`✅ Migrato: ${n} -> ${s}`),e++}catch(a){console.warn(`⚠️ Errore nel migrare ${n}:`,a)}}),localStorage.setItem(zr.MIGRATED,"true"),console.log(`🎉 Migrazione completata: ${e} chiavi migrate`)},dl=t=>{try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch(e){return console.error(`Errore nel leggere ${t}:`,e),null}},gx=(t,e)=>{try{localStorage.setItem(t,JSON.stringify(e))}catch(n){console.error(`Errore nel salvare ${t}:`,n)}},pS=t=>{if(t.setTempMode)return t.setTempMode===Es.FIXED?{mode:Es.FIXED,value:t.setTempC}:t.setTempMode===Es.RANGE?{mode:Es.RANGE,range:t.setTempRangeC}:t.setTempMode===Es.AMBIENT?{mode:Es.AMBIENT}:{mode:"unknown"};const e=t.targetTemp||t.setTemperature||t.temperature||t.temp;if(!e)return t.unknownField?{mode:"unknown"}:{mode:Es.AMBIENT};if(typeof e=="number")return{mode:Es.FIXED,value:e};if(typeof e=="string"){const n=e.toLowerCase().trim();if(n.includes("ambiente")||n.includes("ambient"))return{mode:Es.AMBIENT};const s=n.match(/(\d+(?:\.\d+)?)\s*[-a]\s*(\d+(?:\.\d+)?)/);if(s){const a=parseFloat(s[1]),o=parseFloat(s[2]);return{mode:Es.RANGE,range:{min:a,max:o}}}const i=n.match(/(\d+(?:\.\d+)?)/);if(i){const a=parseFloat(i[1]);return{mode:Es.FIXED,value:a}}}return{mode:Es.AMBIENT}};function zs({title:t,subtitle:e,icon:n,iconColor:s="text-blue-600",iconBgColor:i="bg-blue-100",count:a=0,children:o,testId:l,className:c="",defaultExpanded:d=!1,onToggle:f=null}){const[p,v]=W.useState(d),m=()=>{const N=!p;v(N),f&&f(N)};return r.jsxs(Je,{className:`border-2 border-blue-300 shadow-lg hover:shadow-xl transition-all duration-200 bg-white ${c}`,children:[r.jsx(yt,{className:"cursor-pointer hover:bg-blue-50 transition-all duration-200 border-b border-blue-100",onClick:m,"data-testid":l?`${l}-header`:void 0,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[n&&r.jsx("div",{className:`p-3 rounded-xl ${i} shadow-sm`,children:r.jsx(n,{className:`h-6 w-6 ${s}`})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-900",children:t}),e&&r.jsx("p",{className:"text-sm text-gray-600",children:e})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[a>0&&r.jsx("span",{className:"bg-blue-500 text-white text-sm font-bold px-3 py-1 rounded-full shadow-sm",children:a}),r.jsx(Z2,{className:`h-5 w-5 text-blue-600 transition-transform duration-200 ${p?"rotate-180":""}`})]})]})}),p&&r.jsx(Xe,{className:"pt-8 px-12 pb-12 animate-in slide-in-from-top-2 fade-in-50 duration-300","data-testid":l?`${l}-content`:void 0,children:o})]})}const Ja=(t,e="add-form")=>{const n=W.useRef(null),s=W.useCallback(()=>{t&&n.current&&setTimeout(()=>{var i;(i=n.current)==null||i.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},100)},[t]);return{formRef:n,scrollToForm:s}};function gS({temperatures:t=[],setTemperatures:e,currentUser:n,refrigerators:s=[],setRefrigerators:i,departments:a=[],setDepartments:o}){const[l,c]=W.useState(!1),[d,f]=W.useState(null),{formRef:p,scrollToForm:v}=Ja(l,"conservation-point-form"),[m,N]=W.useState({name:"",location:"",targetTemp:4,selectedCategories:[]});W.useEffect(()=>{l&&v()},[l,v]);const S=[{id:"fresh_dairy",name:"Latticini Freschi",tempRange:[2,4]},{id:"fresh_meat",name:"Carni Fresche",tempRange:[0,2]},{id:"fresh_produce",name:"Prodotti Freschi",tempRange:[2,4]},{id:"fresh_beverages",name:"Bevande Fresche",tempRange:[4,6]},{id:"chilled_ready",name:"Pronti al Consumo",tempRange:[2,4]},{id:"frozen",name:"Congelati",tempRange:[-18,-15]},{id:"deep_frozen",name:"Surgelati",tempRange:[-22,-18]}],y=(()=>{const P=s.length,$=s.filter(C=>{const R=t.filter(te=>te.refrigeratorId===C.id).sort((te,L)=>new Date(L.timestamp)-new Date(te.timestamp))[0];if(!R)return!1;const V=parseFloat(R.temperature),ie=parseFloat(C.targetTemp),Q=2;return Math.abs(V-ie)<=Q}).length,re=t.filter(C=>C.status==="danger").length,A=t.filter(C=>{const R=new Date(C.timestamp),V=new Date(Date.now()-24*60*60*1e3);return R>V}).length;return{total:P,compliant:$,critical:re,recent:A}})(),j=(P=>P.reduce(($,re)=>{const A=re.location||"Non assegnato";return $[A]||($[A]=[]),$[A].push(re),$},{}))(s),z=P=>{if(P.preventDefault(),d){const $=s.map(re=>re.id===d.id?{...re,...m}:re);i($),f(null)}else{const $={...m,id:`ref_${Date.now()}`,createdAt:new Date().toISOString()};i([...s,$])}N({name:"",location:"",targetTemp:4,selectedCategories:[]}),c(!1)},H=P=>{f(P),N({name:P.name,location:P.location,targetTemp:P.targetTemp,selectedCategories:P.selectedCategories||[]}),c(!0)},Z=P=>{confirm("Sei sicuro di voler eliminare questo frigorifero?")&&(i(s.filter($=>$.id!==P)),e(t.filter($=>$.refrigeratorId!==P)))},K=P=>{N($=>({...$,selectedCategories:$.selectedCategories.includes(P)?$.selectedCategories.filter(re=>re!==P):[...$.selectedCategories,P]}))};return r.jsxs("div",{className:"space-y-6",children:[r.jsx(zs,{title:"Punti di Conservazione",subtitle:"Gestione frigoriferi e temperature",icon:ds,iconColor:"text-blue-600",iconBgColor:"bg-blue-100",count:y.total,testId:"pc-list",defaultExpanded:!0,children:r.jsxs("div",{className:"space-y-6",children:[Object.entries(j).map(([P,$])=>{const re={total:$.length,compliant:$.filter(A=>{const C=t.filter(R=>R.refrigeratorId===A.id).sort((R,V)=>new Date(V.timestamp)-new Date(R.timestamp))[0];return C?Math.abs(parseFloat(C.temperature)-parseFloat(A.targetTemp))<=2:!1}).length};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(ds,{className:"h-5 w-5 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:P}),r.jsxs("p",{className:"text-sm text-gray-600",children:[re.total," punti di conservazione"]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[re.compliant,"/",re.total]}),r.jsx("div",{className:"text-sm text-gray-600",children:"Compliant"})]})]}),r.jsx("div",{className:"space-y-3",children:$.map(A=>{const C=t.filter(V=>V.refrigeratorId===A.id).sort((V,ie)=>new Date(ie.timestamp)-new Date(V.timestamp))[0],R=C?Math.abs(parseFloat(C.temperature)-parseFloat(A.targetTemp))<=2:!1;return r.jsx(Je,{className:"border-l-4 border-l-blue-500",children:r.jsx(Xe,{className:"p-4",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-semibold text-gray-900",children:A.name}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Posizione: ",A.location]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Temperatura Target: ",A.targetTemp,"°C"]}),C&&r.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-gray-600",children:["Ultima lettura: ",C.temperature,"°C"]}),R?r.jsx(Cn,{className:"h-4 w-4 text-green-500"}):r.jsx(xn,{className:"h-4 w-4 text-red-500"})]}),A.selectedCategories&&A.selectedCategories.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Categorie supportate:"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:A.selectedCategories.map(V=>{const ie=S.find(Q=>Q.id===V);return ie?r.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:ie.name},V):null})})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{variant:"outline",size:"sm",onClick:()=>H(A),children:r.jsx(ci,{className:"h-4 w-4"})}),r.jsx(le,{variant:"outline",size:"sm",onClick:()=>Z(A.id),className:"text-red-600 hover:text-red-700",children:r.jsx(tr,{className:"h-4 w-4"})})]})]})})},A.id)})})]},P)}),r.jsxs(le,{onClick:()=>c(!0),className:"w-full",variant:"outline",children:[r.jsx(or,{className:"h-4 w-4 mr-2"}),"Aggiungi Frigorifero"]})]})}),r.jsx(zs,{title:"Attività Registro Temperature",subtitle:"Monitoraggio e registrazione temperature",icon:pN,iconColor:"text-green-600",iconBgColor:"bg-green-100",count:y.recent,testId:"pc-registro",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Registra le temperature dei frigoriferi per mantenere la compliance HACCP."}),r.jsx("div",{className:"space-y-2",children:t.slice(0,5).map(P=>{const $=s.find(re=>re.id===P.refrigeratorId);return r.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:($==null?void 0:$.name)||"Frigorifero sconosciuto"}),r.jsx("p",{className:"text-sm text-gray-600",children:new Date(P.timestamp).toLocaleString("it-IT")})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:`font-bold ${P.status==="danger"?"text-red-600":P.status==="warning"?"text-yellow-600":"text-green-600"}`,children:[P.temperature,"°C"]}),r.jsx("p",{className:"text-xs text-gray-500",children:P.status})]})]},P.id)})})]})}),r.jsx(zs,{title:"Stato Punti di Conservazione",subtitle:"Overview compliance e statistiche",icon:Tp,iconColor:"text-purple-600",iconBgColor:"bg-purple-100",count:y.compliant,testId:"pc-stato",children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:y.total}),r.jsx("p",{className:"text-sm text-blue-700",children:"Totale Frigoriferi"})]}),r.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:y.compliant}),r.jsx("p",{className:"text-sm text-green-700",children:"Compliant"})]}),r.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[r.jsx("p",{className:"text-2xl font-bold text-red-600",children:y.critical}),r.jsx("p",{className:"text-sm text-red-700",children:"Critici"})]}),r.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[r.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:y.recent}),r.jsx("p",{className:"text-sm text-yellow-700",children:"Ultime 24h"})]})]})}),r.jsx(zs,{title:"Riferimenti Normativi EU/ASL",subtitle:"Normative europee e linee guida ASL",icon:xn,iconColor:"text-orange-600",iconBgColor:"bg-orange-100",count:3,testId:"pc-normative",children:r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid gap-4",children:[r.jsx(Je,{className:"border-l-4 border-l-orange-500",children:r.jsxs(Xe,{className:"p-4",children:[r.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Regolamento UE 852/2004"}),r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Normativa europea per l'igiene dei prodotti alimentari"}),r.jsxs("div",{className:"text-xs text-gray-500",children:[r.jsx("p",{children:"• Requisiti generali per l'igiene alimentare"}),r.jsx("p",{children:"• Obblighi per gli operatori del settore alimentare"}),r.jsx("p",{children:"• Procedure basate sui principi HACCP"})]})]})}),r.jsx(Je,{className:"border-l-4 border-l-orange-500",children:r.jsxs(Xe,{className:"p-4",children:[r.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Regolamento UE 853/2004"}),r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Norme specifiche per prodotti di origine animale"}),r.jsxs("div",{className:"text-xs text-gray-500",children:[r.jsx("p",{children:"• Requisiti specifici per carni e prodotti derivati"}),r.jsx("p",{children:"• Temperature di conservazione obbligatorie"}),r.jsx("p",{children:"• Tracciabilità e etichettatura"})]})]})}),r.jsx(Je,{className:"border-l-4 border-l-orange-500",children:r.jsxs(Xe,{className:"p-4",children:[r.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Linee Guida ASL"}),r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Indicazioni operative per il controllo ufficiale"}),r.jsxs("div",{className:"text-xs text-gray-500",children:[r.jsx("p",{children:"• Controlli ispettivi programmati"}),r.jsx("p",{children:"• Verifica documentazione HACCP"}),r.jsx("p",{children:"• Sanzioni e provvedimenti"})]})]})})]})})}),l&&r.jsxs(Je,{ref:p,id:"conservation-point-form",className:"border-2 border-blue-200",children:[r.jsx(yt,{children:r.jsx(Nt,{children:d?"Modifica Frigorifero":"Aggiungi Nuovo Frigorifero"})}),r.jsx(Xe,{children:r.jsxs("form",{onSubmit:z,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Frigorifero"}),r.jsx("input",{type:"text",value:m.name,onChange:P=>N($=>({...$,name:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posizione"}),r.jsx("input",{type:"text",value:m.location,onChange:P=>N($=>({...$,location:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Temperatura Target (°C)"}),r.jsx("input",{type:"number",step:"0.1",value:m.targetTemp,onChange:P=>N($=>({...$,targetTemp:parseFloat(P.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categorie di Prodotti Supportate"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:S.map(P=>r.jsxs("label",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"checkbox",checked:m.selectedCategories.includes(P.id),onChange:()=>K(P.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:P.name})]},P.id))})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsxs(le,{type:"submit",className:"flex-1",children:[d?"Aggiorna":"Aggiungi"," Frigorifero"]}),r.jsx(le,{type:"button",variant:"outline",onClick:()=>{c(!1),f(null),N({name:"",location:"",targetTemp:4,selectedCategories:[]})},children:"Annulla"})]})]})})]})]})}function s0({value:t,onValueChange:e,children:n}){return r.jsx("div",{className:"w-full",children:Da.Children.map(n,s=>!s||!s.type?s:s.type===gf?Da.cloneElement(s,{value:t,onValueChange:e}):s.type===Wr?Da.cloneElement(s,{currentValue:t}):s)})}function gf({value:t,onValueChange:e,children:n,className:s=""}){return r.jsx("div",{className:`flex p-1 bg-gray-100 rounded-xl shadow-sm ${s}`,children:Da.Children.map(n,i=>!i||!i.type?i:i.type===Gr?Da.cloneElement(i,{currentValue:t,onValueChange:e,isActive:t===i.props.value}):i)})}function Gr({value:t,currentValue:e,onValueChange:n,isActive:s,children:i,className:a=""}){return r.jsx("button",{onClick:()=>n(t),className:`
        flex-1 px-4 py-3 text-sm font-medium rounded-lg transition-all duration-200 ease-in-out
        ${s?"bg-white text-blue-600 shadow-md transform scale-[1.02]":"text-gray-600 hover:text-gray-900 hover:bg-white/60 active:scale-[0.98]"}
        ${a}
      `,children:i})}function Wr({value:t,currentValue:e,children:n}){return e!==t?null:r.jsx("div",{className:"mt-6 animate-in fade-in-50 duration-200",children:n})}function xS({currentUser:t,products:e=[],temperatures:n=[],cleaning:s=[],staff:i=[],onAction:a}){const[o,l]=W.useState([]),[c,d]=W.useState(""),[f,p]=W.useState(!1),[v,m]=W.useState(!1),[N,S]=W.useState(null),[k,y]=W.useState(!1),[b,j]=W.useState([{id:1,name:"Alert Scadenze",enabled:!0,description:"Avvisa sui prodotti in scadenza"},{id:2,name:"Suggerimenti Ricette",enabled:!0,description:"Genera ricette per ingredienti in scadenza"},{id:3,name:"Ordini Settimanali",enabled:!1,description:"Crea ordini automatici ogni lunedì"},{id:4,name:"Alert Temperature",enabled:!0,description:"Avvisa su temperature critiche"}]),[z,H]=W.useState(()=>{const R=localStorage.getItem("haccp-show-chat-icon");return R!==null?JSON.parse(R):!0});W.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const R=window.SpeechRecognition||window.webkitSpeechRecognition,V=new R;V.continuous=!1,V.interimResults=!1,V.lang="it-IT",V.onstart=()=>{m(!0),Z("assistant","🎤 Ti sto ascoltando... Parla ora!","system")},V.onresult=ie=>{const Q=ie.results[0][0].transcript;d(Q),Z("assistant",`🎤 Ho sentito: "${Q}"`,"system")},V.onerror=ie=>{is("Speech recognition error:",ie.error),m(!1),Z("assistant","❌ Errore nel riconoscimento vocale. Riprova!","system")},V.onend=()=>{m(!1)},S(V)}},[]),W.useEffect(()=>{o.length===0&&Z("assistant",`Ciao ${(t==null?void 0:t.name)||"utente"}! 👋 Sono il tuo assistente IA per il sistema HACCP.

**🤖 Cosa posso fare:**
• **Gestione inventario** - Aggiungere prodotti, controllare scadenze
• **Controlli temperatura** - Registrare e monitorare temperature
• **Attività di pulizia** - Gestire mansioni e frequenze
• **Automatizzazioni** - Alert intelligenti e suggerimenti
• **🎤 Riconoscimento vocale** - Parla invece di scrivere!

**⚙️ Automatizzazioni attive:**
${b.filter(R=>R.enabled).map(R=>`• ${R.name}`).join(`
`)}

Dimmi cosa ti serve!`)},[]);const Z=(R,V,ie="text",Q=null)=>{const te={id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sender:R,content:V,type:ie,data:Q,timestamp:new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"})};l(L=>[...L,te])},K=async()=>{if(!c.trim())return;const R=c.trim();d(""),Z("user",R),p(!0),setTimeout(()=>{const V=P(R);Z("assistant",V.content,V.type,V.data),p(!1)},1e3)},P=R=>{const V=R.toLowerCase();if(V.includes("aiuto")||V.includes("help"))return{content:`🤖 **Come posso aiutarti:**

**📦 Inventario:**
• "Aggiungi un nuovo prodotto"
• "Controlla le scadenze"
• "Mostra i prodotti in scadenza"

**🌡️ Temperature:**
• "Registra una temperatura"
• "Mostra le ultime temperature"
• "Controlla i frigoriferi"

**🧹 Pulizia:**
• "Mostra le attività da svolgere"
• "Aggiungi una nuova attività"
• "Controlla le mansioni"

**⚙️ Automatizzazioni:**
• "Attiva alert scadenze"
• "Genera ricette"
• "Configura automatizzazioni"

**🎤 Comandi vocali:**
• Parla chiaramente in italiano
• Usa frasi semplici e dirette
• Clicca il microfono per iniziare`,type:"text"};if(V.includes("scadenza")||V.includes("scaduti")){const ie=e.filter(Q=>{const te=Math.ceil((new Date(Q.expiryDate)-new Date)/864e5);return te<=7&&te>0});return ie.length>0?{content:`⚠️ **Prodotti in scadenza** (${ie.length} prodotti):

${ie.map(Q=>`• ${Q.name} - Scade il ${Q.expiryDate}`).join(`
`)}

**Suggerimento**: Vuoi che generi delle ricette per utilizzare questi ingredienti?`,type:"alert",data:{products:ie}}:{content:"✅ Nessun prodotto in scadenza nei prossimi 7 giorni!",type:"text"}}if(V.includes("attività")||V.includes("mansioni")){const ie=s.filter(Q=>!Q.completed);return{content:`📋 **Attività da svolgere** (${ie.length} totali):

${ie.slice(0,5).map(Q=>`• ${Q.task} - Assegnato a: ${Q.assignee}`).join(`
`)}
${ie.length>5?`
... e altre ${ie.length-5} attività`:""}

**Suggerimento**: Usa le schede per filtrare per frequenza!`,type:"text"}}return V.includes("temperatura")||V.includes("frigo")?{content:`🌡️ **Ultime temperature registrate**:

${n.slice(-3).map(Q=>`• ${Q.location}: ${Q.temperature}°C (${Q.status})`).join(`
`)}

**Suggerimento**: Registra temperature regolarmente per monitorare la sicurezza alimentare!`,type:"text"}:{content:'Non sono sicuro di aver capito. Prova a dire "aiuto" per vedere tutti i comandi disponibili!',type:"text"}},$=()=>{if(!N){Z("assistant","❌ Riconoscimento vocale non supportato dal tuo browser. Usa Chrome o Edge!","system");return}v?N.stop():N.start()},re=R=>{j(V=>V.map(ie=>ie.id===R?{...ie,enabled:!ie.enabled}:ie))},A=()=>{const R=!z;H(R),localStorage.setItem("haccp-show-chat-icon",JSON.stringify(R))};W.useEffect(()=>{localStorage.setItem("haccp-show-chat-icon",JSON.stringify(z))},[z]);const C=R=>{R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),K())};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"IA Assistant"}),r.jsx("p",{className:"text-gray-600",children:"Il tuo assistente intelligente per la gestione HACCP"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(le,{onClick:$,disabled:f,className:`${v?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`,children:[v?r.jsx(ny,{className:"h-4 w-4 mr-2"}):r.jsx(qh,{className:"h-4 w-4 mr-2"}),v?"Ferma Ascolto":"Parla"]}),r.jsxs(le,{variant:"outline",onClick:()=>y(!k),children:[r.jsx(os,{className:"h-4 w-4 mr-2"}),"Impostazioni"]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsx("div",{className:"lg:col-span-2",children:r.jsxs(Je,{className:"h-96 mb-6",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Qi,{className:"h-5 w-5 text-blue-600"}),"Chat con l'IA",v&&r.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[r.jsx(qh,{className:"h-3 w-3 animate-pulse"}),r.jsx("span",{className:"text-xs",children:"Ascoltando..."})]})]})}),r.jsxs(Xe,{className:"flex flex-col h-full p-6",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto space-y-3 mb-4",children:[o.map(R=>r.jsx("div",{className:`flex ${R.sender==="user"?"justify-end":"justify-start"}`,children:r.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${R.sender==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:r.jsxs("div",{className:"flex items-start gap-2",children:[R.sender==="assistant"&&r.jsx(Qi,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-sm whitespace-pre-wrap",children:R.content}),r.jsx("div",{className:`text-xs mt-1 ${R.sender==="user"?"text-blue-100":"text-gray-500"}`,children:R.timestamp})]})]})})},R.id)),f&&r.jsx("div",{className:"flex justify-start",children:r.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Qi,{className:"h-4 w-4 text-blue-600"}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),r.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),r.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(At,{value:c,onChange:R=>d(R.target.value),onKeyPress:C,placeholder:"Scrivi un messaggio o parla...",className:"flex-1"}),r.jsx(le,{onClick:K,disabled:!c.trim()||f,children:r.jsx(sy,{className:"h-4 w-4"})})]})]})]})}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs(Je,{className:"mb-6",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(FN,{className:"h-5 w-5 text-yellow-600"}),"Automatizzazioni"]})}),r.jsx(Xe,{className:"p-6",children:r.jsx("div",{className:"space-y-4",children:b.map(R=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium text-sm",children:R.name}),r.jsx("p",{className:"text-xs text-gray-600",children:R.description})]}),r.jsx(le,{size:"sm",variant:R.enabled?"default":"outline",onClick:()=>re(R.id),children:R.enabled?"Attiva":"Disattiva"})]},R.id))})})]}),r.jsxs(Je,{className:"mb-6",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(uf,{className:"h-5 w-5 text-purple-600"}),"Azioni Rapide"]})}),r.jsx(Xe,{className:"p-6",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs(le,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>d("Controlla le scadenze"),children:[r.jsx(Un,{className:"h-4 w-4 mr-2"}),"Controlla Scadenze"]}),r.jsxs(le,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>d("Mostra le attività da svolgere"),children:[r.jsx(Cn,{className:"h-4 w-4 mr-2"}),"Attività da Svolgere"]}),r.jsxs(le,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>d("Mostra le ultime temperature"),children:[r.jsx(ds,{className:"h-4 w-4 mr-2"}),"Ultime Temperature"]}),r.jsxs(le,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>d("Aiuto"),children:[r.jsx(Qg,{className:"h-4 w-4 mr-2"}),"Aiuto"]})]})})]}),k&&r.jsxs(Je,{className:"mb-6",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(os,{className:"h-5 w-5 text-gray-600"}),"Impostazioni Chat IA"]})}),r.jsx(Xe,{className:"p-6",children:r.jsxs("div",{className:"space-y-5",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium text-sm",children:"Mostra Icona Chat"}),r.jsx("p",{className:"text-xs text-gray-600",children:"Visualizza l'icona della chat IA nell'app"})]}),r.jsx(le,{size:"sm",variant:z?"default":"outline",onClick:A,children:z?"Attiva":"Disattiva"})]}),r.jsxs("div",{className:"text-xs text-blue-600 bg-blue-50 p-3 rounded-lg",children:["💡 ",r.jsx("strong",{children:"Suggerimento:"}),` Se disattivi l'icona della chat, potrai sempre accedere all'IA dalla sezione "Assistente IA" nel menu principale.`]})]})})]})]})]})]})}function vS({productLabels:t=[],setProductLabels:e,products:n=[],currentUser:s}){var gi,Ws,Ro,Xr,Oi,vr,aa,no;const[i,a]=W.useState("scanner"),[o,l]=W.useState(!1),[c,d]=W.useState("");W.useState(null);const[f,p]=W.useState(""),[v,m]=W.useState(!1),[N,S]=W.useState(!1),[k,y]=W.useState(null),[b,j]=W.useState(!1),[z,H]=W.useState(null),[Z,K]=W.useState(!1),[P,$]=W.useState([]),[re,A]=W.useState(!1),[C,R]=W.useState([]),[V,ie]=W.useState(!1),[Q,te]=W.useState(""),[L,Y]=W.useState([]),[G,ce]=W.useState(null),[_,J]=W.useState(!1),[M,I]=W.useState([]),[q,oe]=W.useState(""),[fe,ge]=W.useState(""),[Te,Ee]=W.useState(""),[Fe,qe]=W.useState(1),[ct,_e]=W.useState(20),[ae,St]=W.useState(new Set),[st,$e]=W.useState("medium"),[Ye,Ge]=W.useState(!1),[He,it]=W.useState([]),[rt,mt]=W.useState([]),[bt,me]=W.useState(""),[Le,Ce]=W.useState(!1),[Me,Ne]=W.useState(null),[gt,et]=W.useState(""),[ut,ye]=W.useState(null);W.useState(null),W.useState(!1);const[Re,xt]=W.useState(!1),[vt,jt]=W.useState(!1);W.useState("");const[Ot,en]=W.useState(!1),[It,wt]=W.useState(""),[Ze,dt]=W.useState({productName:"",barcode:"",expiryDate:"",lotNumber:"",category:"",location:"",notes:"",photo:null,allergens:[]});W.useEffect(()=>{sa(),Xt()},[t]);const Xt=()=>{const ee=localStorage.getItem("haccp-label-groups");ee&&Y(JSON.parse(ee))},Dt=ee=>{Y(ee),localStorage.setItem("haccp-label-groups",JSON.stringify(ee))},Mt=()=>{A(!re),R([])},an=ee=>{R(ke=>ke.includes(ee)?ke.filter(Ve=>Ve!==ee):[...ke,ee])},ht=()=>{const ee=Ct.map(ke=>ke.id);R(ee)},_t=()=>{R([])},Mn=()=>{if(C.length===0){alert("Seleziona almeno una etichetta");return}ie(!0)},Pn=()=>{if(!Q.trim()){alert("Inserisci un nome per il gruppo");return}const ke=t.filter(Pt=>C.includes(Pt.id)).reduce((Pt,Rt)=>{const Jt=new Date(Rt.createdAt);return Jt>Pt?Jt:Pt},new Date(0)),Ve={id:`group_${Date.now()}`,name:Q,labelIds:C,labelCount:C.length,createdAt:new Date().toISOString(),createdBy:s.name,lastUpdate:ke.toISOString()},Bt=[...L,Ve];Dt(Bt),R([]),A(!1),ie(!1),te("")},Sn=()=>{const ee=prompt("Nome del nuovo gruppo:");if(!ee)return;const ke={id:`group_${Date.now()}`,name:ee,labelIds:[],labelCount:0,createdAt:new Date().toISOString(),createdBy:s.name,lastUpdate:new Date().toISOString()},Ve=[...L,ke];Dt(Ve)},vn=ee=>L.find(ke=>ke.labelIds.includes(ee)),gr=()=>{if(!G)return;const ee=t.filter(ke=>!G.labelIds.includes(ke.id));it(ee),mt([]),me(""),Ge(!0)},fi=()=>{if(!G||rt.length===0)return;const ee=[],ke=[];if(rt.forEach(Pt=>{var Jt;const Rt=vn(Pt);Rt&&ke.push({labelId:Pt,labelName:(Jt=t.find(Tn=>Tn.id===Pt))==null?void 0:Jt.productName,fromGroup:Rt.name}),ee.push(Pt)}),ke.length>0){const Pt=ke.map(Jt=>`• "${Jt.labelName}" verrà spostata da "${Jt.fromGroup}"`).join(`
`);if(!confirm(`ATTENZIONE: Le seguenti etichette verranno spostate:

${Pt}

Continuare?`))return}const Ve=L.map(Pt=>{if(Pt.id===G.id){const Rt=[...Pt.labelIds,...ee],Jt=[...new Set(Rt)];return{...Pt,labelIds:Jt,labelCount:Jt.length,lastUpdate:new Date().toISOString()}}else{const Rt=Pt.labelIds.filter(Jt=>!ee.includes(Jt));return{...Pt,labelIds:Rt,labelCount:Rt.length,lastUpdate:Rt.length!==Pt.labelIds.length?new Date().toISOString():Pt.lastUpdate}}});Dt(Ve);const Bt=Ve.find(Pt=>Pt.id===G.id);ce(Bt),Ge(!1),mt([])},Qr=ee=>{mt(ke=>ke.includes(ee)?ke.filter(Ve=>Ve!==ee):[...ke,ee])},Sr=()=>{const ee=He.filter(ke=>ke.productName.toLowerCase().includes(bt.toLowerCase())||ke.barcode.includes(bt)||ke.lotNumber.toLowerCase().includes(bt.toLowerCase())).map(ke=>ke.id);mt(ee)},Ln=()=>{G&&(Ne(G),et(G.name),Ce(!0))},xr=()=>{if(!gt.trim()||!Me)return;const ee=L.map(ke=>ke.id===Me.id?{...ke,name:gt.trim(),lastUpdate:new Date().toISOString()}:ke);Dt(ee),G&&G.id===Me.id&&ce({...G,name:gt.trim(),lastUpdate:new Date().toISOString()}),Ce(!1),Ne(null),et("")},nr=ee=>{Ne(ee),et(ee.name),Ce(!0)},_r=ee=>{const ke=t.find(Rt=>Rt.id===ee);if(!ke||!confirm(`Eliminare l'etichetta "${ke.productName}"?

Questa azione non può essere annullata.`))return;const Bt=t.filter(Rt=>Rt.id!==ee);e(Bt),localStorage.setItem("haccp-product-labels",JSON.stringify(Bt));const Pt=L.map(Rt=>({...Rt,labelIds:Rt.labelIds.filter(Jt=>Jt!==ee),labelCount:Rt.labelIds.filter(Jt=>Jt!==ee).length,lastUpdate:Rt.labelIds.includes(ee)?new Date().toISOString():Rt.lastUpdate}));if(Dt(Pt),G&&G.labelIds.includes(ee)){const Rt=Pt.find(Jt=>Jt.id===G.id);ce(Rt)}},Hn=[{id:"latticini",name:"Latticini e Formaggi",color:"bg-blue-100 text-blue-800",emoji:"🧀"},{id:"carni",name:"Carni e Salumi",color:"bg-red-100 text-red-800",emoji:"🥩"},{id:"verdure",name:"Verdure e Ortaggi",color:"bg-green-100 text-green-800",emoji:"🥬"},{id:"frutta",name:"Frutta Fresca",color:"bg-orange-100 text-orange-800",emoji:"🍎"},{id:"pesce",name:"Pesce e Frutti di Mare",color:"bg-cyan-100 text-cyan-800",emoji:"🐟"},{id:"surgelati",name:"Surgelati",color:"bg-indigo-100 text-indigo-800",emoji:"❄️"},{id:"dispensa",name:"Dispensa Secca",color:"bg-yellow-100 text-yellow-800",emoji:"📦"},{id:"condimenti",name:"Oli e Condimenti",color:"bg-amber-100 text-amber-800",emoji:"🫒"}],fs=ee=>{ut===ee?ye(null):(ye(ee),ce(null))},Vs=()=>{J(!_),I([])},Gs=ee=>{I(ke=>ke.includes(ee)?ke.filter(Ve=>Ve!==ee):[...ke,ee])},mi=()=>{const ee=Tt.map(ke=>ke.id);I(ee)},pi=()=>{I([])},sa=()=>{const ee=new Date,ke=t.filter(Ve=>new Date(Ve.expiryDate)<ee&&Ve.photo);ke.length>0&&($(ke),K(!0))},to=()=>{m(!0),setTimeout(()=>{const ee=["8001234567890","8001234567891","8001234567892","8001234567893","8001234567894"],ke=ee[Math.floor(Math.random()*ee.length)];p(ke),dt(Ve=>({...Ve,barcode:ke})),m(!1),l(!0)},2e3)},ia=()=>{if(!Ze.productName||!Ze.expiryDate){alert("Nome prodotto e data scadenza sono obbligatori");return}jt(!0)},B=()=>{const ee={id:`label_${Date.now()}`,...Ze,createdAt:new Date().toISOString(),createdBy:s.name,status:"active"},ke=[...t,ee];e(ke),localStorage.setItem("haccp-product-labels",JSON.stringify(ke));const Ve={id:`prod_${Date.now()}`,name:Ze.productName,category:Ze.category.startsWith("group_")?"latticini":Ze.category,expiryDate:Ze.expiryDate,location:Ze.location||"Posizione da definire",allergens:Ze.allergens||[],notes:`${Ze.notes?Ze.notes+" - ":""}Generato automaticamente da etichetta. Lotto: ${Ze.lotNumber||"N/A"}`,addedBy:s==null?void 0:s.id,addedByName:s==null?void 0:s.name,createdAt:new Date().toISOString(),status:"active",fromLabel:!0,labelId:ee.id,barcode:Ze.barcode,lotNumber:Ze.lotNumber||"",batchDeliveryDate:"",associatedOrderId:"",supplierName:""},Pt=[...JSON.parse(localStorage.getItem("haccp-products")||"[]"),Ve];if(localStorage.setItem("haccp-products",JSON.stringify(Pt)),Ze.category&&Ze.category.startsWith("group_")){const Rt=Ze.category.replace("group_",""),Jt=L.map(Tn=>Tn.id===Rt?{...Tn,labelIds:[...Tn.labelIds,ee.id],labelCount:Tn.labelCount+1,lastUpdate:new Date().toISOString()}:Tn);Dt(Jt)}dt({productName:"",barcode:"",expiryDate:"",lotNumber:"",category:"",location:"",notes:"",photo:null,allergens:[]}),l(!1),p(""),jt(!1)},je=ee=>{const ke=ee.target.files[0];if(ke){const Ve=new FileReader;Ve.onload=Bt=>{const Pt=new Image;Pt.onload=()=>{const Rt=document.createElement("canvas"),Jt=Rt.getContext("2d"),Tn=800,xi=600;let{width:tn,height:Fr}=Pt;tn>Fr?tn>Tn&&(Fr=Fr*Tn/tn,tn=Tn):Fr>xi&&(tn=tn*xi/Fr,Fr=xi),Rt.width=tn,Rt.height=Fr,Jt.drawImage(Pt,0,0,tn,Fr);const oa=Rt.toDataURL("image/jpeg",.7);dt(Fo=>({...Fo,photo:oa}))},Pt.src=Bt.target.result},Ve.readAsDataURL(ke)}},Pe=ee=>{y(ee),S(!0)},We=()=>{const ee=t.map(ke=>P.some(Ve=>Ve.id===ke.id)?{...ke,photo:null,cleanedAt:new Date().toISOString()}:ke);e(ee),localStorage.setItem("haccp-product-labels",JSON.stringify(ee)),K(!1),$([])},Ct=t.filter(ee=>{if(G)return G.labelIds.includes(ee.id);if(ut){const ke=ee.category===ut,Ve=ee.productName.toLowerCase().includes(c.toLowerCase())||ee.barcode.includes(c)||ee.lotNumber.toLowerCase().includes(c.toLowerCase());return ke&&Ve}return ee.productName.toLowerCase().includes(c.toLowerCase())||ee.barcode.includes(c)||ee.lotNumber.toLowerCase().includes(c.toLowerCase())}),Tt=t.filter(ee=>{if(!ee.photo)return!1;const ke=!q||ee.productName.toLowerCase().includes(q.toLowerCase())||ee.barcode.includes(q)||ee.lotNumber.toLowerCase().includes(q.toLowerCase()),Ve=!fe||new Date(ee.createdAt).toDateString()===new Date(fe).toDateString(),Bt=!Te||(()=>{const Pt=new Date(ee.expiryDate),Jt=Math.ceil((Pt-new Date)/(1e3*60*60*24));switch(Te){case"expired":return Jt<0;case"expiring":return Jt>=0&&Jt<=7;case"fresh":return Jt>7;default:return!0}})();return ke&&Ve&&Bt}),Wt=Math.ceil(Tt.length/ct),ln=Tt.slice((Fe-1)*ct,Fe*ct),Rr=(ee,ke=st)=>{if(!ee)return"";if(ee.startsWith("data:image/")&&ke==="low"&&ee.length>5e4){const Ve=document.createElement("canvas"),Bt=Ve.getContext("2d"),Pt=new Image;return new Promise(Rt=>{Pt.onload=()=>{Ve.width=Math.min(Pt.width,200),Ve.height=Math.min(Pt.height,200),Bt.drawImage(Pt,0,0,Ve.width,Ve.height),Rt(Ve.toDataURL("image/jpeg",.5))},Pt.src=ee})}return ee};W.useEffect(()=>{const ee=t.filter(ke=>ke.photo).map(ke=>ke.id);St(new Set(ee))},[t]),W.useEffect(()=>{qe(1)},[q,fe,Te]);const sn=()=>{const ee=ln.map(ke=>ke.id);I(ke=>[...new Set([...ke,...ee])])},zi=()=>{const ee=t.filter(Bt=>Bt.photo).length,ke=ee>100,Ve=ee>500;return{totalPhotos:ee,isLargeDataset:ke,isVeryLargeDataset:Ve,recommendedPhotosPerPage:Ve?12:ke?20:50}},_s={total:t.length,withPhotos:t.filter(ee=>ee.photo).length,expiringSoon:t.filter(ee=>{const ke=new Date(ee.expiryDate),Bt=Math.ceil((ke-new Date)/(1e3*60*60*24));return Bt<=7&&Bt>=0}).length,expired:t.filter(ee=>new Date(ee.expiryDate)<new Date).length};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(zl,{className:"h-5 w-5"}),"Gestione Etichette Prodotti"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:_s.total}),r.jsx("div",{className:"text-sm text-blue-700",children:"Etichette Totali"})]}),r.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:_s.withPhotos}),r.jsx("div",{className:"text-sm text-green-700",children:"Con Foto"})]}),r.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:_s.expiringSoon}),r.jsx("div",{className:"text-sm text-yellow-700",children:"In Scadenza"})]}),r.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:_s.expired}),r.jsx("div",{className:"text-sm text-red-700",children:"Scaduti"})]})]})})]}),r.jsxs("div",{className:"flex gap-2 overflow-x-auto",children:[r.jsxs(le,{variant:i==="scanner"?"default":"outline",onClick:()=>a("scanner"),className:"flex items-center gap-2 whitespace-nowrap",children:[r.jsx(K1,{className:"h-4 w-4"}),"Scanner"]}),r.jsxs(le,{variant:i==="labels"?"default":"outline",onClick:()=>a("labels"),className:"flex items-center gap-2 whitespace-nowrap",children:[r.jsx(qd,{className:"h-4 w-4"}),"Le Mie Etichette"]}),r.jsxs(le,{variant:i==="photos"?"default":"outline",onClick:()=>a("photos"),className:"flex items-center gap-2 whitespace-nowrap",children:[r.jsx(pl,{className:"h-4 w-4"}),"Foto Prodotti"]})]}),i==="scanner"&&r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(X2,{className:"h-5 w-5"}),"Scanner Codici a Barre"]})}),r.jsx(Xe,{className:"space-y-4",children:r.jsx("div",{className:"text-center",children:v?r.jsxs("div",{className:"flex flex-col items-center gap-4",children:[r.jsx("div",{className:"animate-pulse",children:r.jsx(zl,{className:"h-20 w-20 text-blue-500"})}),r.jsx("p",{className:"text-blue-600",children:"Scansione in corso..."})]}):r.jsxs("div",{className:"space-y-4",children:[f?r.jsx("div",{className:"p-4 bg-green-50 rounded-lg",children:r.jsxs("p",{className:"text-green-700",children:["Codice scansionato: ",r.jsx("strong",{children:f})]})}):r.jsxs("div",{className:"p-8 border-2 border-dashed border-gray-300 rounded-lg",children:[r.jsx(zl,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:'Clicca "Avvia Scanner" per leggere un codice a barre'})]}),r.jsxs(le,{onClick:to,disabled:v,className:"w-full",children:[r.jsx(K1,{className:"h-4 w-4 mr-2"}),"Avvia Scanner"]}),f&&r.jsxs(le,{onClick:()=>l(!0),variant:"outline",className:"w-full",children:[r.jsx(or,{className:"h-4 w-4 mr-2"}),"Crea Etichetta per questo Prodotto"]})]})})})]}),i==="labels"&&r.jsxs("div",{className:"space-y-4",children:[r.jsx(Je,{children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(gl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx(At,{placeholder:G?`Cerca in "${G.name}"...`:ut?`Cerca in "${(gi=Hn.find(ee=>ee.id===ut))==null?void 0:gi.name}"...`:"Cerca per nome, codice, lotto...",value:c,onChange:ee=>d(ee.target.value),className:"pl-10"})]})}),r.jsxs(le,{onClick:()=>l(!0),className:"flex items-center gap-2",children:[r.jsx(or,{className:"h-4 w-4"}),"Nuova Etichetta"]})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs(le,{onClick:Mt,variant:re?"default":"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(W1,{className:"h-4 w-4"}),re?"Annulla Selezione":"Seleziona Etichette"]}),re&&r.jsxs(r.Fragment,{children:[r.jsxs(le,{onClick:ht,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx($d,{className:"h-4 w-4"}),"Seleziona Tutto"]}),r.jsxs(le,{onClick:_t,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(dn,{className:"h-4 w-4"}),"Deseleziona Tutto"]}),r.jsxs(le,{onClick:Mn,variant:"default",size:"sm",className:"flex items-center gap-2",disabled:C.length===0,children:[r.jsx(IN,{className:"h-4 w-4"}),"Crea Gruppo (",C.length,")"]})]}),!G&&!re&&r.jsxs(le,{onClick:Sn,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(J1,{className:"h-4 w-4"}),"Crea Gruppo di Etichette"]}),!G&&re&&C.length>0&&r.jsxs(le,{onClick:()=>en(!0),variant:"default",size:"sm",className:"flex items-center gap-2",children:[r.jsx(ji,{className:"h-4 w-4"}),"Sposta Etichette nel Gruppo..."]}),G&&r.jsxs(r.Fragment,{children:[r.jsxs(le,{onClick:gr,variant:"default",size:"sm",className:"flex items-center gap-2",children:[r.jsx(or,{className:"h-4 w-4"}),"Aggiungi Etichette al Gruppo"]}),r.jsxs(le,{onClick:Ln,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(os,{className:"h-4 w-4"}),"Modifica Gruppo"]}),r.jsxs(le,{onClick:()=>ce(null),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(dn,{className:"h-4 w-4"}),'Esci da "',G.name,'"']})]}),ut&&r.jsxs(le,{onClick:()=>ye(null),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(dn,{className:"h-4 w-4"}),'Esci da "',(Ws=Hn.find(ee=>ee.id===ut))==null?void 0:Ws.name,'"']})]}),re&&C.length>0&&r.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:r.jsxs("p",{className:"text-blue-700 text-sm",children:[C.length," etichett",C.length===1?"a selezionata":"e selezionate"]})})]})})}),!G&&!ut&&r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(ji,{className:"h-5 w-5"}),"I Miei Gruppi di Etichette"]}),L.length>0&&r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("div",{className:"relative",children:[r.jsx(gl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx(At,{placeholder:"Cerca gruppi ed etichette...",value:It,onChange:ee=>wt(ee.target.value),className:"pl-10 w-64"})]})})]})}),r.jsxs(Xe,{children:[It&&r.jsxs("div",{className:"mb-6",children:[r.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[r.jsx(gl,{className:"h-4 w-4"}),'Risultati Ricerca: "',It,'"']}),(()=>{const ee=L.filter(Ve=>Ve.name.toLowerCase().includes(It.toLowerCase())),ke=t.filter(Ve=>Ve.productName.toLowerCase().includes(It.toLowerCase())||Ve.barcode.includes(It)||Ve.lotNumber.toLowerCase().includes(It.toLowerCase()));return ee.length===0&&ke.length===0?r.jsx("div",{className:"text-center py-4",children:r.jsx("p",{className:"text-sm text-gray-500",children:"Nessun risultato trovato"})}):r.jsxs("div",{className:"space-y-4",children:[ee.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-xs font-medium text-gray-500 mb-2 flex items-center gap-1",children:[r.jsx(ji,{className:"h-3 w-3"}),"GRUPPI (",ee.length,")"]}),r.jsx("div",{className:"grid gap-2",children:ee.map(Ve=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors bg-blue-50 border-blue-200",onClick:()=>{ce(Ve),wt("")},children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:[r.jsx(ji,{className:"h-3 w-3"}),"GRUPPO"]}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:Ve.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:[Ve.labelIds.length," etichette"]})]})]}),r.jsx("div",{className:"text-xs text-gray-400",children:"Click per aprire"})]},Ve.id))})]}),ke.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"text-xs font-medium text-gray-500 mb-2 flex items-center gap-1",children:[r.jsx(Un,{className:"h-3 w-3"}),"ETICHETTE (",ke.length,")"]}),r.jsxs("div",{className:"grid gap-2",children:[ke.slice(0,5).map(Ve=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors bg-green-50 border-green-200",onClick:()=>{y(Ve),S(!0),wt("")},children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:[r.jsx(Un,{className:"h-3 w-3"}),"ETICHETTA"]}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:Ve.productName}),r.jsxs("p",{className:"text-xs text-gray-500",children:["Scadenza: ",Ve.expiryDate," • Lotto: ",Ve.lotNumber]})]})]}),r.jsx("div",{className:"text-xs text-gray-400",children:"Click per visualizzare"})]},Ve.id)),ke.length>5&&r.jsx("div",{className:"text-center py-2",children:r.jsxs("p",{className:"text-xs text-gray-500",children:["... e altre ",ke.length-5," etichette"]})})]})]})]})})(),r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:r.jsxs(le,{variant:"outline",size:"sm",onClick:()=>wt(""),className:"w-full",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Chiudi Ricerca"]})})]}),!It&&r.jsxs("div",{className:"mb-6",children:[r.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[r.jsx(qd,{className:"h-4 w-4"}),"Categorie Ingredienti (Scelte Rapide)"]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Hn.map(ee=>{const Ve=t.filter(Bt=>Bt.category===ee.id).length;return r.jsxs(le,{variant:"outline",size:"sm",onClick:()=>fs(ee.id),className:`flex items-center gap-2 ${Ve>0?"hover:shadow-md":"opacity-50 cursor-not-allowed"}`,disabled:Ve===0,children:[r.jsx("span",{className:"text-lg",children:ee.emoji}),r.jsx("span",{className:"hidden sm:inline",children:ee.name}),r.jsx("span",{className:"sm:hidden",children:ee.name.split(" ")[0]}),Ve>0&&r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${ee.color} ml-1`,children:Ve})]},ee.id)})}),r.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Clicca su una categoria per vedere le relative etichette"})]}),L.length>0&&r.jsx("div",{className:"border-t border-gray-200 my-4"}),L.length>0&&r.jsxs("div",{className:"mb-6",children:[r.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[r.jsx(qd,{className:"h-4 w-4"}),"Gruppi Personalizzati (Scelte Rapide)"]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(ee=>{const ke=ee.labelIds.length;return r.jsxs(le,{variant:"outline",size:"sm",onClick:()=>ce(ee),className:`flex items-center gap-2 ${ke>0?"hover:shadow-md":"opacity-50 cursor-not-allowed"}`,disabled:ke===0,children:[r.jsx(ji,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:ee.name}),r.jsx("span",{className:"sm:hidden",children:ee.name.split(" ")[0]}),ke>0&&r.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800 ml-1",children:ke})]},ee.id)})}),r.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Clicca su un gruppo per vedere le relative etichette"})]}),!It&&r.jsx("div",{className:"border-t border-gray-200 my-4"}),!It&&r.jsx("div",{children:r.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[r.jsx(os,{className:"h-4 w-4"}),"Gestione Gruppi Personalizzati"]})}),!It&&r.jsx("div",{className:"grid gap-3",children:L.map(ee=>r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 hover:shadow-md cursor-pointer transition-all",onClick:()=>ce(ee),children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(ji,{className:"h-5 w-5 text-blue-500"}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold",children:ee.name}),r.jsxs("p",{className:"text-sm text-gray-600",children:[ee.labelCount," etichett",ee.labelCount===1?"a":"e"," • Ultimo aggiornamento: ",new Date(ee.lastUpdate).toLocaleDateString("it-IT")]})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{variant:"outline",size:"sm",onClick:ke=>{ke.stopPropagation(),nr(ee)},title:"Modifica gruppo",children:r.jsx(os,{className:"h-4 w-4"})}),r.jsx(le,{variant:"outline",size:"sm",onClick:ke=>{if(ke.stopPropagation(),confirm(`Eliminare il gruppo "${ee.name}"? Le etichette non verranno eliminate.`)){const Ve=L.filter(Bt=>Bt.id!==ee.id);Dt(Ve)}},title:"Elimina gruppo",children:r.jsx(tr,{className:"h-4 w-4"})})]})]},ee.id))}),!It&&L.length===0&&r.jsxs("div",{className:"text-center py-4",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Nessun gruppo personalizzato creato ancora."}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'Usa "Seleziona Etichette" per creare gruppi dalle etichette esistenti'})]})]})]}),r.jsxs(r.Fragment,{children:[G&&r.jsx(Je,{children:r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2 text-lg",children:[r.jsx(ji,{className:"h-5 w-5 text-blue-600"}),"Gruppo: ",r.jsx("span",{className:"text-blue-600",children:G.name}),r.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",G.labelIds.length," etichette)"]})]})})}),ut&&r.jsx(Je,{children:r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2 text-lg",children:[r.jsx(qd,{className:"h-5 w-5 text-green-600"}),"Categoria: ",r.jsx("span",{className:"text-green-600",children:(Ro=Hn.find(ee=>ee.id===ut))==null?void 0:Ro.name}),r.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",Ct.length," etichette)"]})]})})}),r.jsx(Je,{children:r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Un,{className:"h-5 w-5"}),"Etichette Registrate",r.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",Ct.length," totali)"]})]})})})]}),r.jsxs("div",{className:"grid gap-4",children:[Ct.map(ee=>{var Tn,xi;const ke=new Date(ee.expiryDate),Ve=new Date,Bt=Math.ceil((ke-Ve)/(1e3*60*60*24)),Pt=ke<Ve,Rt=Bt<=7&&Bt>=0,Jt=C.includes(ee.id);return r.jsx(Je,{className:`${Pt?"border-red-200 bg-red-50":Rt?"border-yellow-200 bg-yellow-50":""} ${Jt?"ring-2 ring-blue-500":""} ${re?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>re&&an(ee.id),children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"flex justify-between items-start",children:[re&&r.jsx("div",{className:"mr-3 mt-1",children:r.jsx("input",{type:"checkbox",checked:Jt,onChange:()=>an(ee.id),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 pointer-events-none"})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h3",{className:"font-semibold text-lg",children:ee.productName}),ee.photo&&r.jsx(pl,{className:"h-4 w-4 text-blue-500"}),Pt&&r.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"SCADUTO"}),Rt&&!Pt&&r.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:"IN SCADENZA"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Codice:"})," ",ee.barcode]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Lotto:"})," ",ee.lotNumber]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Scadenza:"})," ",new Date(ee.expiryDate).toLocaleDateString("it-IT")]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Categoria:"})," ",((Tn=Hn.find(tn=>tn.id===ee.category))==null?void 0:Tn.name)||((xi=L.find(tn=>tn.id===ee.category))==null?void 0:xi.name)||ee.category||"Non specificata"]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("strong",{children:"Gruppo:"})," ",(()=>{const tn=vn(ee.id);return tn?r.jsxs("span",{className:"inline-flex items-center gap-1 ml-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:[r.jsx(ji,{className:"h-3 w-3"}),tn.name]}):r.jsx("span",{className:"text-gray-400 ml-2",children:"Nessun gruppo"})})()]})]}),ee.location&&r.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[r.jsx("strong",{children:"Posizione:"})," ",ee.location]}),ee.notes&&r.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[r.jsx("strong",{children:"Note:"})," ",ee.notes]}),r.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Creata da ",ee.createdBy," il ",new Date(ee.createdAt).toLocaleDateString("it-IT")]})]}),r.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[r.jsxs(le,{size:"sm",variant:"outline",onClick:tn=>{tn.stopPropagation(),y(ee),S(!0)},className:"flex items-center gap-1",children:[r.jsx(Ep,{className:"h-3 w-3"}),"Visualizza"]}),r.jsxs(le,{size:"sm",onClick:tn=>{tn.stopPropagation(),Pe(ee)},className:"flex items-center gap-1",children:[r.jsx(Bs,{className:"h-3 w-3"}),"Download"]}),ee.photo&&r.jsxs(le,{size:"sm",variant:"outline",onClick:tn=>{tn.stopPropagation(),H(ee.photo),j(!0)},className:"flex items-center gap-1",children:[r.jsx(pl,{className:"h-3 w-3"}),"Foto"]}),r.jsxs(le,{size:"sm",variant:"destructive",onClick:tn=>{tn.stopPropagation(),_r(ee.id)},className:"flex items-center gap-1",children:[r.jsx(tr,{className:"h-3 w-3"}),"Elimina"]})]})]})})},ee.id)}),Ct.length===0&&r.jsx(Je,{children:r.jsxs(Xe,{className:"pt-6 text-center",children:[r.jsx(Un,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:G?`Nessuna etichetta nel gruppo "${G.name}"`:ut?`Nessuna etichetta nella categoria "${(Xr=Hn.find(ee=>ee.id===ut))==null?void 0:Xr.name}"`:c?"Nessuna etichetta trovata":"Nessuna etichetta creata ancora"})]})})]})]}),i==="photos"&&r.jsxs("div",{className:"space-y-4",children:[r.jsx(Je,{children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(gl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx(At,{placeholder:"Cerca per nome, codice, lotto...",value:q,onChange:ee=>oe(ee.target.value),className:"pl-10"})]}),r.jsx(At,{type:"date",placeholder:"Filtra per data creazione",value:fe,onChange:ee=>ge(ee.target.value)}),r.jsxs("select",{value:Te,onChange:ee=>Ee(ee.target.value),className:"p-2 border border-gray-300 rounded-md",children:[r.jsx("option",{value:"",children:"Tutte le scadenze"}),r.jsx("option",{value:"fresh",children:"Prodotti freschi (>7 giorni)"}),r.jsx("option",{value:"expiring",children:"In scadenza (≤7 giorni)"}),r.jsx("option",{value:"expired",children:"Scaduti"})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs(le,{onClick:Vs,variant:_?"default":"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(W1,{className:"h-4 w-4"}),_?"Annulla Selezione":"Seleziona Foto"]}),_&&r.jsxs(r.Fragment,{children:[r.jsxs(le,{onClick:mi,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx($d,{className:"h-4 w-4"}),"Seleziona Tutte (",Tt.length,")"]}),r.jsxs(le,{onClick:sn,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx($d,{className:"h-4 w-4"}),"Solo Pagina Corrente (",ln.length,")"]}),r.jsxs(le,{onClick:pi,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(dn,{className:"h-4 w-4"}),"Deseleziona Tutto"]}),r.jsxs(le,{variant:"destructive",size:"sm",className:"flex items-center gap-2",disabled:M.length===0,onClick:()=>{if(confirm(`Eliminare ${M.length} foto selezionate?`)){const ee=t.map(ke=>M.includes(ke.id)?{...ke,photo:null}:ke);e(ee),localStorage.setItem("haccp-product-labels",JSON.stringify(ee)),I([]),J(!1)}},children:[r.jsx(tr,{className:"h-4 w-4"}),"Elimina Selezionate (",M.length,")"]})]}),(q||fe||Te)&&r.jsxs(le,{onClick:()=>{oe(""),ge(""),Ee("")},variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(dn,{className:"h-4 w-4"}),"Cancella Filtri"]})]}),_&&M.length>0&&r.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:r.jsxs("p",{className:"text-blue-700 text-sm",children:[M.length," foto selezionat",M.length===1?"a":"e"]})}),(q||fe||Te)&&r.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg",children:r.jsxs("p",{className:"text-yellow-700 text-sm",children:["Filtri attivi: ",Tt.length," foto di ",t.filter(ee=>ee.photo).length]})}),(()=>{const ee=zi();return ee.isLargeDataset?r.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("p",{className:"text-blue-700 text-sm font-semibold",children:["Dataset grande: ",ee.totalPhotos," foto"]}),r.jsxs("p",{className:"text-blue-600 text-xs",children:["Modalità ottimizzata attiva • Pagina ",Fe," di ",Wt]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:ct,onChange:ke=>{_e(Number(ke.target.value)),qe(1)},className:"text-xs p-1 border rounded",children:[r.jsx("option",{value:12,children:"12 foto/pagina"}),r.jsx("option",{value:20,children:"20 foto/pagina"}),r.jsx("option",{value:50,children:"50 foto/pagina"}),r.jsx("option",{value:100,children:"100 foto/pagina"})]}),r.jsxs("select",{value:st,onChange:ke=>$e(ke.target.value),className:"text-xs p-1 border rounded",children:[r.jsx("option",{value:"low",children:"Qualità Bassa"}),r.jsx("option",{value:"medium",children:"Qualità Media"}),r.jsx("option",{value:"high",children:"Qualità Alta"})]})]})]})}):null})()]})})}),Wt>1&&r.jsx(Je,{children:r.jsxs(Xe,{className:"pt-6",children:[r.jsxs("div",{className:"flex justify-center items-center gap-4",children:[r.jsx(le,{onClick:()=>qe(ee=>Math.max(1,ee-1)),disabled:Fe===1,variant:"outline",size:"sm",children:"← Precedente"}),r.jsx("div",{className:"flex gap-1",children:[...Array(Math.min(5,Wt))].map((ee,ke)=>{let Ve;return Wt<=5?Ve=ke+1:(Ve=Math.max(1,Fe-2)+ke,Ve>Wt&&(Ve=Wt-(4-ke))),r.jsx(le,{onClick:()=>qe(Ve),variant:Fe===Ve?"default":"outline",size:"sm",className:"w-8 h-8 p-0",children:Ve},Ve)})}),r.jsx(le,{onClick:()=>qe(ee=>Math.min(Wt,ee+1)),disabled:Fe===Wt,variant:"outline",size:"sm",children:"Successiva →"})]}),r.jsx("div",{className:"text-center mt-2",children:r.jsxs("p",{className:"text-sm text-gray-600",children:["Pagina ",Fe," di ",Wt," • Mostrando ",ln.length," di ",Tt.length," foto"]})})]})}),r.jsx("div",{className:`grid gap-4 ${ct<=12?"grid-cols-2 md:grid-cols-3 lg:grid-cols-4":ct<=20?"grid-cols-2 md:grid-cols-4 lg:grid-cols-5":"grid-cols-3 md:grid-cols-5 lg:grid-cols-6"}`,children:ln.map(ee=>{const ke=M.includes(ee.id),Ve=new Date(ee.expiryDate),Bt=new Date,Pt=Math.ceil((Ve-Bt)/(1e3*60*60*24)),Rt=Ve<Bt,Jt=Pt<=7&&Pt>=0;return r.jsxs(Je,{className:`overflow-hidden ${ke?"ring-2 ring-blue-500":""} ${_?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>_&&Gs(ee.id),children:[r.jsxs("div",{className:"relative",children:[_&&r.jsx("div",{className:"absolute top-2 left-2 z-10",children:r.jsx("input",{type:"checkbox",checked:ke,onChange:()=>Gs(ee.id),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 pointer-events-none"})}),(Rt||Jt)&&r.jsx("div",{className:"absolute top-2 right-2 z-10",children:r.jsx("span",{className:`px-2 py-1 text-xs rounded ${Rt?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:Rt?"SCADUTO":"SCADENZA"})}),r.jsxs("div",{className:"aspect-square bg-gray-100 cursor-pointer overflow-hidden",onClick:Tn=>{_||(Tn.stopPropagation(),H(ee.photo),j(!0))},children:[r.jsx("img",{src:Rr(ee.photo),alt:ee.productName,className:"w-full h-full object-cover transition-opacity duration-200",loading:"lazy",onError:Tn=>{Tn.target.style.display="none",Tn.target.nextSibling.style.display="flex"}}),r.jsx("div",{className:"w-full h-full hidden items-center justify-center bg-red-50",children:r.jsxs("div",{className:"text-center",children:[r.jsx(xn,{className:"h-6 w-6 text-red-400 mx-auto mb-1"}),r.jsx("p",{className:"text-xs text-red-600",children:"Errore caricamento"})]})})]})]}),r.jsxs(Xe,{className:"pt-4",children:[r.jsx("h4",{className:"font-semibold text-sm truncate",children:ee.productName}),r.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[r.jsxs("p",{children:["Scad: ",new Date(ee.expiryDate).toLocaleDateString("it-IT")]}),r.jsxs("p",{children:["Creata: ",new Date(ee.createdAt).toLocaleDateString("it-IT")]}),ee.lotNumber&&r.jsxs("p",{children:["Lotto: ",ee.lotNumber]})]})]})]},ee.id)})}),Wt>1&&ln.length>0&&r.jsx(Je,{children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"flex justify-center items-center gap-2",children:[r.jsx(le,{onClick:()=>qe(1),disabled:Fe===1,variant:"outline",size:"sm",children:"Prima"}),r.jsx(le,{onClick:()=>qe(ee=>Math.max(1,ee-1)),disabled:Fe===1,variant:"outline",size:"sm",children:"←"}),r.jsxs("span",{className:"px-4 py-2 text-sm bg-gray-100 rounded",children:[Fe," / ",Wt]}),r.jsx(le,{onClick:()=>qe(ee=>Math.min(Wt,ee+1)),disabled:Fe===Wt,variant:"outline",size:"sm",children:"→"}),r.jsx(le,{onClick:()=>qe(Wt),disabled:Fe===Wt,variant:"outline",size:"sm",children:"Ultima"})]})})}),Tt.length===0&&t.filter(ee=>ee.photo).length>0&&r.jsx(Je,{children:r.jsxs(Xe,{className:"pt-6 text-center",children:[r.jsx(ty,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Nessuna foto trovata con i filtri attuali"})]})}),t.filter(ee=>ee.photo).length===0&&r.jsx(Je,{children:r.jsxs(Xe,{className:"pt-6 text-center",children:[r.jsx(pl,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Nessuna foto caricata ancora"})]})})]}),o&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs(Je,{className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Nuova Etichetta Prodotto"}),r.jsx(le,{variant:"outline",size:"sm",onClick:()=>{l(!1),dt({productName:"",barcode:"",expiryDate:"",lotNumber:"",category:"",location:"",notes:"",photo:null,allergens:[]})},children:r.jsx(dn,{className:"h-4 w-4"})})]})}),r.jsxs(Xe,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"productName",children:"Nome Prodotto *"}),r.jsx(At,{id:"productName",value:Ze.productName,onChange:ee=>dt(ke=>({...ke,productName:ee.target.value})),placeholder:"es. Mozzarella di Bufala"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"barcode",children:"Codice a Barre"}),r.jsx(At,{id:"barcode",value:Ze.barcode,onChange:ee=>dt(ke=>({...ke,barcode:ee.target.value})),placeholder:"Scansiona o inserisci manualmente"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"expiryDate",children:"Data Scadenza *"}),r.jsx(At,{id:"expiryDate",type:"date",value:Ze.expiryDate,onChange:ee=>dt(ke=>({...ke,expiryDate:ee.target.value}))})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"lotNumber",children:"Numero Lotto"}),r.jsx(At,{id:"lotNumber",value:Ze.lotNumber,onChange:ee=>dt(ke=>({...ke,lotNumber:ee.target.value})),placeholder:"es. L240315A"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"category",children:"Categoria"}),r.jsxs("select",{id:"category",value:Ze.category,onChange:ee=>dt(ke=>({...ke,category:ee.target.value})),className:"w-full p-2 border border-gray-300 rounded-md",children:[r.jsx("option",{value:"",children:"Seleziona categoria"}),r.jsxs("optgroup",{label:"📂 Categorie Standard",children:[r.jsx("option",{value:"latticini",children:"Latticini e Formaggi"}),r.jsx("option",{value:"carni",children:"Carni e Salumi"}),r.jsx("option",{value:"verdure",children:"Verdure e Ortaggi"}),r.jsx("option",{value:"frutta",children:"Frutta Fresca"}),r.jsx("option",{value:"pesce",children:"Pesce e Frutti di Mare"}),r.jsx("option",{value:"surgelati",children:"Surgelati"}),r.jsx("option",{value:"dispensa",children:"Dispensa Secca"}),r.jsx("option",{value:"condimenti",children:"Oli e Condimenti"})]}),L.length>0&&r.jsx("optgroup",{label:"🏷️ I Miei Gruppi di Etichette",children:L.map(ee=>r.jsxs("option",{value:`group_${ee.id}`,children:[ee.name," (",ee.labelCount," etichett",ee.labelCount===1?"a":"e",")"]},ee.id))})]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"location",children:"Posizione"}),r.jsx(At,{id:"location",value:Ze.location,onChange:ee=>dt(ke=>({...ke,location:ee.target.value})),placeholder:"es. Frigo A - Ripiano intermedio"})]}),r.jsxs("div",{children:[r.jsx(Ke,{children:"Allergeni"}),r.jsx("div",{className:"grid grid-cols-3 md:grid-cols-7 gap-2 mt-2",children:ALLERGENS.map(ee=>r.jsx("button",{type:"button",onClick:()=>{const ke=Ze.allergens.includes(ee.id);dt(Ve=>({...Ve,allergens:ke?Ve.allergens.filter(Bt=>Bt!==ee.id):[...Ve.allergens,ee.id]}))},className:`px-2 py-1 text-xs rounded transition-colors ${Ze.allergens.includes(ee.id)?ee.color:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:ee.name},ee.id))})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"notes",children:"Note"}),r.jsx("textarea",{id:"notes",value:Ze.notes,onChange:ee=>dt(ke=>({...ke,notes:ee.target.value})),placeholder:"Note aggiuntive...",className:"w-full p-2 border border-gray-300 rounded-md h-20 resize-none"})]}),r.jsxs("div",{children:[r.jsx(Ke,{children:"Foto Prodotto"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:je,className:"w-full p-2 border border-gray-300 rounded-md"}),Ze.photo&&r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:Ze.photo,alt:"Preview",className:"w-full h-32 object-cover rounded-md border"}),r.jsx(le,{size:"sm",variant:"outline",onClick:()=>dt(ee=>({...ee,photo:null})),className:"absolute top-2 right-2",children:r.jsx(dn,{className:"h-3 w-3"})})]})]})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsxs(le,{onClick:ia,className:"flex-1",children:[r.jsx(Cn,{className:"h-4 w-4 mr-2"}),"Salva Etichetta"]}),r.jsx(le,{variant:"outline",onClick:()=>{l(!1),dt({productName:"",barcode:"",expiryDate:"",lotNumber:"",category:"",location:"",notes:"",photo:null,allergens:[]})},children:"Annulla"})]})]})]})}),N&&k&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs(Je,{className:"w-full max-w-md",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Anteprima Etichetta"}),r.jsx(le,{variant:"outline",size:"sm",onClick:()=>S(!1),children:r.jsx(dn,{className:"h-4 w-4"})})]})}),r.jsxs(Xe,{children:[r.jsx("div",{className:"border-2 border-dashed border-gray-300 p-4 rounded-lg bg-white",children:r.jsxs("div",{className:"text-center space-y-2",children:[r.jsx("h2",{className:"text-lg font-bold",children:k.productName}),r.jsxs("div",{className:"text-sm",children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Codice:"})," ",k.barcode]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Lotto:"})," ",k.lotNumber]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Scadenza:"})," ",new Date(k.expiryDate).toLocaleDateString("it-IT")]}),k.location&&r.jsxs("div",{children:[r.jsx("strong",{children:"Posizione:"})," ",k.location]})]}),r.jsx("div",{className:"flex justify-center my-4",children:r.jsx("div",{className:"w-16 h-16 bg-black border-2 border-gray-300 flex items-center justify-center",children:r.jsx(zl,{className:"h-12 w-12 text-white"})})}),r.jsxs("div",{className:"text-xs text-gray-600",children:["Creata il ",new Date(k.createdAt).toLocaleDateString("it-IT")]})]})}),r.jsx("div",{className:"mt-4 text-center",children:r.jsxs(le,{onClick:()=>alert("Funzione stampa in sviluppo"),children:[r.jsx(Bs,{className:"h-4 w-4 mr-2"}),"Scarica Etichetta PDF"]})})]})]})}),b&&z&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"relative max-w-4xl max-h-[90vh]",children:[r.jsx(le,{variant:"outline",size:"sm",onClick:()=>j(!1),className:"absolute top-4 right-4 z-10",children:r.jsx(dn,{className:"h-4 w-4"})}),r.jsx("img",{src:z,alt:"Foto prodotto",className:"max-w-full max-h-full object-contain rounded-lg"})]})}),Z&&P.length>0&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs(Je,{className:"w-full max-w-md",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(xn,{className:"h-5 w-5 text-orange-500"}),"Pulizia Automatica"]})}),r.jsxs(Xe,{children:[r.jsxs("p",{className:"mb-4",children:["Trovati ",r.jsx("strong",{children:P.length})," prodotti scaduti con foto. Vuoi eliminare le foto per liberare spazio in memoria?"]}),r.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto mb-4",children:P.map(ee=>r.jsxs("div",{className:"flex justify-between items-center p-2 bg-red-50 rounded",children:[r.jsx("span",{className:"text-sm",children:ee.productName}),r.jsxs("span",{className:"text-xs text-red-600",children:["Scad: ",new Date(ee.expiryDate).toLocaleDateString("it-IT")]})]},ee.id))}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{onClick:We,className:"flex-1",variant:"destructive",children:[r.jsx(tr,{className:"h-4 w-4 mr-2"}),"Elimina Foto"]}),r.jsx(le,{variant:"outline",onClick:()=>K(!1),children:"Mantieni"})]})]})]})}),V&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs(Je,{className:"w-full max-w-md",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Crea Nuovo Gruppo"}),r.jsx(le,{variant:"outline",size:"sm",onClick:()=>{ie(!1),te("")},children:r.jsx(dn,{className:"h-4 w-4"})})]})}),r.jsxs(Xe,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"groupName",children:"Nome del Gruppo"}),r.jsx(At,{id:"groupName",value:Q,onChange:ee=>te(ee.target.value),placeholder:"es. Etichette Salumi",onKeyPress:ee=>ee.key==="Enter"&&Pn()})]}),r.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:r.jsxs("p",{className:"text-blue-700 text-sm",children:["Il gruppo conterrà ",C.length," etichett",C.length===1?"a":"e"," selezionat",C.length===1?"a":"e"]})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{onClick:Pn,className:"flex-1",disabled:!Q.trim(),children:[r.jsx(J1,{className:"h-4 w-4 mr-2"}),"Crea Gruppo"]}),r.jsx(le,{variant:"outline",onClick:()=>{ie(!1),te("")},children:"Annulla"})]})]})]})}),Ye&&G&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs(Je,{className:"w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center justify-between",children:[r.jsxs("span",{children:['Aggiungi Etichette al Gruppo "',G.name,'"']}),r.jsx(le,{variant:"outline",size:"sm",onClick:()=>{Ge(!1),mt([]),me("")},children:r.jsx(dn,{className:"h-4 w-4"})})]})}),r.jsxs(Xe,{className:"space-y-4 overflow-y-auto",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(gl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx(At,{placeholder:"Cerca etichette da aggiungere...",value:bt,onChange:ee=>me(ee.target.value),className:"pl-10"})]})}),r.jsxs(le,{onClick:Sr,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx($d,{className:"h-4 w-4"}),"Seleziona Tutte"]}),r.jsxs(le,{onClick:()=>mt([]),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(dn,{className:"h-4 w-4"}),"Deseleziona"]})]}),rt.length>0&&r.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:r.jsxs("p",{className:"text-blue-700 text-sm",children:[rt.length," etichett",rt.length===1?"a selezionata":"e selezionate"]})}),r.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:r.jsxs("p",{className:"text-gray-700 text-sm",children:["Etichette disponibili: ",He.filter(ee=>ee.productName.toLowerCase().includes(bt.toLowerCase())||ee.barcode.includes(bt)||ee.lotNumber.toLowerCase().includes(bt.toLowerCase())).length," di ",He.length]})})]}),r.jsxs("div",{className:"max-h-96 overflow-y-auto space-y-2",children:[He.filter(ee=>ee.productName.toLowerCase().includes(bt.toLowerCase())||ee.barcode.includes(bt)||ee.lotNumber.toLowerCase().includes(bt.toLowerCase())).map(ee=>{const ke=rt.includes(ee.id),Ve=vn(ee.id);return r.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors hover:shadow-md ${ke?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-gray-400"}`,onClick:()=>Qr(ee.id),children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"checkbox",checked:ke,onChange:()=>Qr(ee.id),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500 pointer-events-none"}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h4",{className:"font-semibold",children:ee.productName}),ee.photo&&r.jsx(pl,{className:"h-4 w-4 text-blue-500"}),Ve&&r.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:['In "',Ve.name,'"']})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600",children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Codice:"})," ",ee.barcode]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Lotto:"})," ",ee.lotNumber]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Scadenza:"})," ",new Date(ee.expiryDate).toLocaleDateString("it-IT")]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Categoria:"})," ",ee.category]})]})]})]})},ee.id)}),He.length===0&&r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Un,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Tutte le etichette sono già in questo gruppo"})]})]}),r.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[r.jsxs(le,{onClick:fi,className:"flex-1",disabled:rt.length===0,children:[r.jsx(or,{className:"h-4 w-4 mr-2"}),"Aggiungi ",rt.length," Etichett",rt.length===1?"a":"e"]}),r.jsx(le,{variant:"outline",onClick:()=>{Ge(!1),mt([]),me("")},children:"Annulla"})]})]})]})}),Le&&Me&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsxs(Je,{className:"w-full max-w-md",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Modifica Gruppo"}),r.jsx(le,{variant:"outline",size:"sm",onClick:()=>{Ce(!1),Ne(null),et("")},children:r.jsx(dn,{className:"h-4 w-4"})})]})}),r.jsxs(Xe,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"editGroupName",children:"Nome del Gruppo"}),r.jsx(At,{id:"editGroupName",value:gt,onChange:ee=>et(ee.target.value),placeholder:"es. Etichette Salumi",onKeyPress:ee=>ee.key==="Enter"&&xr()})]}),r.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[r.jsxs("p",{className:"text-blue-700 text-sm",children:["Il gruppo contiene ",Me.labelCount," etichett",Me.labelCount===1?"a":"e"]}),r.jsxs("p",{className:"text-blue-600 text-xs mt-1",children:["Creato da ",Me.createdBy," il ",new Date(Me.createdAt).toLocaleDateString("it-IT")]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{onClick:xr,className:"flex-1",disabled:!gt.trim()||gt.trim()===Me.name,children:[r.jsx(os,{className:"h-4 w-4 mr-2"}),"Salva Modifiche"]}),r.jsx(le,{variant:"outline",onClick:()=>{Ce(!1),Ne(null),et("")},children:"Annulla"})]})]})]})}),vt&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs(Je,{className:"w-full max-w-md mx-4",children:[r.jsx(yt,{children:r.jsx(Nt,{className:"text-center text-orange-600",children:"⚠️ Conferma Salvataggio Etichetta"})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"Stai per salvare l'etichetta con questi dati:"}),r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-left space-y-2",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Prodotto:"})," ",Ze.productName]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Scadenza:"})," ",Ze.expiryDate]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Lotto:"})," ",Ze.lotNumber||"Non specificato"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Categoria:"})," ",((Oi=Hn.find(ee=>ee.id===Ze.category))==null?void 0:Oi.name)||((vr=L.find(ee=>ee.id===Ze.category))==null?void 0:vr.name)||"Non specificata"]}),Ze.photo&&r.jsxs("p",{children:[r.jsx("strong",{children:"Foto:"})," ✅ Allegata"]})]}),r.jsxs("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[r.jsxs("p",{className:"text-sm text-red-700",children:[r.jsx("strong",{children:"⚠️ ATTENZIONE:"}),r.jsx("br",{}),"Una volta salvata, l'etichetta ",r.jsx("strong",{children:"NON potrà essere modificata"}),". In caso di errore sarà necessario:"]}),r.jsxs("ul",{className:"text-xs text-red-600 mt-2 text-left",children:[r.jsx("li",{children:"• Caricare una nuova foto"}),r.jsx("li",{children:"• Rifare completamente la registrazione"})]}),r.jsx("p",{className:"text-sm text-red-700 mt-2",children:r.jsx("strong",{children:"Ricontrolla attentamente tutte le informazioni!"})})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{variant:"outline",onClick:()=>jt(!1),className:"flex-1",children:"← Modifica Dati"}),r.jsx(le,{onClick:B,className:"flex-1 bg-green-600 hover:bg-green-700",children:"✓ Conferma e Salva"})]})]})})]})}),N&&k&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs(Je,{className:"w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center justify-between",children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx(Ep,{className:"h-5 w-5"}),"Visualizzazione Etichetta"]}),r.jsx(le,{variant:"ghost",size:"sm",onClick:()=>{S(!1),y(null)},children:r.jsx(dn,{className:"h-4 w-4"})})]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-4",children:[k.photo&&r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-sm font-medium mb-2",children:"Foto Prodotto"}),r.jsxs("div",{className:"relative inline-block",children:[r.jsx("img",{src:k.photo,alt:"Foto prodotto",className:"w-32 h-32 object-cover rounded-lg border cursor-pointer hover:opacity-75 transition-opacity",onClick:()=>xt(!0)}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity bg-black bg-opacity-50 rounded-lg",children:r.jsx("span",{className:"text-white text-xs",children:"Clicca per ingrandire"})})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{className:"text-sm font-medium",children:"Nome Prodotto"}),r.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.productName})]}),r.jsxs("div",{children:[r.jsx(Ke,{className:"text-sm font-medium",children:"Codice/Barcode"}),r.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.barcode||"Non specificato"})]}),r.jsxs("div",{children:[r.jsx(Ke,{className:"text-sm font-medium",children:"Data Scadenza"}),r.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.expiryDate})]}),r.jsxs("div",{children:[r.jsx(Ke,{className:"text-sm font-medium",children:"Numero Lotto"}),r.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.lotNumber||"Non specificato"})]}),r.jsxs("div",{children:[r.jsx(Ke,{className:"text-sm font-medium",children:"Categoria"}),r.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:((aa=Hn.find(ee=>ee.id===k.category))==null?void 0:aa.name)||((no=L.find(ee=>ee.id===k.category))==null?void 0:no.name)||"Non specificata"})]}),r.jsxs("div",{children:[r.jsx(Ke,{className:"text-sm font-medium",children:"Posizione"}),r.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.location||"Non specificata"})]})]}),k.notes&&r.jsxs("div",{children:[r.jsx(Ke,{className:"text-sm font-medium",children:"Note"}),r.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded",children:k.notes})]}),r.jsx("div",{className:"border-t pt-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-gray-500",children:[r.jsxs("div",{children:[r.jsx(Ke,{className:"text-xs font-medium",children:"Creata da"}),r.jsx("p",{children:k.createdBy})]}),r.jsxs("div",{children:[r.jsx(Ke,{className:"text-xs font-medium",children:"Data Creazione"}),r.jsx("p",{children:new Date(k.createdAt).toLocaleString()})]})]})}),r.jsx("div",{className:"border-t pt-4 flex justify-center",children:r.jsx(le,{variant:"outline",onClick:()=>{S(!1),y(null)},className:"px-8",children:"Chiudi"})})]})})]})}),Re&&(k==null?void 0:k.photo)&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:()=>xt(!1),children:r.jsxs("div",{className:"relative max-w-4xl max-h-4xl p-4",children:[r.jsx(le,{variant:"ghost",size:"sm",className:"absolute top-2 right-2 text-white hover:bg-white hover:bg-opacity-20",onClick:()=>xt(!1),children:r.jsx(dn,{className:"h-6 w-6"})}),r.jsx("img",{src:k.photo,alt:"Foto prodotto ingrandita",className:"max-w-full max-h-full object-contain rounded-lg",onClick:ee=>ee.stopPropagation()})]})}),Ot&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs(Je,{className:"w-full max-w-md mx-4",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(ji,{className:"h-5 w-5"}),"Sposta Etichette nel Gruppo"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("p",{className:"text-sm text-gray-600",children:["Seleziona il gruppo dove spostare le ",C.length," etichette selezionate:"]}),r.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:L.length===0?r.jsxs("div",{className:"text-center py-4",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Nessun gruppo disponibile."}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Crea prima un gruppo per spostare le etichette."})]}):L.map(ee=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>{const ke=L.map(Ve=>{if(Ve.id===ee.id){const Bt=[...new Set([...Ve.labelIds,...C])];return{...Ve,labelIds:Bt,labelCount:Bt.length,lastUpdate:new Date().toISOString()}}else{const Bt=Ve.labelIds.filter(Pt=>!C.includes(Pt));return{...Ve,labelIds:Bt,labelCount:Bt.length,lastUpdate:Bt.length!==Ve.labelIds.length?new Date().toISOString():Ve.lastUpdate}}});Dt(ke),R([]),A(!1),en(!1)},children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:ee.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:[ee.labelIds.length," etichette"]})]}),r.jsx(ji,{className:"h-4 w-4 text-gray-400"})]},ee.id))}),r.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[r.jsx(le,{variant:"outline",onClick:()=>{en(!1)},className:"flex-1",children:"Annulla"}),r.jsxs(le,{onClick:()=>{en(!1),ie(!0)},variant:"default",className:"flex-1",children:[r.jsx(or,{className:"h-4 w-4 mr-2"}),"Nuovo Gruppo"]})]})]})})]})})]})}const Jd=[{key:"latticini",name:"Latticini",icon:"🥛",description:"Latte, formaggi, yogurt"},{key:"salumi",name:"Salumi",icon:"🥓",description:"Prosciutto, salame, mortadella"},{key:"verdure",name:"Verdure",icon:"🥬",description:"Verdure fresche e ortaggi"},{key:"farine",name:"Farine",icon:"🌾",description:"Farine, cereali, impasti"},{key:"surgelati",name:"Surgelati",icon:"❄️",description:"Prodotti surgelati"},{key:"altro",name:"Altro",icon:"📦",description:"Altri prodotti alimentari"}];function Iy({currentUser:t}){const[e,n]=W.useState([]),[s,i]=W.useState(!1),[a,o]=W.useState(null),[l,c]=W.useState({name:"",category:"",vat:"",phone:"",email:"",notes:""}),{alertModal:d,confirmModal:f,promptModal:p,closeAlert:v,closeConfirm:m,closePrompt:N,alertSuccess:S,alertError:k,alertWarning:y,confirmDelete:b,confirmAction:j}=rc();W.useEffect(()=>{const C=localStorage.getItem("haccp-suppliers");if(C)try{n(JSON.parse(C))}catch(R){is("Errore nel caricamento fornitori:",R),n([])}},[]),W.useEffect(()=>{localStorage.setItem("haccp-suppliers",JSON.stringify(e))},[e]);const z=()=>{c({name:"",category:"",vat:"",phone:"",email:"",notes:""}),o(null),i(!1)},H=C=>{if(C.preventDefault(),!l.name.trim()||!l.category){k("⚠️ Attenzione: Nome fornitore e categoria sono obbligatori per la tracciabilità HACCP");return}const R={id:(a==null?void 0:a.id)||Date.now().toString(),...l,name:l.name.trim(),category:l.category,createdAt:(a==null?void 0:a.createdAt)||new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:(a==null?void 0:a.createdBy)||(t==null?void 0:t.id)||"unknown",updatedBy:(t==null?void 0:t.id)||"unknown"};a?(n(V=>V.map(ie=>ie.id===a.id?R:ie)),S("✅ Fornitore aggiornato con successo!")):(n(V=>[...V,R]),S("✅ Nuovo fornitore aggiunto con successo!")),z()},Z=C=>{b(`⚠️ ATTENZIONE: Stai per eliminare questo fornitore.

Questa azione non può essere annullata e rimuoverà tutte le informazioni di tracciabilità associate.

Procedere?`,()=>{n(R=>R.filter(V=>V.id!==C)),S("🗑️ Fornitore eliminato con successo")})},K=C=>{o(C),c({name:C.name,category:C.category,vat:C.vat||"",phone:C.phone||"",email:C.email||"",notes:C.notes||""}),i(!0)},P=C=>Jd.find(R=>R.key===C)||{name:"Sconosciuta",icon:"❓",description:"Categoria non definita"},[$,re]=W.useState("all"),A=$==="all"?e:e.filter(C=>C.category===$);return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestione Fornitori"}),r.jsx("p",{className:"text-gray-600",children:"📋 Gestisci i fornitori per garantire la tracciabilità HACCP e la sicurezza alimentare"})]}),r.jsxs(le,{onClick:()=>i(!0),className:"flex items-center gap-2",children:[r.jsx(or,{className:"h-4 w-4"}),"Nuovo Fornitore"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(Je,{children:r.jsxs(Xe,{className:"p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Fornitori Totali"})]})}),Jd.map(C=>r.jsx(Je,{children:r.jsxs(Xe,{className:"p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(R=>R.category===C.key).length}),r.jsx("div",{className:"text-sm text-gray-600",children:C.name})]})},C.key))]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Tu,{className:"h-5 w-5"}),"Filtra per Categoria"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("button",{onClick:()=>re("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${$==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Tutti (",e.length,")"]}),Jd.map(C=>r.jsxs("button",{onClick:()=>re(C.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${$===C.key?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[C.icon," ",C.name," (",e.filter(R=>R.category===C.key).length,")"]},C.key))]})})]}),s&&r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(ko,{className:"h-5 w-5"}),a?"Modifica Fornitore":"Nuovo Fornitore"]}),r.jsx("p",{className:"text-sm text-gray-600",children:"💡 Compila i campi obbligatori per garantire la tracciabilità HACCP"})]}),r.jsx(Xe,{children:r.jsxs("form",{onSubmit:H,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Ke,{htmlFor:"name",className:"flex items-center gap-2",children:["Nome Fornitore *",r.jsx("span",{className:"text-xs text-gray-500",title:"Nome completo del fornitore per la tracciabilità",children:"ℹ️"})]}),r.jsx(At,{id:"name",value:l.name,onChange:C=>c({...l,name:C.target.value}),placeholder:"Es: Fornitura Rossi SRL",required:!0}),r.jsx("p",{className:"text-xs text-gray-500",children:"💡 Inserisci il nome completo per la tracciabilità HACCP"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Ke,{htmlFor:"category",className:"flex items-center gap-2",children:["Categoria *",r.jsx("span",{className:"text-xs text-gray-500",title:"Tipo di prodotti forniti",children:"ℹ️"})]}),r.jsxs("select",{id:"category",value:l.category,onChange:C=>c({...l,category:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[r.jsx("option",{value:"",children:"-- Seleziona Categoria --"}),Jd.map(C=>r.jsxs("option",{value:C.key,children:[C.icon," ",C.name," - ",C.description]},C.key))]}),r.jsx("p",{className:"text-xs text-gray-500",children:"📋 Categorizza per tipo di prodotto fornito"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ke,{htmlFor:"vat",children:"Partita IVA"}),r.jsx(At,{id:"vat",value:l.vat,onChange:C=>c({...l,vat:C.target.value}),placeholder:"IT12345678901"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ke,{htmlFor:"phone",children:"Telefono"}),r.jsx(At,{id:"phone",value:l.phone,onChange:C=>c({...l,phone:C.target.value}),placeholder:"+39 123 456 7890"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ke,{htmlFor:"email",children:"Email"}),r.jsx(At,{id:"email",type:"email",value:l.email,onChange:C=>c({...l,email:C.target.value}),placeholder:"fornitore@example.com"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ke,{htmlFor:"notes",children:"Note"}),r.jsx("textarea",{id:"notes",value:l.notes,onChange:C=>c({...l,notes:C.target.value}),placeholder:"Note aggiuntive, orari di consegna, requisiti speciali...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{type:"submit",className:"flex items-center gap-2",children:[r.jsx(EN,{className:"h-4 w-4"}),a?"Aggiorna":"Salva"," Fornitore"]}),r.jsxs(le,{type:"button",variant:"outline",onClick:z,className:"flex items-center gap-2",children:[r.jsx(dn,{className:"h-4 w-4"}),"Annulla"]})]})]})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(ko,{className:"h-5 w-5"}),"Fornitori (",A.length,")"]})}),r.jsx(Xe,{children:A.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(ko,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{className:"text-lg font-medium",children:"Nessun fornitore trovato"}),r.jsx("p",{className:"text-sm",children:$==="all"?"Inizia aggiungendo il primo fornitore per la tracciabilità HACCP":`Nessun fornitore nella categoria "${P($).name}"`})]}):r.jsx("div",{className:"space-y-3",children:A.map(C=>{const R=P(C.category);return r.jsx("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"font-semibold text-lg",children:C.name}),r.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:[R.icon," ",R.name]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[C.vat&&r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Partita IVA:"}),r.jsx("div",{className:"font-medium",children:C.vat})]}),C.phone&&r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Telefono:"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(TN,{className:"h-3 w-3"}),r.jsx("span",{className:"font-medium",children:C.phone})]})]}),C.email&&r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Email:"}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(AN,{className:"h-3 w-3"}),r.jsx("span",{className:"font-medium",children:C.email})]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Aggiornato:"}),r.jsx("div",{className:"font-medium",children:new Date(C.updatedAt).toLocaleDateString("it-IT")})]})]}),C.notes&&r.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[r.jsx("span",{className:"text-gray-600 text-sm",children:"Note:"}),r.jsx("p",{className:"text-gray-800 mt-1",children:C.notes})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{size:"sm",variant:"outline",onClick:()=>K(C),className:"text-blue-600 hover:text-blue-700",children:r.jsx(ci,{className:"h-4 w-4"})}),r.jsx(le,{size:"sm",variant:"outline",onClick:()=>Z(C.id),className:"text-red-600 hover:text-red-700",children:r.jsx(tr,{className:"h-4 w-4"})})]})]})},C.id)})})})]}),r.jsx(sc,{isOpen:d.isOpen,onClose:v,title:d.title,message:d.message,type:d.type,confirmText:d.confirmText,onConfirm:d.onConfirm}),r.jsx(ic,{isOpen:f.isOpen,onClose:m,title:f.title,message:f.message,type:f.type,confirmText:f.confirmText,cancelText:f.cancelText,onConfirm:f.onConfirm,onCancel:f.onCancel}),r.jsx(ac,{isOpen:p.isOpen,onClose:N,title:p.title,message:p.message,placeholder:p.placeholder,defaultValue:p.defaultValue,type:p.type,confirmText:p.confirmText,cancelText:p.cancelText,validation:p.validation,onConfirm:p.onConfirm,onCancel:p.onCancel})]})}function yS({staff:t=[],setStaff:e,users:n=[],setUsers:s,currentUser:i,isAdmin:a,departments:o=[],setDepartments:l,products:c=[],temperatures:d=[],cleaning:f=[],productLabels:p=[],setProductLabels:v}){const[m,N]=W.useState("staff"),[S,k]=W.useState(!1),[y,b]=W.useState(null),{formRef:j,scrollToForm:z}=Ja(S,"staff-form");W.useEffect(()=>{S&&z()},[S,z]);const[H,Z]=W.useState({name:"",surname:"",role:"Dipendente",department:"",certification:"",notes:""}),[K,P]=W.useState(!1),[$,re]=W.useState(null),[A,C]=W.useState({name:"",description:"",members:[],assignedTasks:[]}),R=["Responsabile HACCP","Amministratore","Cuoco","Cameriere","Banconista","Addetto Pulizie","Magazziniere","Collaboratore Occasionale"],ie=(()=>{const I=t.length,q=t.filter(ge=>ge.certification&&ge.certification.trim()!=="").length,oe=t.filter(ge=>!ge.isInactive).length,fe=t.reduce((ge,Te)=>(ge[Te.role]=(ge[Te.role]||0)+1,ge),{});return{total:I,certified:q,active:oe,byRole:fe}})(),Q=I=>{if(I.preventDefault(),y){const q=t.map(oe=>oe.id===y.id?{...oe,...H,fullName:`${H.name} ${H.surname}`}:oe);e(q),b(null)}else{const q={...H,id:`staff_${Date.now()}`,fullName:`${H.name} ${H.surname}`,addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT"),createdAt:new Date().toISOString()};e([...t,q])}Z({name:"",surname:"",role:"Dipendente",department:"",certification:"",notes:""}),k(!1)},te=I=>{b(I),Z({name:I.name||"",surname:I.surname||"",role:I.role||"Dipendente",department:I.department||"",certification:I.certification||"",notes:I.notes||""}),k(!0)},L=I=>{confirm("Sei sicuro di voler eliminare questo membro dello staff?")&&e(t.filter(q=>q.id!==I))},Y=I=>{if(I.preventDefault(),!A.name.trim())return;const q={id:Date.now(),name:A.name.trim(),description:A.description.trim(),members:[],assignedTasks:[]};l([...o,q]),C({name:"",description:"",members:[],assignedTasks:[]}),P(!1)},G=I=>{re(I),C({name:I.name,description:I.description,members:I.members||[],assignedTasks:I.assignedTasks||[]}),P(!0)},ce=I=>{if(I.preventDefault(),!A.name.trim())return;const q=o.map(oe=>oe.id===$.id?{...oe,name:A.name.trim(),description:A.description.trim()}:oe);l(q),C({name:"",description:"",members:[],assignedTasks:[]}),P(!1),re(null)},_=I=>{confirm("Sei sicuro di voler eliminare questa categoria?")&&l(o.filter(q=>q.id!==I))},J=I=>{const q={Amministratori:"bg-red-100 text-red-800",Responsabili:"bg-purple-100 text-purple-800",Dipendenti:"bg-blue-100 text-blue-800","Collaboratore Occasionale":"bg-yellow-100 text-yellow-800",default:"bg-gray-100 text-gray-800"};return q[I]||q.default},M=I=>{const q=J(I);return q.includes("text-red-800")?"bg-red-50 border-red-200":q.includes("text-purple-800")?"bg-purple-50 border-purple-200":q.includes("text-blue-800")?"bg-blue-50 border-blue-200":q.includes("text-yellow-800")?"bg-yellow-50 border-yellow-200":q.includes("text-green-800")?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs(s0,{value:m,onValueChange:N,children:[r.jsxs(gf,{className:"grid w-full grid-cols-5",children:[r.jsxs(Gr,{value:"staff",className:"flex items-center gap-2",children:[r.jsx(Ai,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Staff"})]}),r.jsxs(Gr,{value:"departments",className:"flex items-center gap-2",children:[r.jsx(Tu,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Reparti"})]}),r.jsxs(Gr,{value:"suppliers",className:"flex items-center gap-2",children:[r.jsx(ko,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Fornitori"})]}),r.jsxs(Gr,{value:"ai-assistant",className:"flex items-center gap-2",children:[r.jsx(Qi,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"IA Assistant"})]}),r.jsxs(Gr,{value:"labels",className:"flex items-center gap-2",children:[r.jsx(zl,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Etichette"})]})]}),r.jsxs(Wr,{value:"staff",className:"space-y-6",children:[i&&i.role==="admin"&&r.jsx(zs,{title:"Gestione Categorie Ruoli",subtitle:"Organizzazione categorie e ruoli del personale",icon:Ai,iconColor:"text-purple-600",iconBgColor:"bg-purple-100",count:o.length,testId:"role-categories",defaultExpanded:!0,children:r.jsxs("div",{className:"space-y-4",children:[K&&r.jsxs("form",{onSubmit:$?ce:Y,className:"space-y-4 mb-6 p-4 bg-blue-50 rounded-lg border",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Label,{htmlFor:"categoryName",children:"Nome Categoria"}),r.jsx(Input,{id:"categoryName",value:A.name,onChange:I=>C({...A,name:I.target.value}),placeholder:"es. Cucina, Sala, Amministrazione",required:!0})]}),r.jsxs("div",{children:[r.jsx(Label,{htmlFor:"categoryDescription",children:"Descrizione"}),r.jsx(Input,{id:"categoryDescription",value:A.description,onChange:I=>C({...A,description:I.target.value}),placeholder:"Descrizione della categoria"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{type:"submit",size:"sm",children:$?"Aggiorna Categoria":"Aggiungi Categoria"}),r.jsx(le,{type:"button",variant:"outline",size:"sm",onClick:()=>{P(!1),re(null),C({name:"",description:"",members:[],assignedTasks:[]})},children:"Annulla"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("h4",{className:"font-medium",children:["Categorie Disponibili (",o.length,")"]}),r.jsx(le,{onClick:()=>P(!0),size:"sm",variant:"outline",children:"Nuova Categoria"})]}),o.length===0?r.jsxs("div",{className:"text-center py-6 text-gray-500",children:[r.jsx(Ai,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),r.jsx("p",{children:"Nessuna categoria creata"}),r.jsx("p",{className:"text-sm",children:"Crea la prima categoria per organizzare i ruoli"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.filter(I=>I&&I.id&&I.name&&typeof I.name=="string").map(I=>{var q;return r.jsxs("div",{className:`p-4 border rounded-lg ${M(I.name)}`,children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h5",{className:"font-medium text-lg",children:I.name||"Nome non disponibile"}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${J(I.name||"")}`,children:I.name||"Nome non disponibile"})]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(le,{onClick:()=>G(I),size:"sm",variant:"ghost",className:"h-8 w-8 p-0",children:"✏️"}),r.jsx(le,{onClick:()=>_(I.id),size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700",children:"🗑️"})]})]}),I.description&&r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:I.description}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[r.jsxs("span",{children:["👥 ",t&&Array.isArray(t)?t.filter(oe=>oe&&(oe.roles&&oe.roles.includes(I.name)||oe.role===I.name||oe.primaryRole===I.name)).length:0," membri"]}),r.jsxs("span",{children:["📋 ",((q=I.assignedTasks)==null?void 0:q.length)||0," compiti"]})]})]},I.id)})})]})]})}),r.jsx(zs,{title:"Elenco Staff Completo",subtitle:"Gestione personale e certificazioni",icon:Ai,iconColor:"text-blue-600",iconBgColor:"bg-blue-100",count:ie.total,testId:"staff-list",defaultExpanded:!0,children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"space-y-3",children:t.map(I=>r.jsx(Je,{className:"border-l-4 border-l-blue-500",children:r.jsx(Xe,{className:"p-4",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-semibold text-gray-900",children:I.fullName}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Ruolo: ",I.role]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Reparto: ",I.department||"Non assegnato"]}),I.certification&&r.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[r.jsx(Cn,{className:"h-4 w-4 text-green-500"}),r.jsx("span",{className:"text-sm text-green-700",children:I.certification})]}),I.notes&&r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:I.notes}),r.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Aggiunto: ",I.addedDate," alle ",I.addedTime]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{variant:"outline",size:"sm",onClick:()=>te(I),children:r.jsx(ci,{className:"h-4 w-4"})}),r.jsx(le,{variant:"outline",size:"sm",onClick:()=>L(I.id),className:"text-red-600 hover:text-red-700",children:r.jsx(tr,{className:"h-4 w-4"})})]})]})})},I.id))}),r.jsxs(le,{onClick:()=>k(!0),className:"w-full",variant:"outline",children:[r.jsx(or,{className:"h-4 w-4 mr-2"}),"Aggiungi Membro Staff"]})]})}),r.jsx(zs,{title:"Suggerimenti Ruoli Comuni",subtitle:"Ruoli standard per il settore alimentare",icon:Cn,iconColor:"text-green-600",iconBgColor:"bg-green-100",count:R.length,testId:"staff-roles",children:r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:R.map(I=>r.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:r.jsx("p",{className:"text-sm font-medium text-green-800",children:I})},I))})})]}),r.jsx(Wr,{value:"departments",className:"space-y-6",children:r.jsx(zs,{title:"Gestione Reparti",subtitle:"Organizzazione aziendale e divisioni",icon:Tu,iconColor:"text-purple-600",iconBgColor:"bg-purple-100",count:o.length,testId:"departments-list",defaultExpanded:!0,children:r.jsx("div",{className:"space-y-4",children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(I=>r.jsx(Je,{className:"border-l-4 border-l-purple-500",children:r.jsxs(Xe,{className:"p-4",children:[r.jsx("h4",{className:"font-semibold text-gray-900",children:I.name}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:I.description||"Nessuna descrizione disponibile"}),I.location&&r.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["📍 ",I.location]}),I.manager&&r.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["👤 Responsabile: ",I.manager]})]})},I.id))})})})}),r.jsx(Wr,{value:"suppliers",className:"space-y-6",children:r.jsx(zs,{title:"Gestione Fornitori",subtitle:"Fornitori e certificazioni",icon:ko,iconColor:"text-amber-600",iconBgColor:"bg-amber-100",count:0,testId:"suppliers-list",defaultExpanded:!0,children:r.jsx(Iy,{currentUser:i})})}),r.jsx(Wr,{value:"ai-assistant",className:"space-y-6",children:r.jsx(zs,{title:"IA Assistant e Azioni Rapide",subtitle:"Assistente intelligente e automatizzazioni HACCP",icon:Qi,iconColor:"text-indigo-600",iconBgColor:"bg-indigo-100",count:4,testId:"ai-assistant",defaultExpanded:!0,children:r.jsx(xS,{currentUser:i,products:c,temperatures:d,cleaning:f,staff:t,onAction:I=>{console.log("AI Action:",I)}})})}),r.jsx(Wr,{value:"labels",className:"space-y-6",children:r.jsx(zs,{title:"Gestione Etichette e Scanner",subtitle:"Creazione etichette e scansione codici a barre",icon:zl,iconColor:"text-teal-600",iconBgColor:"bg-teal-100",count:p.length,testId:"labels-management",defaultExpanded:!0,children:r.jsx(vS,{productLabels:p,setProductLabels:v,products:c,currentUser:i})})})]}),S&&r.jsxs(Je,{ref:j,id:"staff-form",className:"border-2 border-blue-200",children:[r.jsx(yt,{children:r.jsx(Nt,{children:y?"Modifica Membro Staff":"Aggiungi Nuovo Membro Staff"})}),r.jsx(Xe,{children:r.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),r.jsx("input",{type:"text",value:H.name,onChange:I=>Z(q=>({...q,name:I.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cognome"}),r.jsx("input",{type:"text",value:H.surname,onChange:I=>Z(q=>({...q,surname:I.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ruolo"}),r.jsx("select",{value:H.role,onChange:I=>Z(q=>({...q,role:I.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:R.map(I=>r.jsx("option",{value:I,children:I},I))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reparto"}),r.jsxs("select",{value:H.department,onChange:I=>Z(q=>({...q,department:I.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Seleziona reparto"}),o.map(I=>r.jsx("option",{value:I.name,children:I.name},I.id))]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Certificazione HACCP"}),r.jsx("input",{type:"text",value:H.certification,onChange:I=>Z(q=>({...q,certification:I.target.value})),placeholder:"es. HACCP Base, HACCP Avanzato, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note"}),r.jsx("textarea",{value:H.notes,onChange:I=>Z(q=>({...q,notes:I.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsxs(le,{type:"submit",className:"flex-1",children:[y?"Aggiorna":"Aggiungi"," Membro Staff"]}),r.jsx(le,{type:"button",variant:"outline",onClick:()=>{k(!1),b(null),Z({name:"",surname:"",role:"Dipendente",department:"",certification:"",notes:""})},children:"Annulla"})]})]})})]})]})}function bS({customCategories:t=[],setCustomCategories:e,currentUser:n,showCustomCategoryManager:s,setShowCustomCategoryManager:i}){const[a,o]=W.useState(!1),[l,c]=W.useState(null),[d,f]=W.useState({name:"",description:"",temperatureMin:"",temperatureMax:"",storageLocation:"",color:"bg-blue-100 text-blue-800",isAmbiente:!1}),p=["bg-blue-100 text-blue-800","bg-red-100 text-red-800","bg-green-100 text-green-800","bg-yellow-100 text-yellow-800","bg-purple-100 text-purple-800","bg-pink-100 text-pink-800","bg-indigo-100 text-indigo-800","bg-orange-100 text-orange-800","bg-teal-100 text-teal-800","bg-cyan-100 text-cyan-800"];W.useEffect(()=>{localStorage.setItem("haccp-custom-categories",JSON.stringify(t))},[t]);const v=()=>{f({name:"",description:"",temperatureMin:"",temperatureMax:"",storageLocation:"",color:"bg-blue-100 text-blue-800",isAmbiente:!1}),c(null)},m=y=>{if(y.preventDefault(),!d.name.trim()){alert("Compila il nome della categoria");return}let b,j;if(d.isAmbiente)b=15,j=25;else{if(!d.temperatureMin.trim()||!d.temperatureMax.trim()){alert('Compila i campi temperatura o seleziona "Temperatura ambiente"');return}if(b=parseFloat(d.temperatureMin),j=parseFloat(d.temperatureMax),isNaN(b)||isNaN(j)){alert("Inserisci temperature valide");return}if(b>=j){alert("La temperatura minima deve essere inferiore alla temperatura massima");return}}if(l){const z=t.map(H=>H.id===l.id?{...H,name:d.name.trim(),description:d.description.trim(),temperatureMin:b,temperatureMax:j,temperature:d.isAmbiente?"15-25°C (Ambiente)":`${b}-${j}°C`,storageLocation:d.storageLocation.trim(),color:d.color,isAmbiente:d.isAmbiente,updatedAt:new Date().toISOString(),updatedBy:n==null?void 0:n.id,updatedByName:n==null?void 0:n.name}:H);e(z)}else{const z={id:Date.now().toString(),name:d.name.trim(),description:d.description.trim(),temperatureMin:b,temperatureMax:j,temperature:d.isAmbiente?"15-25°C (Ambiente)":`${b}-${j}°C`,storageLocation:d.storageLocation.trim(),color:d.color,isAmbiente:d.isAmbiente,createdAt:new Date().toISOString(),createdBy:n==null?void 0:n.id,createdByName:n==null?void 0:n.name,updatedAt:new Date().toISOString(),updatedBy:n==null?void 0:n.id,updatedByName:n==null?void 0:n.name};e([...t,z])}v(),o(!1)},N=y=>{c(y),f({name:y.name,description:y.description||"",temperatureMin:y.temperatureMin.toString(),temperatureMax:y.temperatureMax.toString(),storageLocation:y.storageLocation||"",color:y.color,isAmbiente:y.isAmbiente||!1}),o(!0)},S=y=>{confirm("Sei sicuro di voler eliminare questa categoria? Questa azione non può essere annullata.")&&e(t.filter(b=>b.id!==y))},k=(y,b)=>{const j=(y+b)/2;return j<=-13.5?"Surgelato":j>=15?"Temperatura Ambiente":"Refrigerato"};return r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Un,{className:"h-5 w-5"}),"Categorie Personalizzate"]}),r.jsx("p",{className:"text-sm text-gray-600",children:"Crea nuove categorie di prodotti specifiche per la tua attività"})]}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex justify-end",children:r.jsxs(le,{onClick:()=>{v(),o(!0)},className:"bg-blue-600 hover:bg-blue-700",children:[r.jsx(or,{className:"mr-2 h-4 w-4"}),"Nuova Categoria"]})}),a&&r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsx(Nt,{children:l?"Modifica Categoria":"Nuova Categoria Personalizzata"}),n&&r.jsxs("p",{className:"text-sm text-gray-600",children:[l?"Modificando come: ":"Creando come: ",r.jsx("span",{className:"font-medium",children:n.name})," (",n.department,")"]})]}),r.jsx(Xe,{children:r.jsxs("form",{onSubmit:m,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"name",children:"Nome Categoria *"}),r.jsx(At,{id:"name",type:"text",value:d.name,onChange:y=>f({...d,name:y.target.value}),placeholder:"es. Prodotti Freschi, Specialità Regionali...",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"color",children:"Colore Identificativo"}),r.jsx("select",{value:d.color,onChange:y=>f({...d,color:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:p.map((y,b)=>r.jsx("option",{value:y,children:y.replace("bg-","").replace("-100 text-"," - ").replace("-800","")},b))})]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"description",children:"Descrizione"}),r.jsx(At,{id:"description",type:"text",value:d.description,onChange:y=>f({...d,description:y.target.value}),placeholder:"es. Prodotti freschi di produzione locale..."})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[r.jsx("input",{type:"checkbox",id:"isAmbiente",checked:d.isAmbiente,onChange:y=>f({...d,isAmbiente:y.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx(Ke,{htmlFor:"isAmbiente",className:"text-sm font-medium text-gray-700",children:"Temperatura ambiente (15-25°C)"})]}),!d.isAmbiente&&r.jsx(oy,{label:"Range Temperatura (°C) *",minValue:d.temperatureMin,maxValue:d.temperatureMax,onMinChange:y=>f({...d,temperatureMin:y.target.value}),onMaxChange:y=>f({...d,temperatureMax:y.target.value}),required:!0,showValidation:!0,showSuggestions:!0,className:"w-full",id:"temperature-range"}),d.isAmbiente&&r.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ds,{className:"h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-sm text-blue-800 font-medium",children:"Temperatura ambiente: 15-25°C"})]}),r.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Questa categoria utilizzerà automaticamente il range di temperatura ambiente per il monitoraggio HACCP."})]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"storageLocation",children:"Posizione di Conservazione Suggerita"}),r.jsx(At,{id:"storageLocation",type:"text",value:d.storageLocation,onChange:y=>f({...d,storageLocation:y.target.value}),placeholder:"es. Ripiano superiore frigo, Scaffale dispensa..."})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsxs(le,{type:"submit",className:"flex-1",children:[l?"Aggiorna":"Crea"," Categoria"]}),r.jsx(le,{type:"button",variant:"outline",onClick:()=>{o(!1),v()},className:"flex-1",children:"Annulla"})]})]})})]}),t.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(y=>r.jsx(Je,{className:"hover:shadow-md transition-shadow",children:r.jsxs(Xe,{className:"p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${y.color}`,children:y.name}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(le,{variant:"ghost",size:"sm",onClick:()=>N(y),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-100",children:r.jsx(ci,{className:"h-3 w-3"})}),r.jsx(le,{variant:"ghost",size:"sm",onClick:()=>S(y.id),className:"text-red-600 hover:text-red-700 hover:bg-red-100",children:r.jsx(tr,{className:"h-3 w-3"})})]})]}),y.description&&r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:y.description}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ds,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-gray-600",children:"Temperatura:"}),r.jsx("span",{className:"font-medium",children:y.temperature}),y.isAmbiente&&r.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Ambiente"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Cn,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-gray-600",children:"Tipo:"}),r.jsx("span",{className:"font-medium",children:k(y.temperatureMin,y.temperatureMax)})]}),y.storageLocation&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(xn,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-gray-600",children:"Posizione:"}),r.jsx("span",{className:"font-medium",children:y.storageLocation})]})]}),r.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 text-xs text-gray-500",children:[r.jsxs("p",{children:["Creata da: ",y.createdByName||"N/A"]}),r.jsxs("p",{children:["Aggiornata: ",new Date(y.updatedAt).toLocaleDateString("it-IT")]})]})]})},y.id))}):r.jsx(Je,{children:r.jsxs(Xe,{className:"p-8 text-center text-gray-500",children:[r.jsx(ds,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{className:"text-lg font-medium mb-2",children:"Nessuna categoria personalizzata"}),r.jsx("p",{className:"text-sm",children:"Crea la tua prima categoria personalizzata per gestire prodotti specifici"})]})})]})})]})}function hn(t){"@babel/helpers - typeof";return hn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hn(t)}var Dr=Uint8Array,bs=Uint16Array,i0=Int32Array,xf=new Dr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vf=new Dr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Gp=new Dr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ty=function(t,e){for(var n=new bs(31),s=0;s<31;++s)n[s]=e+=1<<t[s-1];for(var i=new i0(n[30]),s=1;s<30;++s)for(var a=n[s];a<n[s+1];++a)i[a]=a-n[s]<<5|s;return{b:n,r:i}},Ey=Ty(xf,2),zy=Ey.b,Wp=Ey.r;zy[28]=258,Wp[258]=28;var Oy=Ty(vf,0),wS=Oy.b,xx=Oy.r,Jp=new bs(32768);for(var kn=0;kn<32768;++kn){var Sa=(kn&43690)>>1|(kn&21845)<<1;Sa=(Sa&52428)>>2|(Sa&13107)<<2,Sa=(Sa&61680)>>4|(Sa&3855)<<4,Jp[kn]=((Sa&65280)>>8|(Sa&255)<<8)>>1}var Ti=function(t,e,n){for(var s=t.length,i=0,a=new bs(e);i<s;++i)t[i]&&++a[t[i]-1];var o=new bs(e);for(i=1;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var l;if(n){l=new bs(1<<e);var c=15-e;for(i=0;i<s;++i)if(t[i])for(var d=i<<4|t[i],f=e-t[i],p=o[t[i]-1]++<<f,v=p|(1<<f)-1;p<=v;++p)l[Jp[p]>>c]=d}else for(l=new bs(s),i=0;i<s;++i)t[i]&&(l[i]=Jp[o[t[i]-1]++]>>15-t[i]);return l},Ka=new Dr(288);for(var kn=0;kn<144;++kn)Ka[kn]=8;for(var kn=144;kn<256;++kn)Ka[kn]=9;for(var kn=256;kn<280;++kn)Ka[kn]=7;for(var kn=280;kn<288;++kn)Ka[kn]=8;var Ou=new Dr(32);for(var kn=0;kn<32;++kn)Ou[kn]=5;var NS=Ti(Ka,9,0),jS=Ti(Ka,9,1),SS=Ti(Ou,5,0),_S=Ti(Ou,5,1),Lm=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},Zs=function(t,e,n){var s=e/8|0;return(t[s]|t[s+1]<<8)>>(e&7)&n},Im=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},a0=function(t){return(t+7)/8|0},Dy=function(t,e,n){return(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length),new Dr(t.subarray(e,n))},CS=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ri=function(t,e,n){var s=new Error(e||CS[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,ri),!n)throw s;return s},kS=function(t,e,n,s){var i=t.length,a=s?s.length:0;if(!i||e.f&&!e.l)return n||new Dr(0);var o=!n,l=o||e.i!=2,c=e.i;o&&(n=new Dr(i*3));var d=function(Ee){var Fe=n.length;if(Ee>Fe){var qe=new Dr(Math.max(Fe*2,Ee));qe.set(n),n=qe}},f=e.f||0,p=e.p||0,v=e.b||0,m=e.l,N=e.d,S=e.m,k=e.n,y=i*8;do{if(!m){f=Zs(t,p,1);var b=Zs(t,p+1,3);if(p+=3,b)if(b==1)m=jS,N=_S,S=9,k=5;else if(b==2){var Z=Zs(t,p,31)+257,K=Zs(t,p+10,15)+4,P=Z+Zs(t,p+5,31)+1;p+=14;for(var $=new Dr(P),re=new Dr(19),A=0;A<K;++A)re[Gp[A]]=Zs(t,p+A*3,7);p+=K*3;for(var C=Lm(re),R=(1<<C)-1,V=Ti(re,C,1),A=0;A<P;){var ie=V[Zs(t,p,R)];p+=ie&15;var j=ie>>4;if(j<16)$[A++]=j;else{var Q=0,te=0;for(j==16?(te=3+Zs(t,p,3),p+=2,Q=$[A-1]):j==17?(te=3+Zs(t,p,7),p+=3):j==18&&(te=11+Zs(t,p,127),p+=7);te--;)$[A++]=Q}}var L=$.subarray(0,Z),Y=$.subarray(Z);S=Lm(L),k=Lm(Y),m=Ti(L,S,1),N=Ti(Y,k,1)}else ri(1);else{var j=a0(p)+4,z=t[j-4]|t[j-3]<<8,H=j+z;if(H>i){c&&ri(0);break}l&&d(v+z),n.set(t.subarray(j,H),v),e.b=v+=z,e.p=p=H*8,e.f=f;continue}if(p>y){c&&ri(0);break}}l&&d(v+131072);for(var G=(1<<S)-1,ce=(1<<k)-1,_=p;;_=p){var Q=m[Im(t,p)&G],J=Q>>4;if(p+=Q&15,p>y){c&&ri(0);break}if(Q||ri(2),J<256)n[v++]=J;else if(J==256){_=p,m=null;break}else{var M=J-254;if(J>264){var A=J-257,I=xf[A];M=Zs(t,p,(1<<I)-1)+zy[A],p+=I}var q=N[Im(t,p)&ce],oe=q>>4;q||ri(3),p+=q&15;var Y=wS[oe];if(oe>3){var I=vf[oe];Y+=Im(t,p)&(1<<I)-1,p+=I}if(p>y){c&&ri(0);break}l&&d(v+131072);var fe=v+M;if(v<Y){var ge=a-Y,Te=Math.min(Y,fe);for(ge+v<0&&ri(3);v<Te;++v)n[v]=s[ge+v]}for(;v<fe;++v)n[v]=n[v-Y]}}e.l=m,e.p=_,e.b=v,e.f=f,m&&(f=1,e.m=S,e.d=N,e.n=k)}while(!f);return v!=n.length&&o?Dy(n,0,v):n.subarray(0,v)},Hi=function(t,e,n){n<<=e&7;var s=e/8|0;t[s]|=n,t[s+1]|=n>>8},Vc=function(t,e,n){n<<=e&7;var s=e/8|0;t[s]|=n,t[s+1]|=n>>8,t[s+2]|=n>>16},Tm=function(t,e){for(var n=[],s=0;s<t.length;++s)t[s]&&n.push({s,f:t[s]});var i=n.length,a=n.slice();if(!i)return{t:Ry,l:0};if(i==1){var o=new Dr(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(H,Z){return H.f-Z.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],d=0,f=1,p=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};f!=i-1;)l=n[n[d].f<n[p].f?d++:p++],c=n[d!=f&&n[d].f<n[p].f?d++:p++],n[f++]={s:-1,f:l.f+c.f,l,r:c};for(var v=a[0].s,s=1;s<i;++s)a[s].s>v&&(v=a[s].s);var m=new bs(v+1),N=Kp(n[f-1],m,0);if(N>e){var s=0,S=0,k=N-e,y=1<<k;for(a.sort(function(Z,K){return m[K.s]-m[Z.s]||Z.f-K.f});s<i;++s){var b=a[s].s;if(m[b]>e)S+=y-(1<<N-m[b]),m[b]=e;else break}for(S>>=k;S>0;){var j=a[s].s;m[j]<e?S-=1<<e-m[j]++-1:++s}for(;s>=0&&S;--s){var z=a[s].s;m[z]==e&&(--m[z],++S)}N=e}return{t:new Dr(m),l:N}},Kp=function(t,e,n){return t.s==-1?Math.max(Kp(t.l,e,n+1),Kp(t.r,e,n+1)):e[t.s]=n},vx=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new bs(++e),s=0,i=t[0],a=1,o=function(c){n[s++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=t[l]}return{c:n.subarray(0,s),n:e}},Gc=function(t,e){for(var n=0,s=0;s<e.length;++s)n+=t[s]*e[s];return n},My=function(t,e,n){var s=n.length,i=a0(e+2);t[i]=s&255,t[i+1]=s>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<s;++a)t[i+a+4]=n[a];return(i+4+s)*8},yx=function(t,e,n,s,i,a,o,l,c,d,f){Hi(e,f++,n),++i[256];for(var p=Tm(i,15),v=p.t,m=p.l,N=Tm(a,15),S=N.t,k=N.l,y=vx(v),b=y.c,j=y.n,z=vx(S),H=z.c,Z=z.n,K=new bs(19),P=0;P<b.length;++P)++K[b[P]&31];for(var P=0;P<H.length;++P)++K[H[P]&31];for(var $=Tm(K,7),re=$.t,A=$.l,C=19;C>4&&!re[Gp[C-1]];--C);var R=d+5<<3,V=Gc(i,Ka)+Gc(a,Ou)+o,ie=Gc(i,v)+Gc(a,S)+o+14+3*C+Gc(K,re)+2*K[16]+3*K[17]+7*K[18];if(c>=0&&R<=V&&R<=ie)return My(e,f,t.subarray(c,c+d));var Q,te,L,Y;if(Hi(e,f,1+(ie<V)),f+=2,ie<V){Q=Ti(v,m,0),te=v,L=Ti(S,k,0),Y=S;var G=Ti(re,A,0);Hi(e,f,j-257),Hi(e,f+5,Z-1),Hi(e,f+10,C-4),f+=14;for(var P=0;P<C;++P)Hi(e,f+3*P,re[Gp[P]]);f+=3*C;for(var ce=[b,H],_=0;_<2;++_)for(var J=ce[_],P=0;P<J.length;++P){var M=J[P]&31;Hi(e,f,G[M]),f+=re[M],M>15&&(Hi(e,f,J[P]>>5&127),f+=J[P]>>12)}}else Q=NS,te=Ka,L=SS,Y=Ou;for(var P=0;P<l;++P){var I=s[P];if(I>255){var M=I>>18&31;Vc(e,f,Q[M+257]),f+=te[M+257],M>7&&(Hi(e,f,I>>23&31),f+=xf[M]);var q=I&31;Vc(e,f,L[q]),f+=Y[q],q>3&&(Vc(e,f,I>>5&8191),f+=vf[q])}else Vc(e,f,Q[I]),f+=te[I]}return Vc(e,f,Q[256]),f+te[256]},AS=new i0([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ry=new Dr(0),PS=function(t,e,n,s,i,a){var o=a.z||t.length,l=new Dr(s+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(s,l.length-i),d=a.l,f=(a.r||0)&7;if(e){f&&(c[0]=a.r>>3);for(var p=AS[e-1],v=p>>13,m=p&8191,N=(1<<n)-1,S=a.p||new bs(32768),k=a.h||new bs(N+1),y=Math.ceil(n/3),b=2*y,j=function(ct){return(t[ct]^t[ct+1]<<y^t[ct+2]<<b)&N},z=new i0(25e3),H=new bs(288),Z=new bs(32),K=0,P=0,$=a.i||0,re=0,A=a.w||0,C=0;$+2<o;++$){var R=j($),V=$&32767,ie=k[R];if(S[V]=ie,k[R]=V,A<=$){var Q=o-$;if((K>7e3||re>24576)&&(Q>423||!d)){f=yx(t,c,0,z,H,Z,P,re,C,$-C,f),re=K=P=0,C=$;for(var te=0;te<286;++te)H[te]=0;for(var te=0;te<30;++te)Z[te]=0}var L=2,Y=0,G=m,ce=V-ie&32767;if(Q>2&&R==j($-ce))for(var _=Math.min(v,Q)-1,J=Math.min(32767,$),M=Math.min(258,Q);ce<=J&&--G&&V!=ie;){if(t[$+L]==t[$+L-ce]){for(var I=0;I<M&&t[$+I]==t[$+I-ce];++I);if(I>L){if(L=I,Y=ce,I>_)break;for(var q=Math.min(ce,I-2),oe=0,te=0;te<q;++te){var fe=$-ce+te&32767,ge=S[fe],Te=fe-ge&32767;Te>oe&&(oe=Te,ie=fe)}}}V=ie,ie=S[V],ce+=V-ie&32767}if(Y){z[re++]=268435456|Wp[L]<<18|xx[Y];var Ee=Wp[L]&31,Fe=xx[Y]&31;P+=xf[Ee]+vf[Fe],++H[257+Ee],++Z[Fe],A=$+L,++K}else z[re++]=t[$],++H[t[$]]}}for($=Math.max($,A);$<o;++$)z[re++]=t[$],++H[t[$]];f=yx(t,c,d,z,H,Z,P,re,C,$-C,f),d||(a.r=f&7|c[f/8|0]<<3,f-=7,a.h=k,a.p=S,a.i=$,a.w=A)}else{for(var $=a.w||0;$<o+d;$+=65535){var qe=$+65535;qe>=o&&(c[f/8|0]=d,qe=o),f=My(c,f+1,t.subarray($,qe))}a.i=o}return Dy(l,0,s+a0(f)+i)},Fy=function(){var t=1,e=0;return{p:function(n){for(var s=t,i=e,a=n.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)i+=s+=n[o];s=(s&65535)+15*(s>>16),i=(i&65535)+15*(i>>16)}t=s,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},LS=function(t,e,n,s,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new Dr(a.length+t.length);o.set(a),o.set(t,a.length),t=o,i.w=a.length}return PS(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,s,i)},By=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},IS=function(t,e){var n=e.level,s=n==0?0:n<6?1:n==9?3:2;if(t[0]=120,t[1]=s<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=Fy();i.p(e.dictionary),By(t,2,i.d())}},TS=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ri(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&ri(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Yp(t,e){e||(e={});var n=Fy();n.p(t);var s=LS(t,e,e.dictionary?6:2,4);return IS(s,e),By(s,s.length-4,n.d()),s}function ES(t,e){return kS(t.subarray(TS(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}var zS=typeof TextDecoder<"u"&&new TextDecoder,OS=0;try{zS.decode(Ry,{stream:!0}),OS=1}catch{}var zt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Em(){zt.console&&typeof zt.console.log=="function"&&zt.console.log.apply(zt.console,arguments)}var gn={log:Em,warn:function(t){zt.console&&(typeof zt.console.warn=="function"?zt.console.warn.apply(zt.console,arguments):Em.call(null,arguments))},error:function(t){zt.console&&(typeof zt.console.error=="function"?zt.console.error.apply(zt.console,arguments):Em(t))}};function zm(t,e,n){var s=new XMLHttpRequest;s.open("GET",t),s.responseType="blob",s.onload=function(){yo(s.response,e,n)},s.onerror=function(){gn.error("could not download file")},s.send()}function bx(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Kd(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var mu,Qp,yo=zt.saveAs||((typeof window>"u"?"undefined":hn(window))!=="object"||window!==zt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var s=zt.URL||zt.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?bx(i.href)?zm(t,e,n):Kd(i,i.target="_blank"):Kd(i)):(i.href=s.createObjectURL(t),setTimeout(function(){s.revokeObjectURL(i.href)},4e4),setTimeout(function(){Kd(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download",typeof t=="string")if(bx(t))zm(t,e,n);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout(function(){Kd(s)})}else navigator.msSaveOrOpenBlob(function(i,a){return a===void 0?a={autoBom:!1}:hn(a)!=="object"&&(gn.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob([String.fromCharCode(65279),i],{type:i.type}):i}(t,n),e)}:function(t,e,n,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof t=="string")return zm(t,e,n);var i=t.type==="application/octet-stream",a=/constructor/i.test(zt.HTMLElement)||zt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&a)&&(typeof FileReader>"u"?"undefined":hn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var f=l.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=f:location=f,s=null},l.readAsDataURL(t)}else{var c=zt.URL||zt.webkitURL,d=c.createObjectURL(t);s?s.location=d:location.href=d,s=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function $y(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],s=0;s<n.length;s++){var i=n[s].re,a=n[s].process,o=i.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Om(t,e){var n=t[0],s=t[1],i=t[2],a=t[3];n=Lr(n,s,i,a,e[0],7,-680876936),a=Lr(a,n,s,i,e[1],12,-389564586),i=Lr(i,a,n,s,e[2],17,606105819),s=Lr(s,i,a,n,e[3],22,-1044525330),n=Lr(n,s,i,a,e[4],7,-176418897),a=Lr(a,n,s,i,e[5],12,1200080426),i=Lr(i,a,n,s,e[6],17,-1473231341),s=Lr(s,i,a,n,e[7],22,-45705983),n=Lr(n,s,i,a,e[8],7,1770035416),a=Lr(a,n,s,i,e[9],12,-1958414417),i=Lr(i,a,n,s,e[10],17,-42063),s=Lr(s,i,a,n,e[11],22,-1990404162),n=Lr(n,s,i,a,e[12],7,1804603682),a=Lr(a,n,s,i,e[13],12,-40341101),i=Lr(i,a,n,s,e[14],17,-1502002290),n=Ir(n,s=Lr(s,i,a,n,e[15],22,1236535329),i,a,e[1],5,-165796510),a=Ir(a,n,s,i,e[6],9,-1069501632),i=Ir(i,a,n,s,e[11],14,643717713),s=Ir(s,i,a,n,e[0],20,-373897302),n=Ir(n,s,i,a,e[5],5,-701558691),a=Ir(a,n,s,i,e[10],9,38016083),i=Ir(i,a,n,s,e[15],14,-660478335),s=Ir(s,i,a,n,e[4],20,-405537848),n=Ir(n,s,i,a,e[9],5,568446438),a=Ir(a,n,s,i,e[14],9,-1019803690),i=Ir(i,a,n,s,e[3],14,-187363961),s=Ir(s,i,a,n,e[8],20,1163531501),n=Ir(n,s,i,a,e[13],5,-1444681467),a=Ir(a,n,s,i,e[2],9,-51403784),i=Ir(i,a,n,s,e[7],14,1735328473),n=Tr(n,s=Ir(s,i,a,n,e[12],20,-1926607734),i,a,e[5],4,-378558),a=Tr(a,n,s,i,e[8],11,-2022574463),i=Tr(i,a,n,s,e[11],16,1839030562),s=Tr(s,i,a,n,e[14],23,-35309556),n=Tr(n,s,i,a,e[1],4,-1530992060),a=Tr(a,n,s,i,e[4],11,1272893353),i=Tr(i,a,n,s,e[7],16,-155497632),s=Tr(s,i,a,n,e[10],23,-1094730640),n=Tr(n,s,i,a,e[13],4,681279174),a=Tr(a,n,s,i,e[0],11,-358537222),i=Tr(i,a,n,s,e[3],16,-722521979),s=Tr(s,i,a,n,e[6],23,76029189),n=Tr(n,s,i,a,e[9],4,-640364487),a=Tr(a,n,s,i,e[12],11,-421815835),i=Tr(i,a,n,s,e[15],16,530742520),n=Er(n,s=Tr(s,i,a,n,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Er(a,n,s,i,e[7],10,1126891415),i=Er(i,a,n,s,e[14],15,-1416354905),s=Er(s,i,a,n,e[5],21,-57434055),n=Er(n,s,i,a,e[12],6,1700485571),a=Er(a,n,s,i,e[3],10,-1894986606),i=Er(i,a,n,s,e[10],15,-1051523),s=Er(s,i,a,n,e[1],21,-2054922799),n=Er(n,s,i,a,e[8],6,1873313359),a=Er(a,n,s,i,e[15],10,-30611744),i=Er(i,a,n,s,e[6],15,-1560198380),s=Er(s,i,a,n,e[13],21,1309151649),n=Er(n,s,i,a,e[4],6,-145523070),a=Er(a,n,s,i,e[11],10,-1120210379),i=Er(i,a,n,s,e[2],15,718787259),s=Er(s,i,a,n,e[9],21,-343485551),t[0]=Oa(n,t[0]),t[1]=Oa(s,t[1]),t[2]=Oa(i,t[2]),t[3]=Oa(a,t[3])}function yf(t,e,n,s,i,a){return e=Oa(Oa(e,t),Oa(s,a)),Oa(e<<i|e>>>32-i,n)}function Lr(t,e,n,s,i,a,o){return yf(e&n|~e&s,t,e,i,a,o)}function Ir(t,e,n,s,i,a,o){return yf(e&s|n&~s,t,e,i,a,o)}function Tr(t,e,n,s,i,a,o){return yf(e^n^s,t,e,i,a,o)}function Er(t,e,n,s,i,a,o){return yf(n^(e|~s),t,e,i,a,o)}function qy(t){var e,n=t.length,s=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Om(s,DS(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(Om(s,i),e=0;e<16;e++)i[e]=0;return i[14]=8*n,Om(s,i),s}function DS(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}mu=zt.atob.bind(zt),Qp=zt.btoa.bind(zt);var wx="0123456789abcdef".split("");function MS(t){for(var e="",n=0;n<4;n++)e+=wx[t>>8*n+4&15]+wx[t>>8*n&15];return e}function RS(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Xp(t){return qy(t).map(RS).join("")}var FS=function(t){for(var e=0;e<t.length;e++)t[e]=MS(t[e]);return t.join("")}(qy("hello"))!="5d41402abc4b2a76b9719d911017c592";function Oa(t,e){if(FS){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Zp(t,e){var n,s,i,a;if(t!==n){for(var o=(i=t,a=1+(256/t.length>>0),new Array(a+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var f=l[c];d=(d+f+o.charCodeAt(c))%256,l[c]=l[d],l[d]=f}n=t,s=l}else l=s;var p=e.length,v=0,m=0,N="";for(c=0;c<p;c++)m=(m+(f=l[v=(v+1)%256]))%256,l[v]=l[m],l[m]=f,o=l[(l[v]+l[m])%256],N+=String.fromCharCode(e.charCodeAt(c)^o);return N}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Nx={print:4,modify:8,copy:16,"annot-forms":32};function bl(t,e,n,s){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(Nx.perm!==void 0)throw new Error("Invalid permission: "+l);i+=Nx[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var a=(e+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^i)),this.encryptionKey=Xp(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=Zp(this.encryptionKey,this.padding)}function wl(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,s=0;s<n;s++){var i=t.charCodeAt(s);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[s]}return e}function jx(t){if(hn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(n,s,i){if(i=i||!1,typeof n!="string"||typeof s!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(n)||(e[n]={});var a=Math.random().toString(35);return e[n][a]=[s,!!i],a},this.unsubscribe=function(n){for(var s in e)if(e[s][n])return delete e[s][n],Object.keys(e[s]).length===0&&delete e[s],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var s=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[n]){var o=e[n][a];try{o[0].apply(t,s)}catch(l){zt.console&&gn.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Vh(t){if(!(this instanceof Vh))return new Vh(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function Uy(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function wo(t,e,n,s,i){if(!(this instanceof wo))return new wo(t,e,n,s,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=n,Uy.call(this,s,i)}function Ol(t,e,n,s,i){if(!(this instanceof Ol))return new Ol(t,e,n,s,i);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,Uy.call(this,s,i)}function Et(t){var e,n=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],i=arguments[2],a=arguments[3],o=[],l=1,c=16,d="S",f=null;hn(t=t||{})==="object"&&(n=t.orientation,s=t.unit||s,i=t.format||i,a=t.compress||t.compressPdf||a,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),s=s||"mm",n=(""+(n||"P")).toLowerCase();var p=t.putOnlyUsedFonts||!1,v={},m={internal:{},__private__:{}};m.__private__.PubSub=jx;var N="1.3",S=m.__private__.getPdfVersion=function(){return N};m.__private__.setPdfVersion=function(g){N=g};var k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return k};var y=m.__private__.getPageFormat=function(g){return k[g]};i=i||"a4";var b={COMPAT:"compat",ADVANCED:"advanced"},j=b.COMPAT;function z(){this.saveGraphicsState(),ae(new ht(Ne,0,0,-Ne,0,ua()*Ne).toString()+" cm"),this.setFontSize(this.getFontSize()/Ne),d="n",j=b.ADVANCED}function H(){this.restoreGraphicsState(),d="S",j=b.COMPAT}var Z=m.__private__.combineFontStyleAndFontWeight=function(g,E){if(g=="bold"&&E=="normal"||g=="bold"&&E==400||g=="normal"&&E=="italic"||g=="bold"&&E=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return E&&(g=E==400||E==="normal"?g==="italic"?"italic":"normal":E!=700&&E!=="bold"||g!=="normal"?(E==700?"bold":E)+""+g:"bold"),g};m.advancedAPI=function(g){var E=j===b.COMPAT;return E&&z.call(this),typeof g!="function"||(g(this),E&&H.call(this)),this},m.compatAPI=function(g){var E=j===b.ADVANCED;return E&&H.call(this),typeof g!="function"||(g(this),E&&z.call(this)),this},m.isAdvancedAPI=function(){return j===b.ADVANCED};var K,P=function(g){if(j!==b.ADVANCED)throw new Error(g+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},$=m.roundToPrecision=m.__private__.roundToPrecision=function(g,E){var se=e||E;if(isNaN(g)||isNaN(se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return g.toFixed(se).replace(/0+$/,"")};K=m.hpf=m.__private__.hpf=typeof c=="number"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return $(g,c)}:c==="smart"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return $(g,g>-1&&g<1?16:5)}:function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return $(g,16)};var re=m.f2=m.__private__.f2=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f2");return $(g,2)},A=m.__private__.f3=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f3");return $(g,3)},C=m.scale=m.__private__.scale=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.scale");return j===b.COMPAT?g*Ne:j===b.ADVANCED?g:void 0},R=function(g){return j===b.COMPAT?ua()-g:j===b.ADVANCED?g:void 0},V=function(g){return C(R(g))};m.__private__.setPrecision=m.setPrecision=function(g){typeof parseInt(g,10)=="number"&&(e=parseInt(g,10))};var ie,Q="00000000000000000000000000000000",te=m.__private__.getFileId=function(){return Q},L=m.__private__.setFileId=function(g){return Q=g!==void 0&&/^[a-fA-F0-9]{32}$/.test(g)?g.toUpperCase():Q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Cr=new bl(f.userPermissions,f.userPassword,f.ownerPassword,Q)),Q};m.setFileId=function(g){return L(g),this},m.getFileId=function(){return te()};var Y=m.__private__.convertDateToPDFDate=function(g){var E=g.getTimezoneOffset(),se=E<0?"+":"-",ue=Math.floor(Math.abs(E/60)),ve=Math.abs(E%60),Ie=[se,M(ue),"'",M(ve),"'"].join("");return["D:",g.getFullYear(),M(g.getMonth()+1),M(g.getDate()),M(g.getHours()),M(g.getMinutes()),M(g.getSeconds()),Ie].join("")},G=m.__private__.convertPDFDateToDate=function(g){var E=parseInt(g.substr(2,4),10),se=parseInt(g.substr(6,2),10)-1,ue=parseInt(g.substr(8,2),10),ve=parseInt(g.substr(10,2),10),Ie=parseInt(g.substr(12,2),10),Ue=parseInt(g.substr(14,2),10);return new Date(E,se,ue,ve,Ie,Ue,0)},ce=m.__private__.setCreationDate=function(g){var E;if(g===void 0&&(g=new Date),g instanceof Date)E=Y(g);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(g))throw new Error("Invalid argument passed to jsPDF.setCreationDate");E=g}return ie=E},_=m.__private__.getCreationDate=function(g){var E=ie;return g==="jsDate"&&(E=G(ie)),E};m.setCreationDate=function(g){return ce(g),this},m.getCreationDate=function(g){return _(g)};var J,M=m.__private__.padd2=function(g){return("0"+parseInt(g)).slice(-2)},I=m.__private__.padd2Hex=function(g){return("00"+(g=g.toString())).substr(g.length)},q=0,oe=[],fe=[],ge=0,Te=[],Ee=[],Fe=!1,qe=fe,ct=function(){q=0,ge=0,fe=[],oe=[],Te=[],Qr=vn(),Sr=vn()};m.__private__.setCustomOutputDestination=function(g){Fe=!0,qe=g};var _e=function(g){Fe||(qe=g)};m.__private__.resetCustomOutputDestination=function(){Fe=!1,qe=fe};var ae=m.__private__.out=function(g){return g=g.toString(),ge+=g.length+1,qe.push(g),qe},St=m.__private__.write=function(g){return ae(arguments.length===1?g.toString():Array.prototype.join.call(arguments," "))},st=m.__private__.getArrayBuffer=function(g){for(var E=g.length,se=new ArrayBuffer(E),ue=new Uint8Array(se);E--;)ue[E]=g.charCodeAt(E);return se},$e=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return $e};var Ye=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(g){return Ye=j===b.ADVANCED?g/Ne:g,this};var Ge,He=m.__private__.getFontSize=m.getFontSize=function(){return j===b.COMPAT?Ye:Ye*Ne},it=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(g){return it=g,this},m.__private__.getR2L=m.getR2L=function(){return it};var rt,mt=m.__private__.setZoomMode=function(g){var E=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(g))Ge=g;else if(isNaN(g)){if(E.indexOf(g)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+g+'" is not recognized.');Ge=g}else Ge=parseInt(g,10)};m.__private__.getZoomMode=function(){return Ge};var bt,me=m.__private__.setPageMode=function(g){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(g)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+g+'" is not recognized.');rt=g};m.__private__.getPageMode=function(){return rt};var Le=m.__private__.setLayoutMode=function(g){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(g)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+g+'" is not recognized.');bt=g};m.__private__.getLayoutMode=function(){return bt},m.__private__.setDisplayMode=m.setDisplayMode=function(g,E,se){return mt(g),Le(E),me(se),this};var Ce={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(g){if(Object.keys(Ce).indexOf(g)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ce[g]},m.__private__.getDocumentProperties=function(){return Ce},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(g){for(var E in Ce)Ce.hasOwnProperty(E)&&g[E]&&(Ce[E]=g[E]);return this},m.__private__.setDocumentProperty=function(g,E){if(Object.keys(Ce).indexOf(g)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ce[g]=E};var Me,Ne,gt,et,ut,ye={},Re={},xt=[],vt={},jt={},Ot={},en={},It=null,wt=0,Ze=[],dt=new jx(m),Xt=t.hotfixes||[],Dt={},Mt={},an=[],ht=function g(E,se,ue,ve,Ie,Ue){if(!(this instanceof g))return new g(E,se,ue,ve,Ie,Ue);isNaN(E)&&(E=1),isNaN(se)&&(se=0),isNaN(ue)&&(ue=0),isNaN(ve)&&(ve=1),isNaN(Ie)&&(Ie=0),isNaN(Ue)&&(Ue=0),this._matrix=[E,se,ue,ve,Ie,Ue]};Object.defineProperty(ht.prototype,"sx",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(ht.prototype,"shy",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(ht.prototype,"shx",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(ht.prototype,"sy",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(ht.prototype,"tx",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(ht.prototype,"ty",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(ht.prototype,"a",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(ht.prototype,"b",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(ht.prototype,"c",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(ht.prototype,"d",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(ht.prototype,"e",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(ht.prototype,"f",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(ht.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ht.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ht.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ht.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ht.prototype.join=function(g){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(K).join(g)},ht.prototype.multiply=function(g){var E=g.sx*this.sx+g.shy*this.shx,se=g.sx*this.shy+g.shy*this.sy,ue=g.shx*this.sx+g.sy*this.shx,ve=g.shx*this.shy+g.sy*this.sy,Ie=g.tx*this.sx+g.ty*this.shx+this.tx,Ue=g.tx*this.shy+g.ty*this.sy+this.ty;return new ht(E,se,ue,ve,Ie,Ue)},ht.prototype.decompose=function(){var g=this.sx,E=this.shy,se=this.shx,ue=this.sy,ve=this.tx,Ie=this.ty,Ue=Math.sqrt(g*g+E*E),at=(g/=Ue)*se+(E/=Ue)*ue;se-=g*at,ue-=E*at;var kt=Math.sqrt(se*se+ue*ue);return at/=kt,g*(ue/=kt)<E*(se/=kt)&&(g=-g,E=-E,at=-at,Ue=-Ue),{scale:new ht(Ue,0,0,kt,0,0),translate:new ht(1,0,0,1,ve,Ie),rotate:new ht(g,E,-E,g,0,0),skew:new ht(1,0,at,1,0,0)}},ht.prototype.toString=function(g){return this.join(" ")},ht.prototype.inversed=function(){var g=this.sx,E=this.shy,se=this.shx,ue=this.sy,ve=this.tx,Ie=this.ty,Ue=1/(g*ue-E*se),at=ue*Ue,kt=-E*Ue,Ut=-se*Ue,$t=g*Ue;return new ht(at,kt,Ut,$t,-at*ve-Ut*Ie,-kt*ve-$t*Ie)},ht.prototype.applyToPoint=function(g){var E=g.x*this.sx+g.y*this.shx+this.tx,se=g.x*this.shy+g.y*this.sy+this.ty;return new Uo(E,se)},ht.prototype.applyToRectangle=function(g){var E=this.applyToPoint(g),se=this.applyToPoint(new Uo(g.x+g.w,g.y+g.h));return new gc(E.x,E.y,se.x-E.x,se.y-E.y)},ht.prototype.clone=function(){var g=this.sx,E=this.shy,se=this.shx,ue=this.sy,ve=this.tx,Ie=this.ty;return new ht(g,E,se,ue,ve,Ie)},m.Matrix=ht;var _t=m.matrixMult=function(g,E){return E.multiply(g)},Mn=new ht(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=Mn;var Pn=function(g,E){if(!jt[g]){var se=(E instanceof wo?"Sh":"P")+(Object.keys(vt).length+1).toString(10);E.id=se,jt[g]=se,vt[se]=E,dt.publish("addPattern",E)}};m.ShadingPattern=wo,m.TilingPattern=Ol,m.addShadingPattern=function(g,E){return P("addShadingPattern()"),Pn(g,E),this},m.beginTilingPattern=function(g){P("beginTilingPattern()"),Xu(g.boundingBox[0],g.boundingBox[1],g.boundingBox[2]-g.boundingBox[0],g.boundingBox[3]-g.boundingBox[1],g.matrix)},m.endTilingPattern=function(g,E){P("endTilingPattern()"),E.stream=Ee[J].join(`
`),Pn(g,E),dt.publish("endTilingPattern",E),an.pop().restore()};var Sn=m.__private__.newObject=function(){var g=vn();return gr(g,!0),g},vn=m.__private__.newObjectDeferred=function(){return q++,oe[q]=function(){return ge},q},gr=function(g,E){return E=typeof E=="boolean"&&E,oe[g]=ge,E&&ae(g+" 0 obj"),g},fi=m.__private__.newAdditionalObject=function(){var g={objId:vn(),content:""};return Te.push(g),g},Qr=vn(),Sr=vn(),Ln=m.__private__.decodeColorString=function(g){var E=g.split(" ");if(E.length!==2||E[1]!=="g"&&E[1]!=="G")E.length===5&&(E[4]==="k"||E[4]==="K")&&(E=[(1-E[0])*(1-E[3]),(1-E[1])*(1-E[3]),(1-E[2])*(1-E[3]),"r"]);else{var se=parseFloat(E[0]);E=[se,se,se,"r"]}for(var ue="#",ve=0;ve<3;ve++)ue+=("0"+Math.floor(255*parseFloat(E[ve])).toString(16)).slice(-2);return ue},xr=m.__private__.encodeColorString=function(g){var E;typeof g=="string"&&(g={ch1:g});var se=g.ch1,ue=g.ch2,ve=g.ch3,Ie=g.ch4,Ue=g.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof se=="string"&&se.charAt(0)!=="#"){var at=new $y(se);if(at.ok)se=at.toHex();else if(!/^\d*\.?\d*$/.test(se))throw new Error('Invalid color "'+se+'" passed to jsPDF.encodeColorString.')}if(typeof se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(se)&&(se="#"+se[1]+se[1]+se[2]+se[2]+se[3]+se[3]),typeof se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(se)){var kt=parseInt(se.substr(1),16);se=kt>>16&255,ue=kt>>8&255,ve=255&kt}if(ue===void 0||Ie===void 0&&se===ue&&ue===ve)if(typeof se=="string")E=se+" "+Ue[0];else switch(g.precision){case 2:E=re(se/255)+" "+Ue[0];break;case 3:default:E=A(se/255)+" "+Ue[0]}else if(Ie===void 0||hn(Ie)==="object"){if(Ie&&!isNaN(Ie.a)&&Ie.a===0)return E=["1.","1.","1.",Ue[1]].join(" ");if(typeof se=="string")E=[se,ue,ve,Ue[1]].join(" ");else switch(g.precision){case 2:E=[re(se/255),re(ue/255),re(ve/255),Ue[1]].join(" ");break;default:case 3:E=[A(se/255),A(ue/255),A(ve/255),Ue[1]].join(" ")}}else if(typeof se=="string")E=[se,ue,ve,Ie,Ue[2]].join(" ");else switch(g.precision){case 2:E=[re(se),re(ue),re(ve),re(Ie),Ue[2]].join(" ");break;case 3:default:E=[A(se),A(ue),A(ve),A(Ie),Ue[2]].join(" ")}return E},nr=m.__private__.getFilters=function(){return o},_r=m.__private__.putStream=function(g){var E=(g=g||{}).data||"",se=g.filters||nr(),ue=g.alreadyAppliedFilters||[],ve=g.addLength1||!1,Ie=E.length,Ue=g.objectId,at=function(kr){return kr};if(f!==null&&Ue===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(at=Cr.encryptor(Ue,0));var kt={};se===!0&&(se=["FlateEncode"]);var Ut=g.additionalKeyValues||[],$t=(kt=Et.API.processDataByFilters!==void 0?Et.API.processDataByFilters(E,se):{data:E,reverseChain:[]}).reverseChain+(Array.isArray(ue)?ue.join(" "):ue.toString());if(kt.data.length!==0&&(Ut.push({key:"Length",value:kt.data.length}),ve===!0&&Ut.push({key:"Length1",value:Ie})),$t.length!=0)if($t.split("/").length-1==1)Ut.push({key:"Filter",value:$t});else{Ut.push({key:"Filter",value:"["+$t+"]"});for(var Zt=0;Zt<Ut.length;Zt+=1)if(Ut[Zt].key==="DecodeParms"){for(var En=[],Rn=0;Rn<kt.reverseChain.split("/").length-1;Rn+=1)En.push("null");En.push(Ut[Zt].value),Ut[Zt].value="["+En.join(" ")+"]"}}ae("<<");for(var Qn=0;Qn<Ut.length;Qn++)ae("/"+Ut[Qn].key+" "+Ut[Qn].value);ae(">>"),kt.data.length!==0&&(ae("stream"),ae(at(kt.data)),ae("endstream"))},Hn=m.__private__.putPage=function(g){var E=g.number,se=g.data,ue=g.objId,ve=g.contentsObjId;gr(ue,!0),ae("<</Type /Page"),ae("/Parent "+g.rootDictionaryObjId+" 0 R"),ae("/Resources "+g.resourceDictionaryObjId+" 0 R"),ae("/MediaBox ["+parseFloat(K(g.mediaBox.bottomLeftX))+" "+parseFloat(K(g.mediaBox.bottomLeftY))+" "+K(g.mediaBox.topRightX)+" "+K(g.mediaBox.topRightY)+"]"),g.cropBox!==null&&ae("/CropBox ["+K(g.cropBox.bottomLeftX)+" "+K(g.cropBox.bottomLeftY)+" "+K(g.cropBox.topRightX)+" "+K(g.cropBox.topRightY)+"]"),g.bleedBox!==null&&ae("/BleedBox ["+K(g.bleedBox.bottomLeftX)+" "+K(g.bleedBox.bottomLeftY)+" "+K(g.bleedBox.topRightX)+" "+K(g.bleedBox.topRightY)+"]"),g.trimBox!==null&&ae("/TrimBox ["+K(g.trimBox.bottomLeftX)+" "+K(g.trimBox.bottomLeftY)+" "+K(g.trimBox.topRightX)+" "+K(g.trimBox.topRightY)+"]"),g.artBox!==null&&ae("/ArtBox ["+K(g.artBox.bottomLeftX)+" "+K(g.artBox.bottomLeftY)+" "+K(g.artBox.topRightX)+" "+K(g.artBox.topRightY)+"]"),typeof g.userUnit=="number"&&g.userUnit!==1&&ae("/UserUnit "+g.userUnit),dt.publish("putPage",{objId:ue,pageContext:Ze[E],pageNumber:E,page:se}),ae("/Contents "+ve+" 0 R"),ae(">>"),ae("endobj");var Ie=se.join(`
`);return j===b.ADVANCED&&(Ie+=`
Q`),gr(ve,!0),_r({data:Ie,filters:nr(),objectId:ve}),ae("endobj"),ue},fs=m.__private__.putPages=function(){var g,E,se=[];for(g=1;g<=wt;g++)Ze[g].objId=vn(),Ze[g].contentsObjId=vn();for(g=1;g<=wt;g++)se.push(Hn({number:g,data:Ee[g],objId:Ze[g].objId,contentsObjId:Ze[g].contentsObjId,mediaBox:Ze[g].mediaBox,cropBox:Ze[g].cropBox,bleedBox:Ze[g].bleedBox,trimBox:Ze[g].trimBox,artBox:Ze[g].artBox,userUnit:Ze[g].userUnit,rootDictionaryObjId:Qr,resourceDictionaryObjId:Sr}));gr(Qr,!0),ae("<</Type /Pages");var ue="/Kids [";for(E=0;E<wt;E++)ue+=se[E]+" 0 R ";ae(ue+"]"),ae("/Count "+wt),ae(">>"),ae("endobj"),dt.publish("postPutPages")},Vs=function(g){dt.publish("putFont",{font:g,out:ae,newObject:Sn,putStream:_r}),g.isAlreadyPutted!==!0&&(g.objectNumber=Sn(),ae("<<"),ae("/Type /Font"),ae("/BaseFont /"+wl(g.postScriptName)),ae("/Subtype /Type1"),typeof g.encoding=="string"&&ae("/Encoding /"+g.encoding),ae("/FirstChar 32"),ae("/LastChar 255"),ae(">>"),ae("endobj"))},Gs=function(){for(var g in ye)ye.hasOwnProperty(g)&&(p===!1||p===!0&&v.hasOwnProperty(g))&&Vs(ye[g])},mi=function(g){g.objectNumber=Sn();var E=[];E.push({key:"Type",value:"/XObject"}),E.push({key:"Subtype",value:"/Form"}),E.push({key:"BBox",value:"["+[K(g.x),K(g.y),K(g.x+g.width),K(g.y+g.height)].join(" ")+"]"}),E.push({key:"Matrix",value:"["+g.matrix.toString()+"]"});var se=g.pages[1].join(`
`);_r({data:se,additionalKeyValues:E,objectId:g.objectNumber}),ae("endobj")},pi=function(){for(var g in Dt)Dt.hasOwnProperty(g)&&mi(Dt[g])},sa=function(g,E){var se,ue=[],ve=1/(E-1);for(se=0;se<1;se+=ve)ue.push(se);if(ue.push(1),g[0].offset!=0){var Ie={offset:0,color:g[0].color};g.unshift(Ie)}if(g[g.length-1].offset!=1){var Ue={offset:1,color:g[g.length-1].color};g.push(Ue)}for(var at="",kt=0,Ut=0;Ut<ue.length;Ut++){for(se=ue[Ut];se>g[kt+1].offset;)kt++;var $t=g[kt].offset,Zt=(se-$t)/(g[kt+1].offset-$t),En=g[kt].color,Rn=g[kt+1].color;at+=I(Math.round((1-Zt)*En[0]+Zt*Rn[0]).toString(16))+I(Math.round((1-Zt)*En[1]+Zt*Rn[1]).toString(16))+I(Math.round((1-Zt)*En[2]+Zt*Rn[2]).toString(16))}return at.trim()},to=function(g,E){E||(E=21);var se=Sn(),ue=sa(g.colors,E),ve=[];ve.push({key:"FunctionType",value:"0"}),ve.push({key:"Domain",value:"[0.0 1.0]"}),ve.push({key:"Size",value:"["+E+"]"}),ve.push({key:"BitsPerSample",value:"8"}),ve.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ve.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),_r({data:ue,additionalKeyValues:ve,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:se}),ae("endobj"),g.objectNumber=Sn(),ae("<< /ShadingType "+g.type),ae("/ColorSpace /DeviceRGB");var Ie="/Coords ["+K(parseFloat(g.coords[0]))+" "+K(parseFloat(g.coords[1]))+" ";g.type===2?Ie+=K(parseFloat(g.coords[2]))+" "+K(parseFloat(g.coords[3])):Ie+=K(parseFloat(g.coords[2]))+" "+K(parseFloat(g.coords[3]))+" "+K(parseFloat(g.coords[4]))+" "+K(parseFloat(g.coords[5])),ae(Ie+="]"),g.matrix&&ae("/Matrix ["+g.matrix.toString()+"]"),ae("/Function "+se+" 0 R"),ae("/Extend [true true]"),ae(">>"),ae("endobj")},ia=function(g,E){var se=vn(),ue=Sn();E.push({resourcesOid:se,objectOid:ue}),g.objectNumber=ue;var ve=[];ve.push({key:"Type",value:"/Pattern"}),ve.push({key:"PatternType",value:"1"}),ve.push({key:"PaintType",value:"1"}),ve.push({key:"TilingType",value:"1"}),ve.push({key:"BBox",value:"["+g.boundingBox.map(K).join(" ")+"]"}),ve.push({key:"XStep",value:K(g.xStep)}),ve.push({key:"YStep",value:K(g.yStep)}),ve.push({key:"Resources",value:se+" 0 R"}),g.matrix&&ve.push({key:"Matrix",value:"["+g.matrix.toString()+"]"}),_r({data:g.stream,additionalKeyValues:ve,objectId:g.objectNumber}),ae("endobj")},B=function(g){var E;for(E in vt)vt.hasOwnProperty(E)&&(vt[E]instanceof wo?to(vt[E]):vt[E]instanceof Ol&&ia(vt[E],g))},je=function(g){for(var E in g.objectNumber=Sn(),ae("<<"),g)switch(E){case"opacity":ae("/ca "+re(g[E]));break;case"stroke-opacity":ae("/CA "+re(g[E]))}ae(">>"),ae("endobj")},Pe=function(){var g;for(g in Ot)Ot.hasOwnProperty(g)&&je(Ot[g])},We=function(){for(var g in ae("/XObject <<"),Dt)Dt.hasOwnProperty(g)&&Dt[g].objectNumber>=0&&ae("/"+g+" "+Dt[g].objectNumber+" 0 R");dt.publish("putXobjectDict"),ae(">>")},Ct=function(){Cr.oid=Sn(),ae("<<"),ae("/Filter /Standard"),ae("/V "+Cr.v),ae("/R "+Cr.r),ae("/U <"+Cr.toHexString(Cr.U)+">"),ae("/O <"+Cr.toHexString(Cr.O)+">"),ae("/P "+Cr.P),ae(">>"),ae("endobj")},Tt=function(){for(var g in ae("/Font <<"),ye)ye.hasOwnProperty(g)&&(p===!1||p===!0&&v.hasOwnProperty(g))&&ae("/"+g+" "+ye[g].objectNumber+" 0 R");ae(">>")},Wt=function(){if(Object.keys(vt).length>0){for(var g in ae("/Shading <<"),vt)vt.hasOwnProperty(g)&&vt[g]instanceof wo&&vt[g].objectNumber>=0&&ae("/"+g+" "+vt[g].objectNumber+" 0 R");dt.publish("putShadingPatternDict"),ae(">>")}},ln=function(g){if(Object.keys(vt).length>0){for(var E in ae("/Pattern <<"),vt)vt.hasOwnProperty(E)&&vt[E]instanceof m.TilingPattern&&vt[E].objectNumber>=0&&vt[E].objectNumber<g&&ae("/"+E+" "+vt[E].objectNumber+" 0 R");dt.publish("putTilingPatternDict"),ae(">>")}},Rr=function(){if(Object.keys(Ot).length>0){var g;for(g in ae("/ExtGState <<"),Ot)Ot.hasOwnProperty(g)&&Ot[g].objectNumber>=0&&ae("/"+g+" "+Ot[g].objectNumber+" 0 R");dt.publish("putGStateDict"),ae(">>")}},sn=function(g){gr(g.resourcesOid,!0),ae("<<"),ae("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Tt(),Wt(),ln(g.objectOid),Rr(),We(),ae(">>"),ae("endobj")},zi=function(){var g=[];Gs(),Pe(),pi(),B(g),dt.publish("putResources"),g.forEach(sn),sn({resourcesOid:Sr,objectOid:Number.MAX_SAFE_INTEGER}),dt.publish("postPutResources")},_s=function(){dt.publish("putAdditionalObjects");for(var g=0;g<Te.length;g++){var E=Te[g];gr(E.objId,!0),ae(E.content),ae("endobj")}dt.publish("postPutAdditionalObjects")},gi=function(g){Re[g.fontName]=Re[g.fontName]||{},Re[g.fontName][g.fontStyle]=g.id},Ws=function(g,E,se,ue,ve){var Ie={id:"F"+(Object.keys(ye).length+1).toString(10),postScriptName:g,fontName:E,fontStyle:se,encoding:ue,isStandardFont:ve||!1,metadata:{}};return dt.publish("addFont",{font:Ie,instance:this}),ye[Ie.id]=Ie,gi(Ie),Ie.id},Ro=function(g){for(var E=0,se=$e.length;E<se;E++){var ue=Ws.call(this,g[E][0],g[E][1],g[E][2],$e[E][3],!0);p===!1&&(v[ue]=!0);var ve=g[E][0].split("-");gi({id:ue,fontName:ve[0],fontStyle:ve[1]||""})}dt.publish("addFonts",{fonts:ye,dictionary:Re})},Xr=function(g){return g.foo=function(){try{return g.apply(this,arguments)}catch(ue){var E=ue.stack||"";~E.indexOf(" at ")&&(E=E.split(" at ")[1]);var se="Error in function "+E.split(`
`)[0].split("<")[0]+": "+ue.message;if(!zt.console)throw new Error(se);zt.console.error(se,ue),zt.alert&&alert(se)}},g.foo.bar=g,g.foo},Oi=function(g,E){var se,ue,ve,Ie,Ue,at,kt,Ut,$t;if(ve=(E=E||{}).sourceEncoding||"Unicode",Ue=E.outputEncoding,(E.autoencode||Ue)&&ye[Me].metadata&&ye[Me].metadata[ve]&&ye[Me].metadata[ve].encoding&&(Ie=ye[Me].metadata[ve].encoding,!Ue&&ye[Me].encoding&&(Ue=ye[Me].encoding),!Ue&&Ie.codePages&&(Ue=Ie.codePages[0]),typeof Ue=="string"&&(Ue=Ie[Ue]),Ue)){for(kt=!1,at=[],se=0,ue=g.length;se<ue;se++)(Ut=Ue[g.charCodeAt(se)])?at.push(String.fromCharCode(Ut)):at.push(g[se]),at[se].charCodeAt(0)>>8&&(kt=!0);g=at.join("")}for(se=g.length;kt===void 0&&se!==0;)g.charCodeAt(se-1)>>8&&(kt=!0),se--;if(!kt)return g;for(at=E.noBOM?[]:[254,255],se=0,ue=g.length;se<ue;se++){if(($t=(Ut=g.charCodeAt(se))>>8)>>8)throw new Error("Character at position "+se+" of string '"+g+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");at.push($t),at.push(Ut-($t<<8))}return String.fromCharCode.apply(void 0,at)},vr=m.__private__.pdfEscape=m.pdfEscape=function(g,E){return Oi(g,E).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},aa=m.__private__.beginPage=function(g){Ee[++wt]=[],Ze[wt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(g[0]),topRightY:Number(g[1])}},ke(wt),_e(Ee[J])},no=function(g,E){var se,ue,ve;switch(n=E||n,typeof g=="string"&&(se=y(g.toLowerCase()),Array.isArray(se)&&(ue=se[0],ve=se[1])),Array.isArray(g)&&(ue=g[0]*Ne,ve=g[1]*Ne),isNaN(ue)&&(ue=i[0],ve=i[1]),(ue>14400||ve>14400)&&(gn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ue=Math.min(14400,ue),ve=Math.min(14400,ve)),i=[ue,ve],n.substr(0,1)){case"l":ve>ue&&(i=[ve,ue]);break;case"p":ue>ve&&(i=[ve,ue])}aa(i),Wu(hc),ae(Js),mc!==0&&ae(mc+" J"),pc!==0&&ae(pc+" j"),dt.publish("addPage",{pageNumber:wt})},ee=function(g){g>0&&g<=wt&&(Ee.splice(g,1),Ze.splice(g,1),wt--,J>wt&&(J=wt),this.setPage(J))},ke=function(g){g>0&&g<=wt&&(J=g)},Ve=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Ee.length-1},Bt=function(g,E,se){var ue,ve=void 0;return se=se||{},g=g!==void 0?g:ye[Me].fontName,E=E!==void 0?E:ye[Me].fontStyle,ue=g.toLowerCase(),Re[ue]!==void 0&&Re[ue][E]!==void 0?ve=Re[ue][E]:Re[g]!==void 0&&Re[g][E]!==void 0?ve=Re[g][E]:se.disableWarning===!1&&gn.warn("Unable to look up font label for font '"+g+"', '"+E+"'. Refer to getFontList() for available fonts."),ve||se.noFallback||(ve=Re.times[E])==null&&(ve=Re.times.normal),ve},Pt=m.__private__.putInfo=function(){var g=Sn(),E=function(ue){return ue};for(var se in f!==null&&(E=Cr.encryptor(g,0)),ae("<<"),ae("/Producer ("+vr(E("jsPDF "+Et.version))+")"),Ce)Ce.hasOwnProperty(se)&&Ce[se]&&ae("/"+se.substr(0,1).toUpperCase()+se.substr(1)+" ("+vr(E(Ce[se]))+")");ae("/CreationDate ("+vr(E(ie))+")"),ae(">>"),ae("endobj")},Rt=m.__private__.putCatalog=function(g){var E=(g=g||{}).rootDictionaryObjId||Qr;switch(Sn(),ae("<<"),ae("/Type /Catalog"),ae("/Pages "+E+" 0 R"),Ge||(Ge="fullwidth"),Ge){case"fullwidth":ae("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ae("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ae("/OpenAction [3 0 R /Fit]");break;case"original":ae("/OpenAction [3 0 R /XYZ null null 1]");break;default:var se=""+Ge;se.substr(se.length-1)==="%"&&(Ge=parseInt(Ge)/100),typeof Ge=="number"&&ae("/OpenAction [3 0 R /XYZ null null "+re(Ge)+"]")}switch(bt||(bt="continuous"),bt){case"continuous":ae("/PageLayout /OneColumn");break;case"single":ae("/PageLayout /SinglePage");break;case"two":case"twoleft":ae("/PageLayout /TwoColumnLeft");break;case"tworight":ae("/PageLayout /TwoColumnRight")}rt&&ae("/PageMode /"+rt),dt.publish("putCatalog"),ae(">>"),ae("endobj")},Jt=m.__private__.putTrailer=function(){ae("trailer"),ae("<<"),ae("/Size "+(q+1)),ae("/Root "+q+" 0 R"),ae("/Info "+(q-1)+" 0 R"),f!==null&&ae("/Encrypt "+Cr.oid+" 0 R"),ae("/ID [ <"+Q+"> <"+Q+"> ]"),ae(">>")},Tn=m.__private__.putHeader=function(){ae("%PDF-"+N),ae("%ºß¬à")},xi=m.__private__.putXRef=function(){var g="0000000000";ae("xref"),ae("0 "+(q+1)),ae("0000000000 65535 f ");for(var E=1;E<=q;E++)typeof oe[E]=="function"?ae((g+oe[E]()).slice(-10)+" 00000 n "):oe[E]!==void 0?ae((g+oe[E]).slice(-10)+" 00000 n "):ae("0000000000 00000 n ")},tn=m.__private__.buildDocument=function(){ct(),_e(fe),dt.publish("buildDocument"),Tn(),fs(),_s(),zi(),f!==null&&Ct(),Pt(),Rt();var g=ge;return xi(),Jt(),ae("startxref"),ae(""+g),ae("%%EOF"),_e(Ee[J]),fe.join(`
`)},Fr=m.__private__.getBlob=function(g){return new Blob([st(g)],{type:"application/pdf"})},oa=m.output=m.__private__.output=Xr(function(g,E){switch(typeof(E=E||{})=="string"?E={filename:E}:E.filename=E.filename||"generated.pdf",g){case void 0:return tn();case"save":m.save(E.filename);break;case"arraybuffer":return st(tn());case"blob":return Fr(tn());case"bloburi":case"bloburl":if(zt.URL!==void 0&&typeof zt.URL.createObjectURL=="function")return zt.URL&&zt.URL.createObjectURL(Fr(tn()))||void 0;gn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var se="",ue=tn();try{se=Qp(ue)}catch{se=Qp(unescape(encodeURIComponent(ue)))}return"data:application/pdf;filename="+E.filename+";base64,"+se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(zt)==="[object Window]"){var ve="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ie=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';E.pdfObjectUrl&&(ve=E.pdfObjectUrl,Ie="");var Ue='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ve+'"'+Ie+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(E)+");<\/script></body></html>",at=zt.open();return at!==null&&at.document.write(Ue),at}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(zt)==="[object Window]"){var kt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(E.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+E.filename+'" width="500px" height="400px" /></body></html>',Ut=zt.open();if(Ut!==null){Ut.document.write(kt);var $t=this;Ut.document.documentElement.querySelector("#pdfViewer").onload=function(){Ut.document.title=E.filename,Ut.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open($t.output("bloburl"))}}return Ut}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(zt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Zt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",E)+'"></iframe></body></html>',En=zt.open();if(En!==null&&(En.document.write(Zt),En.document.title=E.filename),En||typeof safari>"u")return En;break;case"datauri":case"dataurl":return zt.document.location.href=this.output("datauristring",E);default:return null}}),Fo=function(g){return Array.isArray(Xt)===!0&&Xt.indexOf(g)>-1};switch(s){case"pt":Ne=1;break;case"mm":Ne=72/25.4;break;case"cm":Ne=72/2.54;break;case"in":Ne=72;break;case"px":Ne=Fo("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ne=12;break;case"ex":Ne=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);Ne=s}var Cr=null;ce(),L();var bf=function(g){return f!==null?Cr.encryptor(g,0):function(E){return E}},Hu=m.__private__.getPageInfo=m.getPageInfo=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ze[g].objId,pageNumber:g,pageContext:Ze[g]}},Ft=m.__private__.getPageInfoByObjId=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var E in Ze)if(Ze[E].objId===g)break;return Hu(E)},wf=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:Ze[J].objId,pageNumber:J,pageContext:Ze[J]}};m.addPage=function(){return no.apply(this,arguments),this},m.setPage=function(){return ke.apply(this,arguments),_e.call(this,Ee[J]),this},m.insertPage=function(g){return this.addPage(),this.movePage(J,g),this},m.movePage=function(g,E){var se,ue;if(g>E){se=Ee[g],ue=Ze[g];for(var ve=g;ve>E;ve--)Ee[ve]=Ee[ve-1],Ze[ve]=Ze[ve-1];Ee[E]=se,Ze[E]=ue,this.setPage(E)}else if(g<E){se=Ee[g],ue=Ze[g];for(var Ie=g;Ie<E;Ie++)Ee[Ie]=Ee[Ie+1],Ze[Ie]=Ze[Ie+1];Ee[E]=se,Ze[E]=ue,this.setPage(E)}return this},m.deletePage=function(){return ee.apply(this,arguments),this},m.__private__.text=m.text=function(g,E,se,ue,ve){var Ie,Ue,at,kt,Ut,$t,Zt,En,Rn,Qn=(ue=ue||{}).scope||this;if(typeof g=="number"&&typeof E=="number"&&(typeof se=="string"||Array.isArray(se))){var kr=se;se=E,E=g,g=kr}if(arguments[3]instanceof ht?(P("The transform parameter of text() with a Matrix value"),Rn=ve):(at=arguments[4],kt=arguments[5],hn(Zt=arguments[3])==="object"&&Zt!==null||(typeof at=="string"&&(kt=at,at=null),typeof Zt=="string"&&(kt=Zt,Zt=null),typeof Zt=="number"&&(at=Zt,Zt=null),ue={flags:Zt,angle:at,align:kt})),isNaN(E)||isNaN(se)||g==null)throw new Error("Invalid arguments passed to jsPDF.text");if(g.length===0)return Qn;var cr="",Ks=!1,ms=typeof ue.lineHeightFactor=="number"?ue.lineHeightFactor:so,bi=Qn.internal.scaleFactor;function Zu(yn){return yn=yn.split("	").join(Array(ue.TabLen||9).join(" ")),vr(yn,Zt)}function bc(yn){for(var bn,Gn=yn.concat(),rr=[],Bi=Gn.length;Bi--;)typeof(bn=Gn.shift())=="string"?rr.push(bn):Array.isArray(yn)&&(bn.length===1||bn[1]===void 0&&bn[2]===void 0)?rr.push(bn[0]):rr.push([bn[0],bn[1],bn[2]]);return rr}function wc(yn,bn){var Gn;if(typeof yn=="string")Gn=bn(yn)[0];else if(Array.isArray(yn)){for(var rr,Bi,Pc=yn.concat(),el=[],sd=Pc.length;sd--;)typeof(rr=Pc.shift())=="string"?el.push(bn(rr)[0]):Array.isArray(rr)&&typeof rr[0]=="string"&&(Bi=bn(rr[0],rr[1],rr[2]),el.push([Bi[0],Bi[1],Bi[2]]));Gn=el}return Gn}var Vo=!1,Nc=!0;if(typeof g=="string")Vo=!0;else if(Array.isArray(g)){var jc=g.concat();Ue=[];for(var Go,yr=jc.length;yr--;)(typeof(Go=jc.shift())!="string"||Array.isArray(Go)&&typeof Go[0]!="string")&&(Nc=!1);Vo=Nc}if(Vo===!1)throw new Error('Type of text must be string or Array. "'+g+'" is not recognized.');typeof g=="string"&&(g=g.match(/[\r?\n]/)?g.split(/\r\n|\r|\n/g):[g]);var Wo=Ye/Qn.internal.scaleFactor,Jo=Wo*(ms-1);switch(ue.baseline){case"bottom":se-=Jo;break;case"top":se+=Wo-Jo;break;case"hanging":se+=Wo-2*Jo;break;case"middle":se+=Wo/2-Jo}if(($t=ue.maxWidth||0)>0&&(typeof g=="string"?g=Qn.splitTextToSize(g,$t):Object.prototype.toString.call(g)==="[object Array]"&&(g=g.reduce(function(yn,bn){return yn.concat(Qn.splitTextToSize(bn,$t))},[]))),Ie={text:g,x:E,y:se,options:ue,mutex:{pdfEscape:vr,activeFontKey:Me,fonts:ye,activeFontSize:Ye}},dt.publish("preProcessText",Ie),g=Ie.text,at=(ue=Ie.options).angle,!(Rn instanceof ht)&&at&&typeof at=="number"){at*=Math.PI/180,ue.rotationDirection===0&&(at=-at),j===b.ADVANCED&&(at=-at);var Ko=Math.cos(at),Sc=Math.sin(at);Rn=new ht(Ko,Sc,-Sc,Ko,0,0)}else at&&at instanceof ht&&(Rn=at);j!==b.ADVANCED||Rn||(Rn=Mn),(Ut=ue.charSpace||qo)!==void 0&&(cr+=K(C(Ut))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(En=ue.horizontalScale)!==void 0&&(cr+=K(100*En)+` Tz
`),ue.lang;var Zr=-1,If=ue.renderingMode!==void 0?ue.renderingMode:ue.stroke,_c=Qn.internal.getCurrentPageInfo().pageContext;switch(If){case 0:case!1:case"fill":Zr=0;break;case 1:case!0:case"stroke":Zr=1;break;case 2:case"fillThenStroke":Zr=2;break;case 3:case"invisible":Zr=3;break;case 4:case"fillAndAddForClipping":Zr=4;break;case 5:case"strokeAndAddPathForClipping":Zr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Zr=6;break;case 7:case"addToPathForClipping":Zr=7}var ed=_c.usedRenderingMode!==void 0?_c.usedRenderingMode:-1;Zr!==-1?cr+=Zr+` Tr
`:ed!==-1&&(cr+=`0 Tr
`),Zr!==-1&&(_c.usedRenderingMode=Zr),kt=ue.align||"left";var Cs,Yo=Ye*ms,td=Qn.internal.pageSize.getWidth(),nd=ye[Me];Ut=ue.charSpace||qo,$t=ue.maxWidth||0,Zt=Object.assign({autoencode:!0,noBOM:!0},ue.flags);var da=[],oo=function(yn){return Qn.getStringUnitWidth(yn,{font:nd,charSpace:Ut,fontSize:Ye,doKerning:!1})*Ye/bi};if(Object.prototype.toString.call(g)==="[object Array]"){var es;Ue=bc(g),kt!=="left"&&(Cs=Ue.map(oo));var Br,ha=0;if(kt==="right"){E-=Cs[0],g=[],yr=Ue.length;for(var Mi=0;Mi<yr;Mi++)Mi===0?(Br=yi(E),es=Di(se)):(Br=C(ha-Cs[Mi]),es=-Yo),g.push([Ue[Mi],Br,es]),ha=Cs[Mi]}else if(kt==="center"){E-=Cs[0]/2,g=[],yr=Ue.length;for(var Ri=0;Ri<yr;Ri++)Ri===0?(Br=yi(E),es=Di(se)):(Br=C((ha-Cs[Ri])/2),es=-Yo),g.push([Ue[Ri],Br,es]),ha=Cs[Ri]}else if(kt==="left"){g=[],yr=Ue.length;for(var Qo=0;Qo<yr;Qo++)g.push(Ue[Qo])}else if(kt==="justify"&&nd.encoding==="Identity-H"){g=[],yr=Ue.length,$t=$t!==0?$t:td;for(var Fi=0,Vn=0;Vn<yr;Vn++)if(es=Vn===0?Di(se):-Yo,Br=Vn===0?yi(E):Fi,Vn<yr-1){var Cc=C(($t-Cs[Vn])/(Ue[Vn].split(" ").length-1)),$r=Ue[Vn].split(" ");g.push([$r[0]+" ",Br,es]),Fi=0;for(var ks=1;ks<$r.length;ks++){var Xo=(oo($r[ks-1]+" "+$r[ks])-oo($r[ks]))*bi+Cc;ks==$r.length-1?g.push([$r[ks],Xo,0]):g.push([$r[ks]+" ",Xo,0]),Fi-=Xo}}else g.push([Ue[Vn],Br,es]);g.push(["",Fi,0])}else{if(kt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(g=[],yr=Ue.length,$t=$t!==0?$t:td,Vn=0;Vn<yr;Vn++)es=Vn===0?Di(se):-Yo,Br=Vn===0?yi(E):0,Vn<yr-1?da.push(K(C(($t-Cs[Vn])/(Ue[Vn].split(" ").length-1)))):da.push(0),g.push([Ue[Vn],Br,es])}}var rd=typeof ue.R2L=="boolean"?ue.R2L:it;rd===!0&&(g=wc(g,function(yn,bn,Gn){return[yn.split("").reverse().join(""),bn,Gn]})),Ie={text:g,x:E,y:se,options:ue,mutex:{pdfEscape:vr,activeFontKey:Me,fonts:ye,activeFontSize:Ye}},dt.publish("postProcessText",Ie),g=Ie.text,Ks=Ie.mutex.isHex||!1;var kc=ye[Me].encoding;kc!=="WinAnsiEncoding"&&kc!=="StandardEncoding"||(g=wc(g,function(yn,bn,Gn){return[Zu(yn),bn,Gn]})),Ue=bc(g),g=[];for(var lo,co,fa,uo=0,Zo=1,ho=Array.isArray(Ue[0])?Zo:uo,ma="",Ac=function(yn,bn,Gn){var rr="";return Gn instanceof ht?(Gn=typeof ue.angle=="number"?_t(Gn,new ht(1,0,0,1,yn,bn)):_t(new ht(1,0,0,1,yn,bn),Gn),j===b.ADVANCED&&(Gn=_t(new ht(1,0,0,-1,0,0),Gn)),rr=Gn.join(" ")+` Tm
`):rr=K(yn)+" "+K(bn)+` Td
`,rr},As=0;As<Ue.length;As++){switch(ma="",ho){case Zo:fa=(Ks?"<":"(")+Ue[As][0]+(Ks?">":")"),lo=parseFloat(Ue[As][1]),co=parseFloat(Ue[As][2]);break;case uo:fa=(Ks?"<":"(")+Ue[As]+(Ks?">":")"),lo=yi(E),co=Di(se)}da!==void 0&&da[As]!==void 0&&(ma=da[As]+` Tw
`),As===0?g.push(ma+Ac(lo,co,Rn)+fa):ho===uo?g.push(ma+fa):ho===Zo&&g.push(ma+Ac(lo,co,Rn)+fa)}g=ho===uo?g.join(` Tj
T* `):g.join(` Tj
`),g+=` Tj
`;var Ps=`BT
/`;return Ps+=Me+" "+Ye+` Tf
`,Ps+=K(Ye*ms)+` TL
`,Ps+=io+`
`,Ps+=cr,Ps+=g,ae(Ps+="ET"),v[Me]=!0,Qn};var Nf=m.__private__.clip=m.clip=function(g){return ae(g==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return Nf("evenodd")},m.__private__.discardPath=m.discardPath=function(){return ae("n"),this};var vi=m.__private__.isValidStyle=function(g){var E=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(g)!==-1&&(E=!0),E};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(g){return vi(g)&&(d=g),this};var Vu=m.__private__.getStyle=m.getStyle=function(g){var E=d;switch(g){case"D":case"S":E="S";break;case"F":E="f";break;case"FD":case"DF":E="B";break;case"f":case"f*":case"B":case"B*":E=g}return E},Gu=m.close=function(){return ae("h"),this};m.stroke=function(){return ae("S"),this},m.fill=function(g){return Bo("f",g),this},m.fillEvenOdd=function(g){return Bo("f*",g),this},m.fillStroke=function(g){return Bo("B",g),this},m.fillStrokeEvenOdd=function(g){return Bo("B*",g),this};var Bo=function(g,E){hn(E)==="object"?Sf(E,g):ae(g)},uc=function(g){g===null||j===b.ADVANCED&&g===void 0||(g=Vu(g),ae(g))};function jf(g,E,se,ue,ve){var Ie=new Ol(E||this.boundingBox,se||this.xStep,ue||this.yStep,this.gState,ve||this.matrix);Ie.stream=this.stream;var Ue=g+"$$"+this.cloneIndex+++"$$";return Pn(Ue,Ie),Ie}var Sf=function(g,E){var se=jt[g.key],ue=vt[se];if(ue instanceof wo)ae("q"),ae(_f(E)),ue.gState&&m.setGState(ue.gState),ae(g.matrix.toString()+" cm"),ae("/"+se+" sh"),ae("Q");else if(ue instanceof Ol){var ve=new ht(1,0,0,-1,0,ua());g.matrix&&(ve=ve.multiply(g.matrix||Mn),se=jf.call(ue,g.key,g.boundingBox,g.xStep,g.yStep,ve).id),ae("q"),ae("/Pattern cs"),ae("/"+se+" scn"),ue.gState&&m.setGState(ue.gState),ae(E),ae("Q")}},_f=function(g){switch(g){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},dc=m.moveTo=function(g,E){return ae(K(C(g))+" "+K(V(E))+" m"),this},ro=m.lineTo=function(g,E){return ae(K(C(g))+" "+K(V(E))+" l"),this},la=m.curveTo=function(g,E,se,ue,ve,Ie){return ae([K(C(g)),K(V(E)),K(C(se)),K(V(ue)),K(C(ve)),K(V(Ie)),"c"].join(" ")),this};m.__private__.line=m.line=function(g,E,se,ue,ve){if(isNaN(g)||isNaN(E)||isNaN(se)||isNaN(ue)||!vi(ve))throw new Error("Invalid arguments passed to jsPDF.line");return j===b.COMPAT?this.lines([[se-g,ue-E]],g,E,[1,1],ve||"S"):this.lines([[se-g,ue-E]],g,E,[1,1]).stroke()},m.__private__.lines=m.lines=function(g,E,se,ue,ve,Ie){var Ue,at,kt,Ut,$t,Zt,En,Rn,Qn,kr,cr,Ks;if(typeof g=="number"&&(Ks=se,se=E,E=g,g=Ks),ue=ue||[1,1],Ie=Ie||!1,isNaN(E)||isNaN(se)||!Array.isArray(g)||!Array.isArray(ue)||!vi(ve)||typeof Ie!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(dc(E,se),Ue=ue[0],at=ue[1],Ut=g.length,kr=E,cr=se,kt=0;kt<Ut;kt++)($t=g[kt]).length===2?(kr=$t[0]*Ue+kr,cr=$t[1]*at+cr,ro(kr,cr)):(Zt=$t[0]*Ue+kr,En=$t[1]*at+cr,Rn=$t[2]*Ue+kr,Qn=$t[3]*at+cr,kr=$t[4]*Ue+kr,cr=$t[5]*at+cr,la(Zt,En,Rn,Qn,kr,cr));return Ie&&Gu(),uc(ve),this},m.path=function(g){for(var E=0;E<g.length;E++){var se=g[E],ue=se.c;switch(se.op){case"m":dc(ue[0],ue[1]);break;case"l":ro(ue[0],ue[1]);break;case"c":la.apply(this,ue);break;case"h":Gu()}}return this},m.__private__.rect=m.rect=function(g,E,se,ue,ve){if(isNaN(g)||isNaN(E)||isNaN(se)||isNaN(ue)||!vi(ve))throw new Error("Invalid arguments passed to jsPDF.rect");return j===b.COMPAT&&(ue=-ue),ae([K(C(g)),K(V(E)),K(C(se)),K(C(ue)),"re"].join(" ")),uc(ve),this},m.__private__.triangle=m.triangle=function(g,E,se,ue,ve,Ie,Ue){if(isNaN(g)||isNaN(E)||isNaN(se)||isNaN(ue)||isNaN(ve)||isNaN(Ie)||!vi(Ue))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[se-g,ue-E],[ve-se,Ie-ue],[g-ve,E-Ie]],g,E,[1,1],Ue,!0),this},m.__private__.roundedRect=m.roundedRect=function(g,E,se,ue,ve,Ie,Ue){if(isNaN(g)||isNaN(E)||isNaN(se)||isNaN(ue)||isNaN(ve)||isNaN(Ie)||!vi(Ue))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var at=4/3*(Math.SQRT2-1);return ve=Math.min(ve,.5*se),Ie=Math.min(Ie,.5*ue),this.lines([[se-2*ve,0],[ve*at,0,ve,Ie-Ie*at,ve,Ie],[0,ue-2*Ie],[0,Ie*at,-ve*at,Ie,-ve,Ie],[2*ve-se,0],[-ve*at,0,-ve,-Ie*at,-ve,-Ie],[0,2*Ie-ue],[0,-Ie*at,ve*at,-Ie,ve,-Ie]],g+ve,E,[1,1],Ue,!0),this},m.__private__.ellipse=m.ellipse=function(g,E,se,ue,ve){if(isNaN(g)||isNaN(E)||isNaN(se)||isNaN(ue)||!vi(ve))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ie=4/3*(Math.SQRT2-1)*se,Ue=4/3*(Math.SQRT2-1)*ue;return dc(g+se,E),la(g+se,E-Ue,g+Ie,E-ue,g,E-ue),la(g-Ie,E-ue,g-se,E-Ue,g-se,E),la(g-se,E+Ue,g-Ie,E+ue,g,E+ue),la(g+Ie,E+ue,g+se,E+Ue,g+se,E),uc(ve),this},m.__private__.circle=m.circle=function(g,E,se,ue){if(isNaN(g)||isNaN(E)||isNaN(se)||!vi(ue))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(g,E,se,se,ue)},m.setFont=function(g,E,se){return se&&(E=Z(E,se)),Me=Bt(g,E,{disableWarning:!1}),this};var Cf=m.__private__.getFont=m.getFont=function(){return ye[Bt.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var g,E,se={};for(g in Re)if(Re.hasOwnProperty(g))for(E in se[g]=[],Re[g])Re[g].hasOwnProperty(E)&&se[g].push(E);return se},m.addFont=function(g,E,se,ue,ve){var Ie=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ie.indexOf(arguments[3])!==-1?ve=arguments[3]:arguments[3]&&Ie.indexOf(arguments[3])==-1&&(se=Z(se,ue)),ve=ve||"Identity-H",Ws.call(this,g,E,se,ve)};var so,hc=t.lineWidth||.200025,$o=m.__private__.getLineWidth=m.getLineWidth=function(){return hc},Wu=m.__private__.setLineWidth=m.setLineWidth=function(g){return hc=g,ae(K(C(g))+" w"),this};m.__private__.setLineDash=Et.API.setLineDash=Et.API.setLineDashPattern=function(g,E){if(g=g||[],E=E||0,isNaN(E)||!Array.isArray(g))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return g=g.map(function(se){return K(C(se))}).join(" "),E=K(C(E)),ae("["+g+"] "+E+" d"),this};var Ju=m.__private__.getLineHeight=m.getLineHeight=function(){return Ye*so};m.__private__.getLineHeight=m.getLineHeight=function(){return Ye*so};var Ku=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(g){return typeof(g=g||1.15)=="number"&&(so=g),this},Yu=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return so};Ku(t.lineHeight);var yi=m.__private__.getHorizontalCoordinate=function(g){return C(g)},Di=m.__private__.getVerticalCoordinate=function(g){return j===b.ADVANCED?g:Ze[J].mediaBox.topRightY-Ze[J].mediaBox.bottomLeftY-C(g)},kf=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(g){return K(yi(g))},ca=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(g){return K(Di(g))},Js=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Ln(Js)},m.__private__.setStrokeColor=m.setDrawColor=function(g,E,se,ue){return Js=xr({ch1:g,ch2:E,ch3:se,ch4:ue,pdfColorType:"draw",precision:2}),ae(Js),this};var fc=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Ln(fc)},m.__private__.setFillColor=m.setFillColor=function(g,E,se,ue){return fc=xr({ch1:g,ch2:E,ch3:se,ch4:ue,pdfColorType:"fill",precision:2}),ae(fc),this};var io=t.textColor||"0 g",Af=m.__private__.getTextColor=m.getTextColor=function(){return Ln(io)};m.__private__.setTextColor=m.setTextColor=function(g,E,se,ue){return io=xr({ch1:g,ch2:E,ch3:se,ch4:ue,pdfColorType:"text",precision:3}),this};var qo=t.charSpace,Pf=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(qo||0)};m.__private__.setCharSpace=m.setCharSpace=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return qo=g,this};var mc=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(g){var E=m.CapJoinStyles[g];if(E===void 0)throw new Error("Line cap style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return mc=E,ae(E+" J"),this};var pc=0;m.__private__.setLineJoin=m.setLineJoin=function(g){var E=m.CapJoinStyles[g];if(E===void 0)throw new Error("Line join style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pc=E,ae(E+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(g){if(g=g||0,isNaN(g))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ae(K(C(g))+" M"),this},m.GState=Vh,m.setGState=function(g){(g=typeof g=="string"?Ot[en[g]]:Qu(null,g)).equals(It)||(ae("/"+g.id+" gs"),It=g)};var Qu=function(g,E){if(!g||!en[g]){var se=!1;for(var ue in Ot)if(Ot.hasOwnProperty(ue)&&Ot[ue].equals(E)){se=!0;break}if(se)E=Ot[ue];else{var ve="GS"+(Object.keys(Ot).length+1).toString(10);Ot[ve]=E,E.id=ve}return g&&(en[g]=E.id),dt.publish("addGState",E),E}};m.addGState=function(g,E){return Qu(g,E),this},m.saveGraphicsState=function(){return ae("q"),xt.push({key:Me,size:Ye,color:io}),this},m.restoreGraphicsState=function(){ae("Q");var g=xt.pop();return Me=g.key,Ye=g.size,io=g.color,It=null,this},m.setCurrentTransformationMatrix=function(g){return ae(g.toString()+" cm"),this},m.comment=function(g){return ae("#"+g),this};var Uo=function(g,E){var se=g||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return se},set:function(Ie){isNaN(Ie)||(se=parseFloat(Ie))}});var ue=E||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ue},set:function(Ie){isNaN(Ie)||(ue=parseFloat(Ie))}});var ve="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ve},set:function(Ie){ve=Ie.toString()}}),this},gc=function(g,E,se,ue){Uo.call(this,g,E),this.type="rect";var ve=se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ve},set:function(Ue){isNaN(Ue)||(ve=parseFloat(Ue))}});var Ie=ue||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ie},set:function(Ue){isNaN(Ue)||(Ie=parseFloat(Ue))}}),this},xc=function(){this.page=wt,this.currentPage=J,this.pages=Ee.slice(0),this.pagesContext=Ze.slice(0),this.x=gt,this.y=et,this.matrix=ut,this.width=ao(J),this.height=ua(J),this.outputDestination=qe,this.id="",this.objectNumber=-1};xc.prototype.restore=function(){wt=this.page,J=this.currentPage,Ze=this.pagesContext,Ee=this.pages,gt=this.x,et=this.y,ut=this.matrix,vc(J,this.width),yc(J,this.height),qe=this.outputDestination};var Xu=function(g,E,se,ue,ve){an.push(new xc),wt=J=0,Ee=[],gt=g,et=E,ut=ve,aa([se,ue])},Lf=function(g){if(Mt[g])an.pop().restore();else{var E=new xc,se="Xo"+(Object.keys(Dt).length+1).toString(10);E.id=se,Mt[g]=se,Dt[se]=E,dt.publish("addFormObject",E),an.pop().restore()}};for(var Ho in m.beginFormObject=function(g,E,se,ue,ve){return Xu(g,E,se,ue,ve),this},m.endFormObject=function(g){return Lf(g),this},m.doFormObject=function(g,E){var se=Dt[Mt[g]];return ae("q"),ae(E.toString()+" cm"),ae("/"+se.id+" Do"),ae("Q"),this},m.getFormObject=function(g){var E=Dt[Mt[g]];return{x:E.x,y:E.y,width:E.width,height:E.height,matrix:E.matrix}},m.save=function(g,E){return g=g||"generated.pdf",(E=E||{}).returnPromise=E.returnPromise||!1,E.returnPromise===!1?(yo(Fr(tn()),g),typeof yo.unload=="function"&&zt.setTimeout&&setTimeout(yo.unload,911),this):new Promise(function(se,ue){try{var ve=yo(Fr(tn()),g);typeof yo.unload=="function"&&zt.setTimeout&&setTimeout(yo.unload,911),se(ve)}catch(Ie){ue(Ie.message)}})},Et.API)Et.API.hasOwnProperty(Ho)&&(Ho==="events"&&Et.API.events.length?function(g,E){var se,ue,ve;for(ve=E.length-1;ve!==-1;ve--)se=E[ve][0],ue=E[ve][1],g.subscribe.apply(g,[se].concat(typeof ue=="function"?[ue]:ue))}(dt,Et.API.events):m[Ho]=Et.API[Ho]);var ao=m.getPageWidth=function(g){return(Ze[g=g||J].mediaBox.topRightX-Ze[g].mediaBox.bottomLeftX)/Ne},vc=m.setPageWidth=function(g,E){Ze[g].mediaBox.topRightX=E*Ne+Ze[g].mediaBox.bottomLeftX},ua=m.getPageHeight=function(g){return(Ze[g=g||J].mediaBox.topRightY-Ze[g].mediaBox.bottomLeftY)/Ne},yc=m.setPageHeight=function(g,E){Ze[g].mediaBox.topRightY=E*Ne+Ze[g].mediaBox.bottomLeftY};return m.internal={pdfEscape:vr,getStyle:Vu,getFont:Cf,getFontSize:He,getCharSpace:Pf,getTextColor:Af,getLineHeight:Ju,getLineHeightFactor:Yu,getLineWidth:$o,write:St,getHorizontalCoordinate:yi,getVerticalCoordinate:Di,getCoordinateString:kf,getVerticalCoordinateString:ca,collections:{},newObject:Sn,newAdditionalObject:fi,newObjectDeferred:vn,newObjectDeferredBegin:gr,getFilters:nr,putStream:_r,events:dt,scaleFactor:Ne,pageSize:{getWidth:function(){return ao(J)},setWidth:function(g){vc(J,g)},getHeight:function(){return ua(J)},setHeight:function(g){yc(J,g)}},encryptionOptions:f,encryption:Cr,getEncryptor:bf,output:oa,getNumberOfPages:Ve,pages:Ee,out:ae,f2:re,f3:A,getPageInfo:Hu,getPageInfoByObjId:Ft,getCurrentPageInfo:wf,getPDFVersion:S,Point:Uo,Rectangle:gc,Matrix:ht,hasHotfix:Fo},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return ao(J)},set:function(g){vc(J,g)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return ua(J)},set:function(g){yc(J,g)},enumerable:!0,configurable:!0}),Ro.call(m,$e),Me="F1",no(i,n),dt.publish("initialized"),m}bl.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},bl.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},bl.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},bl.prototype.processOwnerPassword=function(t,e){return Zp(Xp(e).substr(0,5),t)},bl.prototype.encryptor=function(t,e){var n=Xp(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(s){return Zp(n,s)}},Vh.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||hn(t)!==hn(this))return!1;var s=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;s++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&s--;return s===0},Et.API={events:[]},Et.version="3.0.1";var $n=Et.API,o0=1,Mo=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hl=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},qt=function(t){return t.toFixed(2)},_a=function(t){return t.toFixed(5)};$n.__acroform__={};var hs=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},Sx=function(t){return t*o0},Si=function(t){var e=new Vy,n=pt.internal.getHeight(t)||0,s=pt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(qt(s)),Number(qt(n))],e},BS=$n.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},$S=$n.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},qS=$n.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Jn=$n.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return qS(t,e-1)},Kn=$n.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return BS(t,e-1)},Yn=$n.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return $S(t,e-1)},US=$n.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,s=e.internal.getVerticalCoordinate,i=t[0],a=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=n(i)||0,c.lowerLeft_Y=s(a+l)||0,c.upperRight_X=n(i+o)||0,c.upperRight_Y=s(a)||0,[Number(qt(c.lowerLeft_X)),Number(qt(c.lowerLeft_Y)),Number(qt(c.upperRight_X)),Number(qt(c.upperRight_Y))]},HS=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,s=eg(t,n),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+qt(s.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(s.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=Si(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},eg=function(t,e){var n=t.fontSize===0?t.maxFontSize:t.fontSize,s={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(A){return A.split(`
`)}):i.map(function(A){return[A]});var a=n,o=pt.internal.getHeight(t)||0;o=o<0?-o:o;var l=pt.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(A,C,R){if(A+1<i.length){var V=C+" "+i[A+1][0];return Yd(V,t,R).width<=l-4}return!1};a++;e:for(;a>0;){e="",a--;var d,f,p=Yd("3",t,a).height,v=t.multiline?o-a:(o-p)/2,m=v+=2,N=0,S=0,k=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+Yd(e,t,a=12).width+", FieldWidth:"+l+`
`;break}for(var y="",b=0,j=0;j<i.length;j++)if(i.hasOwnProperty(j)){var z=!1;if(i[j].length!==1&&k!==i[j].length-1){if((p+2)*(b+2)+2>o)continue e;y+=i[j][k],z=!0,S=j,j--}else{y=(y+=i[j][k]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var H=parseInt(j),Z=c(H,y,a),K=j>=i.length-1;if(Z&&!K){y+=" ",k=0;continue}if(Z||K){if(K)S=H;else if(t.multiline&&(p+2)*(b+2)+2>o)continue e}else{if(!t.multiline||(p+2)*(b+2)+2>o)continue e;S=H}}for(var P="",$=N;$<=S;$++){var re=i[$];if(t.multiline){if($===S){P+=re[k]+" ",k=(k+1)%re.length;continue}if($===N){P+=re[re.length-1]+" ";continue}}P+=re[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,f=Yd(P,t,a).width,t.textAlign){case"right":d=l-f-2;break;case"center":d=(l-f)/2;break;case"left":default:d=2}e+=qt(d)+" "+qt(m)+` Td
`,e+="("+Mo(P)+`) Tj
`,e+=-qt(d)+` 0 Td
`,m=-(a+2),f=0,N=z?S:S+1,b++,y=""}break}return s.text=e,s.fontSize=a,s},Yd=function(t,e,n){var s=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:s,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},VS={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},GS=function(t,e){var n={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(s){return s.type===n.type&&s.object===n.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},WS=function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var s=n,i=t[n];e.internal.newObjectDeferredBegin(i.objId,!0),hn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[s]}},JS=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(di.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(VS)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");o0=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Gy,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in s)if(s.hasOwnProperty(i)){var a=s[i];a.objId=void 0,a.hasAnnotation&&GS(a,n)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(n){(function(s,i){var a=!s;for(var o in s||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(o)){var l=s[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=US(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=pt.createDefaultAppearanceStream(l),hn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var f=HS(l);c.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(l.appearanceStreamContent){var p="";for(var v in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(v)){var m=l.appearanceStreamContent[v];if(p+="/"+v+" ",p+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var N=m[o];typeof N=="function"&&(N=N.call(i,l)),p+="/"+o+" "+N+" ",i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N)}}else typeof(N=m)=="function"&&(N=N.call(i,l)),p+="/"+o+" "+N,i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}a&&WS(i.internal.acroformPlugin.xForms,i)})(n,t)}),t.internal.acroformPlugin.isInitialized=!0}},Hy=$n.__acroform__.arrayToPdfArray=function(t,e,n){var s=function(o){return o};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),hn(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&n&&(s=n.internal.getEncryptor(e)),i+="("+Mo(s(t[a].toString()))+")"):i+=t[a].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Dm=function(t,e,n){var s=function(i){return i};return e!==void 0&&n&&(s=n.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Mo(s(t))+")"},Pi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Pi.prototype.toString=function(){return this.objId+" 0 R"},Pi.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Pi.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var s=e[n],i=this[s];i&&(Array.isArray(i)?t.push({key:s,value:Hy(i,this.objId,this.scope)}):i instanceof Pi?(i.scope=this.scope,t.push({key:s,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:s,value:i}))}return t};var Vy=function(){Pi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){t=n.trim()},get:function(){return t||null}})};hs(Vy,Pi);var Gy=function(){Pi.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var n=function(s){return s};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Mo(n(t))+")"}},set:function(n){t=n}})};hs(Gy,Pi);var di=function t(){Pi.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');e=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Jn(e,3)},set:function(y){y?this.F=Kn(e,3):this.F=Yn(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');n=y}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(y){s=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(y){s[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(y){s[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(y){s[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(y){s[3]=y}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Gh)return;a="FieldObject"+t.FieldNum++}var y=function(b){return b};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+Mo(y(a))+")"},set:function(y){a=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(y){a=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/o0:d},set:function(y){d=y}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(y){f=y}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof Gh||this instanceof Ao))return Dm(p,this.objId,this.scope)},set:function(y){y=y.toString(),p=y}});var v=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof mr?v:Dm(v,this.objId,this.scope)},set:function(y){y=y.toString(),v=this instanceof mr?y:y.substr(0,1)==="("?hl(y.substr(1,y.length-2)):hl(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mr?hl(v.substr(1,v.length-1)):v},set:function(y){y=y.toString(),v=this instanceof mr?"/"+y:y}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof mr?m:Dm(m,this.objId,this.scope)},set:function(y){y=y.toString(),m=this instanceof mr?y:y.substr(0,1)==="("?hl(y.substr(1,y.length-2)):hl(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mr?hl(m.substr(1,m.length-1)):m},set:function(y){y=y.toString(),m=this instanceof mr?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var N,S=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return S},set:function(y){y=!!y,S=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(N)return N},set:function(y){N=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,1)},set:function(y){y?this.Ff=Kn(this.Ff,1):this.Ff=Yn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,2)},set:function(y){y?this.Ff=Kn(this.Ff,2):this.Ff=Yn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,3)},set:function(y){y?this.Ff=Kn(this.Ff,3):this.Ff=Yn(this.Ff,3)}});var k=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(k!==null)return k},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');k=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(k){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:k=2;break;case"center":case 1:k=1;break;case"left":case 0:default:k=0}}})};hs(di,Pi);var ql=function(){di.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){t=n}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Hy(e,this.objId,this.scope)},set:function(n){var s,i;i=[],typeof(s=n)=="string"&&(i=function(a,o,l){l||(l=1);for(var c,d=[];c=o.exec(a);)d.push(c[l]);return d}(s,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(n){e=n,this.sort&&e.sort()},this.addOption=function(n){n=(n=n||"").toString(),e.push(n),this.sort&&e.sort()},this.removeOption=function(n,s){for(s=s||!1,n=(n=n||"").toString();e.indexOf(n)!==-1&&(e.splice(e.indexOf(n),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,18)},set:function(n){n?this.Ff=Kn(this.Ff,18):this.Ff=Yn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Kn(this.Ff,19):this.Ff=Yn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,20)},set:function(n){n?(this.Ff=Kn(this.Ff,20),e.sort()):this.Ff=Yn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,22)},set:function(n){n?this.Ff=Kn(this.Ff,22):this.Ff=Yn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,23)},set:function(n){n?this.Ff=Kn(this.Ff,23):this.Ff=Yn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,27)},set:function(n){n?this.Ff=Kn(this.Ff,27):this.Ff=Yn(this.Ff,27)}}),this.hasAppearanceStream=!1};hs(ql,di);var Ul=function(){ql.call(this),this.fontName="helvetica",this.combo=!1};hs(Ul,ql);var Hl=function(){Ul.call(this),this.combo=!0};hs(Hl,Ul);var fh=function(){Hl.call(this),this.edit=!0};hs(fh,Hl);var mr=function(){di.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,15)},set:function(n){n?this.Ff=Kn(this.Ff,15):this.Ff=Yn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,16)},set:function(n){n?this.Ff=Kn(this.Ff,16):this.Ff=Yn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,17)},set:function(n){n?this.Ff=Kn(this.Ff,17):this.Ff=Yn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,26)},set:function(n){n?this.Ff=Kn(this.Ff,26):this.Ff=Yn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var s,i=[];for(s in i.push("<<"),e)i.push("/"+s+" ("+Mo(n(e[s]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){hn(n)==="object"&&(e=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(n){typeof n=="string"&&(e.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}})};hs(mr,di);var mh=function(){mr.call(this),this.pushButton=!0};hs(mh,mr);var Vl=function(){mr.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};hs(Vl,mr);var Gh=function(){var t,e;di.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var n,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),s)o.push("/"+a+" ("+Mo(i(s[a]))+")");return o.push(">>"),o.join(`
`)},set:function(i){hn(i)==="object"&&(s=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(i){typeof i=="string"&&(s.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=pt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};hs(Gh,di),Vl.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},Vl.prototype.createOption=function(t){var e=new Gh;return e.Parent=this,e.optionName=t,this.Kids.push(e),KS.call(this.scope,e),e};var ph=function(){mr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=pt.CheckBox.createAppearanceStream()};hs(ph,mr);var Ao=function(){di.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,13)},set:function(e){e?this.Ff=Kn(this.Ff,13):this.Ff=Yn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,21)},set:function(e){e?this.Ff=Kn(this.Ff,21):this.Ff=Yn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,23)},set:function(e){e?this.Ff=Kn(this.Ff,23):this.Ff=Yn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,24)},set:function(e){e?this.Ff=Kn(this.Ff,24):this.Ff=Yn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,25)},set:function(e){e?this.Ff=Kn(this.Ff,25):this.Ff=Yn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,26)},set:function(e){e?this.Ff=Kn(this.Ff,26):this.Ff=Yn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};hs(Ao,di);var gh=function(){Ao.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Jn(this.Ff,14)},set:function(t){t?this.Ff=Kn(this.Ff,14):this.Ff=Yn(this.Ff,14)}}),this.password=!0};hs(gh,Ao);var pt={CheckBox:{createAppearanceStream:function(){return{N:{On:pt.CheckBox.YesNormal},D:{On:pt.CheckBox.YesPushDown,Off:pt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Si(t);e.scope=t.scope;var n=[],s=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=eg(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+qt(pt.internal.getWidth(t))+" "+qt(pt.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+s+" "+qt(a.fontSize)+" Tf "+i),n.push("BT"),n.push(a.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t){var e=Si(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),i=[],a=pt.internal.getHeight(t),o=pt.internal.getWidth(t),l=eg(t,t.caption);return i.push("1 g"),i.push("0 0 "+qt(o)+" "+qt(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+qt(o-1)+" "+qt(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+qt(l.fontSize)+" Tf "+s),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Si(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+qt(pt.internal.getWidth(t))+" "+qt(pt.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:pt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=pt.RadioButton.Circle.YesNormal,e.D[t]=pt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Si(t);e.scope=t.scope;var n=[],s=pt.internal.getWidth(t)<=pt.internal.getHeight(t)?pt.internal.getWidth(t)/4:pt.internal.getHeight(t)/4;s=Number((.9*s).toFixed(5));var i=pt.internal.Bezier_C,a=Number((s*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+_a(pt.internal.getWidth(t)/2)+" "+_a(pt.internal.getHeight(t)/2)+" cm"),n.push(s+" 0 m"),n.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),n.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),n.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),n.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Si(t);e.scope=t.scope;var n=[],s=pt.internal.getWidth(t)<=pt.internal.getHeight(t)?pt.internal.getWidth(t)/4:pt.internal.getHeight(t)/4;s=Number((.9*s).toFixed(5));var i=Number((2*s).toFixed(5)),a=Number((i*pt.internal.Bezier_C).toFixed(5)),o=Number((s*pt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+_a(pt.internal.getWidth(t)/2)+" "+_a(pt.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+_a(pt.internal.getWidth(t)/2)+" "+_a(pt.internal.getHeight(t)/2)+" cm"),n.push(s+" 0 m"),n.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),n.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),n.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),n.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Si(t);e.scope=t.scope;var n=[],s=pt.internal.getWidth(t)<=pt.internal.getHeight(t)?pt.internal.getWidth(t)/4:pt.internal.getHeight(t)/4;s=Number((.9*s).toFixed(5));var i=Number((2*s).toFixed(5)),a=Number((i*pt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+_a(pt.internal.getWidth(t)/2)+" "+_a(pt.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:pt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=pt.RadioButton.Cross.YesNormal,e.D[t]=pt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Si(t);e.scope=t.scope;var n=[],s=pt.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+qt(pt.internal.getWidth(t)-2)+" "+qt(pt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(qt(s.x1.x)+" "+qt(s.x1.y)+" m"),n.push(qt(s.x2.x)+" "+qt(s.x2.y)+" l"),n.push(qt(s.x4.x)+" "+qt(s.x4.y)+" m"),n.push(qt(s.x3.x)+" "+qt(s.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t){var e=Si(t);e.scope=t.scope;var n=pt.internal.calculateCross(t),s=[];return s.push("0.749023 g"),s.push("0 0 "+qt(pt.internal.getWidth(t))+" "+qt(pt.internal.getHeight(t))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+qt(pt.internal.getWidth(t)-2)+" "+qt(pt.internal.getHeight(t)-2)+" re"),s.push("W"),s.push("n"),s.push(qt(n.x1.x)+" "+qt(n.x1.y)+" m"),s.push(qt(n.x2.x)+" "+qt(n.x2.y)+" l"),s.push(qt(n.x4.x)+" "+qt(n.x4.y)+" m"),s.push(qt(n.x3.x)+" "+qt(n.x3.y)+" l"),s.push("s"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=Si(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+qt(pt.internal.getWidth(t))+" "+qt(pt.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};pt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=pt.internal.getWidth(t),n=pt.internal.getHeight(t),s=Math.min(e,n);return{x1:{x:(e-s)/2,y:(n-s)/2+s},x2:{x:(e-s)/2+s,y:(n-s)/2},x3:{x:(e-s)/2,y:(n-s)/2},x4:{x:(e-s)/2+s,y:(n-s)/2+s}}}},pt.internal.getWidth=function(t){var e=0;return hn(t)==="object"&&(e=Sx(t.Rect[2])),e},pt.internal.getHeight=function(t){var e=0;return hn(t)==="object"&&(e=Sx(t.Rect[3])),e};var KS=$n.addField=function(t){if(JS(this,t),!(t instanceof di))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};$n.AcroFormChoiceField=ql,$n.AcroFormListBox=Ul,$n.AcroFormComboBox=Hl,$n.AcroFormEditBox=fh,$n.AcroFormButton=mr,$n.AcroFormPushButton=mh,$n.AcroFormRadioButton=Vl,$n.AcroFormCheckBox=ph,$n.AcroFormTextField=Ao,$n.AcroFormPasswordField=gh,$n.AcroFormAppearance=pt,$n.AcroForm={ChoiceField:ql,ListBox:Ul,ComboBox:Hl,EditBox:fh,Button:mr,PushButton:mh,RadioButton:Vl,CheckBox:ph,TextField:Ao,PasswordField:gh,Appearance:pt},Et.AcroForm={ChoiceField:ql,ListBox:Ul,ComboBox:Hl,EditBox:fh,Button:mr,PushButton:mh,RadioButton:Vl,CheckBox:ph,TextField:Ao,PasswordField:gh,Appearance:pt};function Wy(t){return t.reduce(function(e,n,s){return e[n]=s,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=t.__addimage__.getImageFileTypeByImageData=function(A,C){var R,V,ie,Q,te,L=e;if((C=C||e)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(Z(A))for(te in n)for(ie=n[te],R=0;R<ie.length;R+=1){for(Q=!0,V=0;V<ie[R].length;V+=1)if(ie[R][V]!==void 0&&ie[R][V]!==A[V]){Q=!1;break}if(Q===!0){L=te;break}}else for(te in n)for(ie=n[te],R=0;R<ie.length;R+=1){for(Q=!0,V=0;V<ie[R].length;V+=1)if(ie[R][V]!==void 0&&ie[R][V]!==A.charCodeAt(V)){Q=!1;break}if(Q===!0){L=te;break}}return L===e&&C!==e&&(L=C),L},i=function A(C){for(var R=this.internal.write,V=this.internal.putStream,ie=(0,this.internal.getFilters)();ie.indexOf("FlateEncode")!==-1;)ie.splice(ie.indexOf("FlateEncode"),1);C.objectId=this.internal.newObject();var Q=[];if(Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Image"}),Q.push({key:"Width",value:C.width}),Q.push({key:"Height",value:C.height}),C.colorSpace===k.INDEXED?Q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(C.palette.length/3-1)+" "+("sMask"in C&&C.sMask!==void 0?C.objectId+2:C.objectId+1)+" 0 R]"}):(Q.push({key:"ColorSpace",value:"/"+C.colorSpace}),C.colorSpace===k.DEVICE_CMYK&&Q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Q.push({key:"BitsPerComponent",value:C.bitsPerComponent}),"decodeParameters"in C&&C.decodeParameters!==void 0&&Q.push({key:"DecodeParms",value:"<<"+C.decodeParameters+">>"}),"transparency"in C&&Array.isArray(C.transparency)){for(var te="",L=0,Y=C.transparency.length;L<Y;L++)te+=C.transparency[L]+" "+C.transparency[L]+" ";Q.push({key:"Mask",value:"["+te+"]"})}C.sMask!==void 0&&Q.push({key:"SMask",value:C.objectId+1+" 0 R"});var G=C.filter!==void 0?["/"+C.filter]:void 0;if(V({data:C.data,additionalKeyValues:Q,alreadyAppliedFilters:G,objectId:C.objectId}),R("endobj"),"sMask"in C&&C.sMask!==void 0){var ce="/Predictor "+C.predictor+" /Colors 1 /BitsPerComponent "+C.bitsPerComponent+" /Columns "+C.width,_={width:C.width,height:C.height,colorSpace:"DeviceGray",bitsPerComponent:C.bitsPerComponent,decodeParameters:ce,data:C.sMask};"filter"in C&&(_.filter=C.filter),A.call(this,_)}if(C.colorSpace===k.INDEXED){var J=this.internal.newObject();V({data:P(new Uint8Array(C.palette)),objectId:J}),R("endobj")}},a=function(){var A=this.internal.collections.addImage_images;for(var C in A)i.call(this,A[C])},o=function(){var A,C=this.internal.collections.addImage_images,R=this.internal.write;for(var V in C)R("/I"+(A=C[V]).index,A.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var A=this.internal.collections.addImage_images;return l.call(this),A},d=function(){return Object.keys(this.internal.collections.addImage_images).length},f=function(A){return typeof t["process"+A.toUpperCase()]=="function"},p=function(A){return hn(A)==="object"&&A.nodeType===1},v=function(A,C){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var R=""+A.getAttribute("src");if(R.indexOf("data:image/")===0)return mu(unescape(R).split("base64,").pop());var V=t.loadFile(R,!0);if(V!==void 0)return V}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var ie;switch(C){case"PNG":ie="image/png";break;case"WEBP":ie="image/webp";break;case"JPEG":case"JPG":default:ie="image/jpeg"}return mu(A.toDataURL(ie,1).split("base64,").pop())}},m=function(A){var C=this.internal.collections.addImage_images;if(C){for(var R in C)if(A===C[R].alias)return C[R]}},N=function(A,C,R){return A||C||(A=-96,C=-96),A<0&&(A=-1*R.width*72/A/this.internal.scaleFactor),C<0&&(C=-1*R.height*72/C/this.internal.scaleFactor),A===0&&(A=C*R.width/R.height),C===0&&(C=A*R.height/R.width),[A,C]},S=function(A,C,R,V,ie,Q){var te=N.call(this,R,V,ie),L=this.internal.getCoordinateString,Y=this.internal.getVerticalCoordinateString,G=c.call(this);if(R=te[0],V=te[1],G[ie.index]=ie,Q){Q*=Math.PI/180;var ce=Math.cos(Q),_=Math.sin(Q),J=function(I){return I.toFixed(4)},M=[J(ce),J(_),J(-1*_),J(ce),0,0,"cm"]}this.internal.write("q"),Q?(this.internal.write([1,"0","0",1,L(A),Y(C+V),"cm"].join(" ")),this.internal.write(M.join(" ")),this.internal.write([L(R),"0","0",L(V),"0","0","cm"].join(" "))):this.internal.write([L(R),"0","0",L(V),L(A),Y(C+V),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ie.index+" Do"),this.internal.write("Q")},k=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(A){var C,R,V=0;if(typeof A=="string")for(R=A.length,C=0;C<R;C++)V=(V<<5)-V+A.charCodeAt(C),V|=0;else if(Z(A))for(R=A.byteLength/2,C=0;C<R;C++)V=(V<<5)-V+A[C],V|=0;return V},j=t.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var C=!0;return A.length===0&&(C=!1),A.length%4!=0&&(C=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(C=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(C=!1),C},z=t.__addimage__.extractImageFromDataUrl=function(A){if(A==null||!(A=A.trim()).startsWith("data:"))return null;var C=A.indexOf(",");return C<0?null:A.substring(0,C).trim().endsWith("base64")?A.substring(C+1):null},H=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(A){return H()&&A instanceof ArrayBuffer};var Z=t.__addimage__.isArrayBufferView=function(A){return H()&&typeof Uint32Array<"u"&&(A instanceof Int8Array||A instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array)},K=t.__addimage__.binaryStringToUint8Array=function(A){for(var C=A.length,R=new Uint8Array(C),V=0;V<C;V++)R[V]=A.charCodeAt(V);return R},P=t.__addimage__.arrayBufferToBinaryString=function(A){for(var C="",R=Z(A)?A:new Uint8Array(A),V=0;V<R.length;V+=8192)C+=String.fromCharCode.apply(null,R.subarray(V,V+8192));return C};t.addImage=function(){var A,C,R,V,ie,Q,te,L,Y;if(typeof arguments[1]=="number"?(C=e,R=arguments[1],V=arguments[2],ie=arguments[3],Q=arguments[4],te=arguments[5],L=arguments[6],Y=arguments[7]):(C=arguments[1],R=arguments[2],V=arguments[3],ie=arguments[4],Q=arguments[5],te=arguments[6],L=arguments[7],Y=arguments[8]),hn(A=arguments[0])==="object"&&!p(A)&&"imageData"in A){var G=A;A=G.imageData,C=G.format||C||e,R=G.x||R||0,V=G.y||V||0,ie=G.w||G.width||ie,Q=G.h||G.height||Q,te=G.alias||te,L=G.compression||L,Y=G.rotation||G.angle||Y}var ce=this.internal.getFilters();if(L===void 0&&ce.indexOf("FlateEncode")!==-1&&(L="SLOW"),isNaN(R)||isNaN(V))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var _=$.call(this,A,C,te,L);return S.call(this,R,V,ie,Q,_,Y),this};var $=function(A,C,R,V){var ie,Q,te;if(typeof A=="string"&&s(A)===e){A=unescape(A);var L=re(A,!1);(L!==""||(L=t.loadFile(A,!0))!==void 0)&&(A=L)}if(p(A)&&(A=v(A,C)),C=s(A,C),!f(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(((te=R)==null||te.length===0)&&(R=function(Y){return typeof Y=="string"||Z(Y)?b(Y):Z(Y.data)?b(Y.data):null}(A)),(ie=m.call(this,R))||(H()&&(A instanceof Uint8Array||C==="RGBA"||(Q=A,A=K(A))),ie=this["process"+C.toUpperCase()](A,d.call(this),R,function(Y){return Y&&typeof Y=="string"&&(Y=Y.toUpperCase()),Y in t.image_compression?Y:y.NONE}(V),Q)),!ie)throw new Error("An unknown error occurred whilst processing the image.");return ie},re=t.__addimage__.convertBase64ToBinaryString=function(A,C){C=typeof C!="boolean"||C;var R,V="";if(typeof A=="string"){var ie;R=(ie=z(A))!==null&&ie!==void 0?ie:A;try{V=mu(R)}catch(Q){if(C)throw j(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return V};t.getImageProperties=function(A){var C,R,V="";if(p(A)&&(A=v(A)),typeof A=="string"&&s(A)===e&&((V=re(A,!1))===""&&(V=t.loadFile(A)||""),A=V),R=s(A),!f(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(!H()||A instanceof Uint8Array||(A=K(A)),!(C=this["process"+R.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return C.fileType=R,C}})(Et.API),function(t){var e=function(n){if(n!==void 0&&n!="")return!0};Et.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(n){for(var s,i,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),d=n.pageContext.annotations,f=!1,p=0;p<d.length&&!f;p++)switch((s=d[p]).type){case"link":(e(s.options.url)||e(s.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var v=0;v<d.length;v++){s=d[v];var m=this.internal.pdfEscape,N=this.internal.getEncryptor(n.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var S=this.internal.newAdditionalObject(),k=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(S.objId),b=s.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(s.bounds.x)+" "+l(s.bounds.y+s.bounds.h)+" "+o(s.bounds.x+s.bounds.w)+" "+l(s.bounds.y)+"] ")+"/Contents ("+m(y(s.contents))+")",a+=" /Popup "+k.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+m(y(b))+") >>",S.content=a;var j=S.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(s.bounds.x+30)+" "+l(s.bounds.y+s.bounds.h)+" "+o(s.bounds.x+s.bounds.w+30)+" "+l(s.bounds.y)+"] ")+" /Parent "+j,s.open&&(a+=" /Open true"),a+=" >>",k.content=a,this.internal.write(S.objId,"0 R",k.objId,"0 R");break;case"freetext":i="/Rect ["+o(s.bounds.x)+" "+l(s.bounds.y)+" "+o(s.bounds.x+s.bounds.w)+" "+l(s.bounds.y+s.bounds.h)+"] ";var z=s.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+m(N(s.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+z+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(s.options.name){var H=this.annotations._nameMap[s.options.name];s.options.pageNumber=H.page,s.options.top=H.y}else s.options.top||(s.options.top=0);if(i="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",a="",s.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+m(N(s.options.url))+") >>";else if(s.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,a+=" /FitV "+s.options.left+"]";break;case"XYZ":default:var Z=l(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),a+=" /XYZ "+s.options.left+" "+Z+" "+s.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(n){var s=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":s.pageContext.annotations.push(n)}},t.link=function(n,s,i,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(n),y:d(s),w:c(n+i),h:d(s+a)},options:o,type:"link"})},t.textWithLink=function(n,s,i,a){var o,l,c=this.getTextWidth(n),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var f=this.splitTextToSize(n,l).length;o=Math.ceil(d*f)}else l=c,o=d;return this.text(n,s,i,a),i+=.2*d,a.align==="center"&&(s-=c/2),a.align==="right"&&(s-=c),this.link(s,i-d,l,o,a),c},t.getTextWidth=function(n){var s=this.internal.getFontSize();return this.getStringUnitWidth(n)*s/this.internal.scaleFactor}}(Et.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(S){return e[S.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(S){return typeof S=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(S)},l=t.__arabicParser__.isArabicEndLetter=function(S){return o(S)&&a(S)&&e[S.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(S){return o(S)&&i.indexOf(S.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(S){return o(S)&&a(S)&&e[S.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(S){return o(S)&&a(S)&&e[S.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(S){return o(S)&&a(S)&&e[S.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(S){return o(S)&&a(S)&&e[S.charCodeAt(0)].length==4},p=t.__arabicParser__.resolveLigatures=function(S){var k=0,y=n,b="",j=0;for(k=0;k<S.length;k+=1)y[S.charCodeAt(k)]!==void 0?(j++,typeof(y=y[S.charCodeAt(k)])=="number"&&(b+=String.fromCharCode(y),y=n,j=0),k===S.length-1&&(y=n,b+=S.charAt(k-(j-1)),k-=j-1,j=0)):(y=n,b+=S.charAt(k-j),k-=j,j=0);return b};t.__arabicParser__.isArabicDiacritic=function(S){return S!==void 0&&s[S.charCodeAt(0)]!==void 0};var v=t.__arabicParser__.getCorrectForm=function(S,k,y){return o(S)?a(S)===!1?-1:!d(S)||!o(k)&&!o(y)||!o(y)&&l(k)||l(S)&&!o(k)||l(S)&&c(k)||l(S)&&l(k)?0:f(S)&&o(k)&&!l(k)&&o(y)&&d(y)?3:l(S)||!o(y)?1:2:-1},m=function(S){var k=0,y=0,b=0,j="",z="",H="",Z=(S=S||"").split("\\s+"),K=[];for(k=0;k<Z.length;k+=1){for(K.push(""),y=0;y<Z[k].length;y+=1)j=Z[k][y],z=Z[k][y-1],H=Z[k][y+1],o(j)?(b=v(j,z,H),K[k]+=b!==-1?String.fromCharCode(e[j.charCodeAt(0)][b]):j):K[k]+=j;K[k]=p(K[k])}return K.join(" ")},N=t.__arabicParser__.processArabic=t.processArabic=function(){var S,k=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(k)){var b=0;for(y=[],b=0;b<k.length;b+=1)Array.isArray(k[b])?y.push([m(k[b][0]),k[b][1],k[b][2]]):y.push([m(k[b])]);S=y}else S=m(k);return typeof arguments[0]=="string"?S:(arguments[0].text=S,arguments[0])};t.events.push(["preProcessText",N])}(Et.API),Et.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(n,s){var i;if((n=n||"2d")!=="2d")return null;for(i in s)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=s[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Et.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(S){c=S}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(S){d=S}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(S){f=S}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(S){p=S}});var v=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return v},set:function(S){v=S}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(S){m=S}});var N=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return N},set:function(S){N=S}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return s.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){s.call(this);var f=(d=d||{}).fontSize||this.getFontSize(),p=d.font||this.getFont(),v=d.scaleFactor||this.internal.scaleFactor,m=0,N=0,S=0,k=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=d.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(j,z){return j.concat(k.splitTextToSize(z,y))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)m<(S=this.getStringUnitWidth(c[b],{font:p})*f)&&(m=S);return m!==0&&(N=c.length),{w:m/=v,h:Math.max((N*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/v,0)}},t.cellAddPage=function(){s.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),s.call(this);var d=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,v=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,m&&v&&(this.printHeaderRow(c.lineNumber,!0),c.y+=v[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,f,p,v){if(s.call(this),!f)throw new Error("No data for PDF table.");var m,N,S,k,y=[],b=[],j=[],z={},H={},Z=[],K=[],P=(v=v||{}).autoSize||!1,$=v.printHeaders!==!1,re=v.css&&v.css["font-size"]!==void 0?16*v.css["font-size"]:v.fontSize||12,A=v.margins||Object.assign({width:this.getPageWidth()},e),C=typeof v.padding=="number"?v.padding:3,R=v.headerBackgroundColor||"#c8c8c8",V=v.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=$,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=re,this.internal.__cell__.padding=C,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=V,this.setFontSize(re),p==null)b=y=Object.keys(f[0]),j=y.map(function(){return"left"});else if(Array.isArray(p)&&hn(p[0])==="object")for(y=p.map(function(G){return G.name}),b=p.map(function(G){return G.prompt||G.name||""}),j=p.map(function(G){return G.align||"left"}),m=0;m<p.length;m+=1)H[p[m].name]=p[m].width*(19.049976/25.4);else Array.isArray(p)&&typeof p[0]=="string"&&(b=y=p,j=y.map(function(){return"left"}));if(P||Array.isArray(p)&&typeof p[0]=="string")for(m=0;m<y.length;m+=1){for(z[k=y[m]]=f.map(function(G){return G[k]}),this.setFont(void 0,"bold"),Z.push(this.getTextDimensions(b[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),N=z[k],this.setFont(void 0,"normal"),S=0;S<N.length;S+=1)Z.push(this.getTextDimensions(N[S],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);H[k]=Math.max.apply(null,Z)+C+C,Z=[]}if($){var ie={};for(m=0;m<y.length;m+=1)ie[y[m]]={},ie[y[m]].text=b[m],ie[y[m]].align=j[m];var Q=l.call(this,ie,H);K=y.map(function(G){return new a(c,d,H[G],Q,ie[G].text,void 0,ie[G].align)}),this.setTableHeaderRow(K),this.printHeaderRow(1,!1)}var te=p.reduce(function(G,ce){return G[ce.name]=ce.align,G},{});for(m=0;m<f.length;m+=1){"rowStart"in v&&v.rowStart instanceof Function&&v.rowStart({row:m,data:f[m]},this);var L=l.call(this,f[m],H);for(S=0;S<y.length;S+=1){var Y=f[m][y[S]];"cellStart"in v&&v.cellStart instanceof Function&&v.cellStart({row:m,col:S,data:Y},this),o.call(this,new a(c,d,H[y[S]],L,Y,m+2,te[y[S]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var f=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,v=this.internal.scaleFactor;return Object.keys(c).map(function(m){var N=c[m];return this.splitTextToSize(N.hasOwnProperty("text")?N.text:N,d[m]-f-f)},this).map(function(m){return this.getLineHeightFactor()*m.length*p/v+f+f},this).reduce(function(m,N){return Math.max(m,N)},0)};t.setTableHeaderRow=function(c){s.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var v=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){f=this.internal.__cell__.tableHeaderRow[m].clone(),d&&(f.y=this.internal.__cell__.margins.top||0,v.push(f)),f.lineNumber=c;var N=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(N)}v.length>0&&this.setTableHeaderRow(v),this.setFont(void 0,"normal"),n=!1}}(Et.API);var Jy={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Ky=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],tg=Wy(Ky),Yy=[100,200,300,400,500,600,700,800,900],YS=Wy(Yy);function ng(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(a){return Jy[a=a||"normal"]?a:"normal"}(t.style),s=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(a){return typeof tg[a=a||"normal"]=="number"?a:"normal"}(t.stretch);return{family:e,style:n,weight:s,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,n,s].join(" ")}}}function _x(t,e,n,s){var i;for(i=n;i>=0&&i<e.length;i+=s)if(t[e[i]])return t[e[i]];for(i=n;i>=0&&i<e.length;i-=s)if(t[e[i]])return t[e[i]]}var QS={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Cx={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function kx(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function XS(t,e,n){for(var s=(n=n||{}).defaultFontFamily||"times",i=Object.assign({},QS,n.genericFontFamilies||{}),a=null,o=null,l=0;l<e.length;++l)if(i[(a=ng(e[l])).family]&&(a.family=i[a.family]),t.hasOwnProperty(a.family)){o=t[a.family];break}if(!(o=o||t[s]))throw new Error("Could not find a font-family for the rule '"+kx(a)+"' and default family '"+s+"'.");if(o=function(c,d){if(d[c])return d[c];var f=tg[c],p=f<=tg.normal?-1:1,v=_x(d,Ky,f,p);if(!v)throw new Error("Could not find a matching font-stretch value for "+c);return v}(a.stretch,o),o=function(c,d){if(d[c])return d[c];for(var f=Jy[c],p=0;p<f.length;++p)if(d[f[p]])return d[f[p]];throw new Error("Could not find a matching font-style for "+c)}(a.style,o),!(o=function(c,d){if(d[c])return d[c];if(c===400&&d[500])return d[500];if(c===500&&d[400])return d[400];var f=YS[c],p=_x(d,Yy,f,c<400?-1:1);if(!p)throw new Error("Could not find a matching font-weight for value "+c);return p}(a.weight,o)))throw new Error("Failed to resolve a font for the rule '"+kx(a)+"'.");return o}function Ax(t){return t.trimLeft()}function ZS(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function e3(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Qd,Px,Lx,Mm=["times"];(function(t){var e,n,s,i,a,o,l,c,d,f=function(_){return _=_||{},this.isStrokeTransparent=_.isStrokeTransparent||!1,this.strokeOpacity=_.strokeOpacity||1,this.strokeStyle=_.strokeStyle||"#000000",this.fillStyle=_.fillStyle||"#000000",this.isFillTransparent=_.isFillTransparent||!1,this.fillOpacity=_.fillOpacity||1,this.font=_.font||"10px sans-serif",this.textBaseline=_.textBaseline||"alphabetic",this.textAlign=_.textAlign||"left",this.lineWidth=_.lineWidth||1,this.lineJoin=_.lineJoin||"miter",this.lineCap=_.lineCap||"butt",this.path=_.path||[],this.transform=_.transform!==void 0?_.transform.clone():new c,this.globalCompositeOperation=_.globalCompositeOperation||"normal",this.globalAlpha=_.globalAlpha||1,this.clip_path=_.clip_path||[],this.currentPoint=_.currentPoint||new o,this.miterLimit=_.miterLimit||10,this.lastPoint=_.lastPoint||new o,this.lineDashOffset=_.lineDashOffset||0,this.lineDash=_.lineDash||[],this.margin=_.margin||[0,0,0,0],this.prevPageLastElemOffset=_.prevPageLastElemOffset||0,this.ignoreClearRect=typeof _.ignoreClearRect!="boolean"||_.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,n=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new f}]);var p=function(_){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var J=_;Object.defineProperty(this,"pdf",{get:function(){return J}});var M=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return M},set:function(_e){M=!!_e}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(_e){I=!!_e}});var q=0;Object.defineProperty(this,"posX",{get:function(){return q},set:function(_e){isNaN(_e)||(q=_e)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(_e){isNaN(_e)||(oe=_e)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(_e){var ae;typeof _e=="number"?ae=[_e,_e,_e,_e]:((ae=new Array(4))[0]=_e[0],ae[1]=_e.length>=2?_e[1]:ae[0],ae[2]=_e.length>=3?_e[2]:ae[0],ae[3]=_e.length>=4?_e[3]:ae[1]),d.margin=ae}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(_e){fe=_e}});var ge=0;Object.defineProperty(this,"lastBreak",{get:function(){return ge},set:function(_e){ge=_e}});var Te=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Te},set:function(_e){Te=_e}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(_e){_e instanceof f&&(d=_e)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(_e){d.path=_e}});var Ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ee},set:function(_e){Ee=_e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(_e){var ae;ae=v(_e),this.ctx.fillStyle=ae.style,this.ctx.isFillTransparent=ae.a===0,this.ctx.fillOpacity=ae.a,this.pdf.setFillColor(ae.r,ae.g,ae.b,{a:ae.a}),this.pdf.setTextColor(ae.r,ae.g,ae.b,{a:ae.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(_e){var ae=v(_e);this.ctx.strokeStyle=ae.style,this.ctx.isStrokeTransparent=ae.a===0,this.ctx.strokeOpacity=ae.a,ae.a===0?this.pdf.setDrawColor(255,255,255):(ae.a,this.pdf.setDrawColor(ae.r,ae.g,ae.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(_e){["butt","round","square"].indexOf(_e)!==-1&&(this.ctx.lineCap=_e,this.pdf.setLineCap(_e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(_e){isNaN(_e)||(this.ctx.lineWidth=_e,this.pdf.setLineWidth(_e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(_e){["bevel","round","miter"].indexOf(_e)!==-1&&(this.ctx.lineJoin=_e,this.pdf.setLineJoin(_e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(_e){isNaN(_e)||(this.ctx.miterLimit=_e,this.pdf.setMiterLimit(_e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(_e){this.ctx.textBaseline=_e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(_e){["right","end","center","left","start"].indexOf(_e)!==-1&&(this.ctx.textAlign=_e)}});var Fe=null;function qe(_e,ae){if(Fe===null){var St=function(st){var $e=[];return Object.keys(st).forEach(function(Ye){st[Ye].forEach(function(Ge){var He=null;switch(Ge){case"bold":He={family:Ye,weight:"bold"};break;case"italic":He={family:Ye,style:"italic"};break;case"bolditalic":He={family:Ye,weight:"bold",style:"italic"};break;case"":case"normal":He={family:Ye}}He!==null&&(He.ref={name:Ye,style:Ge},$e.push(He))})}),$e}(_e.getFontList());Fe=function(st){for(var $e={},Ye=0;Ye<st.length;++Ye){var Ge=ng(st[Ye]),He=Ge.family,it=Ge.stretch,rt=Ge.style,mt=Ge.weight;$e[He]=$e[He]||{},$e[He][it]=$e[He][it]||{},$e[He][it][rt]=$e[He][it][rt]||{},$e[He][it][rt][mt]=Ge}return $e}(St.concat(ae))}return Fe}var ct=null;Object.defineProperty(this,"fontFaces",{get:function(){return ct},set:function(_e){Fe=null,ct=_e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(_e){var ae;if(this.ctx.font=_e,(ae=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(_e))!==null){var St=ae[1];ae[2];var st=ae[3],$e=ae[4];ae[5];var Ye=ae[6],Ge=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec($e)[2];$e=Math.floor(Ge==="px"?parseFloat($e)*this.pdf.internal.scaleFactor:Ge==="em"?parseFloat($e)*this.pdf.getFontSize():parseFloat($e)*this.pdf.internal.scaleFactor),this.pdf.setFontSize($e);var He=function(Ce){var Me,Ne,gt=[],et=Ce.trim();if(et==="")return Mm;if(et in Cx)return[Cx[et]];for(;et!=="";){switch(Ne=null,Me=(et=Ax(et)).charAt(0)){case'"':case"'":Ne=ZS(et.substring(1),Me);break;default:Ne=e3(et)}if(Ne===null||(gt.push(Ne[0]),(et=Ax(Ne[1]))!==""&&et.charAt(0)!==","))return Mm;et=et.replace(/^,/,"")}return gt}(Ye);if(this.fontFaces){var it=XS(qe(this.pdf,this.fontFaces),He.map(function(Ce){return{family:Ce,stretch:"normal",weight:st,style:St}}));this.pdf.setFont(it.ref.name,it.ref.style)}else{var rt="";(st==="bold"||parseInt(st,10)>=700||St==="bold")&&(rt="bold"),St==="italic"&&(rt+="italic"),rt.length===0&&(rt="normal");for(var mt="",bt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},me=0;me<He.length;me++){if(this.pdf.internal.getFont(He[me],rt,{noFallback:!0,disableWarning:!0})!==void 0){mt=He[me];break}if(rt==="bolditalic"&&this.pdf.internal.getFont(He[me],"bold",{noFallback:!0,disableWarning:!0})!==void 0)mt=He[me],rt="bold";else if(this.pdf.internal.getFont(He[me],"normal",{noFallback:!0,disableWarning:!0})!==void 0){mt=He[me],rt="normal";break}}if(mt===""){for(var Le=0;Le<He.length;Le++)if(bt[He[Le]]){mt=bt[He[Le]];break}}mt=mt===""?"Times":mt,this.pdf.setFont(mt,rt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(_e){this.ctx.globalCompositeOperation=_e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(_e){this.ctx.globalAlpha=_e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(_e){this.ctx.lineDashOffset=_e,ce.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(_e){this.ctx.lineDash=_e,ce.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(_e){this.ctx.ignoreClearRect=!!_e}})};p.prototype.setLineDash=function(_){this.lineDash=_},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){z.call(this,"fill",!1)},p.prototype.stroke=function(){z.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(_,J){if(isNaN(_)||isNaN(J))throw gn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var M=this.ctx.transform.applyToPoint(new o(_,J));this.path.push({type:"mt",x:M.x,y:M.y}),this.ctx.lastPoint=new o(_,J)},p.prototype.closePath=function(){var _=new o(0,0),J=0;for(J=this.path.length-1;J!==-1;J--)if(this.path[J].type==="begin"&&hn(this.path[J+1])==="object"&&typeof this.path[J+1].x=="number"){_=new o(this.path[J+1].x,this.path[J+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(_.x,_.y)},p.prototype.lineTo=function(_,J){if(isNaN(_)||isNaN(J))throw gn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var M=this.ctx.transform.applyToPoint(new o(_,J));this.path.push({type:"lt",x:M.x,y:M.y}),this.ctx.lastPoint=new o(M.x,M.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),z.call(this,null,!0)},p.prototype.quadraticCurveTo=function(_,J,M,I){if(isNaN(M)||isNaN(I)||isNaN(_)||isNaN(J))throw gn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var q=this.ctx.transform.applyToPoint(new o(M,I)),oe=this.ctx.transform.applyToPoint(new o(_,J));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:q.x,y:q.y}),this.ctx.lastPoint=new o(q.x,q.y)},p.prototype.bezierCurveTo=function(_,J,M,I,q,oe){if(isNaN(q)||isNaN(oe)||isNaN(_)||isNaN(J)||isNaN(M)||isNaN(I))throw gn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new o(q,oe)),ge=this.ctx.transform.applyToPoint(new o(_,J)),Te=this.ctx.transform.applyToPoint(new o(M,I));this.path.push({type:"bct",x1:ge.x,y1:ge.y,x2:Te.x,y2:Te.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new o(fe.x,fe.y)},p.prototype.arc=function(_,J,M,I,q,oe){if(isNaN(_)||isNaN(J)||isNaN(M)||isNaN(I)||isNaN(q))throw gn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new o(_,J));_=fe.x,J=fe.y;var ge=this.ctx.transform.applyToPoint(new o(0,M)),Te=this.ctx.transform.applyToPoint(new o(0,0));M=Math.sqrt(Math.pow(ge.x-Te.x,2)+Math.pow(ge.y-Te.y,2))}Math.abs(q-I)>=2*Math.PI&&(I=0,q=2*Math.PI),this.path.push({type:"arc",x:_,y:J,radius:M,startAngle:I,endAngle:q,counterclockwise:oe})},p.prototype.arcTo=function(_,J,M,I,q){throw new Error("arcTo not implemented.")},p.prototype.rect=function(_,J,M,I){if(isNaN(_)||isNaN(J)||isNaN(M)||isNaN(I))throw gn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(_,J),this.lineTo(_+M,J),this.lineTo(_+M,J+I),this.lineTo(_,J+I),this.lineTo(_,J),this.lineTo(_+M,J),this.lineTo(_,J)},p.prototype.fillRect=function(_,J,M,I){if(isNaN(_)||isNaN(J)||isNaN(M)||isNaN(I))throw gn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var q={};this.lineCap!=="butt"&&(q.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(q.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(_,J,M,I),this.fill(),q.hasOwnProperty("lineCap")&&(this.lineCap=q.lineCap),q.hasOwnProperty("lineJoin")&&(this.lineJoin=q.lineJoin)}},p.prototype.strokeRect=function(_,J,M,I){if(isNaN(_)||isNaN(J)||isNaN(M)||isNaN(I))throw gn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");N.call(this)||(this.beginPath(),this.rect(_,J,M,I),this.stroke())},p.prototype.clearRect=function(_,J,M,I){if(isNaN(_)||isNaN(J)||isNaN(M)||isNaN(I))throw gn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(_,J,M,I))},p.prototype.save=function(_){_=typeof _!="boolean"||_;for(var J=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("q");if(this.pdf.setPage(J),_){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},p.prototype.restore=function(_){_=typeof _!="boolean"||_;for(var J=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("Q");this.pdf.setPage(J),_&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var v=function(_){var J,M,I,q;if(_.isCanvasGradient===!0&&(_=_.getColor()),!_)return{r:0,g:0,b:0,a:0,style:_};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(_))J=0,M=0,I=0,q=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(_);if(oe!==null)J=parseInt(oe[1]),M=parseInt(oe[2]),I=parseInt(oe[3]),q=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(_))!==null)J=parseInt(oe[1]),M=parseInt(oe[2]),I=parseInt(oe[3]),q=parseFloat(oe[4]);else{if(q=1,typeof _=="string"&&_.charAt(0)!=="#"){var fe=new $y(_);_=fe.ok?fe.toHex():"#000000"}_.length===4?(J=_.substring(1,2),J+=J,M=_.substring(2,3),M+=M,I=_.substring(3,4),I+=I):(J=_.substring(1,3),M=_.substring(3,5),I=_.substring(5,7)),J=parseInt(J,16),M=parseInt(M,16),I=parseInt(I,16)}}return{r:J,g:M,b:I,a:q,style:_}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},N=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(_,J,M,I){if(isNaN(J)||isNaN(M)||typeof _!="string")throw gn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!m.call(this)){var q=L(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;C.call(this,{text:_,x:J,y:M,scale:oe,angle:q,align:this.textAlign,maxWidth:I})}},p.prototype.strokeText=function(_,J,M,I){if(isNaN(J)||isNaN(M)||typeof _!="string")throw gn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!N.call(this)){I=isNaN(I)?void 0:I;var q=L(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;C.call(this,{text:_,x:J,y:M,scale:oe,renderingMode:"stroke",angle:q,align:this.textAlign,maxWidth:I})}},p.prototype.measureText=function(_){if(typeof _!="string")throw gn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var J=this.pdf,M=this.pdf.internal.scaleFactor,I=J.internal.getFontSize(),q=J.getStringUnitWidth(_)*I/J.internal.scaleFactor,oe=function(fe){var ge=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ge}}),this};return new oe({width:q*=Math.round(96*M/72*1e4)/1e4})},p.prototype.scale=function(_,J){if(isNaN(_)||isNaN(J))throw gn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var M=new c(_,0,0,J,0,0);this.ctx.transform=this.ctx.transform.multiply(M)},p.prototype.rotate=function(_){if(isNaN(_))throw gn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var J=new c(Math.cos(_),Math.sin(_),-Math.sin(_),Math.cos(_),0,0);this.ctx.transform=this.ctx.transform.multiply(J)},p.prototype.translate=function(_,J){if(isNaN(_)||isNaN(J))throw gn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var M=new c(1,0,0,1,_,J);this.ctx.transform=this.ctx.transform.multiply(M)},p.prototype.transform=function(_,J,M,I,q,oe){if(isNaN(_)||isNaN(J)||isNaN(M)||isNaN(I)||isNaN(q)||isNaN(oe))throw gn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new c(_,J,M,I,q,oe);this.ctx.transform=this.ctx.transform.multiply(fe)},p.prototype.setTransform=function(_,J,M,I,q,oe){_=isNaN(_)?1:_,J=isNaN(J)?0:J,M=isNaN(M)?0:M,I=isNaN(I)?1:I,q=isNaN(q)?0:q,oe=isNaN(oe)?0:oe,this.ctx.transform=new c(_,J,M,I,q,oe)};var S=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(_,J,M,I,q,oe,fe,ge,Te){var Ee=this.pdf.getImageProperties(_),Fe=1,qe=1,ct=1,_e=1;I!==void 0&&ge!==void 0&&(ct=ge/I,_e=Te/q,Fe=Ee.width/I*ge/I,qe=Ee.height/q*Te/q),oe===void 0&&(oe=J,fe=M,J=0,M=0),I!==void 0&&ge===void 0&&(ge=I,Te=q),I===void 0&&ge===void 0&&(ge=Ee.width,Te=Ee.height);for(var ae,St=this.ctx.transform.decompose(),st=L(St.rotate.shx),$e=new c,Ye=($e=($e=($e=$e.multiply(St.translate)).multiply(St.skew)).multiply(St.scale)).applyToRectangle(new l(oe-J*ct,fe-M*_e,I*Fe,q*qe)),Ge=k.call(this,Ye),He=[],it=0;it<Ge.length;it+=1)He.indexOf(Ge[it])===-1&&He.push(Ge[it]);if(j(He),this.autoPaging)for(var rt=He[0],mt=He[He.length-1],bt=rt;bt<mt+1;bt++){this.pdf.setPage(bt);var me=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Le=bt===1?this.posY+this.margin[0]:this.margin[0],Ce=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Me=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ne=bt===1?0:Ce+(bt-2)*Me;if(this.ctx.clip_path.length!==0){var gt=this.path;ae=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ae,this.posX+this.margin[3],-Ne+Le+this.ctx.prevPageLastElemOffset),H.call(this,"fill",!0),this.path=gt}var et=JSON.parse(JSON.stringify(Ye));et=b([et],this.posX+this.margin[3],-Ne+Le+this.ctx.prevPageLastElemOffset)[0];var ut=(bt>rt||bt<mt)&&S.call(this);ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],me,Me,null).clip().discardPath()),this.pdf.addImage(_,"JPEG",et.x,et.y,et.w,et.h,null,null,st),ut&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(_,"JPEG",Ye.x,Ye.y,Ye.w,Ye.h,null,null,st)};var k=function(_,J,M){var I=[];J=J||this.pdf.internal.pageSize.width,M=M||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var q=this.posY+this.ctx.prevPageLastElemOffset;switch(_.type){default:case"mt":case"lt":I.push(Math.floor((_.y+q)/M)+1);break;case"arc":I.push(Math.floor((_.y+q-_.radius)/M)+1),I.push(Math.floor((_.y+q+_.radius)/M)+1);break;case"qct":var oe=Y(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x,_.y);I.push(Math.floor((oe.y+q)/M)+1),I.push(Math.floor((oe.y+oe.h+q)/M)+1);break;case"bct":var fe=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x2,_.y2,_.x,_.y);I.push(Math.floor((fe.y+q)/M)+1),I.push(Math.floor((fe.y+fe.h+q)/M)+1);break;case"rect":I.push(Math.floor((_.y+q)/M)+1),I.push(Math.floor((_.y+_.h+q)/M)+1)}for(var ge=0;ge<I.length;ge+=1)for(;this.pdf.internal.getNumberOfPages()<I[ge];)y.call(this);return I},y=function(){var _=this.fillStyle,J=this.strokeStyle,M=this.font,I=this.lineCap,q=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=_,this.strokeStyle=J,this.font=M,this.lineCap=I,this.lineWidth=q,this.lineJoin=oe},b=function(_,J,M){for(var I=0;I<_.length;I++)switch(_[I].type){case"bct":_[I].x2+=J,_[I].y2+=M;case"qct":_[I].x1+=J,_[I].y1+=M;case"mt":case"lt":case"arc":default:_[I].x+=J,_[I].y+=M}return _},j=function(_){return _.sort(function(J,M){return J-M})},z=function(_,J){for(var M,I,q=this.fillStyle,oe=this.strokeStyle,fe=this.lineCap,ge=this.lineWidth,Te=Math.abs(ge*this.ctx.transform.scaleX),Ee=this.lineJoin,Fe=JSON.parse(JSON.stringify(this.path)),qe=JSON.parse(JSON.stringify(this.path)),ct=[],_e=0;_e<qe.length;_e++)if(qe[_e].x!==void 0)for(var ae=k.call(this,qe[_e]),St=0;St<ae.length;St+=1)ct.indexOf(ae[St])===-1&&ct.push(ae[St]);for(var st=0;st<ct.length;st++)for(;this.pdf.internal.getNumberOfPages()<ct[st];)y.call(this);if(j(ct),this.autoPaging)for(var $e=ct[0],Ye=ct[ct.length-1],Ge=$e;Ge<Ye+1;Ge++){this.pdf.setPage(Ge),this.fillStyle=q,this.strokeStyle=oe,this.lineCap=fe,this.lineWidth=Te,this.lineJoin=Ee;var He=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],it=Ge===1?this.posY+this.margin[0]:this.margin[0],rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],mt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],bt=Ge===1?0:rt+(Ge-2)*mt;if(this.ctx.clip_path.length!==0){var me=this.path;M=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(M,this.posX+this.margin[3],-bt+it+this.ctx.prevPageLastElemOffset),H.call(this,_,!0),this.path=me}if(I=JSON.parse(JSON.stringify(Fe)),this.path=b(I,this.posX+this.margin[3],-bt+it+this.ctx.prevPageLastElemOffset),J===!1||Ge===0){var Le=(Ge>$e||Ge<Ye)&&S.call(this);Le&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],He,mt,null).clip().discardPath()),H.call(this,_,J),Le&&this.pdf.restoreGraphicsState()}this.lineWidth=ge}else this.lineWidth=Te,H.call(this,_,J),this.lineWidth=ge;this.path=Fe},H=function(_,J){if((_!=="stroke"||J||!N.call(this))&&(_==="stroke"||J||!m.call(this))){for(var M,I,q=[],oe=this.path,fe=0;fe<oe.length;fe++){var ge=oe[fe];switch(ge.type){case"begin":q.push({begin:!0});break;case"close":q.push({close:!0});break;case"mt":q.push({start:ge,deltas:[],abs:[]});break;case"lt":var Te=q.length;if(oe[fe-1]&&!isNaN(oe[fe-1].x)&&(M=[ge.x-oe[fe-1].x,ge.y-oe[fe-1].y],Te>0)){for(;Te>=0;Te--)if(q[Te-1].close!==!0&&q[Te-1].begin!==!0){q[Te-1].deltas.push(M),q[Te-1].abs.push(ge);break}}break;case"bct":M=[ge.x1-oe[fe-1].x,ge.y1-oe[fe-1].y,ge.x2-oe[fe-1].x,ge.y2-oe[fe-1].y,ge.x-oe[fe-1].x,ge.y-oe[fe-1].y],q[q.length-1].deltas.push(M);break;case"qct":var Ee=oe[fe-1].x+2/3*(ge.x1-oe[fe-1].x),Fe=oe[fe-1].y+2/3*(ge.y1-oe[fe-1].y),qe=ge.x+2/3*(ge.x1-ge.x),ct=ge.y+2/3*(ge.y1-ge.y),_e=ge.x,ae=ge.y;M=[Ee-oe[fe-1].x,Fe-oe[fe-1].y,qe-oe[fe-1].x,ct-oe[fe-1].y,_e-oe[fe-1].x,ae-oe[fe-1].y],q[q.length-1].deltas.push(M);break;case"arc":q.push({deltas:[],abs:[],arc:!0}),Array.isArray(q[q.length-1].abs)&&q[q.length-1].abs.push(ge)}}I=J?null:_==="stroke"?"stroke":"fill";for(var St=!1,st=0;st<q.length;st++)if(q[st].arc)for(var $e=q[st].abs,Ye=0;Ye<$e.length;Ye++){var Ge=$e[Ye];Ge.type==="arc"?P.call(this,Ge.x,Ge.y,Ge.radius,Ge.startAngle,Ge.endAngle,Ge.counterclockwise,void 0,J,!St):R.call(this,Ge.x,Ge.y),St=!0}else if(q[st].close===!0)this.pdf.internal.out("h"),St=!1;else if(q[st].begin!==!0){var He=q[st].start.x,it=q[st].start.y;V.call(this,q[st].deltas,He,it),St=!0}I&&$.call(this,I),J&&re.call(this)}},Z=function(_){var J=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,M=J*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return _-M;case"top":return _+J-M;case"hanging":return _+J-2*M;case"middle":return _+J/2-M;case"ideographic":return _;case"alphabetic":default:return _}},K=function(_){return _+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var _=function(){};return _.colorStops=[],_.addColorStop=function(J,M){this.colorStops.push([J,M])},_.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},_.isCanvasGradient=!0,_},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(_,J,M,I,q,oe,fe,ge,Te){for(var Ee=Q.call(this,M,I,q,oe),Fe=0;Fe<Ee.length;Fe++){var qe=Ee[Fe];Fe===0&&(Te?A.call(this,qe.x1+_,qe.y1+J):R.call(this,qe.x1+_,qe.y1+J)),ie.call(this,_,J,qe.x2,qe.y2,qe.x3,qe.y3,qe.x4,qe.y4)}ge?re.call(this):$.call(this,fe)},$=function(_){switch(_){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},re=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(_,J){this.pdf.internal.out(n(_)+" "+s(J)+" m")},C=function(_){var J;switch(_.align){case"right":case"end":J="right";break;case"center":J="center";break;case"left":case"start":default:J="left"}var M=this.pdf.getTextDimensions(_.text),I=Z.call(this,_.y),q=K.call(this,I)-M.h,oe=this.ctx.transform.applyToPoint(new o(_.x,I)),fe=this.ctx.transform.decompose(),ge=new c;ge=(ge=(ge=ge.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var Te,Ee,Fe,qe=this.ctx.transform.applyToRectangle(new l(_.x,I,M.w,M.h)),ct=ge.applyToRectangle(new l(_.x,q,M.w,M.h)),_e=k.call(this,ct),ae=[],St=0;St<_e.length;St+=1)ae.indexOf(_e[St])===-1&&ae.push(_e[St]);if(j(ae),this.autoPaging)for(var st=ae[0],$e=ae[ae.length-1],Ye=st;Ye<$e+1;Ye++){this.pdf.setPage(Ye);var Ge=Ye===1?this.posY+this.margin[0]:this.margin[0],He=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],it=this.pdf.internal.pageSize.height-this.margin[2],rt=it-this.margin[0],mt=this.pdf.internal.pageSize.width-this.margin[1],bt=mt-this.margin[3],me=Ye===1?0:He+(Ye-2)*rt;if(this.ctx.clip_path.length!==0){var Le=this.path;Te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(Te,this.posX+this.margin[3],-1*me+Ge),H.call(this,"fill",!0),this.path=Le}var Ce=b([JSON.parse(JSON.stringify(ct))],this.posX+this.margin[3],-me+Ge+this.ctx.prevPageLastElemOffset)[0];_.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*_.scale),Fe=this.lineWidth,this.lineWidth=Fe*_.scale);var Me=this.autoPaging!=="text";if(Me||Ce.y+Ce.h<=it){if(Me||Ce.y>=Ge&&Ce.x<=mt){var Ne=Me?_.text:this.pdf.splitTextToSize(_.text,_.maxWidth||mt-Ce.x)[0],gt=b([JSON.parse(JSON.stringify(qe))],this.posX+this.margin[3],-me+Ge+this.ctx.prevPageLastElemOffset)[0],et=Me&&(Ye>st||Ye<$e)&&S.call(this);et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,rt,null).clip().discardPath()),this.pdf.text(Ne,gt.x,gt.y,{angle:_.angle,align:J,renderingMode:_.renderingMode}),et&&this.pdf.restoreGraphicsState()}}else Ce.y<it&&(this.ctx.prevPageLastElemOffset+=it-Ce.y);_.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Fe)}else _.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*_.scale),Fe=this.lineWidth,this.lineWidth=Fe*_.scale),this.pdf.text(_.text,oe.x+this.posX,oe.y+this.posY,{angle:_.angle,align:J,renderingMode:_.renderingMode,maxWidth:_.maxWidth}),_.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=Fe)},R=function(_,J,M,I){M=M||0,I=I||0,this.pdf.internal.out(n(_+M)+" "+s(J+I)+" l")},V=function(_,J,M){return this.pdf.lines(_,J,M,null,null)},ie=function(_,J,M,I,q,oe,fe,ge){this.pdf.internal.out([e(i(M+_)),e(a(I+J)),e(i(q+_)),e(a(oe+J)),e(i(fe+_)),e(a(ge+J)),"c"].join(" "))},Q=function(_,J,M,I){for(var q=2*Math.PI,oe=Math.PI/2;J>M;)J-=q;var fe=Math.abs(M-J);fe<q&&I&&(fe=q-fe);for(var ge=[],Te=I?-1:1,Ee=J;fe>1e-5;){var Fe=Ee+Te*Math.min(fe,oe);ge.push(te.call(this,_,Ee,Fe)),fe-=Math.abs(Fe-Ee),Ee=Fe}return ge},te=function(_,J,M){var I=(M-J)/2,q=_*Math.cos(I),oe=_*Math.sin(I),fe=q,ge=-oe,Te=fe*fe+ge*ge,Ee=Te+fe*q+ge*oe,Fe=4/3*(Math.sqrt(2*Te*Ee)-Ee)/(fe*oe-ge*q),qe=fe-Fe*ge,ct=ge+Fe*fe,_e=qe,ae=-ct,St=I+J,st=Math.cos(St),$e=Math.sin(St);return{x1:_*Math.cos(J),y1:_*Math.sin(J),x2:qe*st-ct*$e,y2:qe*$e+ct*st,x3:_e*st-ae*$e,y3:_e*$e+ae*st,x4:_*Math.cos(M),y4:_*Math.sin(M)}},L=function(_){return 180*_/Math.PI},Y=function(_,J,M,I,q,oe){var fe=_+.5*(M-_),ge=J+.5*(I-J),Te=q+.5*(M-q),Ee=oe+.5*(I-oe),Fe=Math.min(_,q,fe,Te),qe=Math.max(_,q,fe,Te),ct=Math.min(J,oe,ge,Ee),_e=Math.max(J,oe,ge,Ee);return new l(Fe,ct,qe-Fe,_e-ct)},G=function(_,J,M,I,q,oe,fe,ge){var Te,Ee,Fe,qe,ct,_e,ae,St,st,$e,Ye,Ge,He,it,rt=M-_,mt=I-J,bt=q-M,me=oe-I,Le=fe-q,Ce=ge-oe;for(Ee=0;Ee<41;Ee++)st=(ae=(Fe=_+(Te=Ee/40)*rt)+Te*((ct=M+Te*bt)-Fe))+Te*(ct+Te*(q+Te*Le-ct)-ae),$e=(St=(qe=J+Te*mt)+Te*((_e=I+Te*me)-qe))+Te*(_e+Te*(oe+Te*Ce-_e)-St),Ee==0?(Ye=st,Ge=$e,He=st,it=$e):(Ye=Math.min(Ye,st),Ge=Math.min(Ge,$e),He=Math.max(He,st),it=Math.max(it,$e));return new l(Math.round(Ye),Math.round(Ge),Math.round(He-Ye),Math.round(it-Ge))},ce=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var _,J,M=(_=this.ctx.lineDash,J=this.ctx.lineDashOffset,JSON.stringify({lineDash:_,lineDashOffset:J}));this.prevLineDash!==M&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=M)}}})(Et.API),function(t){var e=function(a){var o,l,c,d,f,p,v,m,N,S;for(l=[],c=0,d=(a+=o="\0\0\0\0".slice(a.length%4||4)).length;d>c;c+=4)(f=(a.charCodeAt(c)<<24)+(a.charCodeAt(c+1)<<16)+(a.charCodeAt(c+2)<<8)+a.charCodeAt(c+3))!==0?(p=(f=((f=((f=((f=(f-(S=f%85))/85)-(N=f%85))/85)-(m=f%85))/85)-(v=f%85))/85)%85,l.push(p+33,v+33,m+33,N+33,S+33)):l.push(122);return function(k,y){for(var b=y;b>0;b--)k.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},n=function(a){var o,l,c,d,f,p=String,v="length",m=255,N="charCodeAt",S="slice",k="replace";for(a[S](-2),a=a[S](0,-2)[k](/\s/g,"")[k]("z","!!!!!"),c=[],d=0,f=(a+=o="uuuuu"[S](a[v]%5||5))[v];f>d;d+=5)l=52200625*(a[N](d)-33)+614125*(a[N](d+1)-33)+7225*(a[N](d+2)-33)+85*(a[N](d+3)-33)+(a[N](d+4)-33),c.push(m&l>>24,m&l>>16,m&l>>8,m&l);return function(y,b){for(var j=b;j>0;j--)y.pop()}(c,o[v]),p.fromCharCode.apply(p,c)},s=function(a){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),o.test(a)===!1)return"";for(var l="",c=0;c<a.length;c+=2)l+=String.fromCharCode("0x"+(a[c]+a[c+1]));return l},i=function(a){for(var o=new Uint8Array(a.length),l=a.length;l--;)o[l]=a.charCodeAt(l);return a=(o=Yp(o)).reduce(function(c,d){return c+String.fromCharCode(d)},"")};t.processDataByFilters=function(a,o){var l=0,c=a||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=n(c),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=s(c),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(f){return("0"+f.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:d.reverse().join(" ")}}}(Et.API),function(t){t.loadFile=function(e,n,s){return function(i,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,f){var p=new XMLHttpRequest,v=0,m=function(N){var S=N.length,k=[],y=String.fromCharCode;for(v=0;v<S;v+=1)k.push(y(255&N.charCodeAt(v)));return k.join("")};if(p.open("GET",c,!d),p.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(p.onload=function(){p.status===200?f(m(this.responseText)):f(void 0)}),p.send(null),d&&p.status===200)return m(p.responseText)}(i,a,o)}catch{}return l}(e,n,s)},t.loadImageFile=t.loadFile}(Et.API),function(t){function e(){return(zt.html2canvas?Promise.resolve(zt.html2canvas):Wa(()=>import("./html2canvas.esm-e0a7d97b.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function n(){return(zt.DOMPurify?Promise.resolve(zt.DOMPurify):Wa(()=>import("./purify.es-31816194.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var s=function(o){var l=hn(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(o,l){var c=document.createElement(o);for(var d in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[d]=l.style[d];return c},a=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),c);return d=(d=d.setProgress(1,o,1,[o])).set(l)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(o,l){return o.__proto__=l||a.prototype,o},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(s(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(n).then(function(c){return this.set({src:i("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},a.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(d,f){for(var p=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),v=d.firstChild;v;v=v.nextSibling)f!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||p.appendChild(c(v,f));return d.nodeType===1&&(d.nodeName==="CANVAS"?(p.width=d.width,p.height=d.height,p.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(p.value=d.value),p.addEventListener("load",function(){p.scrollTop=d.scrollTop,p.scrollLeft=d.scrollLeft},!0)),p}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=d,d)for(var v=0;v<d.length;++v){var m=d[v],N=m.src.find(function(S){return S.format==="truetype"});N&&c.addFont(N.url,m.ref.name,m.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,c.context2d.save(!0),l(this.prop.container,p)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},a.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},a.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},a.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(o){if(s(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in a.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},a.prototype.get=function(o,l){return this.then(function(){var c=o in a.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},a.prototype.setMargin=function(o){return this.then(function(){switch(s(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},a.prototype.setPageSize=function(o){function l(c,d){return Math.floor(c*d/72*96)}return this.then(function(){(o=o||Et.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},a.prototype.setProgress=function(o,l,c,d){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(o,l,c,d){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,d?this.progress.stack.concat(d):null)},a.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(d,f){return c.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(p){return c.updateProgress(null,d),p}).then(d,f).then(function(p){return c.updateProgress(1),p})})},a.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),f=c.call(d,o,l);return a.convert(f,this.__proto__)},a.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},a.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},a.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return a.convert(l,this)},a.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},a.prototype.error=function(o){return this.then(function(){throw new Error(o)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Et.getPageSize=function(o,l,c){if(hn(o)==="object"){var d=o;o=d.orientation,l=d.unit||l,c=d.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var f,p=(""+c).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+l}var m,N=0,S=0;if(v.hasOwnProperty(p))N=v[p][1]/f,S=v[p][0]/f;else try{N=c[1],S=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",S>N&&(m=S,S=N,N=m);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",N>S&&(m=S,S=N,N=m)}return{width:S,height:N,unit:l,k:f,orientation:o}},t.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(ng):null;var c=new a(l);return l.worker?c:c.from(o).doCallback()}}(Et.API),Et.API.addJS=function(t){return Lx=t,this.internal.events.subscribe("postPutResources",function(){Qd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Qd+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Px=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Lx+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Qd!==void 0&&Px!==void 0&&this.internal.out("/Names <</JavaScript "+Qd+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var n=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),a=0;a<i.length;a++){var o=i[a],l=s.exec(o);if(l!=null){var c=l[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,f=[];for(a=0;a<d;a++){var p=n.internal.newObject();f.push(p);var v=n.internal.getPageInfo(a+1);n.internal.write("<< /D["+v.objId+" 0 R /XYZ null null null]>> endobj")}var m=n.internal.newObject();for(n.internal.write("<< /Names [ "),a=0;a<f.length;a++)n.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");n.internal.write(" ] >>","endobj"),e=n.internal.newObject(),n.internal.write("<< /Dests "+m+" 0 R"),n.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(s,i,a){var o={title:i,options:a,children:[]};return s==null&&(s=this.root),s.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(s){s.id=n.internal.newObjectDeferred();for(var i=0;i<s.children.length;i++)this.genIds_r(s.children[i])},n.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},n.outline.renderItems=function(s){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<s.children.length;a++){var o=s.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(s)),a>0&&this.line("/Prev "+this.makeRef(s.children[a-1])),a<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var d=0;d<s.children.length;d++)this.renderItems(s.children[d])},n.outline.line=function(s){this.ctx.val+=s+`\r
`},n.outline.makeRef=function(s){return s.id+" 0 R"},n.outline.makeString=function(s){return"("+n.internal.pdfEscape(s)+")"},n.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(s,i){for(var a=0;a<i.children.length;a++)s.count++,this.count_r(s,i.children[a]);return s.count}}])}(Et.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(n,s,i,a,o,l){var c,d=this.decode.DCT_DECODE,f=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(c=function(p){for(var v,m=256*p.charCodeAt(4)+p.charCodeAt(5),N=p.length,S={width:0,height:0,numcomponents:1},k=4;k<N;k+=2){if(k+=m,e.indexOf(p.charCodeAt(k+1))!==-1){v=256*p.charCodeAt(k+5)+p.charCodeAt(k+6),S={width:256*p.charCodeAt(k+7)+p.charCodeAt(k+8),height:v,numcomponents:p.charCodeAt(k+9)};break}m=256*p.charCodeAt(k+2)+p.charCodeAt(k+3)}return S}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}f={data:n,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:s,alias:i}}return f}}(Et.API);var fl,Xd,Ix,Tx,Ex,t3=function(){var t,e,n;function s(a){var o,l,c,d,f,p,v,m,N,S,k,y,b,j;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},p=null;;){switch(o=this.readUInt32(),N=(function(){var z,H;for(H=[],z=0;z<4;++z)H.push(String.fromCharCode(this.data[this.pos++]));return H}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":p&&this.animation.frames.push(p),this.pos+=4,p={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),d=this.readUInt16()||100,p.delay=1e3*f/d,p.disposeOp=this.data[this.pos++],p.blendOp=this.data[this.pos++],p.data=[];break;case"IDAT":case"fdAT":for(N==="fdAT"&&(this.pos+=4,o-=4),a=(p!=null?p.data:void 0)||this.imgData,y=0;0<=o?y<o:y>o;0<=o?++y:--y)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((S=c-this.transparency.indexed.length)>0)for(b=0;0<=S?b<S:b>S;0<=S?++b:--b)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":v=(k=this.read(o)).indexOf(0),m=String.fromCharCode.apply(String,k.slice(0,v)),this.text[m]=String.fromCharCode.apply(String,k.slice(v+1));break;case"IEND":return p&&this.animation.frames.push(p),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(j=this.colorType)===4||j===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}s.prototype.read=function(a){var o,l;for(l=[],o=0;0<=a?o<a:o>a;0<=a?++o:--o)l.push(this.data[this.pos++]);return l},s.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.decodePixels=function(a){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,d=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function f(p,v,m,N){var S,k,y,b,j,z,H,Z,K,P,$,re,A,C,R,V,ie,Q,te,L,Y,G=Math.ceil((d.width-p)/m),ce=Math.ceil((d.height-v)/N),_=d.width==G&&d.height==ce;for(C=o*G,re=_?l:new Uint8Array(C*ce),z=a.length,A=0,k=0;A<ce&&c<z;){switch(a[c++]){case 0:for(b=ie=0;ie<C;b=ie+=1)re[k++]=a[c++];break;case 1:for(b=Q=0;Q<C;b=Q+=1)S=a[c++],j=b<o?0:re[k-o],re[k++]=(S+j)%256;break;case 2:for(b=te=0;te<C;b=te+=1)S=a[c++],y=(b-b%o)/o,R=A&&re[(A-1)*C+y*o+b%o],re[k++]=(R+S)%256;break;case 3:for(b=L=0;L<C;b=L+=1)S=a[c++],y=(b-b%o)/o,j=b<o?0:re[k-o],R=A&&re[(A-1)*C+y*o+b%o],re[k++]=(S+Math.floor((j+R)/2))%256;break;case 4:for(b=Y=0;Y<C;b=Y+=1)S=a[c++],y=(b-b%o)/o,j=b<o?0:re[k-o],A===0?R=V=0:(R=re[(A-1)*C+y*o+b%o],V=y&&re[(A-1)*C+(y-1)*o+b%o]),H=j+R-V,Z=Math.abs(H-j),P=Math.abs(H-R),$=Math.abs(H-V),K=Z<=P&&Z<=$?j:P<=$?R:V,re[k++]=(S+K)%256;break;default:throw new Error("Invalid filter algorithm: "+a[c-1])}if(!_){var J=((v+A*N)*d.width+p)*o,M=A*C;for(b=0;b<G;b+=1){for(var I=0;I<o;I+=1)l[J++]=re[M++];J+=(m-1)*o}}A++}}return a=ES(a),d.interlaceMethod==1?(f(0,0,8,8),f(4,0,8,8),f(0,4,4,8),f(2,0,4,4),f(0,2,2,4),f(1,0,2,2),f(0,1,1,2)):f(0,0,1,1),l},s.prototype.decodePalette=function(){var a,o,l,c,d,f,p,v,m;for(l=this.palette,f=this.transparency.indexed||[],d=new Uint8Array((f.length||0)+l.length),c=0,a=0,o=p=0,v=l.length;p<v;o=p+=3)d[c++]=l[o],d[c++]=l[o+1],d[c++]=l[o+2],d[c++]=(m=f[a++])!=null?m:255;return d},s.prototype.copyToImageData=function(a,o){var l,c,d,f,p,v,m,N,S,k,y;if(c=this.colors,S=null,l=this.hasAlphaChannel,this.palette.length&&(S=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),c=4,l=!0),N=(d=a.data||a).length,p=S||o,f=v=0,c===1)for(;f<N;)m=S?4*o[f/4]:v,k=p[m++],d[f++]=k,d[f++]=k,d[f++]=k,d[f++]=l?p[m++]:255,v=m;else for(;f<N;)m=S?4*o[f/4]:v,d[f++]=p[m++],d[f++]=p[m++],d[f++]=p[m++],d[f++]=l?p[m++]:255,v=m},s.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var i=function(){if(Object.prototype.toString.call(zt)==="[object Window]"){try{e=zt.document.createElement("canvas"),n=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(a){var o;if(i()===!0)return n.width=a.width,n.height=a.height,n.clearRect(0,0,a.width,a.height),n.putImageData(a,0,0),(o=new Image).src=e.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},s.prototype.decodeFrames=function(a){var o,l,c,d,f,p,v,m;if(this.animation){for(m=[],l=f=0,p=(v=this.animation.frames).length;f<p;l=++f)o=v[l],c=a.createImageData(o.width,o.height),d=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,d),o.imageData=c,m.push(o.image=t(c));return m}},s.prototype.renderFrame=function(a,o){var l,c,d;return l=(c=this.animation.frames)[o],d=c[o-1],o===0&&a.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?a.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&a.putImageData(d.imageData,d.xOffset,d.yOffset),l.blendOp===0&&a.clearRect(l.xOffset,l.yOffset,l.width,l.height),a.drawImage(l.image,l.xOffset,l.yOffset)},s.prototype.animate=function(a){var o,l,c,d,f,p,v=this;return l=0,p=this.animation,d=p.numFrames,c=p.frames,f=p.numPlays,(o=function(){var m,N;if(m=l++%d,N=c[m],v.renderFrame(a,m),d>1&&l/d<f)return v.animation._timeout=setTimeout(o,N.delay)})()},s.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},s.prototype.render=function(a){var o,l;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,o=a.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},s}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function n3(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,s=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,o=1<<(7&i)+1;t[e++],t[e++];var l=null,c=null;a&&(l=e,c=o,e+=3*o);var d=!0,f=[],p=0,v=null,m=0,N=null;for(this.width=n,this.height=s;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,N=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var S=t[e++];p=t[e++]|t[e++]<<8,v=t[e++],!(1&S)&&(v=null),m=S>>2&7,e++;break;case 254:for(;;){if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var k=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,j=t[e++]|t[e++]<<8,z=t[e++],H=z>>6&1,Z=1<<(7&z)+1,K=l,P=c,$=!1;z>>7&&($=!0,K=e,P=Z,e+=3*Z);var re=e;for(e++;;){var A;if(!((A=t[e++])>=0))throw Error("Invalid block size");if(A===0)break;e+=A}f.push({x:k,y,width:b,height:j,has_local_palette:$,palette_offset:K,palette_size:P,data_offset:re,data_length:e-re,transparent_index:v,interlaced:!!H,delay:p,disposal:m});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return N},this.frameInfo=function(C){if(C<0||C>=f.length)throw new Error("Frame index out of range.");return f[C]},this.decodeAndBlitFrameBGRA=function(C,R){var V=this.frameInfo(C),ie=V.width*V.height,Q=new Uint8Array(ie);zx(t,V.data_offset,Q,ie);var te=V.palette_offset,L=V.transparent_index;L===null&&(L=256);var Y=V.width,G=n-Y,ce=Y,_=4*(V.y*n+V.x),J=4*((V.y+V.height)*n+V.x),M=_,I=4*G;V.interlaced===!0&&(I+=4*n*7);for(var q=8,oe=0,fe=Q.length;oe<fe;++oe){var ge=Q[oe];if(ce===0&&(ce=Y,(M+=I)>=J&&(I=4*G+4*n*(q-1),M=_+(Y+G)*(q<<1),q>>=1)),ge===L)M+=4;else{var Te=t[te+3*ge],Ee=t[te+3*ge+1],Fe=t[te+3*ge+2];R[M++]=Fe,R[M++]=Ee,R[M++]=Te,R[M++]=255}--ce}},this.decodeAndBlitFrameRGBA=function(C,R){var V=this.frameInfo(C),ie=V.width*V.height,Q=new Uint8Array(ie);zx(t,V.data_offset,Q,ie);var te=V.palette_offset,L=V.transparent_index;L===null&&(L=256);var Y=V.width,G=n-Y,ce=Y,_=4*(V.y*n+V.x),J=4*((V.y+V.height)*n+V.x),M=_,I=4*G;V.interlaced===!0&&(I+=4*n*7);for(var q=8,oe=0,fe=Q.length;oe<fe;++oe){var ge=Q[oe];if(ce===0&&(ce=Y,(M+=I)>=J&&(I=4*G+4*n*(q-1),M=_+(Y+G)*(q<<1),q>>=1)),ge===L)M+=4;else{var Te=t[te+3*ge],Ee=t[te+3*ge+1],Fe=t[te+3*ge+2];R[M++]=Te,R[M++]=Ee,R[M++]=Fe,R[M++]=255}--ce}}}function zx(t,e,n,s){for(var i=t[e++],a=1<<i,o=a+1,l=o+1,c=i+1,d=(1<<c)-1,f=0,p=0,v=0,m=t[e++],N=new Int32Array(4096),S=null;;){for(;f<16&&m!==0;)p|=t[e++]<<f,f+=8,m===1?m=t[e++]:--m;if(f<c)break;var k=p&d;if(p>>=c,f-=c,k!==a){if(k===o)break;for(var y=k<l?k:S,b=0,j=y;j>a;)j=N[j]>>8,++b;var z=j;if(v+b+(y!==k?1:0)>s)return void gn.log("Warning, gif stream longer than expected.");n[v++]=z;var H=v+=b;for(y!==k&&(n[v++]=z),j=y;b--;)j=N[j],n[--H]=255&j,j>>=8;S!==null&&l<4096&&(N[l++]=S<<8|z,l>=d+1&&c<12&&(++c,d=d<<1|1)),S=k}else l=o+1,d=(1<<(c=i+1))-1,S=null}return v!==s&&gn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Rm(t){var e,n,s,i,a,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),f=new Array(64),p=new Array(65535),v=new Array(65535),m=new Array(64),N=new Array(64),S=[],k=0,y=7,b=new Array(64),j=new Array(64),z=new Array(64),H=new Array(256),Z=new Array(2048),K=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],$=[0,1,2,3,4,5,6,7,8,9,10,11],re=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],C=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ie=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Q(_,J){for(var M=0,I=0,q=new Array,oe=1;oe<=16;oe++){for(var fe=1;fe<=_[oe];fe++)q[J[I]]=[],q[J[I]][0]=M,q[J[I]][1]=oe,I++,M++;M*=2}return q}function te(_){for(var J=_[0],M=_[1]-1;M>=0;)J&1<<M&&(k|=1<<y),M--,--y<0&&(k==255?(L(255),L(0)):L(k),y=7,k=0)}function L(_){S.push(_)}function Y(_){L(_>>8&255),L(255&_)}function G(_,J,M,I,q){for(var oe,fe=q[0],ge=q[240],Te=function($e,Ye){var Ge,He,it,rt,mt,bt,me,Le,Ce,Me,Ne=0;for(Ce=0;Ce<8;++Ce){Ge=$e[Ne],He=$e[Ne+1],it=$e[Ne+2],rt=$e[Ne+3],mt=$e[Ne+4],bt=$e[Ne+5],me=$e[Ne+6];var gt=Ge+(Le=$e[Ne+7]),et=Ge-Le,ut=He+me,ye=He-me,Re=it+bt,xt=it-bt,vt=rt+mt,jt=rt-mt,Ot=gt+vt,en=gt-vt,It=ut+Re,wt=ut-Re;$e[Ne]=Ot+It,$e[Ne+4]=Ot-It;var Ze=.707106781*(wt+en);$e[Ne+2]=en+Ze,$e[Ne+6]=en-Ze;var dt=.382683433*((Ot=jt+xt)-(wt=ye+et)),Xt=.5411961*Ot+dt,Dt=1.306562965*wt+dt,Mt=.707106781*(It=xt+ye),an=et+Mt,ht=et-Mt;$e[Ne+5]=ht+Xt,$e[Ne+3]=ht-Xt,$e[Ne+1]=an+Dt,$e[Ne+7]=an-Dt,Ne+=8}for(Ne=0,Ce=0;Ce<8;++Ce){Ge=$e[Ne],He=$e[Ne+8],it=$e[Ne+16],rt=$e[Ne+24],mt=$e[Ne+32],bt=$e[Ne+40],me=$e[Ne+48];var _t=Ge+(Le=$e[Ne+56]),Mn=Ge-Le,Pn=He+me,Sn=He-me,vn=it+bt,gr=it-bt,fi=rt+mt,Qr=rt-mt,Sr=_t+fi,Ln=_t-fi,xr=Pn+vn,nr=Pn-vn;$e[Ne]=Sr+xr,$e[Ne+32]=Sr-xr;var _r=.707106781*(nr+Ln);$e[Ne+16]=Ln+_r,$e[Ne+48]=Ln-_r;var Hn=.382683433*((Sr=Qr+gr)-(nr=Sn+Mn)),fs=.5411961*Sr+Hn,Vs=1.306562965*nr+Hn,Gs=.707106781*(xr=gr+Sn),mi=Mn+Gs,pi=Mn-Gs;$e[Ne+40]=pi+fs,$e[Ne+24]=pi-fs,$e[Ne+8]=mi+Vs,$e[Ne+56]=mi-Vs,Ne++}for(Ce=0;Ce<64;++Ce)Me=$e[Ce]*Ye[Ce],m[Ce]=Me>0?Me+.5|0:Me-.5|0;return m}(_,J),Ee=0;Ee<64;++Ee)N[K[Ee]]=Te[Ee];var Fe=N[0]-M;M=N[0],Fe==0?te(I[0]):(te(I[v[oe=32767+Fe]]),te(p[oe]));for(var qe=63;qe>0&&N[qe]==0;)qe--;if(qe==0)return te(fe),M;for(var ct,_e=1;_e<=qe;){for(var ae=_e;N[_e]==0&&_e<=qe;)++_e;var St=_e-ae;if(St>=16){ct=St>>4;for(var st=1;st<=ct;++st)te(ge);St&=15}oe=32767+N[_e],te(q[(St<<4)+v[oe]]),te(p[oe]),_e++}return qe!=63&&te(fe),M}function ce(_){_=Math.min(Math.max(_,1),100),a!=_&&(function(J){for(var M=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],I=0;I<64;I++){var q=o((M[I]*J+50)/100);q=Math.min(Math.max(q,1),255),l[K[I]]=q}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var ge=o((oe[fe]*J+50)/100);ge=Math.min(Math.max(ge,1),255),c[K[fe]]=ge}for(var Te=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ee=0,Fe=0;Fe<8;Fe++)for(var qe=0;qe<8;qe++)d[Ee]=1/(l[K[Ee]]*Te[Fe]*Te[qe]*8),f[Ee]=1/(c[K[Ee]]*Te[Fe]*Te[qe]*8),Ee++}(_<50?Math.floor(5e3/_):Math.floor(200-2*_)),a=_)}this.encode=function(_,J){J&&ce(J),S=new Array,k=0,y=7,Y(65496),Y(65504),Y(16),L(74),L(70),L(73),L(70),L(0),L(1),L(1),L(0),Y(1),Y(1),L(0),L(0),function(){Y(65499),Y(132),L(0);for(var He=0;He<64;He++)L(l[He]);L(1);for(var it=0;it<64;it++)L(c[it])}(),function(He,it){Y(65472),Y(17),L(8),Y(it),Y(He),L(3),L(1),L(17),L(0),L(2),L(17),L(1),L(3),L(17),L(1)}(_.width,_.height),function(){Y(65476),Y(418),L(0);for(var He=0;He<16;He++)L(P[He+1]);for(var it=0;it<=11;it++)L($[it]);L(16);for(var rt=0;rt<16;rt++)L(re[rt+1]);for(var mt=0;mt<=161;mt++)L(A[mt]);L(1);for(var bt=0;bt<16;bt++)L(C[bt+1]);for(var me=0;me<=11;me++)L(R[me]);L(17);for(var Le=0;Le<16;Le++)L(V[Le+1]);for(var Ce=0;Ce<=161;Ce++)L(ie[Ce])}(),Y(65498),Y(12),L(3),L(1),L(0),L(2),L(17),L(3),L(17),L(0),L(63),L(0);var M=0,I=0,q=0;k=0,y=7,this.encode.displayName="_encode_";for(var oe,fe,ge,Te,Ee,Fe,qe,ct,_e,ae=_.data,St=_.width,st=_.height,$e=4*St,Ye=0;Ye<st;){for(oe=0;oe<$e;){for(Ee=$e*Ye+oe,qe=-1,ct=0,_e=0;_e<64;_e++)Fe=Ee+(ct=_e>>3)*$e+(qe=4*(7&_e)),Ye+ct>=st&&(Fe-=$e*(Ye+1+ct-st)),oe+qe>=$e&&(Fe-=oe+qe-$e+4),fe=ae[Fe++],ge=ae[Fe++],Te=ae[Fe++],b[_e]=(Z[fe]+Z[ge+256>>0]+Z[Te+512>>0]>>16)-128,j[_e]=(Z[fe+768>>0]+Z[ge+1024>>0]+Z[Te+1280>>0]>>16)-128,z[_e]=(Z[fe+1280>>0]+Z[ge+1536>>0]+Z[Te+1792>>0]>>16)-128;M=G(b,d,M,e,s),I=G(j,f,I,n,i),q=G(z,f,q,n,i),oe+=32}Ye+=8}if(y>=0){var Ge=[];Ge[1]=y+1,Ge[0]=(1<<y+1)-1,te(Ge)}return Y(65497),new Uint8Array(S)},t=t||50,function(){for(var _=String.fromCharCode,J=0;J<256;J++)H[J]=_(J)}(),e=Q(P,$),n=Q(C,R),s=Q(re,A),i=Q(V,ie),function(){for(var _=1,J=2,M=1;M<=15;M++){for(var I=_;I<J;I++)v[32767+I]=M,p[32767+I]=[],p[32767+I][1]=M,p[32767+I][0]=I;for(var q=-(J-1);q<=-_;q++)v[32767+q]=M,p[32767+q]=[],p[32767+q][1]=M,p[32767+q][0]=J-1+q;_<<=1,J<<=1}}(),function(){for(var _=0;_<256;_++)Z[_]=19595*_,Z[_+256>>0]=38470*_,Z[_+512>>0]=7471*_+32768,Z[_+768>>0]=-11059*_,Z[_+1024>>0]=-21709*_,Z[_+1280>>0]=32768*_+8421375,Z[_+1536>>0]=-27439*_,Z[_+1792>>0]=-5329*_}(),ce(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ei(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Ox(t){function e(P){if(!P)throw Error("assert :P")}function n(P,$,re){for(var A=0;4>A;A++)if(P[$+A]!=re.charCodeAt(A))return!0;return!1}function s(P,$,re,A,C){for(var R=0;R<C;R++)P[$+R]=re[A+R]}function i(P,$,re,A){for(var C=0;C<A;C++)P[$+C]=re}function a(P){return new Int32Array(P)}function o(P,$){for(var re=[],A=0;A<P;A++)re.push(new $);return re}function l(P,$){var re=[];return function A(C,R,V){for(var ie=V[R],Q=0;Q<ie&&(C.push(V.length>R+1?[]:new $),!(V.length<R+1));Q++)A(C[Q],R+1,V)}(re,0,P),re}var c=function(){var P=this;function $(u,h){for(var x=1<<h-1>>>0;u&x;)x>>>=1;return x?(u&x-1)+x:u}function re(u,h,x,w,T){e(!(w%x));do u[h+(w-=x)]=T;while(0<w)}function A(u,h,x,w,T){if(e(2328>=T),512>=T)var O=a(512);else if((O=a(T))==null)return 0;return function(D,F,U,ne,de,be){var we,xe,De=F,Ae=1<<U,he=a(16),pe=a(16);for(e(de!=0),e(ne!=null),e(D!=null),e(0<U),xe=0;xe<de;++xe){if(15<ne[xe])return 0;++he[ne[xe]]}if(he[0]==de)return 0;for(pe[1]=0,we=1;15>we;++we){if(he[we]>1<<we)return 0;pe[we+1]=pe[we]+he[we]}for(xe=0;xe<de;++xe)we=ne[xe],0<ne[xe]&&(be[pe[we]++]=xe);if(pe[15]==1)return(ne=new C).g=0,ne.value=be[0],re(D,De,1,Ae,ne),Ae;var ze,Be=-1,Oe=Ae-1,lt=0,tt=1,Lt=1,nt=1<<U;for(xe=0,we=1,de=2;we<=U;++we,de<<=1){if(tt+=Lt<<=1,0>(Lt-=he[we]))return 0;for(;0<he[we];--he[we])(ne=new C).g=we,ne.value=be[xe++],re(D,De+lt,de,nt,ne),lt=$(lt,we)}for(we=U+1,de=2;15>=we;++we,de<<=1){if(tt+=Lt<<=1,0>(Lt-=he[we]))return 0;for(;0<he[we];--he[we]){if(ne=new C,(lt&Oe)!=Be){for(De+=nt,ze=1<<(Be=we)-U;15>Be&&!(0>=(ze-=he[Be]));)++Be,ze<<=1;Ae+=nt=1<<(ze=Be-U),D[F+(Be=lt&Oe)].g=ze+U,D[F+Be].value=De-F-Be}ne.g=we-U,ne.value=be[xe++],re(D,De+(lt>>U),de,nt,ne),lt=$(lt,we)}}return tt!=2*pe[15]-1?0:Ae}(u,h,x,w,T,O)}function C(){this.value=this.g=0}function R(){this.value=this.g=0}function V(){this.G=o(5,C),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(yr,R)}function ie(u,h,x,w){e(u!=null),e(h!=null),e(2147483648>w),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=h,u.pa=x,u.Jd=h,u.Yc=x+w,u.Zc=4<=w?x+w-4+1:x,oe(u)}function Q(u,h){for(var x=0;0<h--;)x|=ge(u,128)<<h;return x}function te(u,h){var x=Q(u,h);return fe(u)?-x:x}function L(u,h,x,w){var T,O=0;for(e(u!=null),e(h!=null),e(4294967288>w),u.Sb=w,u.Ra=0,u.u=0,u.h=0,4<w&&(w=4),T=0;T<w;++T)O+=h[x+T]<<8*T;u.Ra=O,u.bb=w,u.oa=h,u.pa=x}function Y(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<Ko-8>>>0,++u.bb,u.u-=8;M(u)&&(u.h=1,u.u=0)}function G(u,h){if(e(0<=h),!u.h&&h<=Jo){var x=J(u)&Wo[h];return u.u+=h,Y(u),x}return u.h=1,u.u=0}function ce(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function _(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function J(u){return u.Ra>>>(u.u&Ko-1)>>>0}function M(u){return e(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>Ko}function I(u,h){u.u=h,u.h=M(u)}function q(u){u.u>=Sc&&(e(u.u>=Sc),Y(u))}function oe(u){e(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(e(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function fe(u){return Q(u,1)}function ge(u,h){var x=u.Ca;0>u.b&&oe(u);var w=u.b,T=x*h>>>8,O=(u.I>>>w>T)+0;for(O?(x-=T,u.I-=T+1<<w>>>0):x=T+1,w=x,T=0;256<=w;)T+=8,w>>=8;return w=7^T+Zr[w],u.b-=w,u.Ca=(x<<w)-1,O}function Te(u,h,x){u[h+0]=x>>24&255,u[h+1]=x>>16&255,u[h+2]=x>>8&255,u[h+3]=x>>0&255}function Ee(u,h){return u[h+0]<<0|u[h+1]<<8}function Fe(u,h){return Ee(u,h)|u[h+2]<<16}function qe(u,h){return Ee(u,h)|Ee(u,h+2)<<16}function ct(u,h){var x=1<<h;return e(u!=null),e(0<h),u.X=a(x),u.X==null?0:(u.Mb=32-h,u.Xa=h,1)}function _e(u,h){e(u!=null),e(h!=null),e(u.Xa==h.Xa),s(h.X,0,u.X,0,1<<h.Xa)}function ae(){this.X=[],this.Xa=this.Mb=0}function St(u,h,x,w){e(x!=null),e(w!=null);var T=x[0],O=w[0];return T==0&&(T=(u*O+h/2)/h),O==0&&(O=(h*T+u/2)/u),0>=T||0>=O?0:(x[0]=T,w[0]=O,1)}function st(u,h){return u+(1<<h)-1>>>h}function $e(u,h){return((4278255360&u)+(4278255360&h)>>>0&4278255360)+((16711935&u)+(16711935&h)>>>0&16711935)>>>0}function Ye(u,h){P[h]=function(x,w,T,O,D,F,U){var ne;for(ne=0;ne<D;++ne){var de=P[u](F[U+ne-1],T,O+ne);F[U+ne]=$e(x[w+ne],de)}}}function Ge(){this.ud=this.hd=this.jd=0}function He(u,h){return((4278124286&(u^h))>>>1)+(u&h)>>>0}function it(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function rt(u,h){return it(u+(u-h+.5>>1))}function mt(u,h,x){return Math.abs(h-x)-Math.abs(u-x)}function bt(u,h,x,w,T,O,D){for(w=O[D-1],x=0;x<T;++x)O[D+x]=w=$e(u[h+x],w)}function me(u,h,x,w,T){var O;for(O=0;O<x;++O){var D=u[h+O],F=D>>8&255,U=16711935&(U=(U=16711935&D)+((F<<16)+F));w[T+O]=(4278255360&D)+U>>>0}}function Le(u,h){h.jd=u>>0&255,h.hd=u>>8&255,h.ud=u>>16&255}function Ce(u,h,x,w,T,O){var D;for(D=0;D<w;++D){var F=h[x+D],U=F>>>8,ne=F,de=255&(de=(de=F>>>16)+((u.jd<<24>>24)*(U<<24>>24)>>>5));ne=255&(ne=(ne=ne+((u.hd<<24>>24)*(U<<24>>24)>>>5))+((u.ud<<24>>24)*(de<<24>>24)>>>5)),T[O+D]=(4278255360&F)+(de<<16)+ne}}function Me(u,h,x,w,T){P[h]=function(O,D,F,U,ne,de,be,we,xe){for(U=be;U<we;++U)for(be=0;be<xe;++be)ne[de++]=T(F[w(O[D++])])},P[u]=function(O,D,F,U,ne,de,be){var we=8>>O.b,xe=O.Ea,De=O.K[0],Ae=O.w;if(8>we)for(O=(1<<O.b)-1,Ae=(1<<we)-1;D<F;++D){var he,pe=0;for(he=0;he<xe;++he)he&O||(pe=w(U[ne++])),de[be++]=T(De[pe&Ae]),pe>>=we}else P["VP8LMapColor"+x](U,ne,De,Ae,de,be,D,F,xe)}}function Ne(u,h,x,w,T){for(x=h+x;h<x;){var O=u[h++];w[T++]=O>>16&255,w[T++]=O>>8&255,w[T++]=O>>0&255}}function gt(u,h,x,w,T){for(x=h+x;h<x;){var O=u[h++];w[T++]=O>>16&255,w[T++]=O>>8&255,w[T++]=O>>0&255,w[T++]=O>>24&255}}function et(u,h,x,w,T){for(x=h+x;h<x;){var O=(D=u[h++])>>16&240|D>>12&15,D=D>>0&240|D>>28&15;w[T++]=O,w[T++]=D}}function ut(u,h,x,w,T){for(x=h+x;h<x;){var O=(D=u[h++])>>16&248|D>>13&7,D=D>>5&224|D>>3&31;w[T++]=O,w[T++]=D}}function ye(u,h,x,w,T){for(x=h+x;h<x;){var O=u[h++];w[T++]=O>>0&255,w[T++]=O>>8&255,w[T++]=O>>16&255}}function Re(u,h,x,w,T,O){if(O==0)for(x=h+x;h<x;)Te(w,((O=u[h++])[0]>>24|O[1]>>8&65280|O[2]<<8&16711680|O[3]<<24)>>>0),T+=32;else s(w,T,u,h,x)}function xt(u,h){P[h][0]=P[u+"0"],P[h][1]=P[u+"1"],P[h][2]=P[u+"2"],P[h][3]=P[u+"3"],P[h][4]=P[u+"4"],P[h][5]=P[u+"5"],P[h][6]=P[u+"6"],P[h][7]=P[u+"7"],P[h][8]=P[u+"8"],P[h][9]=P[u+"9"],P[h][10]=P[u+"10"],P[h][11]=P[u+"11"],P[h][12]=P[u+"12"],P[h][13]=P[u+"13"],P[h][14]=P[u+"0"],P[h][15]=P[u+"0"]}function vt(u){return u==zf||u==Of||u==ud||u==Df}function jt(){this.eb=[],this.size=this.A=this.fb=0}function Ot(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function en(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new jt,this.f.kb=new Ot,this.sd=null}function It(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function wt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ze(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function dt(u,h){var x=u.T,w=h.ba.f.RGBA,T=w.eb,O=w.fb+u.ka*w.A,D=Is[h.ba.S],F=u.y,U=u.O,ne=u.f,de=u.N,be=u.ea,we=u.W,xe=h.cc,De=h.dc,Ae=h.Mc,he=h.Nc,pe=u.ka,ze=u.ka+u.T,Be=u.U,Oe=Be+1>>1;for(pe==0?D(F,U,null,null,ne,de,be,we,ne,de,be,we,T,O,null,null,Be):(D(h.ec,h.fc,F,U,xe,De,Ae,he,ne,de,be,we,T,O-w.A,T,O,Be),++x);pe+2<ze;pe+=2)xe=ne,De=de,Ae=be,he=we,de+=u.Rc,we+=u.Rc,O+=2*w.A,D(F,(U+=2*u.fa)-u.fa,F,U,xe,De,Ae,he,ne,de,be,we,T,O-w.A,T,O,Be);return U+=u.fa,u.j+ze<u.o?(s(h.ec,h.fc,F,U,Be),s(h.cc,h.dc,ne,de,Oe),s(h.Mc,h.Nc,be,we,Oe),x--):1&ze||D(F,U,null,null,ne,de,be,we,ne,de,be,we,T,O+w.A,null,null,Be),x}function Xt(u,h,x){var w=u.F,T=[u.J];if(w!=null){var O=u.U,D=h.ba.S,F=D==cd||D==ud;h=h.ba.f.RGBA;var U=[0],ne=u.ka;U[0]=u.T,u.Kb&&(ne==0?--U[0]:(--ne,T[0]-=u.width),u.j+u.ka+u.T==u.o&&(U[0]=u.o-u.j-ne));var de=h.eb;ne=h.fb+ne*h.A,u=bn(w,T[0],u.width,O,U,de,ne+(F?0:3),h.A),e(x==U),u&&vt(D)&&Ps(de,ne,F,O,U,h.A)}return 0}function Dt(u){var h=u.ma,x=h.ba.S,w=11>x,T=x==od||x==ld||x==cd||x==Ef||x==12||vt(x);if(h.memory=null,h.Ib=null,h.Jb=null,h.Nd=null,!Nc(h.Oa,u,T?11:12))return 0;if(T&&vt(x)&&Ue(),u.da)alert("todo:use_scaling");else{if(w){if(h.Ib=Ze,u.Kb){if(x=u.U+1>>1,h.memory=a(u.U+2*x),h.memory==null)return 0;h.ec=h.memory,h.fc=0,h.cc=h.ec,h.dc=h.fc+u.U,h.Mc=h.cc,h.Nc=h.dc+x,h.Ib=dt,Ue()}}else alert("todo:EmitYUV");T&&(h.Jb=Xt,w&&ve())}if(w&&!y0){for(u=0;256>u;++u)y5[u]=89858*(u-128)+hd>>dd,N5[u]=-22014*(u-128)+hd,w5[u]=-45773*(u-128),b5[u]=113618*(u-128)+hd>>dd;for(u=Ic;u<Ff;++u)h=76283*(u-16)+hd>>dd,j5[u-Ic]=ms(h,255),S5[u-Ic]=ms(h+8>>4,15);y0=1}return 1}function Mt(u){var h=u.ma,x=u.U,w=u.T;return e(!(1&u.ka)),0>=x||0>=w?0:(x=h.Ib(u,h),h.Jb!=null&&h.Jb(u,h,x),h.Dc+=x,1)}function an(u){u.ma.memory=null}function ht(u,h,x,w){return G(u,8)!=47?0:(h[0]=G(u,14)+1,x[0]=G(u,14)+1,w[0]=G(u,1),G(u,3)!=0?0:!u.h)}function _t(u,h){if(4>u)return u+1;var x=u-2>>1;return(2+(1&u)<<x)+G(h,x)+1}function Mn(u,h){return 120<h?h-120:1<=(x=((x=i5[h-1])>>4)*u+(8-(15&x)))?x:1;var x}function Pn(u,h,x){var w=J(x),T=u[h+=255&w].g-8;return 0<T&&(I(x,x.u+8),w=J(x),h+=u[h].value,h+=w&(1<<T)-1),I(x,x.u+u[h].g),u[h].value}function Sn(u,h,x){return x.g+=u.g,x.value+=u.value<<h>>>0,e(8>=x.g),u.g}function vn(u,h,x){var w=u.xc;return e((h=w==0?0:u.vc[u.md*(x>>w)+(h>>w)])<u.Wb),u.Ya[h]}function gr(u,h,x,w){var T=u.ab,O=u.c*h,D=u.C;h=D+h;var F=x,U=w;for(w=u.Ta,x=u.Ua;0<T--;){var ne=u.gc[T],de=D,be=h,we=F,xe=U,De=(U=w,F=x,ne.Ea);switch(e(de<be),e(be<=ne.nc),ne.hc){case 2:ed(we,xe,(be-de)*De,U,F);break;case 0:var Ae=de,he=be,pe=U,ze=F,Be=(nt=ne).Ea;Ae==0&&(If(we,xe,null,null,1,pe,ze),bt(we,xe+1,0,0,Be-1,pe,ze+1),xe+=Be,ze+=Be,++Ae);for(var Oe=1<<nt.b,lt=Oe-1,tt=st(Be,nt.b),Lt=nt.K,nt=nt.w+(Ae>>nt.b)*tt;Ae<he;){var on=Lt,cn=nt,nn=1;for(_c(we,xe,pe,ze-Be,1,pe,ze);nn<Be;){var Qt=(nn&~lt)+Oe;Qt>Be&&(Qt=Be),(0,da[on[cn++]>>8&15])(we,xe+ +nn,pe,ze+nn-Be,Qt-nn,pe,ze+nn),nn=Qt}xe+=Be,ze+=Be,++Ae&lt||(nt+=tt)}be!=ne.nc&&s(U,F-De,U,F+(be-de-1)*De,De);break;case 1:for(De=we,he=xe,Be=(we=ne.Ea)-(ze=we&~(pe=(xe=1<<ne.b)-1)),Ae=st(we,ne.b),Oe=ne.K,ne=ne.w+(de>>ne.b)*Ae;de<be;){for(lt=Oe,tt=ne,Lt=new Ge,nt=he+ze,on=he+we;he<nt;)Le(lt[tt++],Lt),oo(Lt,De,he,xe,U,F),he+=xe,F+=xe;he<on&&(Le(lt[tt++],Lt),oo(Lt,De,he,Be,U,F),he+=Be,F+=Be),++de&pe||(ne+=Ae)}break;case 3:if(we==U&&xe==F&&0<ne.b){for(he=U,we=De=F+(be-de)*De-(ze=(be-de)*st(ne.Ea,ne.b)),xe=U,pe=F,Ae=[],ze=(Be=ze)-1;0<=ze;--ze)Ae[ze]=xe[pe+ze];for(ze=Be-1;0<=ze;--ze)he[we+ze]=Ae[ze];Cs(ne,de,be,U,De,U,F)}else Cs(ne,de,be,we,xe,U,F)}F=w,U=x}U!=x&&s(w,x,F,U,O)}function fi(u,h){var x=u.V,w=u.Ba+u.c*u.C,T=h-u.C;if(e(h<=u.l.o),e(16>=T),0<T){var O=u.l,D=u.Ta,F=u.Ua,U=O.width;if(gr(u,T,x,w),T=F=[F],e((x=u.C)<(w=h)),e(O.v<O.va),w>O.o&&(w=O.o),x<O.j){var ne=O.j-x;x=O.j,T[0]+=ne*U}if(x>=w?x=0:(T[0]+=4*O.v,O.ka=x-O.j,O.U=O.va-O.v,O.T=w-x,x=1),x){if(F=F[0],11>(x=u.ca).S){var de=x.f.RGBA,be=(w=x.S,T=O.U,O=O.T,ne=de.eb,de.A),we=O;for(de=de.fb+u.Ma*de.A;0<we--;){var xe=D,De=F,Ae=T,he=ne,pe=de;switch(w){case ad:es(xe,De,Ae,he,pe);break;case od:Br(xe,De,Ae,he,pe);break;case zf:Br(xe,De,Ae,he,pe),Ps(he,pe,0,Ae,1,0);break;case c0:Ri(xe,De,Ae,he,pe);break;case ld:Re(xe,De,Ae,he,pe,1);break;case Of:Re(xe,De,Ae,he,pe,1),Ps(he,pe,0,Ae,1,0);break;case cd:Re(xe,De,Ae,he,pe,0);break;case ud:Re(xe,De,Ae,he,pe,0),Ps(he,pe,1,Ae,1,0);break;case Ef:ha(xe,De,Ae,he,pe);break;case Df:ha(xe,De,Ae,he,pe),yn(he,pe,Ae,1,0);break;case u0:Mi(xe,De,Ae,he,pe);break;default:e(0)}F+=U,de+=be}u.Ma+=O}else alert("todo:EmitRescaledRowsYUVA");e(u.Ma<=x.height)}}u.C=h,e(u.C<=u.i)}function Qr(u){var h;if(0<u.ua)return 0;for(h=0;h<u.Wb;++h){var x=u.Ya[h].G,w=u.Ya[h].H;if(0<x[1][w[1]+0].g||0<x[2][w[2]+0].g||0<x[3][w[3]+0].g)return 0}return 1}function Sr(u,h,x,w,T,O){if(u.Z!=0){var D=u.qd,F=u.rd;for(e(ga[u.Z]!=null);h<x;++h)ga[u.Z](D,F,w,T,w,T,O),D=w,F=T,T+=O;u.qd=D,u.rd=F}}function Ln(u,h){var x=u.l.ma,w=x.Z==0||x.Z==1?u.l.j:u.C;if(w=u.C<w?w:u.C,e(h<=u.l.o),h>w){var T=u.l.width,O=x.ca,D=x.tb+T*w,F=u.V,U=u.Ba+u.c*w,ne=u.gc;e(u.ab==1),e(ne[0].hc==3),td(ne[0],w,h,F,U,O,D),Sr(x,w,h,O,D,T)}u.C=u.Ma=h}function xr(u,h,x,w,T,O,D){var F=u.$/w,U=u.$%w,ne=u.m,de=u.s,be=x+u.$,we=be;T=x+w*T;var xe=x+w*O,De=280+de.ua,Ae=u.Pb?F:16777216,he=0<de.ua?de.Wa:null,pe=de.wc,ze=be<xe?vn(de,U,F):null;e(u.C<O),e(xe<=T);var Be=!1;e:for(;;){for(;Be||be<xe;){var Oe=0;if(F>=Ae){var lt=be-x;e((Ae=u).Pb),Ae.wd=Ae.m,Ae.xd=lt,0<Ae.s.ua&&_e(Ae.s.Wa,Ae.s.vb),Ae=F+o5}if(U&pe||(ze=vn(de,U,F)),e(ze!=null),ze.Qb&&(h[be]=ze.qb,Be=!0),!Be)if(q(ne),ze.jc){Oe=ne,lt=h;var tt=be,Lt=ze.pd[J(Oe)&yr-1];e(ze.jc),256>Lt.g?(I(Oe,Oe.u+Lt.g),lt[tt]=Lt.value,Oe=0):(I(Oe,Oe.u+Lt.g-256),e(256<=Lt.value),Oe=Lt.value),Oe==0&&(Be=!0)}else Oe=Pn(ze.G[0],ze.H[0],ne);if(ne.h)break;if(Be||256>Oe){if(!Be)if(ze.nd)h[be]=(ze.qb|Oe<<8)>>>0;else{if(q(ne),Be=Pn(ze.G[1],ze.H[1],ne),q(ne),lt=Pn(ze.G[2],ze.H[2],ne),tt=Pn(ze.G[3],ze.H[3],ne),ne.h)break;h[be]=(tt<<24|Be<<16|Oe<<8|lt)>>>0}if(Be=!1,++be,++U>=w&&(U=0,++F,D!=null&&F<=O&&!(F%16)&&D(u,F),he!=null))for(;we<be;)Oe=h[we++],he.X[(506832829*Oe&4294967295)>>>he.Mb]=Oe}else if(280>Oe){if(Oe=_t(Oe-256,ne),lt=Pn(ze.G[4],ze.H[4],ne),q(ne),lt=Mn(w,lt=_t(lt,ne)),ne.h)break;if(be-x<lt||T-be<Oe)break e;for(tt=0;tt<Oe;++tt)h[be+tt]=h[be+tt-lt];for(be+=Oe,U+=Oe;U>=w;)U-=w,++F,D!=null&&F<=O&&!(F%16)&&D(u,F);if(e(be<=T),U&pe&&(ze=vn(de,U,F)),he!=null)for(;we<be;)Oe=h[we++],he.X[(506832829*Oe&4294967295)>>>he.Mb]=Oe}else{if(!(Oe<De))break e;for(Be=Oe-280,e(he!=null);we<be;)Oe=h[we++],he.X[(506832829*Oe&4294967295)>>>he.Mb]=Oe;Oe=be,e(!(Be>>>(lt=he).Xa)),h[Oe]=lt.X[Be],Be=!0}Be||e(ne.h==M(ne))}if(u.Pb&&ne.h&&be<T)e(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&_e(u.s.vb,u.s.Wa);else{if(ne.h)break e;D!=null&&D(u,F>O?O:F),u.a=0,u.$=be-x}return 1}return u.a=3,0}function nr(u){e(u!=null),u.vc=null,u.yc=null,u.Ya=null;var h=u.Wa;h!=null&&(h.X=null),u.vb=null,e(u!=null)}function _r(){var u=new Lf;return u==null?null:(u.a=0,u.xb=f0,xt("Predictor","VP8LPredictors"),xt("Predictor","VP8LPredictors_C"),xt("PredictorAdd","VP8LPredictorsAdd"),xt("PredictorAdd","VP8LPredictorsAdd_C"),ed=me,oo=Ce,es=Ne,Br=gt,ha=et,Mi=ut,Ri=ye,P.VP8LMapColor32b=Yo,P.VP8LMapColor8b=nd,u)}function Hn(u,h,x,w,T){var O=1,D=[u],F=[h],U=w.m,ne=w.s,de=null,be=0;e:for(;;){if(x)for(;O&&G(U,1);){var we=D,xe=F,De=w,Ae=1,he=De.m,pe=De.gc[De.ab],ze=G(he,2);if(De.Oc&1<<ze)O=0;else{switch(De.Oc|=1<<ze,pe.hc=ze,pe.Ea=we[0],pe.nc=xe[0],pe.K=[null],++De.ab,e(4>=De.ab),ze){case 0:case 1:pe.b=G(he,3)+2,Ae=Hn(st(pe.Ea,pe.b),st(pe.nc,pe.b),0,De,pe.K),pe.K=pe.K[0];break;case 3:var Be,Oe=G(he,8)+1,lt=16<Oe?0:4<Oe?1:2<Oe?2:3;if(we[0]=st(pe.Ea,lt),pe.b=lt,Be=Ae=Hn(Oe,1,0,De,pe.K)){var tt,Lt=Oe,nt=pe,on=1<<(8>>nt.b),cn=a(on);if(cn==null)Be=0;else{var nn=nt.K[0],Qt=nt.w;for(cn[0]=nt.K[0][0],tt=1;tt<1*Lt;++tt)cn[tt]=$e(nn[Qt+tt],cn[tt-1]);for(;tt<4*on;++tt)cn[tt]=0;nt.K[0]=null,nt.K[0]=cn,Be=1}}Ae=Be;break;case 2:break;default:e(0)}O=Ae}}if(D=D[0],F=F[0],O&&G(U,1)&&!(O=1<=(be=G(U,4))&&11>=be)){w.a=3;break e}var pn;if(pn=O)t:{var mn,Ht,Xn,ts=w,Zn=D,ns=F,un=be,gs=x,xs=ts.m,ur=ts.s,br=[null],qr=1,Ts=0,wi=a5[un];n:for(;;){if(gs&&G(xs,1)){var dr=G(xs,3)+2,qi=st(Zn,dr),fo=st(ns,dr),tl=qi*fo;if(!Hn(qi,fo,0,ts,br))break n;for(br=br[0],ur.xc=dr,mn=0;mn<tl;++mn){var xa=br[mn]>>8&65535;br[mn]=xa,xa>=qr&&(qr=xa+1)}}if(xs.h)break n;for(Ht=0;5>Ht;++Ht){var Fn=d0[Ht];!Ht&&0<un&&(Fn+=1<<un),Ts<Fn&&(Ts=Fn)}var Bf=o(qr*wi,C),N0=qr,j0=o(N0,V);if(j0==null)var md=null;else e(65536>=N0),md=j0;var Tc=a(Ts);if(md==null||Tc==null||Bf==null){ts.a=1;break n}var pd=Bf;for(mn=Xn=0;mn<qr;++mn){var Qs=md[mn],nl=Qs.G,rl=Qs.H,S0=0,gd=1,_0=0;for(Ht=0;5>Ht;++Ht){Fn=d0[Ht],nl[Ht]=pd,rl[Ht]=Xn,!Ht&&0<un&&(Fn+=1<<un);s:{var xd,$f=Fn,vd=ts,Ec=Tc,k5=pd,A5=Xn,qf=0,va=vd.m,P5=G(va,1);if(i(Ec,0,0,$f),P5){var L5=G(va,1)+1,I5=G(va,1),C0=G(va,I5==0?1:8);Ec[C0]=1,L5==2&&(Ec[C0=G(va,8)]=1);var yd=1}else{var k0=a(19),A0=G(va,4)+4;if(19<A0){vd.a=3;var bd=0;break s}for(xd=0;xd<A0;++xd)k0[s5[xd]]=G(va,3);var Uf=void 0,zc=void 0,P0=vd,T5=k0,wd=$f,L0=Ec,Hf=0,ya=P0.m,I0=8,T0=o(128,C);r:for(;A(T0,0,7,T5,19);){if(G(ya,1)){var E5=2+2*G(ya,3);if((Uf=2+G(ya,E5))>wd)break r}else Uf=wd;for(zc=0;zc<wd&&Uf--;){q(ya);var E0=T0[0+(127&J(ya))];I(ya,ya.u+E0.g);var sl=E0.value;if(16>sl)L0[zc++]=sl,sl!=0&&(I0=sl);else{var z5=sl==16,z0=sl-16,O5=n5[z0],O0=G(ya,t5[z0])+O5;if(zc+O0>wd)break r;for(var D5=z5?I0:0;0<O0--;)L0[zc++]=D5}}Hf=1;break r}Hf||(P0.a=3),yd=Hf}(yd=yd&&!va.h)&&(qf=A(k5,A5,8,Ec,$f)),yd&&qf!=0?bd=qf:(vd.a=3,bd=0)}if(bd==0)break n;if(gd&&r5[Ht]==1&&(gd=pd[Xn].g==0),S0+=pd[Xn].g,Xn+=bd,3>=Ht){var Oc,Vf=Tc[0];for(Oc=1;Oc<Fn;++Oc)Tc[Oc]>Vf&&(Vf=Tc[Oc]);_0+=Vf}}if(Qs.nd=gd,Qs.Qb=0,gd&&(Qs.qb=(nl[3][rl[3]+0].value<<24|nl[1][rl[1]+0].value<<16|nl[2][rl[2]+0].value)>>>0,S0==0&&256>nl[0][rl[0]+0].value&&(Qs.Qb=1,Qs.qb+=nl[0][rl[0]+0].value<<8)),Qs.jc=!Qs.Qb&&6>_0,Qs.jc){var Nd,Ui=Qs;for(Nd=0;Nd<yr;++Nd){var ba=Nd,wa=Ui.pd[ba],jd=Ui.G[0][Ui.H[0]+ba];256<=jd.value?(wa.g=jd.g+256,wa.value=jd.value):(wa.g=0,wa.value=0,ba>>=Sn(jd,8,wa),ba>>=Sn(Ui.G[1][Ui.H[1]+ba],16,wa),ba>>=Sn(Ui.G[2][Ui.H[2]+ba],0,wa),Sn(Ui.G[3][Ui.H[3]+ba],24,wa))}}}ur.vc=br,ur.Wb=qr,ur.Ya=md,ur.yc=Bf,pn=1;break t}pn=0}if(!(O=pn)){w.a=3;break e}if(0<be){if(ne.ua=1<<be,!ct(ne.Wa,be)){w.a=1,O=0;break e}}else ne.ua=0;var Gf=w,D0=D,M5=F,Wf=Gf.s,Jf=Wf.xc;if(Gf.c=D0,Gf.i=M5,Wf.md=st(D0,Jf),Wf.wc=Jf==0?-1:(1<<Jf)-1,x){w.xb=m5;break e}if((de=a(D*F))==null){w.a=1,O=0;break e}O=(O=xr(w,de,0,D,F,F,null))&&!U.h;break e}return O?(T!=null?T[0]=de:(e(de==null),e(x)),w.$=0,x||nr(ne)):nr(ne),O}function fs(u,h){var x=u.c*u.i,w=x+h+16*h;return e(u.c<=h),u.V=a(w),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+x+h,1)}function Vs(u,h){var x=u.C,w=h-x,T=u.V,O=u.Ba+u.c*x;for(e(h<=u.l.o);0<w;){var D=16<w?16:w,F=u.l.ma,U=u.l.width,ne=U*D,de=F.ca,be=F.tb+U*x,we=u.Ta,xe=u.Ua;gr(u,D,T,O),Gn(we,xe,de,be,ne),Sr(F,x,x+D,de,be,U),w-=D,T+=D*u.c,x+=D}e(x==h),u.C=u.Ma=h}function Gs(){this.ub=this.yd=this.td=this.Rb=0}function mi(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function pi(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function sa(){this.Yb=function(){var u=[];return function h(x,w,T){for(var O=T[w],D=0;D<O&&(x.push(T.length>w+1?[]:0),!(T.length<w+1));D++)h(x[D],w+1,T)}(u,0,[3,11]),u}()}function to(){this.jb=a(3),this.Wc=l([4,8],sa),this.Xc=l([4,17],sa)}function ia(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function B(){this.ld=this.La=this.dd=this.tc=0}function je(){this.Na=this.la=0}function Pe(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function We(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ct(){this.uc=this.M=this.Nb=0,this.wa=Array(new B),this.Y=0,this.ya=Array(new We),this.aa=0,this.l=new ln}function Tt(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Wt(){this.cb=this.a=0,this.sc="",this.m=new ce,this.Od=new Gs,this.Kc=new mi,this.ed=new ia,this.Qa=new pi,this.Ic=this.$c=this.Aa=0,this.D=new Ct,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,ce),this.ia=0,this.pb=o(4,Pe),this.Pa=new to,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Tt),this.Hd=0,this.rb=Array(new je),this.sb=0,this.wa=Array(new B),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new We),this.L=this.aa=0,this.gd=l([4,2],B),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ln(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Rr(){var u=new Wt;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,Lc||(Lc=gi)),u}function sn(u,h,x){return u.a==0&&(u.a=h,u.sc=x,u.cb=0),0}function zi(u,h,x){return 3<=x&&u[h+0]==157&&u[h+1]==1&&u[h+2]==42}function _s(u,h){if(u==null)return 0;if(u.a=0,u.sc="OK",h==null)return sn(u,2,"null VP8Io passed to VP8GetHeaders()");var x=h.data,w=h.w,T=h.ha;if(4>T)return sn(u,7,"Truncated header.");var O=x[w+0]|x[w+1]<<8|x[w+2]<<16,D=u.Od;if(D.Rb=!(1&O),D.td=O>>1&7,D.yd=O>>4&1,D.ub=O>>5,3<D.td)return sn(u,3,"Incorrect keyframe parameters.");if(!D.yd)return sn(u,4,"Frame not displayable.");w+=3,T-=3;var F=u.Kc;if(D.Rb){if(7>T)return sn(u,7,"cannot parse picture header");if(!zi(x,w,T))return sn(u,3,"Bad code word");F.c=16383&(x[w+4]<<8|x[w+3]),F.Td=x[w+4]>>6,F.i=16383&(x[w+6]<<8|x[w+5]),F.Ud=x[w+6]>>6,w+=7,T-=7,u.za=F.c+15>>4,u.Ub=F.i+15>>4,h.width=F.c,h.height=F.i,h.Da=0,h.j=0,h.v=0,h.va=h.width,h.o=h.height,h.da=0,h.ib=h.width,h.hb=h.height,h.U=h.width,h.T=h.height,i((O=u.Pa).jb,0,255,O.jb.length),e((O=u.Qa)!=null),O.Cb=0,O.Bb=0,O.Fb=1,i(O.Zb,0,0,O.Zb.length),i(O.Lb,0,0,O.Lb)}if(D.ub>T)return sn(u,7,"bad partition length");ie(O=u.m,x,w,D.ub),w+=D.ub,T-=D.ub,D.Rb&&(F.Ld=fe(O),F.Kd=fe(O)),F=u.Qa;var U,ne=u.Pa;if(e(O!=null),e(F!=null),F.Cb=fe(O),F.Cb){if(F.Bb=fe(O),fe(O)){for(F.Fb=fe(O),U=0;4>U;++U)F.Zb[U]=fe(O)?te(O,7):0;for(U=0;4>U;++U)F.Lb[U]=fe(O)?te(O,6):0}if(F.Bb)for(U=0;3>U;++U)ne.jb[U]=fe(O)?Q(O,8):255}else F.Bb=0;if(O.Ka)return sn(u,3,"cannot parse segment header");if((F=u.ed).zd=fe(O),F.Tb=Q(O,6),F.wb=Q(O,3),F.Pc=fe(O),F.Pc&&fe(O)){for(ne=0;4>ne;++ne)fe(O)&&(F.vd[ne]=te(O,6));for(ne=0;4>ne;++ne)fe(O)&&(F.od[ne]=te(O,6))}if(u.L=F.Tb==0?0:F.zd?1:2,O.Ka)return sn(u,3,"cannot parse filter header");var de=T;if(T=U=w,w=U+de,F=de,u.Xb=(1<<Q(u.m,2))-1,de<3*(ne=u.Xb))x=7;else{for(U+=3*ne,F-=3*ne,de=0;de<ne;++de){var be=x[T+0]|x[T+1]<<8|x[T+2]<<16;be>F&&(be=F),ie(u.Jc[+de],x,U,be),U+=be,F-=be,T+=3}ie(u.Jc[+ne],x,U,F),x=U<w?0:5}if(x!=0)return sn(u,x,"cannot parse partitions");for(x=Q(U=u.m,7),T=fe(U)?te(U,4):0,w=fe(U)?te(U,4):0,F=fe(U)?te(U,4):0,ne=fe(U)?te(U,4):0,U=fe(U)?te(U,4):0,de=u.Qa,be=0;4>be;++be){if(de.Cb){var we=de.Zb[be];de.Fb||(we+=x)}else{if(0<be){u.pb[be]=u.pb[0];continue}we=x}var xe=u.pb[be];xe.Sc[0]=Mf[ms(we+T,127)],xe.Sc[1]=Rf[ms(we+0,127)],xe.Eb[0]=2*Mf[ms(we+w,127)],xe.Eb[1]=101581*Rf[ms(we+F,127)]>>16,8>xe.Eb[1]&&(xe.Eb[1]=8),xe.Qc[0]=Mf[ms(we+ne,117)],xe.Qc[1]=Rf[ms(we+U,127)],xe.lc=we+U}if(!D.Rb)return sn(u,4,"Not a key frame.");for(fe(O),D=u.Pa,x=0;4>x;++x){for(T=0;8>T;++T)for(w=0;3>w;++w)for(F=0;11>F;++F)ne=ge(O,h5[x][T][w][F])?Q(O,8):u5[x][T][w][F],D.Wc[x][T].Yb[w][F]=ne;for(T=0;17>T;++T)D.Xc[x][T]=D.Wc[x][f5[T]]}return u.kc=fe(O),u.kc&&(u.Bd=Q(O,8)),u.cb=1}function gi(u,h,x,w,T,O,D){var F=h[T].Yb[x];for(x=0;16>T;++T){if(!ge(u,F[x+0]))return T;for(;!ge(u,F[x+1]);)if(F=h[++T].Yb[0],x=0,T==16)return 16;var U=h[T+1].Yb;if(ge(u,F[x+2])){var ne=u,de=0;if(ge(ne,(we=F)[(be=x)+3]))if(ge(ne,we[be+6])){for(F=0,be=2*(de=ge(ne,we[be+8]))+(we=ge(ne,we[be+9+de])),de=0,we=l5[be];we[F];++F)de+=de+ge(ne,we[F]);de+=3+(8<<be)}else ge(ne,we[be+7])?(de=7+2*ge(ne,165),de+=ge(ne,145)):de=5+ge(ne,159);else de=ge(ne,we[be+4])?3+ge(ne,we[be+5]):2;F=U[2]}else de=1,F=U[1];U=D+c5[T],0>(ne=u).b&&oe(ne);var be,we=ne.b,xe=(be=ne.Ca>>1)-(ne.I>>we)>>31;--ne.b,ne.Ca+=xe,ne.Ca|=1,ne.I-=(be+1&xe)<<we,O[U]=((de^xe)-xe)*w[(0<T)+0]}return 16}function Ws(u){var h=u.rb[u.sb-1];h.la=0,h.Na=0,i(u.zc,0,0,u.zc.length),u.ja=0}function Ro(u,h){if(u==null)return 0;if(h==null)return sn(u,2,"NULL VP8Io parameter in VP8Decode().");if(!u.cb&&!_s(u,h))return 0;if(e(u.cb),h.ac==null||h.ac(h)){h.ob&&(u.L=0);var x=fd[u.L];if(u.L==2?(u.yb=0,u.zb=0):(u.yb=h.v-x>>4,u.zb=h.j-x>>4,0>u.yb&&(u.yb=0),0>u.zb&&(u.zb=0)),u.Va=h.o+15+x>>4,u.Hb=h.va+15+x>>4,u.Hb>u.za&&(u.Hb=u.za),u.Va>u.Ub&&(u.Va=u.Ub),0<u.L){var w=u.ed;for(x=0;4>x;++x){var T;if(u.Qa.Cb){var O=u.Qa.Lb[x];u.Qa.Fb||(O+=w.Tb)}else O=w.Tb;for(T=0;1>=T;++T){var D=u.gd[x][T],F=O;if(w.Pc&&(F+=w.vd[0],T&&(F+=w.od[0])),0<(F=0>F?0:63<F?63:F)){var U=F;0<w.wb&&(U=4<w.wb?U>>2:U>>1)>9-w.wb&&(U=9-w.wb),1>U&&(U=1),D.dd=U,D.tc=2*F+U,D.ld=40<=F?2:15<=F?1:0}else D.tc=0;D.La=T}}}x=0}else sn(u,6,"Frame setup failed"),x=u.a;if(x=x==0){if(x){u.$c=0,0<u.Aa||(u.Ic=C5);e:{x=u.Ic,w=4*(U=u.za);var ne=32*U,de=U+1,be=0<u.L?U*(0<u.Aa?2:1):0,we=(u.Aa==2?2:1)*U;if((D=w+832+(T=3*(16*x+fd[u.L])/2*ne)+(O=u.Fa!=null&&0<u.Fa.length?u.Kc.c*u.Kc.i:0))!=D)x=0;else{if(D>u.Vb){if(u.Vb=0,u.Ec=a(D),u.Fc=0,u.Ec==null){x=sn(u,1,"no memory during frame initialization.");break e}u.Vb=D}D=u.Ec,F=u.Fc,u.Ac=D,u.Bc=F,F+=w,u.Gd=o(ne,Tt),u.Hd=0,u.rb=o(de+1,je),u.sb=1,u.wa=be?o(be,B):null,u.Y=0,u.D.Nb=0,u.D.wa=u.wa,u.D.Y=u.Y,0<u.Aa&&(u.D.Y+=U),e(!0),u.oc=D,u.pc=F,F+=832,u.ya=o(we,We),u.aa=0,u.D.ya=u.ya,u.D.aa=u.aa,u.Aa==2&&(u.D.aa+=U),u.R=16*U,u.B=8*U,U=(ne=fd[u.L])*u.R,ne=ne/2*u.B,u.sa=D,u.ta=F+U,u.qa=u.sa,u.ra=u.ta+16*x*u.R+ne,u.Ha=u.qa,u.Ia=u.ra+8*x*u.B+ne,u.$c=0,F+=T,u.mb=O?D:null,u.nb=O?F:null,e(F+O<=u.Fc+u.Vb),Ws(u),i(u.Ac,u.Bc,0,w),x=1}}if(x){if(h.ka=0,h.y=u.sa,h.O=u.ta,h.f=u.qa,h.N=u.ra,h.ea=u.Ha,h.Vd=u.Ia,h.fa=u.R,h.Rc=u.B,h.F=null,h.J=0,!sd){for(x=-255;255>=x;++x)rr[255+x]=0>x?-x:x;for(x=-1020;1020>=x;++x)Bi[1020+x]=-128>x?-128:127<x?127:x;for(x=-112;112>=x;++x)Pc[112+x]=-16>x?-16:15<x?15:x;for(x=-255;510>=x;++x)el[255+x]=0>x?0:255<x?255:x;sd=1}Qo=Pt,Fi=ee,Cc=ke,$r=Ve,ks=Bt,Vn=no,Xo=fc,rd=io,kc=Pf,lo=mc,co=Af,fa=qo,uo=pc,Zo=Qu,ho=Yu,ma=yi,Ac=Di,As=kf,Ys[0]=vi,Ys[1]=Jt,Ys[2]=wf,Ys[3]=Nf,Ys[4]=Vu,Ys[5]=Bo,Ys[6]=Gu,Ys[7]=uc,Ys[8]=Sf,Ys[9]=jf,pa[0]=Fo,pa[1]=xi,pa[2]=tn,pa[3]=Fr,pa[4]=Cr,pa[5]=bf,pa[6]=Hu,$i[0]=la,$i[1]=Tn,$i[2]=_f,$i[3]=dc,$i[4]=so,$i[5]=Cf,$i[6]=hc,x=1}else x=0}x&&(x=function(xe,De){for(xe.M=0;xe.M<xe.Va;++xe.M){var Ae,he=xe.Jc[xe.M&xe.Xb],pe=xe.m,ze=xe;for(Ae=0;Ae<ze.za;++Ae){var Be=pe,Oe=ze,lt=Oe.Ac,tt=Oe.Bc+4*Ae,Lt=Oe.zc,nt=Oe.ya[Oe.aa+Ae];if(Oe.Qa.Bb?nt.$b=ge(Be,Oe.Pa.jb[0])?2+ge(Be,Oe.Pa.jb[2]):ge(Be,Oe.Pa.jb[1]):nt.$b=0,Oe.kc&&(nt.Ad=ge(Be,Oe.Bd)),nt.Za=!ge(Be,145)+0,nt.Za){var on=nt.Ob,cn=0;for(Oe=0;4>Oe;++Oe){var nn,Qt=Lt[0+Oe];for(nn=0;4>nn;++nn){Qt=d5[lt[tt+nn]][Qt];for(var pn=h0[ge(Be,Qt[0])];0<pn;)pn=h0[2*pn+ge(Be,Qt[pn])];Qt=-pn,lt[tt+nn]=Qt}s(on,cn,lt,tt,4),cn+=4,Lt[0+Oe]=Qt}}else Qt=ge(Be,156)?ge(Be,128)?1:3:ge(Be,163)?2:0,nt.Ob[0]=Qt,i(lt,tt,Qt,4),i(Lt,0,Qt,4);nt.Dd=ge(Be,142)?ge(Be,114)?ge(Be,183)?1:3:2:0}if(ze.m.Ka)return sn(xe,7,"Premature end-of-partition0 encountered.");for(;xe.ja<xe.za;++xe.ja){if(ze=he,Be=(pe=xe).rb[pe.sb-1],lt=pe.rb[pe.sb+pe.ja],Ae=pe.ya[pe.aa+pe.ja],tt=pe.kc?Ae.Ad:0)Be.la=lt.la=0,Ae.Za||(Be.Na=lt.Na=0),Ae.Hc=0,Ae.Gc=0,Ae.ia=0;else{var mn,Ht;if(Be=lt,lt=ze,tt=pe.Pa.Xc,Lt=pe.ya[pe.aa+pe.ja],nt=pe.pb[Lt.$b],Oe=Lt.ad,on=0,cn=pe.rb[pe.sb-1],Qt=nn=0,i(Oe,on,0,384),Lt.Za)var Xn=0,ts=tt[3];else{pn=a(16);var Zn=Be.Na+cn.Na;if(Zn=Lc(lt,tt[1],Zn,nt.Eb,0,pn,0),Be.Na=cn.Na=(0<Zn)+0,1<Zn)Qo(pn,0,Oe,on);else{var ns=pn[0]+3>>3;for(pn=0;256>pn;pn+=16)Oe[on+pn]=ns}Xn=1,ts=tt[0]}var un=15&Be.la,gs=15&cn.la;for(pn=0;4>pn;++pn){var xs=1&gs;for(ns=Ht=0;4>ns;++ns)un=un>>1|(xs=(Zn=Lc(lt,ts,Zn=xs+(1&un),nt.Sc,Xn,Oe,on))>Xn)<<7,Ht=Ht<<2|(3<Zn?3:1<Zn?2:Oe[on+0]!=0),on+=16;un>>=4,gs=gs>>1|xs<<7,nn=(nn<<8|Ht)>>>0}for(ts=un,Xn=gs>>4,mn=0;4>mn;mn+=2){for(Ht=0,un=Be.la>>4+mn,gs=cn.la>>4+mn,pn=0;2>pn;++pn){for(xs=1&gs,ns=0;2>ns;++ns)Zn=xs+(1&un),un=un>>1|(xs=0<(Zn=Lc(lt,tt[2],Zn,nt.Qc,0,Oe,on)))<<3,Ht=Ht<<2|(3<Zn?3:1<Zn?2:Oe[on+0]!=0),on+=16;un>>=2,gs=gs>>1|xs<<5}Qt|=Ht<<4*mn,ts|=un<<4<<mn,Xn|=(240&gs)<<mn}Be.la=ts,cn.la=Xn,Lt.Hc=nn,Lt.Gc=Qt,Lt.ia=43690&Qt?0:nt.ia,tt=!(nn|Qt)}if(0<pe.L&&(pe.wa[pe.Y+pe.ja]=pe.gd[Ae.$b][Ae.Za],pe.wa[pe.Y+pe.ja].La|=!tt),ze.Ka)return sn(xe,7,"Premature end-of-file encountered.")}if(Ws(xe),pe=De,ze=1,Ae=(he=xe).D,Be=0<he.L&&he.M>=he.zb&&he.M<=he.Va,he.Aa==0)e:{if(Ae.M=he.M,Ae.uc=Be,wc(he,Ae),ze=1,Ae=(Ht=he.D).Nb,Be=(Qt=fd[he.L])*he.R,lt=Qt/2*he.B,pn=16*Ae*he.R,ns=8*Ae*he.B,tt=he.sa,Lt=he.ta-Be+pn,nt=he.qa,Oe=he.ra-lt+ns,on=he.Ha,cn=he.Ia-lt+ns,gs=(un=Ht.M)==0,nn=un>=he.Va-1,he.Aa==2&&wc(he,Ht),Ht.uc)for(xs=(Zn=he).D.M,e(Zn.D.uc),Ht=Zn.yb;Ht<Zn.Hb;++Ht){Xn=Ht,ts=xs;var ur=(br=(Fn=Zn).D).Nb;mn=Fn.R;var br=br.wa[br.Y+Xn],qr=Fn.sa,Ts=Fn.ta+16*ur*mn+16*Xn,wi=br.dd,dr=br.tc;if(dr!=0)if(e(3<=dr),Fn.L==1)0<Xn&&ma(qr,Ts,mn,dr+4),br.La&&As(qr,Ts,mn,dr),0<ts&&ho(qr,Ts,mn,dr+4),br.La&&Ac(qr,Ts,mn,dr);else{var qi=Fn.B,fo=Fn.qa,tl=Fn.ra+8*ur*qi+8*Xn,xa=Fn.Ha,Fn=Fn.Ia+8*ur*qi+8*Xn;ur=br.ld,0<Xn&&(rd(qr,Ts,mn,dr+4,wi,ur),lo(fo,tl,xa,Fn,qi,dr+4,wi,ur)),br.La&&(fa(qr,Ts,mn,dr,wi,ur),Zo(fo,tl,xa,Fn,qi,dr,wi,ur)),0<ts&&(Xo(qr,Ts,mn,dr+4,wi,ur),kc(fo,tl,xa,Fn,qi,dr+4,wi,ur)),br.La&&(co(qr,Ts,mn,dr,wi,ur),uo(fo,tl,xa,Fn,qi,dr,wi,ur))}}if(he.ia&&alert("todo:DitherRow"),pe.put!=null){if(Ht=16*un,un=16*(un+1),gs?(pe.y=he.sa,pe.O=he.ta+pn,pe.f=he.qa,pe.N=he.ra+ns,pe.ea=he.Ha,pe.W=he.Ia+ns):(Ht-=Qt,pe.y=tt,pe.O=Lt,pe.f=nt,pe.N=Oe,pe.ea=on,pe.W=cn),nn||(un-=Qt),un>pe.o&&(un=pe.o),pe.F=null,pe.J=null,he.Fa!=null&&0<he.Fa.length&&Ht<un&&(pe.J=yc(he,pe,Ht,un-Ht),pe.F=he.mb,pe.F==null&&pe.F.length==0)){ze=sn(he,3,"Could not decode alpha data.");break e}Ht<pe.j&&(Qt=pe.j-Ht,Ht=pe.j,e(!(1&Qt)),pe.O+=he.R*Qt,pe.N+=he.B*(Qt>>1),pe.W+=he.B*(Qt>>1),pe.F!=null&&(pe.J+=pe.width*Qt)),Ht<un&&(pe.O+=pe.v,pe.N+=pe.v>>1,pe.W+=pe.v>>1,pe.F!=null&&(pe.J+=pe.v),pe.ka=Ht-pe.j,pe.U=pe.va-pe.v,pe.T=un-Ht,ze=pe.put(pe))}Ae+1!=he.Ic||nn||(s(he.sa,he.ta-Be,tt,Lt+16*he.R,Be),s(he.qa,he.ra-lt,nt,Oe+8*he.B,lt),s(he.Ha,he.Ia-lt,on,cn+8*he.B,lt))}if(!ze)return sn(xe,6,"Output aborted.")}return 1}(u,h)),h.bc!=null&&h.bc(h),x&=1}return x?(u.cb=0,x):0}function Xr(u,h,x,w,T){T=u[h+x+32*w]+(T>>3),u[h+x+32*w]=-256&T?0>T?0:255:T}function Oi(u,h,x,w,T,O){Xr(u,h,0,x,w+T),Xr(u,h,1,x,w+O),Xr(u,h,2,x,w-O),Xr(u,h,3,x,w-T)}function vr(u){return(20091*u>>16)+u}function aa(u,h,x,w){var T,O=0,D=a(16);for(T=0;4>T;++T){var F=u[h+0]+u[h+8],U=u[h+0]-u[h+8],ne=(35468*u[h+4]>>16)-vr(u[h+12]),de=vr(u[h+4])+(35468*u[h+12]>>16);D[O+0]=F+de,D[O+1]=U+ne,D[O+2]=U-ne,D[O+3]=F-de,O+=4,h++}for(T=O=0;4>T;++T)F=(u=D[O+0]+4)+D[O+8],U=u-D[O+8],ne=(35468*D[O+4]>>16)-vr(D[O+12]),Xr(x,w,0,0,F+(de=vr(D[O+4])+(35468*D[O+12]>>16))),Xr(x,w,1,0,U+ne),Xr(x,w,2,0,U-ne),Xr(x,w,3,0,F-de),O++,w+=32}function no(u,h,x,w){var T=u[h+0]+4,O=35468*u[h+4]>>16,D=vr(u[h+4]),F=35468*u[h+1]>>16;Oi(x,w,0,T+D,u=vr(u[h+1]),F),Oi(x,w,1,T+O,u,F),Oi(x,w,2,T-O,u,F),Oi(x,w,3,T-D,u,F)}function ee(u,h,x,w,T){aa(u,h,x,w),T&&aa(u,h+16,x,w+4)}function ke(u,h,x,w){Fi(u,h+0,x,w,1),Fi(u,h+32,x,w+128,1)}function Ve(u,h,x,w){var T;for(u=u[h+0]+4,T=0;4>T;++T)for(h=0;4>h;++h)Xr(x,w,h,T,u)}function Bt(u,h,x,w){u[h+0]&&$r(u,h+0,x,w),u[h+16]&&$r(u,h+16,x,w+4),u[h+32]&&$r(u,h+32,x,w+128),u[h+48]&&$r(u,h+48,x,w+128+4)}function Pt(u,h,x,w){var T,O=a(16);for(T=0;4>T;++T){var D=u[h+0+T]+u[h+12+T],F=u[h+4+T]+u[h+8+T],U=u[h+4+T]-u[h+8+T],ne=u[h+0+T]-u[h+12+T];O[0+T]=D+F,O[8+T]=D-F,O[4+T]=ne+U,O[12+T]=ne-U}for(T=0;4>T;++T)D=(u=O[0+4*T]+3)+O[3+4*T],F=O[1+4*T]+O[2+4*T],U=O[1+4*T]-O[2+4*T],ne=u-O[3+4*T],x[w+0]=D+F>>3,x[w+16]=ne+U>>3,x[w+32]=D-F>>3,x[w+48]=ne-U>>3,w+=64}function Rt(u,h,x){var w,T=h-32,O=ps,D=255-u[T-1];for(w=0;w<x;++w){var F,U=O,ne=D+u[h-1];for(F=0;F<x;++F)u[h+F]=U[ne+u[T+F]];h+=32}}function Jt(u,h){Rt(u,h,4)}function Tn(u,h){Rt(u,h,8)}function xi(u,h){Rt(u,h,16)}function tn(u,h){var x;for(x=0;16>x;++x)s(u,h+32*x,u,h-32,16)}function Fr(u,h){var x;for(x=16;0<x;--x)i(u,h,u[h-1],16),h+=32}function oa(u,h,x){var w;for(w=0;16>w;++w)i(h,x+32*w,u,16)}function Fo(u,h){var x,w=16;for(x=0;16>x;++x)w+=u[h-1+32*x]+u[h+x-32];oa(w>>5,u,h)}function Cr(u,h){var x,w=8;for(x=0;16>x;++x)w+=u[h-1+32*x];oa(w>>4,u,h)}function bf(u,h){var x,w=8;for(x=0;16>x;++x)w+=u[h+x-32];oa(w>>4,u,h)}function Hu(u,h){oa(128,u,h)}function Ft(u,h,x){return u+2*h+x+2>>2}function wf(u,h){var x,w=h-32;for(w=new Uint8Array([Ft(u[w-1],u[w+0],u[w+1]),Ft(u[w+0],u[w+1],u[w+2]),Ft(u[w+1],u[w+2],u[w+3]),Ft(u[w+2],u[w+3],u[w+4])]),x=0;4>x;++x)s(u,h+32*x,w,0,w.length)}function Nf(u,h){var x=u[h-1],w=u[h-1+32],T=u[h-1+64],O=u[h-1+96];Te(u,h+0,16843009*Ft(u[h-1-32],x,w)),Te(u,h+32,16843009*Ft(x,w,T)),Te(u,h+64,16843009*Ft(w,T,O)),Te(u,h+96,16843009*Ft(T,O,O))}function vi(u,h){var x,w=4;for(x=0;4>x;++x)w+=u[h+x-32]+u[h-1+32*x];for(w>>=3,x=0;4>x;++x)i(u,h+32*x,w,4)}function Vu(u,h){var x=u[h-1+0],w=u[h-1+32],T=u[h-1+64],O=u[h-1-32],D=u[h+0-32],F=u[h+1-32],U=u[h+2-32],ne=u[h+3-32];u[h+0+96]=Ft(w,T,u[h-1+96]),u[h+1+96]=u[h+0+64]=Ft(x,w,T),u[h+2+96]=u[h+1+64]=u[h+0+32]=Ft(O,x,w),u[h+3+96]=u[h+2+64]=u[h+1+32]=u[h+0+0]=Ft(D,O,x),u[h+3+64]=u[h+2+32]=u[h+1+0]=Ft(F,D,O),u[h+3+32]=u[h+2+0]=Ft(U,F,D),u[h+3+0]=Ft(ne,U,F)}function Gu(u,h){var x=u[h+1-32],w=u[h+2-32],T=u[h+3-32],O=u[h+4-32],D=u[h+5-32],F=u[h+6-32],U=u[h+7-32];u[h+0+0]=Ft(u[h+0-32],x,w),u[h+1+0]=u[h+0+32]=Ft(x,w,T),u[h+2+0]=u[h+1+32]=u[h+0+64]=Ft(w,T,O),u[h+3+0]=u[h+2+32]=u[h+1+64]=u[h+0+96]=Ft(T,O,D),u[h+3+32]=u[h+2+64]=u[h+1+96]=Ft(O,D,F),u[h+3+64]=u[h+2+96]=Ft(D,F,U),u[h+3+96]=Ft(F,U,U)}function Bo(u,h){var x=u[h-1+0],w=u[h-1+32],T=u[h-1+64],O=u[h-1-32],D=u[h+0-32],F=u[h+1-32],U=u[h+2-32],ne=u[h+3-32];u[h+0+0]=u[h+1+64]=O+D+1>>1,u[h+1+0]=u[h+2+64]=D+F+1>>1,u[h+2+0]=u[h+3+64]=F+U+1>>1,u[h+3+0]=U+ne+1>>1,u[h+0+96]=Ft(T,w,x),u[h+0+64]=Ft(w,x,O),u[h+0+32]=u[h+1+96]=Ft(x,O,D),u[h+1+32]=u[h+2+96]=Ft(O,D,F),u[h+2+32]=u[h+3+96]=Ft(D,F,U),u[h+3+32]=Ft(F,U,ne)}function uc(u,h){var x=u[h+0-32],w=u[h+1-32],T=u[h+2-32],O=u[h+3-32],D=u[h+4-32],F=u[h+5-32],U=u[h+6-32],ne=u[h+7-32];u[h+0+0]=x+w+1>>1,u[h+1+0]=u[h+0+64]=w+T+1>>1,u[h+2+0]=u[h+1+64]=T+O+1>>1,u[h+3+0]=u[h+2+64]=O+D+1>>1,u[h+0+32]=Ft(x,w,T),u[h+1+32]=u[h+0+96]=Ft(w,T,O),u[h+2+32]=u[h+1+96]=Ft(T,O,D),u[h+3+32]=u[h+2+96]=Ft(O,D,F),u[h+3+64]=Ft(D,F,U),u[h+3+96]=Ft(F,U,ne)}function jf(u,h){var x=u[h-1+0],w=u[h-1+32],T=u[h-1+64],O=u[h-1+96];u[h+0+0]=x+w+1>>1,u[h+2+0]=u[h+0+32]=w+T+1>>1,u[h+2+32]=u[h+0+64]=T+O+1>>1,u[h+1+0]=Ft(x,w,T),u[h+3+0]=u[h+1+32]=Ft(w,T,O),u[h+3+32]=u[h+1+64]=Ft(T,O,O),u[h+3+64]=u[h+2+64]=u[h+0+96]=u[h+1+96]=u[h+2+96]=u[h+3+96]=O}function Sf(u,h){var x=u[h-1+0],w=u[h-1+32],T=u[h-1+64],O=u[h-1+96],D=u[h-1-32],F=u[h+0-32],U=u[h+1-32],ne=u[h+2-32];u[h+0+0]=u[h+2+32]=x+D+1>>1,u[h+0+32]=u[h+2+64]=w+x+1>>1,u[h+0+64]=u[h+2+96]=T+w+1>>1,u[h+0+96]=O+T+1>>1,u[h+3+0]=Ft(F,U,ne),u[h+2+0]=Ft(D,F,U),u[h+1+0]=u[h+3+32]=Ft(x,D,F),u[h+1+32]=u[h+3+64]=Ft(w,x,D),u[h+1+64]=u[h+3+96]=Ft(T,w,x),u[h+1+96]=Ft(O,T,w)}function _f(u,h){var x;for(x=0;8>x;++x)s(u,h+32*x,u,h-32,8)}function dc(u,h){var x;for(x=0;8>x;++x)i(u,h,u[h-1],8),h+=32}function ro(u,h,x){var w;for(w=0;8>w;++w)i(h,x+32*w,u,8)}function la(u,h){var x,w=8;for(x=0;8>x;++x)w+=u[h+x-32]+u[h-1+32*x];ro(w>>4,u,h)}function Cf(u,h){var x,w=4;for(x=0;8>x;++x)w+=u[h+x-32];ro(w>>3,u,h)}function so(u,h){var x,w=4;for(x=0;8>x;++x)w+=u[h-1+32*x];ro(w>>3,u,h)}function hc(u,h){ro(128,u,h)}function $o(u,h,x){var w=u[h-x],T=u[h+0],O=3*(T-w)+Tf[1020+u[h-2*x]-u[h+x]],D=id[112+(O+4>>3)];u[h-x]=ps[255+w+id[112+(O+3>>3)]],u[h+0]=ps[255+T-D]}function Wu(u,h,x,w){var T=u[h+0],O=u[h+x];return Ls[255+u[h-2*x]-u[h-x]]>w||Ls[255+O-T]>w}function Ju(u,h,x,w){return 4*Ls[255+u[h-x]-u[h+0]]+Ls[255+u[h-2*x]-u[h+x]]<=w}function Ku(u,h,x,w,T){var O=u[h-3*x],D=u[h-2*x],F=u[h-x],U=u[h+0],ne=u[h+x],de=u[h+2*x],be=u[h+3*x];return 4*Ls[255+F-U]+Ls[255+D-ne]>w?0:Ls[255+u[h-4*x]-O]<=T&&Ls[255+O-D]<=T&&Ls[255+D-F]<=T&&Ls[255+be-de]<=T&&Ls[255+de-ne]<=T&&Ls[255+ne-U]<=T}function Yu(u,h,x,w){var T=2*w+1;for(w=0;16>w;++w)Ju(u,h+w,x,T)&&$o(u,h+w,x)}function yi(u,h,x,w){var T=2*w+1;for(w=0;16>w;++w)Ju(u,h+w*x,1,T)&&$o(u,h+w*x,1)}function Di(u,h,x,w){var T;for(T=3;0<T;--T)Yu(u,h+=4*x,x,w)}function kf(u,h,x,w){var T;for(T=3;0<T;--T)yi(u,h+=4,x,w)}function ca(u,h,x,w,T,O,D,F){for(O=2*O+1;0<T--;){if(Ku(u,h,x,O,D))if(Wu(u,h,x,F))$o(u,h,x);else{var U=u,ne=h,de=x,be=U[ne-2*de],we=U[ne-de],xe=U[ne+0],De=U[ne+de],Ae=U[ne+2*de],he=27*(ze=Tf[1020+3*(xe-we)+Tf[1020+be-De]])+63>>7,pe=18*ze+63>>7,ze=9*ze+63>>7;U[ne-3*de]=ps[255+U[ne-3*de]+ze],U[ne-2*de]=ps[255+be+pe],U[ne-de]=ps[255+we+he],U[ne+0]=ps[255+xe-he],U[ne+de]=ps[255+De-pe],U[ne+2*de]=ps[255+Ae-ze]}h+=w}}function Js(u,h,x,w,T,O,D,F){for(O=2*O+1;0<T--;){if(Ku(u,h,x,O,D))if(Wu(u,h,x,F))$o(u,h,x);else{var U=u,ne=h,de=x,be=U[ne-de],we=U[ne+0],xe=U[ne+de],De=id[112+((Ae=3*(we-be))+4>>3)],Ae=id[112+(Ae+3>>3)],he=De+1>>1;U[ne-2*de]=ps[255+U[ne-2*de]+he],U[ne-de]=ps[255+be+Ae],U[ne+0]=ps[255+we-De],U[ne+de]=ps[255+xe-he]}h+=w}}function fc(u,h,x,w,T,O){ca(u,h,x,1,16,w,T,O)}function io(u,h,x,w,T,O){ca(u,h,1,x,16,w,T,O)}function Af(u,h,x,w,T,O){var D;for(D=3;0<D;--D)Js(u,h+=4*x,x,1,16,w,T,O)}function qo(u,h,x,w,T,O){var D;for(D=3;0<D;--D)Js(u,h+=4,1,x,16,w,T,O)}function Pf(u,h,x,w,T,O,D,F){ca(u,h,T,1,8,O,D,F),ca(x,w,T,1,8,O,D,F)}function mc(u,h,x,w,T,O,D,F){ca(u,h,1,T,8,O,D,F),ca(x,w,1,T,8,O,D,F)}function pc(u,h,x,w,T,O,D,F){Js(u,h+4*T,T,1,8,O,D,F),Js(x,w+4*T,T,1,8,O,D,F)}function Qu(u,h,x,w,T,O,D,F){Js(u,h+4,1,T,8,O,D,F),Js(x,w+4,1,T,8,O,D,F)}function Uo(){this.ba=new en,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new wt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function gc(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function xc(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Xu(){this.ua=0,this.Wa=new ae,this.vb=new ae,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new V,this.yc=new C}function Lf(){this.xb=this.a=0,this.l=new ln,this.ca=new en,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new _,this.Pb=0,this.wd=new _,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Xu,this.ab=0,this.gc=o(4,xc),this.Oc=0}function Ho(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ln,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ao(u,h,x,w,T,O,D){for(u=u==null?0:u[h+0],h=0;h<D;++h)T[O+h]=u+x[w+h]&255,u=T[O+h]}function vc(u,h,x,w,T,O,D){var F;if(u==null)ao(null,null,x,w,T,O,D);else for(F=0;F<D;++F)T[O+F]=u[h+F]+x[w+F]&255}function ua(u,h,x,w,T,O,D){if(u==null)ao(null,null,x,w,T,O,D);else{var F,U=u[h+0],ne=U,de=U;for(F=0;F<D;++F)ne=de+(U=u[h+F])-ne,de=x[w+F]+(-256&ne?0>ne?0:255:ne)&255,ne=U,T[O+F]=de}}function yc(u,h,x,w){var T=h.width,O=h.o;if(e(u!=null&&h!=null),0>x||0>=w||x+w>O)return null;if(!u.Cc){if(u.ga==null){var D;if(u.ga=new Ho,(D=u.ga==null)||(D=h.width*h.o,e(u.Gb.length==0),u.Gb=a(D),u.Uc=0,u.Gb==null?D=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,D=1),D=!D),!D){D=u.ga;var F=u.Fa,U=u.P,ne=u.qc,de=u.mb,be=u.nb,we=U+1,xe=ne-1,De=D.l;if(e(F!=null&&de!=null&&h!=null),ga[0]=null,ga[1]=ao,ga[2]=vc,ga[3]=ua,D.ca=de,D.tb=be,D.c=h.width,D.i=h.height,e(0<D.c&&0<D.i),1>=ne)h=0;else if(D.$a=F[U+0]>>0&3,D.Z=F[U+0]>>2&3,D.Lc=F[U+0]>>4&3,U=F[U+0]>>6&3,0>D.$a||1<D.$a||4<=D.Z||1<D.Lc||U)h=0;else if(De.put=Mt,De.ac=Dt,De.bc=an,De.ma=D,De.width=h.width,De.height=h.height,De.Da=h.Da,De.v=h.v,De.va=h.va,De.j=h.j,De.o=h.o,D.$a)e:{e(D.$a==1),h=_r();t:for(;;){if(h==null){h=0;break e}if(e(D!=null),D.mc=h,h.c=D.c,h.i=D.i,h.l=D.l,h.l.ma=D,h.l.width=D.c,h.l.height=D.i,h.a=0,L(h.m,F,we,xe),!Hn(D.c,D.i,1,h,null)||(h.ab==1&&h.gc[0].hc==3&&Qr(h.s)?(D.ic=1,F=h.c*h.i,h.Ta=null,h.Ua=0,h.V=a(F),h.Ba=0,h.V==null?(h.a=1,h=0):h=1):(D.ic=0,h=fs(h,D.c)),!h))break t;h=1;break e}D.mc=null,h=0}else h=xe>=D.c*D.i;D=!h}if(D)return null;u.ga.Lc!=1?u.Ga=0:w=O-x}e(u.ga!=null),e(x+w<=O);e:{if(h=(F=u.ga).c,O=F.l.o,F.$a==0){if(we=u.rc,xe=u.Vc,De=u.Fa,U=u.P+1+x*h,ne=u.mb,de=u.nb+x*h,e(U<=u.P+u.qc),F.Z!=0)for(e(ga[F.Z]!=null),D=0;D<w;++D)ga[F.Z](we,xe,De,U,ne,de,h),we=ne,xe=de,de+=h,U+=h;else for(D=0;D<w;++D)s(ne,de,De,U,h),we=ne,xe=de,de+=h,U+=h;u.rc=we,u.Vc=xe}else{if(e(F.mc!=null),h=x+w,e((D=F.mc)!=null),e(h<=D.i),D.C>=h)h=1;else if(F.ic||ve(),F.ic){F=D.V,we=D.Ba,xe=D.c;var Ae=D.i,he=(De=1,U=D.$/xe,ne=D.$%xe,de=D.m,be=D.s,D.$),pe=xe*Ae,ze=xe*h,Be=be.wc,Oe=he<ze?vn(be,ne,U):null;e(he<=pe),e(h<=Ae),e(Qr(be));t:for(;;){for(;!de.h&&he<ze;){if(ne&Be||(Oe=vn(be,ne,U)),e(Oe!=null),q(de),256>(Ae=Pn(Oe.G[0],Oe.H[0],de)))F[we+he]=Ae,++he,++ne>=xe&&(ne=0,++U<=h&&!(U%16)&&Ln(D,U));else{if(!(280>Ae)){De=0;break t}Ae=_t(Ae-256,de);var lt,tt=Pn(Oe.G[4],Oe.H[4],de);if(q(de),!(he>=(tt=Mn(xe,tt=_t(tt,de)))&&pe-he>=Ae)){De=0;break t}for(lt=0;lt<Ae;++lt)F[we+he+lt]=F[we+he+lt-tt];for(he+=Ae,ne+=Ae;ne>=xe;)ne-=xe,++U<=h&&!(U%16)&&Ln(D,U);he<ze&&ne&Be&&(Oe=vn(be,ne,U))}e(de.h==M(de))}Ln(D,U>h?h:U);break t}!De||de.h&&he<pe?(De=0,D.a=de.h?5:3):D.$=he,h=De}else h=xr(D,D.V,D.Ba,D.c,D.i,h,Vs);if(!h){w=0;break e}}x+w>=O&&(u.Cc=1),w=1}if(!w)return null;if(u.Cc&&((w=u.ga)!=null&&(w.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+x*T}function g(u,h,x,w,T,O){for(;0<T--;){var D,F=u,U=h+(x?1:0),ne=u,de=h+(x?0:3);for(D=0;D<w;++D){var be=ne[de+4*D];be!=255&&(be*=32897,F[U+4*D+0]=F[U+4*D+0]*be>>23,F[U+4*D+1]=F[U+4*D+1]*be>>23,F[U+4*D+2]=F[U+4*D+2]*be>>23)}h+=O}}function E(u,h,x,w,T){for(;0<w--;){var O;for(O=0;O<x;++O){var D=u[h+2*O+0],F=15&(ne=u[h+2*O+1]),U=4369*F,ne=(240&ne|ne>>4)*U>>16;u[h+2*O+0]=(240&D|D>>4)*U>>16&240|(15&D|D<<4)*U>>16>>4&15,u[h+2*O+1]=240&ne|F}h+=T}}function se(u,h,x,w,T,O,D,F){var U,ne,de=255;for(ne=0;ne<T;++ne){for(U=0;U<w;++U){var be=u[h+U];O[D+4*U]=be,de&=be}h+=x,D+=F}return de!=255}function ue(u,h,x,w,T){var O;for(O=0;O<T;++O)x[w+O]=u[h+O]>>8}function ve(){Ps=g,yn=E,bn=se,Gn=ue}function Ie(u,h,x){P[u]=function(w,T,O,D,F,U,ne,de,be,we,xe,De,Ae,he,pe,ze,Be){var Oe,lt=Be-1>>1,tt=F[U+0]|ne[de+0]<<16,Lt=be[we+0]|xe[De+0]<<16;e(w!=null);var nt=3*tt+Lt+131074>>2;for(h(w[T+0],255&nt,nt>>16,Ae,he),O!=null&&(nt=3*Lt+tt+131074>>2,h(O[D+0],255&nt,nt>>16,pe,ze)),Oe=1;Oe<=lt;++Oe){var on=F[U+Oe]|ne[de+Oe]<<16,cn=be[we+Oe]|xe[De+Oe]<<16,nn=tt+on+Lt+cn+524296,Qt=nn+2*(on+Lt)>>3;nt=Qt+tt>>1,tt=(nn=nn+2*(tt+cn)>>3)+on>>1,h(w[T+2*Oe-1],255&nt,nt>>16,Ae,he+(2*Oe-1)*x),h(w[T+2*Oe-0],255&tt,tt>>16,Ae,he+(2*Oe-0)*x),O!=null&&(nt=nn+Lt>>1,tt=Qt+cn>>1,h(O[D+2*Oe-1],255&nt,nt>>16,pe,ze+(2*Oe-1)*x),h(O[D+2*Oe+0],255&tt,tt>>16,pe,ze+(2*Oe+0)*x)),tt=on,Lt=cn}1&Be||(nt=3*tt+Lt+131074>>2,h(w[T+Be-1],255&nt,nt>>16,Ae,he+(Be-1)*x),O!=null&&(nt=3*Lt+tt+131074>>2,h(O[D+Be-1],255&nt,nt>>16,pe,ze+(Be-1)*x)))}}function Ue(){Is[ad]=p5,Is[od]=m0,Is[c0]=g5,Is[ld]=p0,Is[cd]=g0,Is[Ef]=x0,Is[u0]=x5,Is[zf]=m0,Is[Of]=p0,Is[ud]=g0,Is[Df]=x0}function at(u){return u&~v5?0>u?0:255:u>>v0}function kt(u,h){return at((19077*u>>8)+(26149*h>>8)-14234)}function Ut(u,h,x){return at((19077*u>>8)-(6419*h>>8)-(13320*x>>8)+8708)}function $t(u,h){return at((19077*u>>8)+(33050*h>>8)-17685)}function Zt(u,h,x,w,T){w[T+0]=kt(u,x),w[T+1]=Ut(u,h,x),w[T+2]=$t(u,h)}function En(u,h,x,w,T){w[T+0]=$t(u,h),w[T+1]=Ut(u,h,x),w[T+2]=kt(u,x)}function Rn(u,h,x,w,T){var O=Ut(u,h,x);h=O<<3&224|$t(u,h)>>3,w[T+0]=248&kt(u,x)|O>>5,w[T+1]=h}function Qn(u,h,x,w,T){var O=240&$t(u,h)|15;w[T+0]=240&kt(u,x)|Ut(u,h,x)>>4,w[T+1]=O}function kr(u,h,x,w,T){w[T+0]=255,Zt(u,h,x,w,T+1)}function cr(u,h,x,w,T){En(u,h,x,w,T),w[T+3]=255}function Ks(u,h,x,w,T){Zt(u,h,x,w,T),w[T+3]=255}function ms(u,h){return 0>u?0:u>h?h:u}function bi(u,h,x){P[u]=function(w,T,O,D,F,U,ne,de,be){for(var we=de+(-2&be)*x;de!=we;)h(w[T+0],O[D+0],F[U+0],ne,de),h(w[T+1],O[D+0],F[U+0],ne,de+x),T+=2,++D,++U,de+=2*x;1&be&&h(w[T+0],O[D+0],F[U+0],ne,de)}}function Zu(u,h,x){return x==0?u==0?h==0?6:5:h==0?4:0:x}function bc(u,h,x,w,T){switch(u>>>30){case 3:Fi(h,x,w,T,0);break;case 2:Vn(h,x,w,T);break;case 1:$r(h,x,w,T)}}function wc(u,h){var x,w,T=h.M,O=h.Nb,D=u.oc,F=u.pc+40,U=u.oc,ne=u.pc+584,de=u.oc,be=u.pc+600;for(x=0;16>x;++x)D[F+32*x-1]=129;for(x=0;8>x;++x)U[ne+32*x-1]=129,de[be+32*x-1]=129;for(0<T?D[F-1-32]=U[ne-1-32]=de[be-1-32]=129:(i(D,F-32-1,127,21),i(U,ne-32-1,127,9),i(de,be-32-1,127,9)),w=0;w<u.za;++w){var we=h.ya[h.aa+w];if(0<w){for(x=-1;16>x;++x)s(D,F+32*x-4,D,F+32*x+12,4);for(x=-1;8>x;++x)s(U,ne+32*x-4,U,ne+32*x+4,4),s(de,be+32*x-4,de,be+32*x+4,4)}var xe=u.Gd,De=u.Hd+w,Ae=we.ad,he=we.Hc;if(0<T&&(s(D,F-32,xe[De].y,0,16),s(U,ne-32,xe[De].f,0,8),s(de,be-32,xe[De].ea,0,8)),we.Za){var pe=D,ze=F-32+16;for(0<T&&(w>=u.za-1?i(pe,ze,xe[De].y[15],4):s(pe,ze,xe[De+1].y,0,4)),x=0;4>x;x++)pe[ze+128+x]=pe[ze+256+x]=pe[ze+384+x]=pe[ze+0+x];for(x=0;16>x;++x,he<<=2)pe=D,ze=F+b0[x],Ys[we.Ob[x]](pe,ze),bc(he,Ae,16*+x,pe,ze)}else if(pe=Zu(w,T,we.Ob[0]),pa[pe](D,F),he!=0)for(x=0;16>x;++x,he<<=2)bc(he,Ae,16*+x,D,F+b0[x]);for(x=we.Gc,pe=Zu(w,T,we.Dd),$i[pe](U,ne),$i[pe](de,be),he=Ae,pe=U,ze=ne,255&(we=x>>0)&&(170&we?Cc(he,256,pe,ze):ks(he,256,pe,ze)),we=de,he=be,255&(x>>=8)&&(170&x?Cc(Ae,320,we,he):ks(Ae,320,we,he)),T<u.Ub-1&&(s(xe[De].y,0,D,F+480,16),s(xe[De].f,0,U,ne+224,8),s(xe[De].ea,0,de,be+224,8)),x=8*O*u.B,xe=u.sa,De=u.ta+16*w+16*O*u.R,Ae=u.qa,we=u.ra+8*w+x,he=u.Ha,pe=u.Ia+8*w+x,x=0;16>x;++x)s(xe,De+x*u.R,D,F+32*x,16);for(x=0;8>x;++x)s(Ae,we+x*u.B,U,ne+32*x,8),s(he,pe+x*u.B,de,be+32*x,8)}}function Vo(u,h,x,w,T,O,D,F,U){var ne=[0],de=[0],be=0,we=U!=null?U.kd:0,xe=U??new gc;if(u==null||12>x)return 7;xe.data=u,xe.w=h,xe.ha=x,h=[h],x=[x],xe.gb=[xe.gb];e:{var De=h,Ae=x,he=xe.gb;if(e(u!=null),e(Ae!=null),e(he!=null),he[0]=0,12<=Ae[0]&&!n(u,De[0],"RIFF")){if(n(u,De[0]+8,"WEBP")){he=3;break e}var pe=qe(u,De[0]+4);if(12>pe||4294967286<pe){he=3;break e}if(we&&pe>Ae[0]-8){he=7;break e}he[0]=pe,De[0]+=12,Ae[0]-=12}he=0}if(he!=0)return he;for(pe=0<xe.gb[0],x=x[0];;){e:{var ze=u;Ae=h,he=x;var Be=ne,Oe=de,lt=De=[0];if((nt=be=[be])[0]=0,8>he[0])he=7;else{if(!n(ze,Ae[0],"VP8X")){if(qe(ze,Ae[0]+4)!=10){he=3;break e}if(18>he[0]){he=7;break e}var tt=qe(ze,Ae[0]+8),Lt=1+Fe(ze,Ae[0]+12);if(2147483648<=Lt*(ze=1+Fe(ze,Ae[0]+15))){he=3;break e}lt!=null&&(lt[0]=tt),Be!=null&&(Be[0]=Lt),Oe!=null&&(Oe[0]=ze),Ae[0]+=18,he[0]-=18,nt[0]=1}he=0}}if(be=be[0],De=De[0],he!=0)return he;if(Ae=!!(2&De),!pe&&be)return 3;if(O!=null&&(O[0]=!!(16&De)),D!=null&&(D[0]=Ae),F!=null&&(F[0]=0),D=ne[0],De=de[0],be&&Ae&&U==null){he=0;break}if(4>x){he=7;break}if(pe&&be||!pe&&!be&&!n(u,h[0],"ALPH")){x=[x],xe.na=[xe.na],xe.P=[xe.P],xe.Sa=[xe.Sa];e:{tt=u,he=h,pe=x;var nt=xe.gb;Be=xe.na,Oe=xe.P,lt=xe.Sa,Lt=22,e(tt!=null),e(pe!=null),ze=he[0];var on=pe[0];for(e(Be!=null),e(lt!=null),Be[0]=null,Oe[0]=null,lt[0]=0;;){if(he[0]=ze,pe[0]=on,8>on){he=7;break e}var cn=qe(tt,ze+4);if(4294967286<cn){he=3;break e}var nn=8+cn+1&-2;if(Lt+=nn,0<nt&&Lt>nt){he=3;break e}if(!n(tt,ze,"VP8 ")||!n(tt,ze,"VP8L")){he=0;break e}if(on[0]<nn){he=7;break e}n(tt,ze,"ALPH")||(Be[0]=tt,Oe[0]=ze+8,lt[0]=cn),ze+=nn,on-=nn}}if(x=x[0],xe.na=xe.na[0],xe.P=xe.P[0],xe.Sa=xe.Sa[0],he!=0)break}x=[x],xe.Ja=[xe.Ja],xe.xa=[xe.xa];e:if(nt=u,he=h,pe=x,Be=xe.gb[0],Oe=xe.Ja,lt=xe.xa,tt=he[0],ze=!n(nt,tt,"VP8 "),Lt=!n(nt,tt,"VP8L"),e(nt!=null),e(pe!=null),e(Oe!=null),e(lt!=null),8>pe[0])he=7;else{if(ze||Lt){if(nt=qe(nt,tt+4),12<=Be&&nt>Be-12){he=3;break e}if(we&&nt>pe[0]-8){he=7;break e}Oe[0]=nt,he[0]+=8,pe[0]-=8,lt[0]=Lt}else lt[0]=5<=pe[0]&&nt[tt+0]==47&&!(nt[tt+4]>>5),Oe[0]=pe[0];he=0}if(x=x[0],xe.Ja=xe.Ja[0],xe.xa=xe.xa[0],h=h[0],he!=0)break;if(4294967286<xe.Ja)return 3;if(F==null||Ae||(F[0]=xe.xa?2:1),D=[D],De=[De],xe.xa){if(5>x){he=7;break}F=D,we=De,Ae=O,u==null||5>x?u=0:5<=x&&u[h+0]==47&&!(u[h+4]>>5)?(pe=[0],nt=[0],Be=[0],L(Oe=new _,u,h,x),ht(Oe,pe,nt,Be)?(F!=null&&(F[0]=pe[0]),we!=null&&(we[0]=nt[0]),Ae!=null&&(Ae[0]=Be[0]),u=1):u=0):u=0}else{if(10>x){he=7;break}F=De,u==null||10>x||!zi(u,h+3,x-3)?u=0:(we=u[h+0]|u[h+1]<<8|u[h+2]<<16,Ae=16383&(u[h+7]<<8|u[h+6]),u=16383&(u[h+9]<<8|u[h+8]),1&we||3<(we>>1&7)||!(we>>4&1)||we>>5>=xe.Ja||!Ae||!u?u=0:(D&&(D[0]=Ae),F&&(F[0]=u),u=1))}if(!u||(D=D[0],De=De[0],be&&(ne[0]!=D||de[0]!=De)))return 3;U!=null&&(U[0]=xe,U.offset=h-U.w,e(4294967286>h-U.w),e(U.offset==U.ha-x));break}return he==0||he==7&&be&&U==null?(O!=null&&(O[0]|=xe.na!=null&&0<xe.na.length),w!=null&&(w[0]=D),T!=null&&(T[0]=De),0):he}function Nc(u,h,x){var w=h.width,T=h.height,O=0,D=0,F=w,U=T;if(h.Da=u!=null&&0<u.Da,h.Da&&(F=u.cd,U=u.bd,O=u.v,D=u.j,11>x||(O&=-2,D&=-2),0>O||0>D||0>=F||0>=U||O+F>w||D+U>T))return 0;if(h.v=O,h.j=D,h.va=O+F,h.o=D+U,h.U=F,h.T=U,h.da=u!=null&&0<u.da,h.da){if(!St(F,U,x=[u.ib],O=[u.hb]))return 0;h.ib=x[0],h.hb=O[0]}return h.ob=u!=null&&u.ob,h.Kb=u==null||!u.Sd,h.da&&(h.ob=h.ib<3*w/4&&h.hb<3*T/4,h.Kb=0),1}function jc(u){if(u==null)return 2;if(11>u.S){var h=u.f.RGBA;h.fb+=(u.height-1)*h.A,h.A=-h.A}else h=u.f.kb,u=u.height,h.O+=(u-1)*h.fa,h.fa=-h.fa,h.N+=(u-1>>1)*h.Ab,h.Ab=-h.Ab,h.W+=(u-1>>1)*h.Db,h.Db=-h.Db,h.F!=null&&(h.J+=(u-1)*h.lb,h.lb=-h.lb);return 0}function Go(u,h,x,w){if(w==null||0>=u||0>=h)return 2;if(x!=null){if(x.Da){var T=x.cd,O=x.bd,D=-2&x.v,F=-2&x.j;if(0>D||0>F||0>=T||0>=O||D+T>u||F+O>h)return 2;u=T,h=O}if(x.da){if(!St(u,h,T=[x.ib],O=[x.hb]))return 2;u=T[0],h=O[0]}}w.width=u,w.height=h;e:{var U=w.width,ne=w.height;if(u=w.S,0>=U||0>=ne||!(u>=ad&&13>u))u=2;else{if(0>=w.Rd&&w.sd==null){D=O=T=h=0;var de=(F=U*w0[u])*ne;if(11>u||(O=(ne+1)/2*(h=(U+1)/2),u==12&&(D=(T=U)*ne)),(ne=a(de+2*O+D))==null){u=1;break e}w.sd=ne,11>u?((U=w.f.RGBA).eb=ne,U.fb=0,U.A=F,U.size=de):((U=w.f.kb).y=ne,U.O=0,U.fa=F,U.Fd=de,U.f=ne,U.N=0+de,U.Ab=h,U.Cd=O,U.ea=ne,U.W=0+de+O,U.Db=h,U.Ed=O,u==12&&(U.F=ne,U.J=0+de+2*O),U.Tc=D,U.lb=T)}if(h=1,T=w.S,O=w.width,D=w.height,T>=ad&&13>T)if(11>T)u=w.f.RGBA,h&=(F=Math.abs(u.A))*(D-1)+O<=u.size,h&=F>=O*w0[T],h&=u.eb!=null;else{u=w.f.kb,F=(O+1)/2,de=(D+1)/2,U=Math.abs(u.fa),ne=Math.abs(u.Ab);var be=Math.abs(u.Db),we=Math.abs(u.lb),xe=we*(D-1)+O;h&=U*(D-1)+O<=u.Fd,h&=ne*(de-1)+F<=u.Cd,h=(h&=be*(de-1)+F<=u.Ed)&U>=O&ne>=F&be>=F,h&=u.y!=null,h&=u.f!=null,h&=u.ea!=null,T==12&&(h&=we>=O,h&=xe<=u.Tc,h&=u.F!=null)}else h=0;u=h?0:2}}return u!=0||x!=null&&x.fd&&(u=jc(w)),u}var yr=64,Wo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Jo=24,Ko=32,Sc=8,Zr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ye("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(u){return u},P.Predictor2=function(u,h,x){return h[x+0]},P.Predictor3=function(u,h,x){return h[x+1]},P.Predictor4=function(u,h,x){return h[x-1]},P.Predictor5=function(u,h,x){return He(He(u,h[x+1]),h[x+0])},P.Predictor6=function(u,h,x){return He(u,h[x-1])},P.Predictor7=function(u,h,x){return He(u,h[x+0])},P.Predictor8=function(u,h,x){return He(h[x-1],h[x+0])},P.Predictor9=function(u,h,x){return He(h[x+0],h[x+1])},P.Predictor10=function(u,h,x){return He(He(u,h[x-1]),He(h[x+0],h[x+1]))},P.Predictor11=function(u,h,x){var w=h[x+0];return 0>=mt(w>>24&255,u>>24&255,(h=h[x-1])>>24&255)+mt(w>>16&255,u>>16&255,h>>16&255)+mt(w>>8&255,u>>8&255,h>>8&255)+mt(255&w,255&u,255&h)?w:u},P.Predictor12=function(u,h,x){var w=h[x+0];return(it((u>>24&255)+(w>>24&255)-((h=h[x-1])>>24&255))<<24|it((u>>16&255)+(w>>16&255)-(h>>16&255))<<16|it((u>>8&255)+(w>>8&255)-(h>>8&255))<<8|it((255&u)+(255&w)-(255&h)))>>>0},P.Predictor13=function(u,h,x){var w=h[x-1];return(rt((u=He(u,h[x+0]))>>24&255,w>>24&255)<<24|rt(u>>16&255,w>>16&255)<<16|rt(u>>8&255,w>>8&255)<<8|rt(u>>0&255,w>>0&255))>>>0};var If=P.PredictorAdd0;P.PredictorAdd1=bt,Ye("Predictor2","PredictorAdd2"),Ye("Predictor3","PredictorAdd3"),Ye("Predictor4","PredictorAdd4"),Ye("Predictor5","PredictorAdd5"),Ye("Predictor6","PredictorAdd6"),Ye("Predictor7","PredictorAdd7"),Ye("Predictor8","PredictorAdd8"),Ye("Predictor9","PredictorAdd9"),Ye("Predictor10","PredictorAdd10"),Ye("Predictor11","PredictorAdd11"),Ye("Predictor12","PredictorAdd12"),Ye("Predictor13","PredictorAdd13");var _c=P.PredictorAdd2;Me("ColorIndexInverseTransform","MapARGB","32b",function(u){return u>>8&255},function(u){return u}),Me("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(u){return u},function(u){return u>>8&255});var ed,Cs=P.ColorIndexInverseTransform,Yo=P.MapARGB,td=P.VP8LColorIndexInverseTransformAlpha,nd=P.MapAlpha,da=P.VP8LPredictorsAdd=[];da.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var oo,es,Br,ha,Mi,Ri,Qo,Fi,Vn,Cc,$r,ks,Xo,rd,kc,lo,co,fa,uo,Zo,ho,ma,Ac,As,Ps,yn,bn,Gn,rr=a(511),Bi=a(2041),Pc=a(225),el=a(767),sd=0,Tf=Bi,id=Pc,ps=el,Ls=rr,ad=0,od=1,c0=2,ld=3,cd=4,Ef=5,u0=6,zf=7,Of=8,ud=9,Df=10,t5=[2,3,7],n5=[3,3,11],d0=[280,256,256,256,40],r5=[0,1,1,1,0],s5=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],i5=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],a5=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],o5=8,Mf=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Rf=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Lc=null,l5=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],c5=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],h0=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],u5=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],d5=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],h5=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],f5=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],pa=[],Ys=[],$i=[],m5=1,f0=2,ga=[],Is=[];Ie("UpsampleRgbLinePair",Zt,3),Ie("UpsampleBgrLinePair",En,3),Ie("UpsampleRgbaLinePair",Ks,4),Ie("UpsampleBgraLinePair",cr,4),Ie("UpsampleArgbLinePair",kr,4),Ie("UpsampleRgba4444LinePair",Qn,2),Ie("UpsampleRgb565LinePair",Rn,2);var p5=P.UpsampleRgbLinePair,g5=P.UpsampleBgrLinePair,m0=P.UpsampleRgbaLinePair,p0=P.UpsampleBgraLinePair,g0=P.UpsampleArgbLinePair,x0=P.UpsampleRgba4444LinePair,x5=P.UpsampleRgb565LinePair,dd=16,hd=1<<dd-1,Ic=-227,Ff=482,v0=6,v5=(256<<v0)-1,y0=0,y5=a(256),b5=a(256),w5=a(256),N5=a(256),j5=a(Ff-Ic),S5=a(Ff-Ic);bi("YuvToRgbRow",Zt,3),bi("YuvToBgrRow",En,3),bi("YuvToRgbaRow",Ks,4),bi("YuvToBgraRow",cr,4),bi("YuvToArgbRow",kr,4),bi("YuvToRgba4444Row",Qn,2),bi("YuvToRgb565Row",Rn,2);var b0=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],fd=[0,2,8],_5=[8,7,6,4,4,2,2,2,1,1,1,1],C5=1;this.WebPDecodeRGBA=function(u,h,x,w,T){var O=od,D=new Uo,F=new en;D.ba=F,F.S=O,F.width=[F.width],F.height=[F.height];var U=F.width,ne=F.height,de=new It;if(de==null||u==null)var be=2;else e(de!=null),be=Vo(u,h,x,de.width,de.height,de.Pd,de.Qd,de.format,null);if(be!=0?U=0:(U!=null&&(U[0]=de.width[0]),ne!=null&&(ne[0]=de.height[0]),U=1),U){F.width=F.width[0],F.height=F.height[0],w!=null&&(w[0]=F.width),T!=null&&(T[0]=F.height);e:{if(w=new ln,(T=new gc).data=u,T.w=h,T.ha=x,T.kd=1,h=[0],e(T!=null),((u=Vo(T.data,T.w,T.ha,null,null,null,h,null,T))==0||u==7)&&h[0]&&(u=4),(h=u)==0){if(e(D!=null),w.data=T.data,w.w=T.w+T.offset,w.ha=T.ha-T.offset,w.put=Mt,w.ac=Dt,w.bc=an,w.ma=D,T.xa){if((u=_r())==null){D=1;break e}if(function(we,xe){var De=[0],Ae=[0],he=[0];t:for(;;){if(we==null)return 0;if(xe==null)return we.a=2,0;if(we.l=xe,we.a=0,L(we.m,xe.data,xe.w,xe.ha),!ht(we.m,De,Ae,he)){we.a=3;break t}if(we.xb=f0,xe.width=De[0],xe.height=Ae[0],!Hn(De[0],Ae[0],1,we,null))break t;return 1}return e(we.a!=0),0}(u,w)){if(w=(h=Go(w.width,w.height,D.Oa,D.ba))==0){t:{w=u;n:for(;;){if(w==null){w=0;break t}if(e(w.s.yc!=null),e(w.s.Ya!=null),e(0<w.s.Wb),e((x=w.l)!=null),e((T=x.ma)!=null),w.xb!=0){if(w.ca=T.ba,w.tb=T.tb,e(w.ca!=null),!Nc(T.Oa,x,ld)){w.a=2;break n}if(!fs(w,x.width)||x.da)break n;if((x.da||vt(w.ca.S))&&ve(),11>w.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),w.ca.f.kb.F!=null&&ve()),w.Pb&&0<w.s.ua&&w.s.vb.X==null&&!ct(w.s.vb,w.s.Wa.Xa)){w.a=1;break n}w.xb=0}if(!xr(w,w.V,w.Ba,w.c,w.i,x.o,fi))break n;T.Dc=w.Ma,w=1;break t}e(w.a!=0),w=0}w=!w}w&&(h=u.a)}else h=u.a}else{if((u=new Rr)==null){D=1;break e}if(u.Fa=T.na,u.P=T.P,u.qc=T.Sa,_s(u,w)){if((h=Go(w.width,w.height,D.Oa,D.ba))==0){if(u.Aa=0,x=D.Oa,e((T=u)!=null),x!=null){if(0<(U=0>(U=x.Md)?0:100<U?255:255*U/100)){for(ne=de=0;4>ne;++ne)12>(be=T.pb[ne]).lc&&(be.ia=U*_5[0>be.lc?0:be.lc]>>3),de|=be.ia;de&&(alert("todo:VP8InitRandom"),T.ia=1)}T.Ga=x.Id,100<T.Ga?T.Ga=100:0>T.Ga&&(T.Ga=0)}Ro(u,w)||(h=u.a)}}else h=u.a}h==0&&D.Oa!=null&&D.Oa.fd&&(h=jc(D.ba))}D=h}O=D!=0?null:11>O?F.f.RGBA.eb:F.f.kb.y}else O=null;return O};var w0=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(P,$){for(var re="",A=0;A<4;A++)re+=String.fromCharCode(P[$++]);return re}function f(P,$){return(P[$+0]<<0|P[$+1]<<8|P[$+2]<<16)>>>0}function p(P,$){return(P[$+0]<<0|P[$+1]<<8|P[$+2]<<16|P[$+3]<<24)>>>0}new c;var v=[0],m=[0],N=[],S=new c,k=t,y=function(P,$){var re={},A=0,C=!1,R=0,V=0;if(re.frames=[],!function(J,M,I,q){for(var oe=0;oe<q;oe++)if(J[M+oe]!=I.charCodeAt(oe))return!0;return!1}(P,$,"RIFF",4)){for(p(P,$+=4),$+=8;$<P.length;){var ie=d(P,$),Q=p(P,$+=4);$+=4;var te=Q+(1&Q);switch(ie){case"VP8 ":case"VP8L":re.frames[A]===void 0&&(re.frames[A]={}),(G=re.frames[A]).src_off=C?V:$-8,G.src_size=R+Q+8,A++,C&&(C=!1,R=0,V=0);break;case"VP8X":(G=re.header={}).feature_flags=P[$];var L=$+4;G.canvas_width=1+f(P,L),L+=3,G.canvas_height=1+f(P,L),L+=3;break;case"ALPH":C=!0,R=te+8,V=$-8;break;case"ANIM":(G=re.header).bgcolor=p(P,$),L=$+4,G.loop_count=(ce=P)[(_=L)+0]<<0|ce[_+1]<<8,L+=2;break;case"ANMF":var Y,G;(G=re.frames[A]={}).offset_x=2*f(P,$),$+=3,G.offset_y=2*f(P,$),$+=3,G.width=1+f(P,$),$+=3,G.height=1+f(P,$),$+=3,G.duration=f(P,$),$+=3,Y=P[$++],G.dispose=1&Y,G.blend=Y>>1&1}ie!="ANMF"&&($+=te)}var ce,_;return re}}(k,0);y.response=k,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,j=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,v=[b.canvas_height],m=[b.canvas_width];for(var z=0;z<j.length&&j[z].blend!=0;z++);}var H=j[0],Z=S.WebPDecodeRGBA(k,H.src_off,H.src_size,m,v);H.rgba=Z,H.imgwidth=m[0],H.imgheight=v[0];for(var K=0;K<m[0]*v[0]*4;K++)N[K]=Z[K];return this.width=m,this.height=v,this.data=N,this}(function(t){var e=function(){return typeof Yp=="function"},n=function(v,m,N,S){var k=4,y=o;switch(S){case t.image_compression.FAST:k=1,y=a;break;case t.image_compression.MEDIUM:k=6,y=l;break;case t.image_compression.SLOW:k=9,y=c}v=s(v,m,N,y);var b=Yp(v,{level:k});return t.__addimage__.arrayBufferToBinaryString(b)},s=function(v,m,N,S){for(var k,y,b,j=v.length/m,z=new Uint8Array(v.length+j),H=f(),Z=0;Z<j;Z+=1){if(b=Z*m,k=v.subarray(b,b+m),S)z.set(S(k,N,y),b+Z);else{for(var K,P=H.length,$=[];K<P;K+=1)$[K]=H[K](k,N,y);var re=p($.concat());z.set($[re],b+Z)}y=k}return z},i=function(v){var m=Array.apply([],v);return m.unshift(0),m},a=function(v,m){var N,S=[],k=v.length;S[0]=1;for(var y=0;y<k;y+=1)N=v[y-m]||0,S[y+1]=v[y]-N+256&255;return S},o=function(v,m,N){var S,k=[],y=v.length;k[0]=2;for(var b=0;b<y;b+=1)S=N&&N[b]||0,k[b+1]=v[b]-S+256&255;return k},l=function(v,m,N){var S,k,y=[],b=v.length;y[0]=3;for(var j=0;j<b;j+=1)S=v[j-m]||0,k=N&&N[j]||0,y[j+1]=v[j]+256-(S+k>>>1)&255;return y},c=function(v,m,N){var S,k,y,b,j=[],z=v.length;j[0]=4;for(var H=0;H<z;H+=1)S=v[H-m]||0,k=N&&N[H]||0,y=N&&N[H-m]||0,b=d(S,k,y),j[H+1]=v[H]-b+256&255;return j},d=function(v,m,N){if(v===m&&m===N)return v;var S=Math.abs(m-N),k=Math.abs(v-N),y=Math.abs(v+m-N-N);return S<=k&&S<=y?v:k<=y?m:N},f=function(){return[i,a,o,l,c]},p=function(v){var m=v.map(function(N){return N.reduce(function(S,k){return S+Math.abs(k)},0)});return m.indexOf(Math.min.apply(null,m))};t.processPNG=function(v,m,N,S){var k,y,b,j,z,H,Z,K,P,$,re,A,C,R,V,ie=this.decode.FLATE_DECODE,Q="";if(this.__addimage__.isArrayBuffer(v)&&(v=new Uint8Array(v)),this.__addimage__.isArrayBufferView(v)){if(v=(b=new t3(v)).imgData,y=b.bits,k=b.colorSpace,z=b.colors,[4,6].indexOf(b.colorType)!==-1){if(b.bits===8){P=(K=b.pixelBitlength==32?new Uint32Array(b.decodePixels().buffer):b.pixelBitlength==16?new Uint16Array(b.decodePixels().buffer):new Uint8Array(b.decodePixels().buffer)).length,re=new Uint8Array(P*b.colors),$=new Uint8Array(P);var te,L=b.pixelBitlength-b.bits;for(R=0,V=0;R<P;R++){for(C=K[R],te=0;te<L;)re[V++]=C>>>te&255,te+=b.bits;$[R]=C>>>te&255}}if(b.bits===16){P=(K=new Uint32Array(b.decodePixels().buffer)).length,re=new Uint8Array(P*(32/b.pixelBitlength)*b.colors),$=new Uint8Array(P*(32/b.pixelBitlength)),A=b.colors>1,R=0,V=0;for(var Y=0;R<P;)C=K[R++],re[V++]=C>>>0&255,A&&(re[V++]=C>>>16&255,C=K[R++],re[V++]=C>>>0&255),$[Y++]=C>>>16&255;y=8}S!==t.image_compression.NONE&&e()?(v=n(re,b.width*b.colors,b.colors,S),Z=n($,b.width,1,S)):(v=re,Z=$,ie=void 0)}if(b.colorType===3&&(k=this.color_spaces.INDEXED,H=b.palette,b.transparency.indexed)){var G=b.transparency.indexed,ce=0;for(R=0,P=G.length;R<P;++R)ce+=G[R];if((ce/=255)===P-1&&G.indexOf(0)!==-1)j=[G.indexOf(0)];else if(ce!==P){for(K=b.decodePixels(),$=new Uint8Array(K.length),R=0,P=K.length;R<P;R++)$[R]=G[K[R]];Z=n($,b.width,1)}}var _=function(J){var M;switch(J){case t.image_compression.FAST:M=11;break;case t.image_compression.MEDIUM:M=13;break;case t.image_compression.SLOW:M=14;break;default:M=12}return M}(S);return ie===this.decode.FLATE_DECODE&&(Q="/Predictor "+_+" "),Q+="/Colors "+z+" /BitsPerComponent "+y+" /Columns "+b.width,(this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),(Z&&this.__addimage__.isArrayBuffer(Z)||this.__addimage__.isArrayBufferView(Z))&&(Z=this.__addimage__.arrayBufferToBinaryString(Z)),{alias:N,data:v,index:m,filter:ie,decodeParameters:Q,transparency:j,palette:H,sMask:Z,predictor:_,width:b.width,height:b.height,bitsPerComponent:y,colorSpace:k}}}})(Et.API),function(t){t.processGIF89A=function(e,n,s,i){var a=new n3(e),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},f=new Rm(100).encode(d,100);return t.processJPEG.call(this,f,n,s,i)},t.processGIF87A=t.processGIF89A}(Et.API),ei.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:s,blue:n,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ei.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){gn.log("bit decode error:"+n)}},ei.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),o=s*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}n!==0&&(this.pos+=4-n)}},ei.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),o=s*this.width*4+2*i*4,l=a>>4,c=15&a,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*i+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},ei.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+4*s;if(i<this.palette.length){var o=this.palette[i];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},ei.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&e)/e*255|0,c=(a>>10&e)/e*255|0,d=a>>15?255:0,f=s*this.width*4+4*i;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=d}this.pos+=t}},ei.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var i=this.bottom_up?s:this.height-1-s,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&n)/n*255|0,d=(o>>11)/e*255|0,f=i*this.width*4+4*a;this.data[f]=d,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=t}},ei.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=s,this.data[o+3]=255}this.pos+=this.width%4}},ei.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*n;this.data[l]=a,this.data[l+1]=i,this.data[l+2]=s,this.data[l+3]=o}},ei.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,s,i){var a=new ei(e,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},d=new Rm(100).encode(c,100);return t.processJPEG.call(this,d,n,s,i)}}(Et.API),Ox.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,s,i){var a=new Ox(e),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},d=new Rm(100).encode(c,100);return t.processJPEG.call(this,d,n,s,i)}}(Et.API),Et.API.processRGBA=function(t,e,n){for(var s=t.data,i=s.length,a=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,d=0;d<i;d+=4){var f=s[d],p=s[d+1],v=s[d+2],m=s[d+3];a[l++]=f,a[l++]=p,a[l++]=v,o[c++]=m}var N=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:N,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Et.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},fl=Et.API,Xd=fl.getCharWidthsArray=function(t,e){var n,s,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=d.fof?d.fof:1,p=e.doKerning!==!1,v=0,m=t.length,N=0,S=l[0]||c,k=[];for(n=0;n<m;n++)s=t.charCodeAt(n),typeof i.metadata.widthOfString=="function"?k.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(s))+o*(1e3/a)||0)/1e3):(v=p&&hn(d[s])==="object"&&!isNaN(parseInt(d[s][N],10))?d[s][N]/f:0,k.push((l[s]||S)/c+v)),N=s;return k},Ix=fl.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),s=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return fl.processArabic&&(t=fl.processArabic(t)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(t,n,i)/n:Xd.apply(this,arguments).reduce(function(a,o){return a+o},0)},Tx=function(t,e,n,s){for(var i=[],a=0,o=t.length,l=0;a!==o&&l+e[a]<n;)l+=e[a],a++;i.push(t.slice(0,a));var c=a;for(l=0;a!==o;)l+e[a]>s&&(i.push(t.slice(c,a)),l=0,c=a),l+=e[a],a++;return c!==a&&i.push(t.slice(c,a)),i},Ex=function(t,e,n){n||(n={});var s,i,a,o,l,c,d,f=[],p=[f],v=n.textIndent||0,m=0,N=0,S=t.split(" "),k=Xd.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?S[0].length+2:n.lineIndent||0){var y=Array(c).join(" "),b=[];S.map(function(z){(z=z.split(/\s*\n/)).length>1?b=b.concat(z.map(function(H,Z){return(Z&&H.length?`
`:"")+H})):b.push(z[0])}),S=b,c=Ix.apply(this,[y,n])}for(a=0,o=S.length;a<o;a++){var j=0;if(s=S[a],c&&s[0]==`
`&&(s=s.substr(1),j=1),v+m+(N=(i=Xd.apply(this,[s,n])).reduce(function(z,H){return z+H},0))>e||j){if(N>e){for(l=Tx.apply(this,[s,i,e-(v+m),e]),f.push(l.shift()),f=[l.pop()];l.length;)p.push([l.shift()]);N=i.slice(s.length-(f[0]?f[0].length:0)).reduce(function(z,H){return z+H},0)}else f=[s];p.push(f),v=N+c,m=k}else f.push(s),v+=m+N,m=k}return d=c?function(z,H){return(H?y:"")+z.join(" ")}:function(z){return z.join(" ")},p.map(d)},fl.splitTextToSize=function(t,e,n){var s,i=(n=n||{}).fontSize||this.internal.getFontSize(),a=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var p=this.internal.getFont(f.fontName,f.fontStyle);return p.metadata.Unicode?{widths:p.metadata.Unicode.widths||{0:1},kerning:p.metadata.Unicode.kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);s=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;a.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=n.lineIndent;var l,c,d=[];for(l=0,c=s.length;l<c;l++)d=d.concat(Ex.apply(this,[s[l],o,a]));return d},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",n={},s={},i=0;i<e.length;i++)n[e[i]]="0123456789abcdef"[i],s["0123456789abcdef"[i]]=e[i];var a=function(p){return"0x"+parseInt(p,10).toString(16)},o=t.__fontmetrics__.compress=function(p){var v,m,N,S,k=["{"];for(var y in p){if(v=p[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=a(y).slice(2)).slice(0,-1)+s[m.slice(-1)]),typeof v=="number")v<0?(N=a(v).slice(3),S="-"):(N=a(v).slice(2),S=""),N=S+N.slice(0,-1)+s[N.slice(-1)];else{if(hn(v)!=="object")throw new Error("Don't know what to do with value type "+hn(v)+".");N=o(v)}k.push(m+N)}return k.push("}"),k.join("")},l=t.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,m,N,S,k={},y=1,b=k,j=[],z="",H="",Z=p.length-1,K=1;K<Z;K+=1)(S=p[K])=="'"?v?(N=v.join(""),v=void 0):v=[]:v?v.push(S):S=="{"?(j.push([b,N]),b={},N=void 0):S=="}"?((m=j.pop())[0][m[1]]=b,N=void 0,b=m[0]):S=="-"?y=-1:N===void 0?n.hasOwnProperty(S)?(z+=n[S],N=parseInt(z,16)*y,y=1,z=""):z+=S:n.hasOwnProperty(S)?(H+=n[S],b[N]=parseInt(H,16)*y,y=1,N=void 0,H=""):H+=S;return k},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},f={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(p){var v=p.font,m=f.Unicode[v.postScriptName];m&&(v.metadata.Unicode={},v.metadata.Unicode.widths=m.widths,v.metadata.Unicode.kerning=m.kerning);var N=d.Unicode[v.postScriptName];N&&(v.metadata.Unicode.encoding=N,v.encoding=N.codePages[0])}])}(Et.API),function(t){var e=function(n){for(var s=n.length,i=new Uint8Array(s),a=0;a<s;a++)i[a]=n.charCodeAt(a);return i};t.API.events.push(["addFont",function(n){var s=void 0,i=n.font,a=n.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(s=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(mu(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,s)}}])}(Et),function(t){function e(){return(zt.canvg?Promise.resolve(zt.canvg):Wa(()=>import("./index.es-dc3cc958.js"),[],import.meta.url)).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}Et.API.addSvgAsImage=function(n,s,i,a,o,l,c,d){if(isNaN(s)||isNaN(i))throw gn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(o))throw gn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=a,f.height=o;var p=f.getContext("2d");p.fillStyle="#fff",p.fillRect(0,0,f.width,f.height);var v={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return e().then(function(N){return N.fromString(p,n,v)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(N){return N.render(v)}).then(function(){m.addImage(f.toDataURL("image/jpeg",1),s,i,a,o,c,d)})}}(),Et.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var i=0;i<this.internal.pages[s].length;i++)this.internal.pages[s][i]=this.internal.pages[s][i].replace(e,n);return this},Et.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var s,i,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,f=0,p=0;function v(N,S){var k,y=!1;for(k=0;k<N.length;k+=1)N[k]===S&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=l.length;for(p=0;p<m;p+=1)n[l[p]].value=n[l[p]].defaultValue,n[l[p]].explicitSet=!1}if(hn(t)==="object"){for(i in t)if(a=t[i],v(l,i)&&a!==void 0){if(n[i].type==="boolean"&&typeof a=="boolean")n[i].value=a;else if(n[i].type==="name"&&v(n[i].valueSet,a))n[i].value=a;else if(n[i].type==="integer"&&Number.isInteger(a))n[i].value=a;else if(n[i].type==="array"){for(d=0;d<a.length;d+=1)if(s=!0,a[d].length===1&&typeof a[d][0]=="number")c.push(String(a[d]-1));else if(a[d].length>1){for(f=0;f<a[d].length;f+=1)typeof a[d][f]!="number"&&(s=!1);s===!0&&c.push([a[d][0]-1,a[d][1]-1].join(" "))}n[i].value="["+c.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var N,S=[];for(N in n)n[N].explicitSet===!0&&(n[N].type==="name"?S.push("/"+N+" /"+n[N].value):S.push("/"+N+" "+n[N].value));S.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+S.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(s)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=a.length+o.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(i+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(s,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(Et.API),function(t){var e=t.API,n=e.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],f=[""],p=0,v=a.length;p<v;++p){if(l=o.metadata.characterToGlyph(a.charCodeAt(p)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(p),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return f.join("");l=l.toString(16),f.push(d[4-l.length],l)}return f.join("")},s=function(a){var o,l,c,d,f,p,v;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,v=(l=Object.keys(a).sort(function(m,N){return m-N})).length;p<v;p++)o=l[p],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(d=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,d=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var p=l.metadata.Unicode.widths,v=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",N=0;N<v.length;N++)m+=String.fromCharCode(v[N]);var S=d();f({data:m,addLength1:!0,objectId:S}),c("endobj");var k=d();f({data:s(l.metadata.toUnicode),addLength1:!0,objectId:k}),c("endobj");var y=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+wl(l.fontName)),c("/FontFile2 "+S+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+wl(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+t.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+k+" 0 R"),c("/BaseFont /"+wl(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,d=o.newObject,f=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var p=l.metadata.rawData,v="",m=0;m<p.length;m++)v+=String.fromCharCode(p[m]);var N=d();f({data:v,addLength1:!0,objectId:N}),c("endobj");var S=d();f({data:s(l.metadata.toUnicode),addLength1:!0,objectId:S}),c("endobj");var k=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+N+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+wl(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+S+" 0 R/BaseFont/"+wl(l.fontName)+"/FontDescriptor "+k+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var i=function(a){var o,l=a.text||"",c=a.x,d=a.y,f=a.options||{},p=a.mutex||{},v=p.pdfEscape,m=p.activeFontKey,N=p.fonts,S=m,k="",y=0,b="",j=N[S].encoding;if(N[S].encoding!=="Identity-H")return{text:l,x:c,y:d,options:f,mutex:p};for(b=l,S=m,Array.isArray(l)&&(b=l[0]),y=0;y<b.length;y+=1)N[S].metadata.hasOwnProperty("cmap")&&(o=N[S].metadata.cmap.unicode.codeMap[b[y].charCodeAt(0)]),o||b[y].charCodeAt(0)<256&&N[S].metadata.hasOwnProperty("Unicode")?k+=b[y]:k+="";var z="";return parseInt(S.slice(1))<14||j==="WinAnsiEncoding"?z=v(k,S).split("").map(function(H){return H.charCodeAt(0).toString(16)}).join(""):j==="Identity-H"&&(z=n(k,N[S])),p.isHex=!0,{text:z,x:c,y:d,options:f,mutex:p}};e.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([i(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(i(Object.assign({},c,{text:o[d]})).text);a.text=l}else a.text=i(Object.assign({},c,{text:o})).text}])}(Et),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0},t.addFileToVFS=function(n,s){return e.call(this),this.internal.vFS[n]=s,this},t.getFileFromVFS=function(n){return e.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(Et.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(s){var i,a,o,l,c,d,f,p=e,v=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],N={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},S={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},k=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,j=0;this.__bidiEngine__={};var z=function(A){var C=A.charCodeAt(),R=C>>8,V=S[R];return V!==void 0?p[256*V+(255&C)]:R===252||R===253?"AL":y.test(R)?"L":R===8?"R":"N"},H=function(A){for(var C,R=0;R<A.length;R++){if((C=z(A.charAt(R)))==="L")return!1;if(C==="R")return!0}return!1},Z=function(A,C,R,V){var ie,Q,te,L,Y=C[V];switch(Y){case"L":case"R":b=!1;break;case"N":case"AN":break;case"EN":b&&(Y="AN");break;case"AL":b=!0,Y="R";break;case"WS":Y="N";break;case"CS":V<1||V+1>=C.length||(ie=R[V-1])!=="EN"&&ie!=="AN"||(Q=C[V+1])!=="EN"&&Q!=="AN"?Y="N":b&&(Q="AN"),Y=Q===ie?Q:"N";break;case"ES":Y=(ie=V>0?R[V-1]:"B")==="EN"&&V+1<C.length&&C[V+1]==="EN"?"EN":"N";break;case"ET":if(V>0&&R[V-1]==="EN"){Y="EN";break}if(b){Y="N";break}for(te=V+1,L=C.length;te<L&&C[te]==="ET";)te++;Y=te<L&&C[te]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(L=C.length,te=V+1;te<L&&C[te]==="NSM";)te++;if(te<L){var G=A[V],ce=G>=1425&&G<=2303||G===64286;if(ie=C[te],ce&&(ie==="R"||ie==="AL")){Y="R";break}}}Y=V<1||(ie=C[V-1])==="B"?"N":R[V-1];break;case"B":b=!1,i=!0,Y=j;break;case"S":a=!0,Y="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"BN":Y="N"}return Y},K=function(A,C,R){var V=A.split("");return R&&P(V,R,{hiLevel:j}),V.reverse(),C&&C.reverse(),V.join("")},P=function(A,C,R){var V,ie,Q,te,L,Y=-1,G=A.length,ce=0,_=[],J=j?m:v,M=[];for(b=!1,i=!1,a=!1,ie=0;ie<G;ie++)M[ie]=z(A[ie]);for(Q=0;Q<G;Q++){if(L=ce,_[Q]=Z(A,M,_,Q),V=240&(ce=J[L][N[_[Q]]]),ce&=15,C[Q]=te=J[ce][5],V>0)if(V===16){for(ie=Y;ie<Q;ie++)C[ie]=1;Y=-1}else Y=-1;if(J[ce][6])Y===-1&&(Y=Q);else if(Y>-1){for(ie=Y;ie<Q;ie++)C[ie]=te;Y=-1}M[Q]==="B"&&(C[Q]=0),R.hiLevel|=te}a&&function(I,q,oe){for(var fe=0;fe<oe;fe++)if(I[fe]==="S"){q[fe]=j;for(var ge=fe-1;ge>=0&&I[ge]==="WS";ge--)q[ge]=j}}(M,C,G)},$=function(A,C,R,V,ie){if(!(ie.hiLevel<A)){if(A===1&&j===1&&!i)return C.reverse(),void(R&&R.reverse());for(var Q,te,L,Y,G=C.length,ce=0;ce<G;){if(V[ce]>=A){for(L=ce+1;L<G&&V[L]>=A;)L++;for(Y=ce,te=L-1;Y<te;Y++,te--)Q=C[Y],C[Y]=C[te],C[te]=Q,R&&(Q=R[Y],R[Y]=R[te],R[te]=Q);ce=L}ce++}}},re=function(A,C,R){var V=A.split(""),ie={hiLevel:j};return R||(R=[]),P(V,R,ie),function(Q,te,L){if(L.hiLevel!==0&&f)for(var Y,G=0;G<Q.length;G++)te[G]===1&&(Y=k.indexOf(Q[G]))>=0&&(Q[G]=k[Y+1])}(V,R,ie),$(2,V,C,R,ie),$(1,V,C,R,ie),V.join("")};return this.__bidiEngine__.doBidiReorder=function(A,C,R){if(function(ie,Q){if(Q)for(var te=0;te<ie.length;te++)Q[te]=te;l===void 0&&(l=H(ie)),d===void 0&&(d=H(ie))}(A,C),o||!c||d)if(o&&c&&l^d)j=l?1:0,A=K(A,C,R);else if(!o&&c&&d)j=l?1:0,A=re(A,C,R),A=K(A,C);else if(!o||l||c||d){if(o&&!c&&l^d)A=K(A,C),l?(j=0,A=re(A,C,R)):(j=1,A=re(A,C,R),A=K(A,C));else if(o&&l&&!c&&d)j=1,A=re(A,C,R),A=K(A,C);else if(!o&&!c&&l^d){var V=f;l?(j=1,A=re(A,C,R),j=0,f=!1,A=re(A,C,R),f=V):(j=0,A=re(A,C,R),A=K(A,C),j=1,f=!1,A=re(A,C,R),f=V,A=K(A,C))}}else j=0,A=re(A,C,R);else j=l?1:0,A=re(A,C,R);return A},this.__bidiEngine__.setOptions=function(A){A&&(o=A.isInputVisual,c=A.isOutputVisual,l=A.isInputRtl,d=A.isOutputRtl,f=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(s){var i=s.text;s.x,s.y;var a=s.options||{};s.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,n.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([n.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([n.doBidiReorder(i[l])]);s.text=o}else s.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(Et),Et.API.TTFFont=function(){function t(e){var n;if(this.rawData=e,n=this.contents=new Ya(e),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new x3(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new r3(this.contents),this.head=new i3(this),this.name=new u3(this),this.cmap=new Qy(this),this.toUnicode={},this.hhea=new a3(this),this.maxp=new d3(this),this.hmtx=new h3(this),this.post=new l3(this),this.os2=new o3(this),this.loca=new g3(this),this.glyf=new f3(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,s,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(s=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var n;return((n=this.cmap.unicode)!=null?n.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*n},t.prototype.widthOfString=function(e,n,s){var i,a,o,l;for(o=0,a=0,l=(e=""+e).length;0<=l?a<l:a>l;a=0<=l?++a:--a)i=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(i))+s*(1e3/n)||0;return o*(n/1e3)},t.prototype.lineHeight=function(e,n){var s;return n==null&&(n=!1),s=n?this.lineGap:0,(this.ascender+s-this.decender)/1e3*e},t}();var hi,Ya=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var n,s;for(s=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)s[n]=String.fromCharCode(this.readByte());return s.join("")},t.prototype.writeString=function(e){var n,s,i;for(i=[],n=0,s=e.length;0<=s?n<s:n>s;n=0<=s?++n:--n)i.push(this.writeByte(e.charCodeAt(n)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,n,s,i,a,o,l,c;return e=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^n)+1099511627776*(255^s)+4294967296*(255^i)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*n+1099511627776*s+4294967296*i+16777216*a+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var n,s;return n=Math.floor(e/4294967296),s=4294967295&e,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var n,s;for(n=[],s=0;0<=e?s<e:s>e;s=0<=e?++s:--s)n.push(this.readByte());return n},t.prototype.write=function(e){var n,s,i,a;for(a=[],s=0,i=e.length;s<i;s++)n=e[s],a.push(this.writeByte(n));return a},t}(),r3=function(){var t;function e(n){var s,i,a;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)s={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[s.tag]=s}return e.prototype.encode=function(n){var s,i,a,o,l,c,d,f,p,v,m,N,S;for(S in m=Object.keys(n).length,c=Math.log(2),p=16*Math.floor(Math.log(m)/c),o=Math.floor(p/c),f=16*m-p,(i=new Ya).writeInt(this.scalarType),i.writeShort(m),i.writeShort(p),i.writeShort(o),i.writeShort(f),a=16*m,d=i.pos+a,l=null,N=[],n)for(v=n[S],i.writeString(S),i.writeInt(t(v)),i.writeInt(d),i.writeInt(v.length),N=N.concat(v),S==="head"&&(l=d),d+=v.length;d%4;)N.push(0),d++;return i.write(N),s=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(s),i.data},t=function(n){var s,i,a,o;for(n=Xy.call(n);n.length%4;)n.push(0);for(a=new Ya(n),i=0,s=0,o=n.length;s<o;s=s+=4)i+=a.readUInt32();return 4294967295&i},e}(),s3={}.hasOwnProperty,Ei=function(t,e){for(var n in e)s3.call(e,n)&&(t[n]=e[n]);function s(){this.constructor=t}return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t};hi=function(){function t(e){var n;this.file=e,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var i3=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="head",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},e.prototype.encode=function(n){var s;return(s=new Ya).writeInt(this.version),s.writeInt(this.revision),s.writeInt(this.checkSumAdjustment),s.writeInt(this.magicNumber),s.writeShort(this.flags),s.writeShort(this.unitsPerEm),s.writeLongLong(this.created),s.writeLongLong(this.modified),s.writeShort(this.xMin),s.writeShort(this.yMin),s.writeShort(this.xMax),s.writeShort(this.yMax),s.writeShort(this.macStyle),s.writeShort(this.lowestRecPPEM),s.writeShort(this.fontDirectionHint),s.writeShort(n),s.writeShort(this.glyphDataFormat),s.data},e}(),Dx=function(){function t(e,n){var s,i,a,o,l,c,d,f,p,v,m,N,S,k,y,b,j;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=n+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),v=m/2,e.pos+=6,a=function(){var z,H;for(H=[],c=z=0;0<=v?z<v:z>v;c=0<=v?++z:--z)H.push(e.readUInt16());return H}(),e.pos+=2,S=function(){var z,H;for(H=[],c=z=0;0<=v?z<v:z>v;c=0<=v?++z:--z)H.push(e.readUInt16());return H}(),d=function(){var z,H;for(H=[],c=z=0;0<=v?z<v:z>v;c=0<=v?++z:--z)H.push(e.readUInt16());return H}(),f=function(){var z,H;for(H=[],c=z=0;0<=v?z<v:z>v;c=0<=v?++z:--z)H.push(e.readUInt16());return H}(),i=(this.length-e.pos+this.offset)/2,l=function(){var z,H;for(H=[],c=z=0;0<=i?z<i:z>i;c=0<=i?++z:--z)H.push(e.readUInt16());return H}(),c=y=0,j=a.length;y<j;c=++y)for(k=a[c],s=b=N=S[c];N<=k?b<=k:b>=k;s=N<=k?++b:--b)f[c]===0?o=s+d[c]:(o=l[f[c]/2+(s-N)-(v-c)]||0)!==0&&(o+=d[c]),this.codeMap[s]=65535&o}e.pos=p}return t.encode=function(e,n){var s,i,a,o,l,c,d,f,p,v,m,N,S,k,y,b,j,z,H,Z,K,P,$,re,A,C,R,V,ie,Q,te,L,Y,G,ce,_,J,M,I,q,oe,fe,ge,Te,Ee,Fe;switch(V=new Ya,o=Object.keys(e).sort(function(qe,ct){return qe-ct}),n){case"macroman":for(S=0,k=function(){var qe=[];for(N=0;N<256;++N)qe.push(0);return qe}(),b={0:0},a={},ie=0,Y=o.length;ie<Y;ie++)b[ge=e[i=o[ie]]]==null&&(b[ge]=++S),a[i]={old:e[i],new:b[e[i]]},k[i]=b[e[i]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(k),{charMap:a,subtable:V.data,maxGlyphID:S+1};case"unicode":for(C=[],p=[],j=0,b={},s={},y=d=null,Q=0,G=o.length;Q<G;Q++)b[H=e[i=o[Q]]]==null&&(b[H]=++j),s[i]={old:H,new:b[H]},l=b[H]-i,y!=null&&l===d||(y&&p.push(y),C.push(i),d=l),y=i;for(y&&p.push(y),p.push(65535),C.push(65535),re=2*($=C.length),P=2*Math.pow(Math.log($)/Math.LN2,2),v=Math.log(P/2)/Math.LN2,K=2*$-P,c=[],Z=[],m=[],N=te=0,ce=C.length;te<ce;N=++te){if(A=C[N],f=p[N],A===65535){c.push(0),Z.push(0);break}if(A-(R=s[A].new)>=32768)for(c.push(0),Z.push(2*(m.length+$-N)),i=L=A;A<=f?L<=f:L>=f;i=A<=f?++L:--L)m.push(s[i].new);else c.push(R-A),Z.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*$+2*m.length),V.writeUInt16(0),V.writeUInt16(re),V.writeUInt16(P),V.writeUInt16(v),V.writeUInt16(K),oe=0,_=p.length;oe<_;oe++)i=p[oe],V.writeUInt16(i);for(V.writeUInt16(0),fe=0,J=C.length;fe<J;fe++)i=C[fe],V.writeUInt16(i);for(Te=0,M=c.length;Te<M;Te++)l=c[Te],V.writeUInt16(l);for(Ee=0,I=Z.length;Ee<I;Ee++)z=Z[Ee],V.writeUInt16(z);for(Fe=0,q=m.length;Fe<q;Fe++)S=m[Fe],V.writeUInt16(S);return{charMap:s,subtable:V.data,maxGlyphID:j+1}}},t}(),Qy=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="cmap",e.prototype.parse=function(n){var s,i,a;for(n.pos=this.offset,this.version=n.readUInt16(),a=n.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)s=new Dx(n,this.offset),this.tables.push(s),s.isUnicode&&this.unicode==null&&(this.unicode=s);return!0},e.encode=function(n,s){var i,a;return s==null&&(s="macroman"),i=Dx.encode(n,s),(a=new Ya).writeUInt16(0),a.writeUInt16(1),i.table=a.data.concat(i.subtable),i},e}(),a3=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="hhea",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},e}(),o3=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="OS/2",e.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var s,i;for(i=[],s=0;s<10;++s)i.push(n.readByte());return i}(),this.charRange=function(){var s,i;for(i=[],s=0;s<4;++s)i.push(n.readInt());return i}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var s,i;for(i=[],s=0;s<2;s=++s)i.push(n.readInt());return i}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},e}(),l3=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="post",e.prototype.parse=function(n){var s,i,a;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var o;for(i=n.readUInt16(),this.glyphNameIndex=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],a=[];n.pos<this.offset+this.length;)s=n.readByte(),a.push(this.names.push(n.readString(s)));return a;case 151552:return i=n.readUInt16(),this.offsets=n.read(i);case 196608:break;case 262144:return this.map=(function(){var l,c,d;for(d=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)d.push(n.readUInt32());return d}).call(this)}},e}(),c3=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},u3=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="name",e.prototype.parse=function(n){var s,i,a,o,l,c,d,f,p,v,m;for(n.pos=this.offset,n.readShort(),s=n.readShort(),c=n.readShort(),i=[],o=0;0<=s?o<s:o>s;o=0<=s?++o:--o)i.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+c+n.readShort()});for(d={},o=p=0,v=i.length;p<v;o=++p)a=i[o],n.pos=a.offset,f=n.readString(a.length),l=new c3(f,a),d[m=a.nameID]==null&&(d[m]=[]),d[a.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e}(),d3=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="maxp",e.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},e}(),h3=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="hmtx",e.prototype.parse=function(n){var s,i,a,o,l,c,d;for(n.pos=this.offset,this.metrics=[],s=0,c=this.file.hhea.numberOfMetrics;0<=c?s<c:s>c;s=0<=c?++s:--s)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var f,p;for(p=[],s=f=0;0<=a?f<a:f>a;s=0<=a?++f:--f)p.push(n.readInt16());return p}(),this.widths=(function(){var f,p,v,m;for(m=[],f=0,p=(v=this.metrics).length;f<p;f++)o=v[f],m.push(o.advance);return m}).call(this),i=this.widths[this.widths.length-1],d=[],s=l=0;0<=a?l<a:l>a;s=0<=a?++l:--l)d.push(this.widths.push(i));return d},e.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},e}(),Xy=[].slice,f3=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(n){var s,i,a,o,l,c,d,f,p,v;return n in this.cache?this.cache[n]:(o=this.file.loca,s=this.file.contents,i=o.indexOf(n),(a=o.lengthOf(n))===0?this.cache[n]=null:(s.pos=this.offset+i,l=(c=new Ya(s.read(a))).readShort(),f=c.readShort(),v=c.readShort(),d=c.readShort(),p=c.readShort(),this.cache[n]=l===-1?new p3(c,f,v,d,p):new m3(c,l,f,v,d,p),this.cache[n]))},e.prototype.encode=function(n,s,i){var a,o,l,c,d;for(l=[],o=[],c=0,d=s.length;c<d;c++)a=n[s[c]],o.push(l.length),a&&(l=l.concat(a.encode(i)));return o.push(l.length),{table:l,offsets:o}},e}(),m3=function(){function t(e,n,s,i,a,o){this.raw=e,this.numberOfContours=n,this.xMin=s,this.yMin=i,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),p3=function(){function t(e,n,s,i,a){var o,l;for(this.raw=e,this.xMin=n,this.yMin=s,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,n,s;for(n=new Ya(Xy.call(this.raw.data)),e=0,s=this.glyphIDs.length;e<s;++e)n.pos=this.glyphOffsets[e];return n.data},t}(),g3=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Ei(e,hi),e.prototype.tag="loca",e.prototype.parse=function(n){var s,i;return n.pos=this.offset,s=this.file.head.indexToLocFormat,this.offsets=s===0?(function(){var a,o;for(o=[],i=0,a=this.length;i<a;i+=2)o.push(2*n.readUInt16());return o}).call(this):(function(){var a,o;for(o=[],i=0,a=this.length;i<a;i+=4)o.push(n.readUInt32());return o}).call(this)},e.prototype.indexOf=function(n){return this.offsets[n]},e.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},e.prototype.encode=function(n,s){for(var i=new Uint32Array(this.offsets.length),a=0,o=0,l=0;l<i.length;++l)if(i[l]=a,o<s.length&&s[o]==l){++o,i[l]=a;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(a+=d)}for(var f=new Array(4*i.length),p=0;p<i.length;++p)f[4*p+3]=255&i[p],f[4*p+2]=(65280&i[p])>>8,f[4*p+1]=(16711680&i[p])>>16,f[4*p]=(4278190080&i[p])>>24;return f},e}(),x3=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,n,s,i,a;for(n in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)s=a[n],e[n]=i[s];return e},t.prototype.glyphsFor=function(e){var n,s,i,a,o,l,c;for(i={},o=0,l=e.length;o<l;o++)i[a=e[o]]=this.font.glyf.glyphFor(a);for(a in n=[],i)(s=i[a])!=null&&s.compound&&n.push.apply(n,s.glyphIDs);if(n.length>0)for(a in c=this.glyphsFor(n))s=c[a],i[a]=s;return i},t.prototype.encode=function(e,n){var s,i,a,o,l,c,d,f,p,v,m,N,S,k,y;for(i in s=Qy.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),m={0:0},y=s.charMap)m[(c=y[i]).old]=c.new;for(N in v=s.maxGlyphID,o)N in m||(m[N]=v++);return f=function(b){var j,z;for(j in z={},b)z[b[j]]=j;return z}(m),p=Object.keys(f).sort(function(b,j){return b-j}),S=function(){var b,j,z;for(z=[],b=0,j=p.length;b<j;b++)l=p[b],z.push(f[l]);return z}(),a=this.font.glyf.encode(o,S,m),d=this.font.loca.encode(a.offsets,S),k={cmap:this.font.cmap.raw(),glyf:a.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(k["OS/2"]=this.font.os2.raw()),this.font.directory.encode(k)},t}();Et.API.PDFObject=function(){var t;function e(){}return t=function(n,s){return(Array(s+1).join("0")+n).slice(-s)},e.convert=function(n){var s,i,a,o;if(Array.isArray(n))return"["+function(){var l,c,d;for(d=[],l=0,c=n.length;l<c;l++)s=n[l],d.push(e.convert(s));return d}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in a=["<<"],n)o=n[i],a.push("/"+i+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+n},e}();const hr=[{id:"carne",name:"Carne",color:"bg-red-100 text-red-800",temp:"0-4°C",storage:"Frigorifero"},{id:"pesce",name:"Pesce",color:"bg-blue-100 text-blue-800",temp:"0-2°C",storage:"Frigorifero"},{id:"latticini",name:"Latticini",color:"bg-yellow-100 text-yellow-800",temp:"2-4°C",storage:"Frigorifero"},{id:"verdura",name:"Verdura",color:"bg-green-100 text-green-800",temp:"2-8°C",storage:"Frigorifero"},{id:"frutta",name:"Frutta",color:"bg-orange-100 text-orange-800",temp:"2-8°C",storage:"Frigorifero"},{id:"pane",name:"Pane",color:"bg-amber-100 text-amber-800",temp:"Ambiente",storage:"Shelf"},{id:"conserva",name:"Conserve",color:"bg-purple-100 text-purple-800",temp:"Ambiente",storage:"Shelf"},{id:"bevande",name:"Bevande",color:"bg-cyan-100 text-cyan-800",temp:"2-8°C",storage:"Frigorifero"}],Mx=[{id:"pollo",name:"Petto di Pollo",category:"carne",temp:"0-4°C"},{id:"manzo",name:"Macinato di Manzo",category:"carne",temp:"0-4°C"},{id:"salmone",name:"Salmone Fresco",category:"pesce",temp:"0-2°C"},{id:"tonno",name:"Tonno Fresco",category:"pesce",temp:"0-2°C"},{id:"latte",name:"Latte Intero",category:"latticini",temp:"2-4°C"},{id:"formaggio",name:"Formaggio Grana",category:"latticini",temp:"2-4°C"},{id:"pomodori",name:"Pomodori",category:"verdura",temp:"2-8°C"},{id:"lattuga",name:"Lattuga",category:"verdura",temp:"2-8°C"},{id:"mele",name:"Mele",category:"frutta",temp:"2-8°C"},{id:"banane",name:"Banane",category:"frutta",temp:"2-8°C"},{id:"pane_bianco",name:"Pane Bianco",category:"pane",temp:"Ambiente"},{id:"pasta",name:"Pasta",category:"conserva",temp:"Ambiente"},{id:"acqua",name:"Acqua",category:"bevande",temp:"2-8°C"}],ml=[{id:"glutine",name:"Glutine",color:"bg-amber-100 text-amber-800"},{id:"latte",name:"Latte",color:"bg-blue-100 text-blue-800"},{id:"uova",name:"Uova",color:"bg-yellow-100 text-yellow-800"},{id:"soia",name:"Soia",color:"bg-green-100 text-green-800"},{id:"frutta_guscio",name:"Frutta a Guscio",color:"bg-orange-100 text-orange-800"},{id:"arachidi",name:"Arachidi",color:"bg-red-100 text-red-800"},{id:"pesce",name:"Pesce",color:"bg-cyan-100 text-cyan-800"},{id:"crostacei",name:"Crostacei",color:"bg-purple-100 text-purple-800"}],v3=()=>{var ia;const{alertModal:t,confirmModal:e,promptModal:n,closeAlert:s,closeConfirm:i,closePrompt:a,alertSuccess:o,alertError:l,alertWarning:c,confirmDelete:d,promptText:f}=rc(),[p,v]=W.useState([]),[m,N]=W.useState(!1),[S,k]=W.useState(null),{formRef:y,scrollToForm:b}=Ja(m,"inventory-product-form");W.useEffect(()=>{m&&b()},[m,b]);const[j,z]=W.useState(""),[H,Z]=W.useState(""),[K,P]=W.useState(""),[$,re]=W.useState(""),[A,C]=W.useState(""),[R,V]=W.useState(""),[ie,Q]=W.useState(""),[te,L]=W.useState(""),[Y,G]=W.useState(""),[ce,_]=W.useState(!1),[J,M]=W.useState(!1),[I,q]=W.useState([]),[oe,fe]=W.useState([]),[ge,Te]=W.useState([]),[Ee,Fe]=W.useState([]),[qe,ct]=W.useState([]),[_e,ae]=W.useState(!1),[St,st]=W.useState([]),[$e,Ye]=W.useState(!1),[Ge,He]=W.useState(!1),[it,rt]=W.useState([]),[mt,bt]=W.useState([]),[me,Le]=W.useState(!1),[Ce,Me]=W.useState([]),[Ne,gt]=W.useState(!1),[et,ut]=W.useState([]),[ye,Re]=W.useState(!1),[xt,vt]=W.useState(""),[jt,Ot]=W.useState(""),[en,It]=W.useState(""),[wt,Ze]=W.useState(""),[dt,Xt]=W.useState({name:"",category:"",department:"",conservationPoint:"",expiryDate:"",allergens:[],notes:"",lotNumber:"",batchDeliveryDate:"",supplierName:"",associatedOrderId:""}),[Dt,Mt]=W.useState({orderId:"",supplierName:"",orderDate:new Date().toISOString().split("T")[0],notes:""});W.useEffect(()=>{var Wt,ln;mS();const B=dl(zr.INVENTORY),je=dl(zr.REFRIGERATORS),Pe=dl(zr.SUPPLIERS),We=dl(zr.ORDERS),Ct=dl(zr.USED_INGREDIENTS),Tt=dl(zr.ONBOARDING);if(Tt){if((Wt=Tt.departments)!=null&&Wt.list){const Rr=Tt.departments.list.filter(sn=>sn.enabled).map(sn=>({id:sn.id,name:sn.name}));Fe(Rr)}(ln=Tt.conservation)!=null&&ln.points&&ct(Tt.conservation.points)}B&&v(B),je&&q(je),Pe&&fe(Pe),We&&Te(We),Ct&&ut(Ct)},[]),W.useEffect(()=>{gx(zr.INVENTORY,p)},[p]),W.useEffect(()=>{gx(zr.USED_INGREDIENTS,et)},[et]),W.useEffect(()=>{const B=p.filter(je=>!je.conservationPoint||je.conservationPoint==="");st(B),B.length>0&&ae(!0)},[p]);const an=B=>{const je=p.filter(Pe=>Pe.department===B);if(je.length>0){const Pe=`Il reparto "${B}" contiene ${je.length} prodotti. Vuoi sostituirlo con un altro reparto?`;d(Pe,()=>{f(`Seleziona il nuovo reparto per i ${je.length} prodotti:
${Ee.map(We=>We.name).join(`
`)}`,We=>{We&&Ee.find(Ct=>Ct.name===We)?(v(Ct=>Ct.map(Tt=>Tt.department===B?{...Tt,department:We}:Tt)),Fe(Ct=>Ct.filter(Tt=>Tt.name!==B)),o(`Reparto "${B}" sostituito con "${We}" per ${je.length} prodotti.`)):l("Reparto non valido. Operazione annullata.")},{title:"Seleziona nuovo reparto",placeholder:"Nome del nuovo reparto",validation:We=>!We||!Ee.find(Ct=>Ct.name===We)?{isValid:!1,error:"Seleziona un reparto valido dalla lista"}:{isValid:!0,error:""}})})}else Fe(Pe=>Pe.filter(We=>We.name!==B))},ht=B=>{const je=p.filter(Pe=>Pe.conservationPoint===B);if(je.length>0){const Pe=`Il punto di conservazione "${B}" contiene ${je.length} prodotti. Vuoi sostituirlo con un altro punto?`;d(Pe,()=>{f(`Seleziona il nuovo punto di conservazione per i ${je.length} prodotti:
${qe.map(We=>We.name).join(`
`)}`,We=>{We&&qe.find(Ct=>Ct.name===We)?(v(Ct=>Ct.map(Tt=>Tt.conservationPoint===B?{...Tt,conservationPoint:We}:Tt)),ct(Ct=>Ct.filter(Tt=>Tt.name!==B)),o(`Punto di conservazione "${B}" sostituito con "${We}" per ${je.length} prodotti.`)):l("Punto di conservazione non valido. Operazione annullata.")},{title:"Seleziona nuovo punto di conservazione",placeholder:"Nome del nuovo punto di conservazione",validation:We=>!We||!qe.find(Ct=>Ct.name===We)?{isValid:!1,error:"Seleziona un punto di conservazione valido dalla lista"}:{isValid:!0,error:""}})})}else ct(Pe=>Pe.filter(We=>We.name!==B))},_t=B=>{const je=new Date,We=new Date(B)-je,Ct=Math.ceil(We/(1e3*60*60*24));return Ct<0?{status:"expired",label:"Scaduto",color:"bg-red-100 text-red-800"}:Ct<=3?{status:"critical",label:"Critico",color:"bg-red-100 text-red-800"}:Ct<=7?{status:"warning",label:"In scadenza",color:"bg-yellow-100 text-yellow-800"}:{status:"ok",label:"OK",color:"bg-green-100 text-green-800"}},Mn=B=>{if(!hr.find(We=>We.id===B))return"Categoria non trovata";const Pe=I.find(We=>{const Ct=pS(We);return Ct.mode==="fixed"&&Ct.value>=0&&Ct.value<=4});return Pe?Pe.name:"Nessun frigorifero appropriato"},Pn=B=>{const je=new Date,Pe=HN[B]||7,We=new Date(je);return We.setDate(je.getDate()+Pe),We.toISOString().split("T")[0]},Sn=B=>{ut(je=>je.filter(Pe=>Pe.id!==B.id)),Xt({name:B.name,category:B.category,expiryDate:Pn(B.category),department:B.department||"",conservationPoint:B.conservationPoint||"",allergens:B.allergens||[],notes:B.notes||"",lotNumber:B.lotNumber||"",batchDeliveryDate:B.batchDeliveryDate||"",associatedOrderId:B.associatedOrderId||"",supplierName:B.supplierName||""}),N(!0),Re(!1)},vn=B=>{Me(je=>je.includes(B)?je.filter(Pe=>Pe!==B):[...je,B])},gr=B=>{B.preventDefault(),p.filter(Pe=>Ce.includes(Pe.id));const je=p.map(Pe=>Ce.includes(Pe.id)?{...Pe,associatedOrderId:Dt.orderId,supplierName:Dt.supplierName,batchDeliveryDate:Dt.orderDate,lotNumber:`L${new Date().toISOString().slice(2,10).replace(/-/g,"")}${Math.random().toString(36).substr(2,3).toUpperCase()}`}:Pe);v(je),Me([]),gt(!1),Mt({orderId:"",supplierName:"",orderDate:new Date().toISOString().split("T")[0],notes:""})},fi=B=>{bt(je=>je.includes(B)?je.filter(Pe=>Pe!==B):[...je,B])},Qr=()=>{const B=new Et;B.setFontSize(20),B.text("Lista della Spesa",20,30),B.setFontSize(12),B.text(`Data: ${new Date().toLocaleDateString("it-IT")}`,20,45);let je=60;B.setFontSize(14),B.text("Prodotti da acquistare:",20,je),je+=10;const Pe=p.filter(We=>mt.includes(We.id));Pe.length===0?(B.setFontSize(12),B.text("Nessun prodotto selezionato",20,je)):(B.setFontSize(10),Pe.forEach((We,Ct)=>{je>280&&(B.addPage(),je=20);const Tt=hr.find(Wt=>Wt.id===We.category);B.text(`${Ct+1}. ${We.name}`,20,je),Tt&&B.text(`   Categoria: ${Tt.name}`,25,je+5),We.department&&B.text(`   Reparto: ${We.department}`,25,je+10),We.conservationPoint&&B.text(`   Punto di Conservazione: ${We.conservationPoint}`,25,je+15),je+=20})),B.save(`lista-spesa-${new Date().toISOString().split("T")[0]}.pdf`),Le(!1),bt([])},Sr=B=>{if(ce){const je={};return B.forEach(Pe=>{const We=Pe.department||"Non assegnato";je[We]||(je[We]=[]),je[We].push(Pe)}),je}else if(J){const je={};return B.forEach(Pe=>{const We=Pe.conservationPoint||"Non assegnato";je[We]||(je[We]=[]),je[We].push(Pe)}),je}return{"Tutti i prodotti":B}},Ln=p.filter(B=>{var zi,_s,gi;const je=!j||B.name.toLowerCase().includes(j.toLowerCase())||((zi=B.department)==null?void 0:zi.toLowerCase().includes(j.toLowerCase()))||((_s=B.conservationPoint)==null?void 0:_s.toLowerCase().includes(j.toLowerCase()))||((gi=hr.find(Ws=>Ws.id===B.category))==null?void 0:gi.name.toLowerCase().includes(j.toLowerCase())),Pe=!H||B.category===H;let We=!0;K&&(We=_t(B.expiryDate).status===K);const Ct=!$||B.allergens&&B.allergens.includes($),Tt=!A||B.lotNumber&&B.lotNumber.toLowerCase().includes(A.toLowerCase()),Wt=!R||B.supplierName&&B.supplierName.toLowerCase().includes(R.toLowerCase()),ln=!ie||B.associatedOrderId&&B.associatedOrderId.toLowerCase().includes(ie.toLowerCase()),Rr=!te||B.department===te,sn=!Y||B.conservationPoint===Y;return je&&Pe&&We&&Ct&&Tt&&Wt&&ln&&Rr&&sn}),xr=()=>{Xt({name:"",category:"",department:"",conservationPoint:"",expiryDate:"",allergens:[],notes:"",lotNumber:"",batchDeliveryDate:"",supplierName:"",associatedOrderId:""}),k(null),N(!1)},nr=(B,je)=>{Xt(Pe=>({...Pe,[B]:je}))},_r=B=>{Xt(je=>({...je,allergens:je.allergens.includes(B)?je.allergens.filter(Pe=>Pe!==B):[...je.allergens,B]}))},Hn=B=>{if(B.preventDefault(),!dt.name||!dt.category||!dt.department||!dt.conservationPoint||!dt.expiryDate){l("Compila tutti i campi obbligatori");return}const je={...dt,id:S?S.id:Date.now().toString(),addedAt:S?S.addedAt:new Date().toISOString()};v(S?Pe=>Pe.map(We=>We.id===S.id?je:We):Pe=>[...Pe,je]),xr()},fs=B=>{Xt({name:B.name,category:B.category,department:B.department||"",conservationPoint:B.conservationPoint||"",expiryDate:B.expiryDate,allergens:B.allergens||[],notes:B.notes||"",lotNumber:B.lotNumber||"",batchDeliveryDate:B.batchDeliveryDate||"",supplierName:B.supplierName||"",associatedOrderId:B.associatedOrderId||""}),k(B),N(!0)},Vs=B=>{const je=p.find(Pe=>Pe.id===B);if(je){const Pe={...je,usedDate:new Date().toISOString(),id:`used_${Date.now()}_${je.id}`};ut(We=>[...We,Pe])}v(Pe=>Pe.filter(We=>We.id!==B))},Gs=B=>{const je=new Date,Pe=new Date(je.getTime()+7*24*60*60*1e3),We=Mn(B.category),Ct=qe.find(ln=>ln.name===We),Tt=(Ct==null?void 0:Ct.location)||"",Wt={...B,id:Date.now().toString(),department:Tt,conservationPoint:We,expiryDate:Pe.toISOString().split("T")[0],allergens:[],notes:"",lotNumber:"",batchDeliveryDate:je.toISOString().split("T")[0],supplierName:"",associatedOrderId:"",addedAt:new Date().toISOString()};v(ln=>[...ln,Wt])},mi=B=>{rt(je=>je.includes(B)?je.filter(Pe=>Pe!==B):[...je,B])},pi=()=>{v(B=>B.filter(je=>!it.includes(je.id))),rt([]),Ye(!1)},sa=()=>{v([]),He(!1)},to=()=>{const B=new Et;B.setFontSize(20),B.text("Inventario HACCP",20,20),B.setFontSize(12),B.text(`Data: ${new Date().toLocaleDateString("it-IT")}`,20,30),B.text(`Totale prodotti: ${p.length}`,20,40);let je=60;p.forEach((Pe,We)=>{je>280&&(B.addPage(),je=20);const Ct=hr.find(Wt=>Wt.id===Pe.category),Tt=_t(Pe.expiryDate);if(B.text(`${We+1}. ${Pe.name}`,20,je),B.text(`   Categoria: ${(Ct==null?void 0:Ct.name)||"N/A"}`,25,je+5),Pe.department&&B.text(`   Reparto: ${Pe.department}`,25,je+10),Pe.conservationPoint&&B.text(`   Punto di Conservazione: ${Pe.conservationPoint}`,25,je+15),B.text(`   Scadenza: ${new Date(Pe.expiryDate).toLocaleDateString("it-IT")} (${Tt.label})`,25,je+15),Pe.allergens&&Pe.allergens.length>0){const Wt=Pe.allergens.map(ln=>{var Rr;return(Rr=ml.find(sn=>sn.id===ln))==null?void 0:Rr.name}).filter(Boolean).join(", ");B.text(`   Allergeni: ${Wt}`,25,je+20),je+=25}else je+=20;Pe.notes&&(B.text(`   Note: ${Pe.notes}`,25,je),je+=10),je+=10}),B.save(`inventario-haccp-${new Date().toISOString().split("T")[0]}.pdf`)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Inventario"}),r.jsx("p",{className:"text-gray-600",children:"Gestisci i prodotti e la tracciabilità HACCP"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{onClick:to,className:"flex items-center gap-2",children:[r.jsx(Bs,{className:"h-4 w-4"}),"Export PDF"]}),r.jsxs(le,{onClick:()=>N(!0),className:"bg-blue-600 hover:bg-blue-700",children:[r.jsx(or,{className:"h-4 w-4 mr-2"}),"Aggiungi Prodotto"]}),r.jsxs(le,{variant:"outline",onClick:()=>Re(!ye),className:"flex items-center gap-2",children:[r.jsx(Un,{className:"h-4 w-4"}),"Ingredienti Utilizzati (",et.length,")"]})]})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(ty,{className:"h-5 w-5"}),"Filtri"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"search",children:"Cerca"}),r.jsxs("div",{className:"relative",children:[r.jsx(gl,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),r.jsx(At,{id:"search",value:j,onChange:B=>z(B.target.value),placeholder:"Nome prodotto, reparto, punto di conservazione...",className:"pl-10"})]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"category",children:"Categoria"}),r.jsxs("select",{id:"category",value:H,onChange:B=>Z(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Tutte le categorie"}),hr.map(B=>r.jsx("option",{value:B.id,children:B.name},B.id))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"expiry",children:"Scadenza"}),r.jsxs("select",{id:"expiry",value:K,onChange:B=>P(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Tutte le scadenze"}),r.jsx("option",{value:"expired",children:"Scaduti"}),r.jsx("option",{value:"critical",children:"Critici (≤3 giorni)"}),r.jsx("option",{value:"warning",children:"In scadenza (≤7 giorni)"}),r.jsx("option",{value:"ok",children:"OK (>7 giorni)"})]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"allergen",children:"Allergene"}),r.jsxs("select",{id:"allergen",value:$,onChange:B=>re(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Tutti gli allergeni"}),ml.map(B=>r.jsx("option",{value:B.id,children:B.name},B.id))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"lot",children:"Numero Lotto"}),r.jsx(At,{id:"lot",value:A,onChange:B=>C(B.target.value),placeholder:"Filtra per numero lotto..."})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"supplier",children:"Fornitore"}),r.jsx(At,{id:"supplier",value:R,onChange:B=>V(B.target.value),placeholder:"Filtra per fornitore..."})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"orderId",children:"ID Ordine"}),r.jsx(At,{id:"orderId",value:ie,onChange:B=>Q(B.target.value),placeholder:"Filtra per ID ordine..."})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"department",children:"Reparto"}),r.jsxs("select",{id:"department",value:te,onChange:B=>L(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Tutti i reparti"}),Ee.map(B=>r.jsx("option",{value:B.name,children:B.name},B.id))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"conservationPoint",children:"Punto di Conservazione"}),r.jsxs("select",{id:"conservationPoint",value:Y,onChange:B=>G(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Tutti i punti"}),qe.map(B=>r.jsx("option",{value:B.name,children:B.name},B.id))]})]}),r.jsxs("div",{className:"col-span-full",children:[r.jsxs("div",{className:"flex flex-wrap gap-4 items-center mb-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"checkbox",id:"groupByDepartment",checked:ce,onChange:B=>{_(B.target.checked),B.target.checked&&M(!1)},className:"rounded"}),r.jsx(Ke,{htmlFor:"groupByDepartment",className:"text-sm",children:"Raggruppa per Reparto"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"checkbox",id:"groupByConservationPoint",checked:J,onChange:B=>{M(B.target.checked),B.target.checked&&_(!1)},className:"rounded"}),r.jsx(Ke,{htmlFor:"groupByConservationPoint",className:"text-sm",children:"Raggruppa per Punto di Conservazione"})]})]}),r.jsx(le,{onClick:()=>{z(""),Z(""),P(""),re(""),C(""),V(""),Q(""),L(""),G(""),_(!1),M(!1)},variant:"outline",className:"w-full",children:"🔄 Reset Filtri"})]})]})})]}),_e&&St.length>0&&r.jsxs(Je,{className:"border-red-200 bg-red-50",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2 text-red-800",children:[r.jsx(xn,{className:"h-5 w-5"}),"Attenzione: ",St.length," prodotti senza punto di conservazione!"]})}),r.jsxs(Xe,{children:[r.jsx("p",{className:"text-red-700 mb-4",children:"I seguenti prodotti devono essere posizionati in un adeguato punto di conservazione:"}),r.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:St.map(B=>{const je=hr.find(Pe=>Pe.id===B.category);return r.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-red-200",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),r.jsx("span",{className:"font-medium",children:B.name}),r.jsxs("span",{className:"text-sm text-gray-600",children:["(",(je==null?void 0:je.name)||"Categoria sconosciuta",")"]})]}),r.jsxs(le,{onClick:()=>{fs(B),ae(!1)},size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:[r.jsx(ci,{className:"h-4 w-4 mr-1"}),"Assegna"]})]},B.id)})}),r.jsx("div",{className:"flex gap-2 mt-4",children:r.jsx(le,{onClick:()=>ae(!1),variant:"outline",size:"sm",children:"Chiudi"})})]})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Un,{className:"h-5 w-5"}),"Gestione Inventario"]}),r.jsx("div",{className:"flex gap-2",children:p.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(le,{onClick:()=>Ye(!0),className:"flex items-center gap-2",variant:"outline",children:"🗑️ Rimuovi Prodotti"}),r.jsx(le,{onClick:()=>He(!0),className:"flex items-center gap-2",variant:"destructive",children:"❌ Cancella Tutto l'Inventario"})]})})]})}),r.jsx(Xe,{children:Ln.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Un,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{className:"text-gray-600",children:p.length===0?"Inventario vuoto. Inizia aggiungendo prodotti con i pulsanti categoria sopra!":"Nessun prodotto trovato con i filtri attuali"})]}):r.jsx("div",{className:"space-y-3",children:Object.entries(Sr(Ln)).map(([B,je])=>r.jsxs("div",{children:[(ce||J)&&r.jsxs("h3",{className:"text-lg font-semibold mb-3 text-gray-800 bg-gray-100 px-3 py-2 rounded-md",children:[B," (",je.length," prodotti)"]}),r.jsx("div",{className:"space-y-3",children:je.map(Pe=>{const We=hr.find(Tt=>Tt.id===Pe.category),Ct=_t(Pe.expiryDate);return r.jsx("div",{className:"border rounded-lg p-4",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h3",{className:"font-medium",children:Pe.name||"Prodotto non disponibile"}),r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${We==null?void 0:We.color}`,children:We==null?void 0:We.name}),r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Ct.color}`,children:Ct.label})]}),r.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("p",{children:["🏢 Reparto: ",Pe.department||"Non assegnato"]}),r.jsxs("p",{children:["📍 Punto: ",Pe.conservationPoint||"Non assegnato"]}),r.jsxs("p",{children:["📅 Scadenza: ",new Date(Pe.expiryDate).toLocaleDateString("it-IT")]}),Pe.allergens&&Pe.allergens.length>0&&r.jsxs("p",{children:["⚠️ Allergeni: ",Pe.allergens.map(Tt=>{var Wt;return(Wt=ml.find(ln=>ln.id===Tt))==null?void 0:Wt.name}).join(", ")]}),Pe.notes&&r.jsxs("p",{children:["📝 ",Pe.notes]})]})]}),r.jsxs("div",{className:"flex gap-2 ml-4",children:[r.jsx(le,{onClick:()=>fs(Pe),size:"sm",variant:"outline",children:r.jsx(ci,{className:"h-4 w-4"})}),r.jsx(le,{onClick:()=>Vs(Pe.id),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:r.jsx(tr,{className:"h-4 w-4"})})]})]})},Pe.id)})})]},B))})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(Nt,{children:["Prodotti nell'inventario (",Ln.length,")",(ce||J)&&r.jsxs("span",{className:"text-sm font-normal text-gray-600 ml-2",children:["- Raggruppati per ",ce?"Reparto":"Punto di Conservazione"]})]}),r.jsx("div",{className:"flex gap-2",children:p.length>0&&r.jsxs(r.Fragment,{children:[r.jsx(le,{onClick:()=>Ye(!0),className:"flex items-center gap-2",variant:"outline",children:"🗑️ Rimuovi Prodotti"}),r.jsx(le,{onClick:()=>He(!0),className:"flex items-center gap-2",variant:"destructive",children:"❌ Cancella Tutto l'Inventario"})]})})]})}),r.jsx(Xe,{children:Ln.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Un,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{className:"text-gray-600",children:p.length===0?"Inventario vuoto. Inizia aggiungendo prodotti con i pulsanti categoria sopra!":"Nessun prodotto trovato con i filtri attuali"})]}):r.jsx("div",{className:"space-y-3",children:Object.entries(Sr(Ln)).map(([B,je])=>r.jsxs("div",{children:[(ce||J)&&r.jsxs("h3",{className:"text-lg font-semibold mb-3 text-gray-800 bg-gray-100 px-3 py-2 rounded-md",children:[B," (",je.length," prodotti)"]}),r.jsx("div",{className:"space-y-3",children:je.map(Pe=>{const We=hr.find(Tt=>Tt.id===Pe.category),Ct=_t(Pe.expiryDate);return r.jsx("div",{className:"border rounded-lg p-4",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h3",{className:"font-medium",children:Pe.name||"Prodotto non disponibile"}),r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${We==null?void 0:We.color}`,children:We==null?void 0:We.name}),r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Ct.color}`,children:Ct.label})]}),r.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("p",{children:["🏢 Reparto: ",Pe.department||"Non assegnato"]}),r.jsxs("p",{children:["📍 Punto: ",Pe.conservationPoint||"Non assegnato"]}),r.jsxs("p",{children:["📅 Scadenza: ",new Date(Pe.expiryDate).toLocaleDateString("it-IT")]}),Pe.allergens&&Pe.allergens.length>0&&r.jsxs("p",{children:["⚠️ Allergeni: ",Pe.allergens.map(Tt=>{var Wt;return(Wt=ml.find(ln=>ln.id===Tt))==null?void 0:Wt.name}).join(", ")]}),Pe.notes&&r.jsxs("p",{children:["📝 ",Pe.notes]})]})]}),r.jsxs("div",{className:"flex gap-2 ml-4",children:[r.jsx(le,{onClick:()=>fs(Pe),size:"sm",variant:"outline",children:r.jsx(ci,{className:"h-4 w-4"})}),r.jsx(le,{onClick:()=>Vs(Pe.id),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:r.jsx(tr,{className:"h-4 w-4"})})]})]})},Pe.id)})})]},B))})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(os,{className:"h-5 w-5"}),"Gestione Reparti e Punti di Conservazione"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-semibold mb-3",children:["Reparti Attivi (",Ee.length,")"]}),r.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:Ee.map(B=>{const je=p.filter(Pe=>Pe.department===B.name).length;return r.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:B.name}),r.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",je," prodotti)"]})]}),r.jsx(le,{onClick:()=>an(B.name),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:r.jsx(tr,{className:"h-4 w-4"})})]},B.id)})})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"font-semibold mb-3",children:["Punti di Conservazione (",qe.length,")"]}),r.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:qe.map(B=>{const je=p.filter(Pe=>Pe.conservationPoint===B.name).length;return r.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:B.name}),r.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",je," prodotti)"]}),r.jsxs("div",{className:"text-xs text-gray-500",children:[B.location," • ",B.targetTemp,"°C"]})]}),r.jsx(le,{onClick:()=>ht(B.name),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:r.jsx(tr,{className:"h-4 w-4"})})]},B.id)})})]})]})})]}),!m&&r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Un,{className:"h-5 w-5"}),"Aggiunta prodotti rapidi"]})}),r.jsxs(Xe,{children:[r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:hr.map(B=>{const je=Mx.filter(Pe=>Pe.category===B.id);return r.jsx("div",{className:"space-y-2",children:r.jsxs("button",{onClick:()=>Z(H===B.id?"":B.id),className:`w-full p-4 text-left rounded-lg border-2 transition-colors ${H===B.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[r.jsx("div",{className:`inline-flex px-2 py-1 text-xs rounded-full ${B.color} mb-2`,children:B.name}),r.jsx("div",{className:"text-sm font-medium",children:B.temp}),r.jsx("div",{className:"text-xs text-gray-600",children:B.storage}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[je.length," prodotti"]})]})},B.id)})}),H&&r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h4",{className:"font-medium mb-3",children:["Prodotti ",(ia=hr.find(B=>B.id===H))==null?void 0:ia.name,":"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Mx.filter(B=>B.category===H).map(B=>{var je;return r.jsx("button",{onClick:()=>Gs(B),className:"p-3 text-left bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors group",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium text-sm text-green-900",children:B.name||"Prodotto non disponibile"}),r.jsx("div",{className:"text-xs text-green-700 mt-1",children:I.length>0?Mn(B.category):"Nessun frigorifero registrato"}),r.jsx("div",{className:"text-xs text-green-600 mt-1",children:(je=hr.find(Pe=>Pe.id===B.category))==null?void 0:je.temp})]}),r.jsx(or,{className:"h-4 w-4 text-green-600 group-hover:text-green-700"})]})},B.id)})})]}),!H&&r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Un,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),r.jsx("p",{className:"text-sm",children:"Seleziona una categoria sopra per vedere i prodotti disponibili"})]})]})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Un,{className:"h-5 w-5"}),"Ordini e Spesa"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"🛒 Lista della Spesa"}),r.jsx(le,{onClick:()=>Le(!0),disabled:mt.length===0,size:"sm",variant:"outline",children:"📄 Genera PDF"})]}),r.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:Ln.length===0?r.jsxs("div",{className:"text-center py-4 text-gray-500",children:[r.jsx("p",{className:"text-sm",children:"Nessun prodotto disponibile per la lista della spesa"}),r.jsx("p",{className:"text-xs",children:"Aggiungi prodotti all'inventario per iniziare"})]}):Ln.map(B=>{const je=mt.includes(B.id);return r.jsxs("div",{className:"flex items-center p-2 border rounded hover:bg-gray-50",children:[r.jsx("input",{type:"checkbox",checked:je,onChange:()=>fi(B.id),className:"mr-3 w-4 h-4"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium text-sm",children:B.name||"Prodotto non disponibile"}),r.jsx("div",{className:"text-xs text-gray-500",children:B.department&&B.conservationPoint?`${B.department} • ${B.conservationPoint}`:B.department||B.conservationPoint||"Non assegnato"})]})]},B.id)})}),r.jsxs("div",{className:"text-sm text-gray-600",children:["Selezionati: ",mt.length," prodotti"]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"📦 Gestione Ordini"}),r.jsx(le,{onClick:()=>gt(!0),disabled:Ce.length===0,size:"sm",variant:"outline",children:"📋 Crea Ordine"})]}),r.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:Ln.length===0?r.jsxs("div",{className:"text-center py-4 text-gray-500",children:[r.jsx("p",{className:"text-sm",children:"Nessun prodotto disponibile per gli ordini"}),r.jsx("p",{className:"text-xs",children:"Aggiungi prodotti all'inventario per iniziare"})]}):Ln.map(B=>{const je=Ce.includes(B.id);return r.jsxs("div",{className:"flex items-center p-2 border rounded hover:bg-gray-50",children:[r.jsx("input",{type:"checkbox",checked:je,onChange:()=>vn(B.id),className:"mr-3 w-4 h-4"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium text-sm",children:B.name||"Prodotto non disponibile"}),r.jsx("div",{className:"text-xs text-gray-500",children:B.department&&B.conservationPoint?`${B.department} • ${B.conservationPoint}`:B.department||B.conservationPoint||"Non assegnato"})]})]},B.id)})}),r.jsxs("div",{className:"text-sm text-gray-600",children:["Prodotti selezionati: ",Ce.length]})]})]})})]}),ye&&r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Un,{className:"h-5 w-5 text-gray-600"}),"Ingredienti già Utilizzati (",et.length,")"]})}),r.jsx(Xe,{children:et.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Un,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),r.jsx("p",{className:"text-lg font-medium",children:"Nessun ingrediente utilizzato"}),r.jsx("p",{className:"text-sm",children:"I prodotti eliminati dall'inventario appariranno qui"})]}):r.jsx("div",{className:"space-y-3",children:et.map(B=>{var je;return r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border rounded-lg opacity-75",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium text-gray-900",children:B.name}),r.jsxs("div",{className:"text-sm text-gray-600",children:[(je=hr.find(Pe=>Pe.id===B.category))==null?void 0:je.name," •",B.location," • Utilizzato: ",new Date(B.usedDate).toLocaleDateString("it-IT")]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{onClick:()=>Sn(B),size:"sm",className:"bg-green-600 hover:bg-green-700",children:"✅ Reinserisci"}),r.jsx(le,{onClick:()=>{d("Sei sicuro di voler eliminare definitivamente questo ingrediente?",()=>{ut(Pe=>Pe.filter(We=>We.id!==B.id))})},size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:"🗑️ Elimina"})]})]},B.id)})})})]}),r.jsx(bS,{}),m&&r.jsxs(Je,{ref:y,id:"inventory-product-form",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(or,{className:"h-5 w-5"}),S?"Modifica Prodotto":"Aggiungi Prodotto"]})}),r.jsx(Xe,{children:r.jsxs("form",{onSubmit:Hn,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"name",children:"Nome Prodotto *"}),r.jsx(At,{id:"name",value:dt.name,onChange:B=>nr("name",B.target.value),placeholder:"Es. Pomodori San Marzano",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"category",children:"Categoria *"}),r.jsxs("select",{id:"category",value:dt.category,onChange:B=>nr("category",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"",children:"Seleziona categoria"}),hr.map(B=>r.jsx("option",{value:B.id,children:B.name},B.id))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"department",children:"Reparto *"}),r.jsxs("select",{id:"department",value:dt.department,onChange:B=>nr("department",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"",children:"Seleziona reparto"}),Ee.map(B=>r.jsx("option",{value:B.name,children:B.name},B.id))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"conservationPoint",children:"Punto di Conservazione *"}),r.jsxs("select",{id:"conservationPoint",value:dt.conservationPoint,onChange:B=>nr("conservationPoint",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[r.jsx("option",{value:"",children:"Seleziona punto di conservazione"}),qe.map(B=>r.jsx("option",{value:B.name,children:B.name},B.id))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"expiryDate",children:"Data di Scadenza *"}),r.jsx(At,{id:"expiryDate",type:"date",value:dt.expiryDate,onChange:B=>nr("expiryDate",B.target.value),required:!0})]})]}),r.jsxs("div",{children:[r.jsx(Ke,{children:"Allergeni"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-2",children:ml.map(B=>r.jsxs("label",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"checkbox",checked:dt.allergens.includes(B.id),onChange:()=>_r(B.id),className:"rounded"}),r.jsx("span",{className:"text-sm",children:B.name})]},B.id))})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"notes",children:"Note"}),r.jsx("textarea",{id:"notes",value:dt.notes,onChange:B=>nr("notes",B.target.value),placeholder:"Note aggiuntive sul prodotto...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(le,{type:"button",onClick:xr,variant:"outline",children:"Annulla"}),r.jsxs(le,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[S?"Aggiorna":"Aggiungi"," Prodotto"]})]})]})})]}),$e&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Rimuovi Prodotti dall'Inventario"}),r.jsxs("div",{className:"space-y-4 mb-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx("input",{type:"text",value:xt,onChange:B=>vt(B.target.value),placeholder:"Cerca prodotti, reparti, punti...",className:"px-3 py-2 border rounded-md"}),r.jsxs("select",{value:jt,onChange:B=>Ot(B.target.value),className:"px-3 py-2 border rounded-md",children:[r.jsx("option",{value:"",children:"Tutte le categorie"}),hr.map(B=>r.jsx("option",{value:B.id,children:B.name},B.id))]}),r.jsxs("select",{value:en,onChange:B=>It(B.target.value),className:"px-3 py-2 border rounded-md",children:[r.jsx("option",{value:"",children:"Tutte le scadenze"}),r.jsx("option",{value:"expired",children:"Scaduti"}),r.jsx("option",{value:"critical",children:"Critici (≤3 giorni)"}),r.jsx("option",{value:"warning",children:"In scadenza (≤7 giorni)"}),r.jsx("option",{value:"ok",children:"OK (>7 giorni)"})]}),r.jsxs("select",{value:wt,onChange:B=>Ze(B.target.value),className:"px-3 py-2 border rounded-md",children:[r.jsx("option",{value:"",children:"Tutti gli allergeni"}),ml.map(B=>r.jsx("option",{value:B.id,children:B.name},B.id))]})]}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Seleziona i prodotti da rimuovere dall'inventario:"}),r.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:Ln.filter(B=>{var Tt,Wt,ln;const je=!xt||B.name.toLowerCase().includes(xt.toLowerCase())||((Tt=B.department)==null?void 0:Tt.toLowerCase().includes(xt.toLowerCase()))||((Wt=B.conservationPoint)==null?void 0:Wt.toLowerCase().includes(xt.toLowerCase()))||((ln=hr.find(Rr=>Rr.id===B.category))==null?void 0:ln.name.toLowerCase().includes(xt.toLowerCase())),Pe=!jt||B.category===jt;let We=!0;en&&(We=_t(B.expiryDate).status===en);const Ct=!wt||B.allergens&&B.allergens.includes(wt);return je&&Pe&&We&&Ct}).map(B=>{const je=hr.find(We=>We.id===B.category),Pe=_t(B.expiryDate);return r.jsxs("div",{className:"flex items-center p-2 border rounded hover:bg-gray-50",children:[r.jsx("input",{type:"checkbox",checked:it.includes(B.id),onChange:()=>mi(B.id),className:"mr-3 w-4 h-4"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium",children:B.name||"Prodotto non disponibile"}),r.jsxs("div",{className:"text-sm text-gray-500",children:[je==null?void 0:je.name," • ",B.department||"N/A"," • ",B.conservationPoint||"N/A"," • Scade: ",new Date(B.expiryDate).toLocaleDateString("it-IT")]})]}),r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Pe.color}`,children:Pe.label})]},B.id)})})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{className:"text-sm text-gray-600",children:["Selezionati: ",it.length," prodotti"]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{onClick:()=>Ye(!1),variant:"outline",children:"Annulla"}),r.jsxs(le,{onClick:pi,disabled:it.length===0,className:"bg-red-600 hover:bg-red-700",children:["Rimuovi ",it.length," Prodotti"]})]})]})]})}),me&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[r.jsx("h2",{className:"text-xl font-bold mb-4",children:"🛒 Lista della Spesa"}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Prodotti selezionati per la lista della spesa (",mt.length,"):"]}),r.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:mt.length===0?r.jsxs("div",{className:"text-center py-4 text-gray-500",children:[r.jsx("p",{className:"text-sm",children:"Nessun prodotto selezionato"}),r.jsx("p",{className:"text-xs",children:"Torna alla sezione inventario per selezionare i prodotti"})]}):p.filter(B=>mt.includes(B.id)).map(B=>{const je=hr.find(Pe=>Pe.id===B.category);return r.jsx("div",{className:"flex items-center p-3 border rounded bg-gray-50",children:r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"font-medium",children:B.name||"Prodotto non disponibile"}),r.jsxs("div",{className:"text-sm text-gray-600",children:[je==null?void 0:je.name," • ",B.department||"N/A"," • ",B.conservationPoint||"N/A"]})]})},B.id)})})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(le,{onClick:Qr,className:"flex-1",children:"📄 Genera PDF"}),r.jsx(le,{onClick:()=>{Le(!1),bt([])},variant:"outline",children:"Annulla"})]})]})}),Ne&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[r.jsx("h2",{className:"text-xl font-bold mb-4",children:"📋 Crea Nuovo Ordine"}),r.jsxs("form",{onSubmit:gr,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{children:"Numero Ordine *"}),r.jsx(At,{value:Dt.orderId,onChange:B=>Mt({...Dt,orderId:B.target.value}),placeholder:"es. ORD-2024-001",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ke,{children:"Fornitore *"}),r.jsx(At,{value:Dt.supplierName,onChange:B=>Mt({...Dt,supplierName:B.target.value}),placeholder:"Nome fornitore",required:!0})]}),r.jsxs("div",{children:[r.jsx(Ke,{children:"Data Ordine *"}),r.jsx(At,{type:"date",value:Dt.orderDate,onChange:B=>Mt({...Dt,orderDate:B.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(Ke,{children:"Note"}),r.jsx(At,{value:Dt.notes,onChange:B=>Mt({...Dt,notes:B.target.value}),placeholder:"Note aggiuntive..."})]})]}),r.jsxs("div",{className:"border-t pt-4",children:[r.jsxs("h3",{className:"font-medium mb-3",children:["Prodotti selezionati (",Ce.length,"):"]}),r.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:p.filter(B=>Ce.includes(B.id)).map(B=>{const je=hr.find(Pe=>Pe.id===B.category);return r.jsxs("div",{className:"p-2 border rounded",children:[r.jsx("div",{className:"font-medium text-sm",children:B.name}),r.jsxs("div",{className:"text-xs text-gray-600",children:[je==null?void 0:je.name," • ",B.department||"N/A"," • ",B.conservationPoint||"N/A"]})]},B.id)})}),r.jsxs("div",{className:"flex gap-3 pt-4",children:[r.jsx(le,{type:"submit",className:"flex-1",children:"📦 Crea Ordine"}),r.jsx(le,{type:"button",onClick:()=>gt(!1),variant:"outline",children:"Annulla"})]})]})]})]})}),Ge&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-red-600",children:"⚠️ Conferma Cancellazione"}),r.jsx("p",{className:"text-gray-700 mb-6",children:"Sei sicuro di voler cancellare TUTTO l'inventario? Questa azione non può essere annullata."}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(le,{onClick:()=>He(!1),variant:"outline",children:"Annulla"}),r.jsx(le,{onClick:sa,className:"bg-red-600 hover:bg-red-700",children:"Sì, Cancella Tutto"})]})]})}),r.jsx(sc,{isOpen:t.isOpen,onClose:s,title:t.title,message:t.message,type:t.type,confirmText:t.confirmText,onConfirm:t.onConfirm}),r.jsx(ic,{isOpen:e.isOpen,onClose:i,title:e.title,message:e.message,type:e.type,confirmText:e.confirmText,cancelText:e.cancelText,onConfirm:e.onConfirm,onCancel:e.onCancel}),r.jsx(ac,{isOpen:n.isOpen,onClose:a,title:n.title,message:n.message,placeholder:n.placeholder,defaultValue:n.defaultValue,type:n.type,confirmText:n.confirmText,cancelText:n.cancelText,validation:n.validation,onConfirm:n.onConfirm,onCancel:n.onCancel})]})};function y3({currentUser:t,currentSection:e,products:n=[],temperatures:s=[],cleaning:i=[],staff:a=[],onAction:o}){const[l,c]=W.useState([]),[d,f]=W.useState(""),[p,v]=W.useState(!1);W.useState([]);const[m,N]=W.useState(!1),[S,k]=W.useState(!1),[y,b]=W.useState(null),[j,z]=W.useState(!0),[H,Z]=W.useState(!1),[K,P]=W.useState(!1),$=W.useRef(null),re=W.useRef(!0),A=W.useRef(!0);Se("🚀 AIAssistant: Component rendering, isMinimized:",j,"isMounted:",H,"isVisible:",K),W.useEffect(()=>{Se("🎯 AIAssistant: useEffect triggered - setting up component"),z(!0),re.current=!0,A.current=!0,P(!1),Se("⏰ AIAssistant: Starting mount timer (500ms)"),setTimeout(()=>{Se("✅ AIAssistant: Mount timer complete - making visible"),Z(!0),z(!0),re.current=!0,P(!0)},500),Se("🚫 AIAssistant: Starting grace period (2000ms)"),setTimeout(()=>{A.current=!1,Se("🎉 AIAssistant: Grace period ended, chat can now be opened by user")},2e3)},[]),W.useEffect(()=>{Se("📊 AIAssistant: State changed - isMinimized:",j,"isMounted:",H,"isVisible:",K,"forceMinimized:",re.current,"gracePeriod:",A.current)},[j,H,K]);const C=I=>{if(Se("AIAssistant: handleSetMinimized called with:",I,"gracePeriod:",A.current,"forceMinimized:",re.current),I===!1&&A.current){Se("AIAssistant: BLOCKED - Still in grace period, no opening allowed");return}if(I===!1&&re.current){Se("AIAssistant: Preventing auto-open, first user click required");return}re.current=!1,z(I)},R=()=>{var I;(I=$.current)==null||I.scrollIntoView({behavior:"smooth"})};W.useEffect(()=>{R()},[l]),W.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const I=window.SpeechRecognition||window.webkitSpeechRecognition,q=new I;q.continuous=!1,q.interimResults=!1,q.lang="it-IT",q.onstart=()=>{k(!0),V("assistant","🎤 Ti sto ascoltando... Parla ora!","system")},q.onresult=oe=>{const fe=oe.results[0][0].transcript;f(fe),V("assistant",`🎤 Ho sentito: "${fe}"`,"system")},q.onerror=oe=>{is("Speech recognition error:",oe.error),k(!1),V("assistant","❌ Errore nel riconoscimento vocale. Riprova!","system")},q.onend=()=>{k(!1)},b(q)}},[]),W.useEffect(()=>{},[]);const V=(I,q,oe="text",fe=null)=>{const ge={id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sender:I,content:q,type:oe,data:fe,timestamp:new Date().toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"})};c(Te=>[...Te,ge])},ie=async()=>{if(!d.trim())return;const I=d.trim();f(""),V("user",I),v(!0),setTimeout(()=>{const q=Q(I,e);V("assistant",q.content,q.type,q.data),v(!1)},1e3)},Q=(I,q)=>{const oe=I.toLowerCase();switch(q){case"inventory":return te(oe);case"cleaning":return L(oe);case"temperature":return Y();case"staff":return G();case"dashboard":return ce();default:return _(oe)}},te=I=>{if(I.includes("aggiungere")||I.includes("nuovo prodotto"))return{content:`Per aggiungere un nuovo prodotto:

1. **Vai alla sezione "Inventario"**
2. **Clicca "Aggiungi Prodotto"**
3. **Compila i campi richiesti:**
   - Nome prodotto
   - Categoria
   - Posizione
   - Data scadenza
   - Allergeni (se presenti)

**Suggerimento**: Puoi anche usare le categorie predefinite per aggiunta rapida!`,type:"text"};if(I.includes("scadenza")||I.includes("scaduti")){const q=n.filter(oe=>{const fe=Math.ceil((new Date(oe.expiryDate)-new Date)/864e5);return fe<=7&&fe>0});return q.length>0?{content:`⚠️ **Prodotti in scadenza** (${q.length} prodotti):

${q.map(oe=>`• ${oe.name} - Scade il ${oe.expiryDate}`).join(`
`)}

**Suggerimento**: Vuoi che generi delle ricette per utilizzare questi ingredienti?`,type:"alert",data:{products:q}}:{content:"✅ Nessun prodotto in scadenza nei prossimi 7 giorni!",type:"text"}}return{content:`Per l'inventario posso aiutarti con:
• Aggiungere prodotti
• Controllare scadenze
• Gestire categorie
• Suggerimenti ricette

Cosa ti serve?`,type:"text"}},L=I=>{if(I.includes("attività")||I.includes("mansioni")){const q=i.filter(oe=>!oe.completed);return{content:`📋 **Attività da svolgere** (${q.length} totali):

${q.slice(0,5).map(oe=>`• ${oe.task} - Assegnato a: ${oe.assignee}`).join(`
`)}
${q.length>5?`
... e altre ${q.length-5} attività`:""}

**Suggerimento**: Usa le schede per filtrare per frequenza (Giornaliere/Settimanali/Mensili/Annuali)`,type:"text"}}return I.includes("temperatura")||I.includes("frigo")?{content:`🌡️ **Ultime temperature registrate**:

${s.slice(-3).map(oe=>`• ${oe.location}: ${oe.temperature}°C (${oe.status})`).join(`
`)}

**Suggerimento**: Registra temperature regolarmente per monitorare la sicurezza alimentare!`,type:"text"}:{content:`Per la sezione pulizia posso aiutarti con:
• Gestione attività
• Controlli temperatura
• Frequenze mansioni
• Report completamento

Cosa ti serve?`,type:"text"}},Y=I=>({content:`Per i controlli temperatura posso aiutarti con:
• Registrare nuove temperature
• Monitorare trend
• Alert automatici
• Report periodici

Cosa ti serve?`,type:"text"}),G=I=>({content:`Per la gestione del personale posso aiutarti con:
• Aggiungere dipendenti
• Gestire ruoli
• Assegnare mansioni
• Report attività

Cosa ti serve?`,type:"text"}),ce=I=>({content:`Per la dashboard posso aiutarti con:
• Panoramica generale
• Statistiche rapide
• Alert importanti
• Navigazione sezioni

Cosa ti serve?`,type:"text"}),_=I=>I.includes("aiuto")||I.includes("help")?{content:`🤖 **Come posso aiutarti:**

**📦 Inventario:**
• Aggiungere prodotti
• Controllare scadenze
• Suggerimenti ricette

**🧹 Pulizia:**
• Gestire attività
• Controlli temperatura
• Frequenze mansioni

**👥 Personale:**
• Gestire dipendenti
• Assegnare ruoli

**📊 Dashboard:**
• Panoramica generale
• Statistiche

**⚙️ Automatizzazioni:**
• Alert scadenze
• Ordini settimanali
• Suggerimenti ricette

Dimmi in quale sezione ti trovi o cosa ti serve!`,type:"text"}:{content:"Non sono sicuro di aver capito. Puoi essere più specifico? Oppure dimmi in quale sezione ti trovi per ricevere aiuto mirato!",type:"text"},J=I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),ie())},M=()=>{if(!y){V("assistant","❌ Riconoscimento vocale non supportato dal tuo browser. Usa Chrome o Edge!","system");return}S?y.stop():y.start()};return r.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:!H||!K?null:j?r.jsx(le,{onClick:()=>C(!1),className:"w-12 h-12 rounded-full bg-blue-600 hover:bg-blue-700 shadow-lg",children:r.jsx(Qi,{className:"h-6 w-6 text-white"})}):r.jsxs(Je,{className:"w-80 h-96 flex flex-col",children:[r.jsx(yt,{className:"pb-3",children:r.jsxs(Nt,{className:"flex items-center justify-between text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Qi,{className:"h-4 w-4 text-blue-600"}),"Assistente IA",S&&r.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[r.jsx(qh,{className:"h-3 w-3 animate-pulse"}),r.jsx("span",{className:"text-xs",children:"Ascoltando..."})]})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(le,{variant:"ghost",size:"sm",onClick:()=>C(!0),className:"h-6 w-6 p-0",children:r.jsx(LN,{className:"h-3 w-3"})}),r.jsx(le,{variant:"ghost",size:"sm",onClick:()=>N(!m),className:"h-6 w-6 p-0",children:r.jsx(os,{className:"h-3 w-3"})})]})]})}),r.jsxs(Xe,{className:"flex-1 flex flex-col p-0",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[l.map(I=>r.jsx("div",{className:`flex ${I.sender==="user"?"justify-end":"justify-start"}`,children:r.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${I.sender==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:r.jsxs("div",{className:"flex items-start gap-2",children:[I.sender==="assistant"&&r.jsx(Qi,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-sm whitespace-pre-wrap",children:I.content}),r.jsx("div",{className:`text-xs mt-1 ${I.sender==="user"?"text-blue-100":"text-gray-500"}`,children:I.timestamp})]})]})})},I.id)),p&&r.jsx("div",{className:"flex justify-start",children:r.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Qi,{className:"h-4 w-4 text-blue-600"}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),r.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),r.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),r.jsx("div",{ref:$})]}),r.jsx("div",{className:"p-4 border-t bg-white",children:r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsx(At,{value:d,onChange:I=>f(I.target.value),onKeyPress:J,placeholder:"Scrivi un messaggio...",className:"flex-1 min-h-[40px]"}),r.jsx(le,{onClick:M,disabled:p,size:"sm",className:`px-3 h-10 ${S?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`,children:S?r.jsx(ny,{className:"h-4 w-4"}):r.jsx(qh,{className:"h-4 w-4"})}),r.jsx(le,{onClick:ie,disabled:!d.trim()||p,size:"sm",className:"px-3 h-10",children:r.jsx(sy,{className:"h-4 w-4"})})]})})]})]})})}function b3({products:t=[],onRecipeSuggestion:e}){const[n,s]=W.useState([]),[i,a]=W.useState(!1),[o,l]=W.useState([]),[c,d]=W.useState(!1);W.useEffect(()=>{(()=>{const N=new Date,S=t.filter(k=>{if(!k.expiryDate)return!1;const y=new Date(k.expiryDate),b=Math.ceil((y-N)/(1e3*60*60*24));return b<=7&&b>0});s(S),S.length>0&&d(!1)})()},[t]);const f=()=>{const m=[];n.forEach(N=>{const S=v(N);S&&m.push(S)}),l(m),a(!0)},p=()=>{d(!0)},v=m=>({"Mozzarella di Bufala":{name:"Insalata Caprese",ingredients:["Mozzarella di Bufala","Pomodoro","Basilico","Olio EVO"],instructions:"Taglia mozzarella e pomodoro a fette, alterna su piatto, guarnisci con basilico e olio.",difficulty:"Facile",time:"10 minuti"},"Parmigiano Reggiano":{name:"Risotto al Parmigiano",ingredients:["Riso Carnaroli","Parmigiano Reggiano","Burro","Brodo"],instructions:"Prepara risotto classico, manteca con parmigiano e burro.",difficulty:"Media",time:"25 minuti"},"Prosciutto Crudo":{name:"Antipasto Prosciutto e Melone",ingredients:["Prosciutto Crudo","Melone","Rucola"],instructions:"Avvolgi fette di prosciutto su cubetti di melone, guarnisci con rucola.",difficulty:"Facile",time:"5 minuti"},Salmone:{name:"Salmone al Forno con Erbe",ingredients:["Salmone","Limone","Erbe aromatiche","Olio EVO"],instructions:"Condisci salmone con erbe, limone e olio, cuoci in forno a 180°C per 15 min.",difficulty:"Facile",time:"20 minuti"},"Basilico Fresco":{name:"Pesto alla Genovese",ingredients:["Basilico Fresco","Parmigiano","Pine Nuts","Olio EVO","Aglio"],instructions:"Frulla tutti gli ingredienti fino a ottenere una crema omogenea.",difficulty:"Facile",time:"10 minuti"}})[m.name]||{name:`Ricetta con ${m.name}`,ingredients:[m.name,"Altri ingredienti disponibili"],instructions:"Crea una ricetta utilizzando questo ingrediente prima che scada.",difficulty:"Media",time:"15 minuti"};return n.length===0||c?null:r.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-md",children:r.jsxs(Je,{className:"border-orange-200 bg-orange-50",children:[r.jsx(yt,{className:"pb-3",children:r.jsxs(Nt,{className:"flex items-center gap-2 text-orange-800",children:[r.jsx(xn,{className:"h-5 w-5"}),"Prodotti in Scadenza"]})}),r.jsxs(Xe,{className:"space-y-3",children:[r.jsxs("div",{className:"text-sm text-orange-700",children:[r.jsxs("p",{className:"font-medium mb-2",children:[n.length," prodotto",n.length>1?"i":""," in scadenza:"]}),r.jsx("ul",{className:"space-y-1",children:n.map(m=>r.jsxs("li",{className:"flex items-center gap-2",children:[r.jsx(Eu,{className:"h-3 w-3"}),r.jsx("span",{children:m.name}),r.jsxs("span",{className:"text-xs",children:["(scade il ",new Date(m.expiryDate).toLocaleDateString("it-IT"),")"]})]},m.id))})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{onClick:f,className:"bg-orange-600 hover:bg-orange-700 text-white",size:"sm",children:[r.jsx(vN,{className:"h-4 w-4 mr-1"}),"Suggerisci Ricette"]}),r.jsxs(le,{variant:"outline",size:"sm",className:"text-orange-600 border-orange-300",onClick:p,children:[r.jsx(tr,{className:"h-4 w-4 mr-1"}),"Rimuovi Alert"]})]}),i&&o.length>0&&r.jsxs("div",{className:"mt-4 p-3 bg-white rounded-lg border",children:[r.jsx("h4",{className:"font-medium mb-2",children:"Ricette Suggerite:"}),r.jsx("div",{className:"space-y-2",children:o.map((m,N)=>r.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[r.jsx("h5",{className:"font-medium text-sm",children:m.name}),r.jsxs("p",{className:"text-xs text-gray-600",children:["Tempo: ",m.time," • Difficoltà: ",m.difficulty]}),r.jsx("p",{className:"text-xs text-gray-700 mt-1",children:m.instructions})]},N))})]})]})]})})}function w3({temperatures:t,cleaning:e,products:n,refrigerators:s,setTemperatures:i,setCleaning:a,setProducts:o,setRefrigerators:l}){const[c,d]=W.useState(!1),[f,p]=W.useState({temperatures:0,cleaning:0,products:0,refrigerators:0,totalSize:0}),{alertModal:v,confirmModal:m,promptModal:N,closeAlert:S,closeConfirm:k,closePrompt:y,alertSuccess:b,alertError:j,alertWarning:z,confirmDelete:H,confirmAction:Z}=rc();W.useEffect(()=>{(()=>{const C=t||[],R=e||[],V=n||[],ie=s||[],Q=JSON.stringify(C).length,te=JSON.stringify(R).length,L=JSON.stringify(V).length,Y=JSON.stringify(ie).length;p({temperatures:C.length,cleaning:R.length,products:V.length,refrigerators:ie.length,totalSize:Q+te+L+Y})})()},[t,e,n,s]);const K=()=>{if(!c)return;const A=new Date;A.setDate(A.getDate()-30);const C=t||[],R=e||[],V=C.filter(_=>new Date(_.timestamp)<A),ie=C.filter(_=>new Date(_.timestamp)>=A),Q=R.filter(_=>_.completed&&new Date(_.createdAt)<A),te=R.filter(_=>!_.completed||new Date(_.createdAt)>=A);let L=[];const Y={temperatures:V,cleaning:Q,expiredLabels:L,archivedAt:new Date().toISOString()},G=JSON.parse(localStorage.getItem("haccp-archives")||"[]");G.push(Y),localStorage.setItem("haccp-archives",JSON.stringify(G)),i(ie),a(te),V.length+Q.length+L.length>0?b(`🗂️ Archiviazione completata!

📊 Elementi archiviati:
• ${V.length} registrazioni temperature
• ${Q.length} attività completate
• ${L.length} etichette prodotti scaduti

💾 Controllo scadenze temporaneamente disabilitato`):b(`✅ Archiviazione completata!

📊 Elementi archiviati:
• ${V.length} registrazioni temperature
• ${Q.length} attività completate
• Controllo etichette scadute: disabilitato`)};W.useEffect(()=>{if(!c)return;const A=setInterval(()=>{K()},24*60*60*1e3);return()=>clearInterval(A)},[c]);const P=A=>Math.min(A/5242880*100,100),$=A=>A<50?"text-green-600":A<80?"text-yellow-600":"text-red-600",re=A=>{if(A===0)return"0 Bytes";const C=1024,R=["Bytes","KB","MB","GB"],V=Math.floor(Math.log(A)/Math.log(C));return parseFloat((A/Math.pow(C,V)).toFixed(2))+" "+R[V]};return r.jsxs("div",{className:"space-y-6",children:[r.jsx(zs,{title:"Gestione Storage",subtitle:"Monitoraggio spazio e archiviazione dati",icon:Xc,iconColor:"text-gray-600",iconBgColor:"bg-gray-100",count:f.temperatures+f.cleaning+f.products+f.refrigerators,testId:"storage-manager",defaultExpanded:!0,children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-4",children:"Utilizzo Storage"}),r.jsxs("div",{className:"relative w-48 h-48 mx-auto",children:[r.jsxs("svg",{className:"w-48 h-48 transform -rotate-90",viewBox:"0 0 100 100",children:[r.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#3B82F6",strokeWidth:"8",strokeDasharray:`${f.temperatures/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2} 251.2`,strokeDashoffset:"0"}),r.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#10B981",strokeWidth:"8",strokeDasharray:`${f.cleaning/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2} 251.2`,strokeDashoffset:`-${f.temperatures/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2}`}),r.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#F59E0B",strokeWidth:"8",strokeDasharray:`${f.products/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2} 251.2`,strokeDashoffset:`-${(f.temperatures+f.cleaning)/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2}`}),r.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#8B5CF6",strokeWidth:"8",strokeDasharray:`${f.refrigerators/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2} 251.2`,strokeDashoffset:`-${(f.temperatures+f.cleaning+f.products)/(f.temperatures+f.cleaning+f.products+f.refrigerators)*251.2}`})]}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:`text-2xl font-bold ${$(P(f.totalSize))}`,children:re(f.totalSize)}),r.jsx("div",{className:"text-sm text-gray-600",children:"Utilizzato"})]})})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-4",children:"Dettaglio Dati"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),r.jsx("span",{className:"text-sm font-medium",children:"Temperature"})]}),r.jsxs("span",{className:"text-sm text-gray-600",children:[f.temperatures," record"]})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),r.jsx("span",{className:"text-sm font-medium",children:"Attività"})]}),r.jsxs("span",{className:"text-sm text-gray-600",children:[f.cleaning," record"]})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),r.jsx("span",{className:"text-sm font-medium",children:"Prodotti"})]}),r.jsxs("span",{className:"text-sm text-gray-600",children:[f.products," record"]})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),r.jsx("span",{className:"text-sm font-medium",children:"Frigoriferi"})]}),r.jsxs("span",{className:"text-sm text-gray-600",children:[f.refrigerators," record"]})]})]})]})]}),r.jsxs("div",{className:"border-t pt-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[r.jsx(G1,{className:"h-4 w-4"}),"Archiviazione Automatica"]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Rimuove automaticamente i dati vecchi per mantenere l'app veloce"})]}),r.jsx(le,{variant:c?"default":"outline",onClick:()=>d(!c),className:"flex items-center gap-2",children:c?r.jsxs(r.Fragment,{children:[r.jsx(Cn,{className:"h-4 w-4"}),"Abilitata"]}):r.jsxs(r.Fragment,{children:[r.jsx(os,{className:"h-4 w-4"}),"Disabilitata"]})})]}),c&&r.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Cosa fa l'archiviazione automatica:"}),r.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[r.jsx("li",{children:"• Rimuove le registrazioni temperature più vecchie di 30 giorni"}),r.jsx("li",{children:"• Archivia le attività completate più vecchie di 30 giorni"}),r.jsx("li",{children:"• Chiede conferma per rimuovere etichette di prodotti scaduti OGGI"}),r.jsx("li",{children:"• Mantiene tutti i prodotti e frigoriferi attivi"}),r.jsx("li",{children:"• Crea un backup completo dei dati rimossi"}),r.jsx("li",{children:"• Libera spazio solo con conferma utente per le foto"}),r.jsx("li",{children:"• Si esegue automaticamente ogni 24 ore"})]}),r.jsx("div",{className:"mt-3",children:r.jsxs(le,{onClick:K,className:"flex items-center gap-2",size:"sm",children:[r.jsx(G1,{className:"h-4 w-4"}),"Archivia Ora"]})})]})]}),r.jsxs("div",{className:"border-t pt-6",children:[r.jsx("h3",{className:"font-semibold mb-4",children:"Azioni Manuali"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs(le,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{const A={temperatures:t,cleaning:e,products:n,refrigerators:s,exportedAt:new Date().toISOString()},C=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),R=URL.createObjectURL(C),V=document.createElement("a");V.href=R,V.download=`haccp-backup-${new Date().toISOString().split("T")[0]}.json`,V.click()},children:[r.jsx(Bs,{className:"h-4 w-4"}),"Esporta Tutti i Dati"]}),r.jsxs(le,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{H("Sei sicuro di voler eliminare tutti i dati? Questa azione non può essere annullata.",()=>{i([]),a([]),o([]),l([]),b("Tutti i dati sono stati eliminati.")})},children:[r.jsx(tr,{className:"h-4 w-4"}),"Elimina Tutti i Dati"]})]})]})]})}),r.jsx(sc,{isOpen:v.isOpen,onClose:S,title:v.title,message:v.message,type:v.type,confirmText:v.confirmText,onConfirm:v.onConfirm}),r.jsx(ic,{isOpen:m.isOpen,onClose:k,title:m.title,message:m.message,type:m.type,confirmText:m.confirmText,cancelText:m.cancelText,onConfirm:m.onConfirm,onCancel:m.onCancel}),r.jsx(ac,{isOpen:N.isOpen,onClose:y,title:N.title,message:N.message,placeholder:N.placeholder,defaultValue:N.defaultValue,type:N.type,confirmText:N.confirmText,cancelText:N.cancelText,validation:N.validation,onConfirm:N.onConfirm,onCancel:N.onCancel})]})}function N3(){const[t,e]=W.useState(null),[n,s]=W.useState(!1),[i,a]=W.useState(!1);W.useEffect(()=>{const c=()=>window.matchMedia("(display-mode: standalone)").matches?(a(!0),!0):!1,d=localStorage.getItem("pwa-install-rejected");return!c()&&!d&&(window.addEventListener("beforeinstallprompt",f=>{f.preventDefault(),e(f),s(!0)}),window.addEventListener("appinstalled",()=>{a(!0),s(!1),e(null)})),()=>{window.removeEventListener("beforeinstallprompt",()=>{}),window.removeEventListener("appinstalled",()=>{})}},[]);const o=async()=>{if(!t)return;t.prompt();const{outcome:c}=await t.userChoice;c==="accepted"?(Se("PWA installata con successo!"),a(!0)):(Se("Installazione PWA rifiutata"),localStorage.setItem("pwa-install-rejected","true")),e(null),s(!1)},l=()=>{s(!1),localStorage.setItem("pwa-install-rejected","true")};return i||!n?null:r.jsx("div",{className:"fixed bottom-4 left-4 right-4 bg-white border border-gray-200 rounded-lg shadow-lg p-4 z-50",children:r.jsx("div",{className:"flex items-start justify-between",children:r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Bs,{className:"h-5 w-5 text-blue-600"}),r.jsx("h3",{className:"font-semibold text-gray-900",children:"Installa l'App"})]}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Installa Mini-ePackPro sul tuo dispositivo per un accesso più veloce e funzionalità offline."}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{onClick:o,size:"sm",className:"flex items-center gap-2",children:[r.jsx(Bs,{className:"h-4 w-4"}),"Installa"]}),r.jsxs(le,{onClick:l,variant:"outline",size:"sm",children:[r.jsx(dn,{className:"h-4 w-4"}),"Non ora"]})]})]})})})}class j3{constructor(e){this.companyId=e,this.storagePrefix=`cloud-sim-${e}`,console.log("☁️ CloudSimulator attivo per:",e)}async saveToCloud(e,n,s){return new Promise((i,a)=>{try{setTimeout(()=>{const o=`${this.storagePrefix}-${e}`,l={data:n,lastModified:new Date().toISOString(),modifiedBy:s,companyId:this.companyId,version:Date.now()};localStorage.setItem(o,JSON.stringify(l)),console.log(`📤 [SIMULATO] Salvato in cloud: ${e}`),i({success:!0,message:`✅ ${e} condiviso con tutti!`,timestamp:l.lastModified})},800+Math.random()*400)}catch{a({success:!1,message:`❌ Errore simulato nel salvare ${e}`})}})}async loadFromCloud(e){return new Promise((n,s)=>{try{setTimeout(()=>{const i=`${this.storagePrefix}-${e}`,a=localStorage.getItem(i);if(a){const o=JSON.parse(a);console.log(`📥 [SIMULATO] Scaricato dal cloud: ${e}`),n({success:!0,data:o.data,lastModified:o.lastModified,message:`✅ Ricevuti aggiornamenti di ${e}!`})}else n({success:!0,data:null,message:`ℹ️ Nessun dato di ${e} nel cloud`})},600+Math.random()*300)}catch{s({success:!1,message:`❌ Errore nel scaricare ${e}`})}})}isOnline(){return navigator.onLine}async getCompanyInfo(){return new Promise(e=>{setTimeout(()=>{e({id:this.companyId,name:"Demo Pizzeria Da Mario",plan:"free",users:5,maxUsers:25,storageUsed:"45 MB",storageMax:"1 GB"})},300)})}async getRecentChanges(){return new Promise(e=>{setTimeout(()=>{e({success:!0,changes:[{type:"inventory",user:"Luca (Magazzino)",action:"Aggiunto: Mozzarella di Bufala",time:"5 min fa"},{type:"temperatures",user:"Sara (Cucina)",action:"Temperatura Frigo A: 4.2°C",time:"12 min fa"},{type:"cleaning",user:"Marco (Pulizie)",action:"Completata: Sanificazione tavoli",time:"25 min fa"}],hasUpdates:Math.random()>.5})},400)})}getStorageStats(){return{localSpace:"45 MB",cloudSpace:"12 MB",photosCount:23,documentsCount:156,lastSync:localStorage.getItem("haccp-last-sync")||"Mai",syncCount:parseInt(localStorage.getItem("cloud-sim-sync-count")||"0")}}incrementSyncCount(){const e=parseInt(localStorage.getItem("cloud-sim-sync-count")||"0");localStorage.setItem("cloud-sim-sync-count",(e+1).toString())}async cleanupCloudStorage(){return new Promise(e=>{setTimeout(()=>{const n=Math.floor(Math.random()*20)+5;e({success:!0,message:`🧹 Liberati ${n} MB dal cloud!`,spaceSaved:`${n} MB`})},1e3)})}}const S3=(t="demo-company")=>new j3(t),Ms={version:"2.0",lastUpdated:"2024-12-19",principles:[{id:"data-collection",title:"Raccolta Dati Pertinenti",description:"Raccogliere dati pertinenti (temperature, pulizie, controlli, fornitori, prodotti) in formato tracciabile",critical:!0,implementation:"Ogni funzione deve salvare timestamp, operatore e dati completi"},{id:"data-archiving",title:"Archiviazione 12 Mesi",description:"Archiviare i dati per almeno 12 mesi in formato esportabile (PDF o JSON) leggibile da terzi (ASL, NAS, auditor)",critical:!0,implementation:"Sistema di backup automatico e export manuale"},{id:"data-integrity",title:"Integrità Dati",description:"Garantire integrità dei dati (nessuna modifica senza tracciamento, log azioni con data e ora)",critical:!0,implementation:"Log di tutte le modifiche con timestamp e operatore"},{id:"prerequisites",title:"Prerequisiti Normativi",description:"Facilitare il rispetto dei prerequisiti normativi: igiene personale, controllo infestanti, manutenzione impianti, formazione personale",critical:!0,implementation:"Checklist e promemoria per prerequisiti"},{id:"ccp-management",title:"Gestione CCP",description:"Gestire i CCP (Critical Control Points) con controlli programmati e azioni correttive",critical:!0,implementation:"Sistema di allarmi e azioni correttive automatiche"}],guidelines:{temperature:{id:"temperature-control",title:"Registrazione Temperature",frequency:"Almeno 2 volte al giorno (inizio e metà turno)",criticalPoints:[{name:"Frigo A - Conservazione Freschi",range:{min:2,max:4,unit:"°C"},description:"Latticini, formaggi freschi, salumi, verdure fresche",preset:"pizzeria-bar",allowedCategories:["latticini","carni","verdure","formaggi"]},{name:"Frigo B - Surgelati",range:{min:-19,max:-16,unit:"°C"},description:"Surgelati, pesce congelato, gelati",preset:"pizzeria-bar",allowedCategories:["surgelati","pesce_surgelato","gelati"]},{name:"Banco ingredienti",range:{min:0,max:8,unit:"°C"},description:"Pomodoro, mozzarella, verdure fresche",preset:"pizzeria",allowedCategories:["verdure","latticini","condimenti"]},{name:"Freezer",range:{min:-18,max:null,unit:"°C"},description:"Tutti i prodotti surgelati",preset:"universal",allowedCategories:["surgelati","pesce_surgelato","gelati","verdure_congelate"]}],correctiveActions:["Isolare prodotto e segnalarlo immediatamente","Riparare/controllare apparecchio","Registrare azione correttiva e prodotto isolato","Verificare temperatura prima di riutilizzare"],whyMatters:"Le temperature fuori range favoriscono la proliferazione batterica e compromettono la sicurezza alimentare"},conservationPoints:{id:"conservation-points-haccp",title:"Punti di Conservazione HACCP",description:"Gestione strutturata dei punti di conservazione secondo standard HACCP",criticalPoints:[{name:"Frigo A - Conservazione Freschi",temperature:{min:2,max:4,unit:"°C"},categories:["latticini","carni","verdure","formaggi"],monitoring:"2 volte al giorno",correctiveAction:"Isolare prodotti e verificare temperatura",preset:"pizzeria-bar"},{name:"Frigo B - Surgelati",temperature:{min:-19,max:-16,unit:"°C"},categories:["surgelati","pesce_surgelato","gelati"],monitoring:"1 volta al giorno",correctiveAction:"Verificare funzionamento e isolare prodotti",preset:"pizzeria-bar"}],validationRules:["Temperatura deve essere sempre nel range specificato","Categorie prodotti devono corrispondere al punto di conservazione","Monitoraggio frequente e registrazione obbligatoria","Azioni correttive immediate in caso di deviazione"],whyMatters:"La corretta gestione dei punti di conservazione è fondamentale per la sicurezza alimentare e la conformità HACCP"},cleaning:{id:"cleaning-sanitization",title:"Pulizie e Sanificazioni",zones:[{name:"Superfici di lavoro",frequency:"Dopo ogni uso",products:["Detergente neutro","Disinfettante alimentare"]},{name:"Celle e frigoriferi",frequency:"Settimanale",products:["Detergente specifico","Disinfettante alimentare"]},{name:"Pavimenti",frequency:"Quotidiano",products:["Detergente pavimenti","Disinfettante"]},{name:"Attrezzature",frequency:"Secondo manuale tecnico",products:["Detergente specifico per attrezzature"]}],recording:"Indicare operatore, orario, detergente/disinfettante usato",whyMatters:"La pulizia regolare previene contaminazioni e mantiene standard igienici"},staff:{id:"staff-management",title:"Gestione Personale",roles:[{name:"Amministratore",level:1,responsibilities:["Gestione completa sistema","Responsabilità legale","Approvazione procedure"]},{name:"Responsabile",level:2,responsibilities:["Supervisione operativa","Controllo procedure","Formazione staff"]},{name:"Dipendente",level:3,responsibilities:["Esecuzione procedure","Registrazione dati","Segnalazione problemi"]},{name:"Collaboratore occasionale",level:4,responsibilities:["Esecuzione procedure base","Seguire istruzioni responsabile"]}],requirements:["Mansioni assegnate e documentate","Formazione HACCP registrata e aggiornata","Conoscenza procedure operative","Responsabilità chiare per ogni ruolo"],whyMatters:"Personale formato e responsabilizzato garantisce applicazione corretta delle procedure HACCP"},products:{id:"product-management",title:"Gestione Prodotti",scheda:["Nome commerciale e nome scientifico","Categoria (carne, latticini, verdure, ecc.)","Data di ricezione e scadenza","Fornitore e documentazione","Etichetta interna se necessario (es. preparazioni interne con TMC)","Condizioni di conservazione","Allergeni presenti"],whyMatters:"Tracciabilità completa garantisce sicurezza e conformità normativa"},suppliers:{id:"supplier-management",title:"Gestione Fornitori",registration:["Nome e categoria merceologica","Contatti e documentazione","DDT/fatture con data di consegna","Valutazione periodica affidabilità","Controllo documenti di trasporto","Verifica certificazioni HACCP"],whyMatters:"Fornitori qualificati garantiscono materie prime sicure e conformi"},nonConformity:{id:"non-conformity",title:"Gestione Non Conformità",recording:["Data e ora del rilevamento","Descrizione dettagliata del problema","Azione correttiva intrapresa","Responsabile dell'azione","Verifica efficacia azione correttiva","Prevenzione ricorrenza"],examples:["Temperatura fuori range per più di 2 ore","Presenza infestanti in magazzino","Prodotto scaduto in vendita","Dispositivo di controllo non funzionante","Personale non formato per mansione"],whyMatters:"Gestione corretta delle non conformità previene rischi e migliora il sistema"}},requirements:{refrigerators:{mandatory:["nome","tipo","range-temperatura","posizione"],validation:"Minimo 1 registrato per sbloccare registrazione temperature",blocking:["temperatures"],whyMatters:"I frigoriferi sono punti di controllo critici per la catena del freddo"},temperature:{mandatory:["punto-controllo","valore","ora","operatore"],validation:"Se valore fuori range → mostra alert e richiede azione correttiva",blocking:[],whyMatters:"Le temperature fuori range compromettono la sicurezza alimentare"},staff:{mandatory:["nome","ruolo","mansioni","formazione-haccp"],validation:"Minimo 1 per sbloccare pulizie e controlli",blocking:["cleaning","inventory"],whyMatters:"Il personale formato è responsabile dell'applicazione delle procedure"},cleaning:{mandatory:["area","frequenza","prodotto-usato","operatore","data-ora"],validation:"Blocco se area non associata a un reparto",blocking:[],whyMatters:"Le pulizie regolari prevengono contaminazioni"},products:{mandatory:["nome","categoria","data-ricezione","scadenza","fornitore"],validation:"Alert se scadenza imminente (<3 giorni)",blocking:[],whyMatters:"La tracciabilità garantisce sicurezza e conformità"},suppliers:{mandatory:["nome","categoria","contatto","documentazione"],validation:"Minimo 1 per associare prodotti",blocking:["products"],whyMatters:"I fornitori qualificati garantiscono materie prime sicure"},nonConformity:{mandatory:["data","descrizione","azione-correttiva","responsabile"],validation:"Blocco salvataggio se mancano dettagli essenziali",blocking:[],whyMatters:"La gestione delle non conformità previene rischi futuri"}},educationalMessages:{welcome:"Benvenuto nel sistema HACCP! Questo sistema ti guiderà nella gestione della sicurezza alimentare.",whyHaccp:"L'HACCP è un sistema preventivo richiesto per legge che garantisce la sicurezza alimentare.",dataImportance:"Ogni dato registrato contribuisce alla sicurezza e alla conformità normativa.",responsibility:"La sicurezza alimentare è responsabilità di tutti i membri dello staff."},getRequirement:t=>Ms.requirements[t]||null,getGuideline:t=>Ms.guidelines[t]||null,getPrinciple:t=>Ms.principles.find(e=>e.id===t)||null,validateRequirement:(t,e)=>{const n=Ms.getRequirement(t);if(!n)return{valid:!1,error:"Sezione non trovata"};const s=n.mandatory.filter(i=>!e[i]);return{valid:s.length===0,missing:s,message:s.length>0?`Campi mancanti: ${s.join(", ")}`:"Tutti i campi obbligatori sono compilati"}},getBlockingSections:t=>{const e=Ms.getRequirement(t);return e?e.blocking:[]},isSectionBlocked:(t,e)=>{if(!Ms.getRequirement(t))return!1;switch(t){case"temperatures":return!e.refrigerators||e.refrigerators.length===0;case"cleaning":return!e.refrigerators||e.refrigerators.length===0||!e.staff||e.staff.length===0;case"inventory":return!e.departments||e.departments.length===0||!e.refrigerators||e.refrigerators.length===0;case"products":return!e.suppliers||e.suppliers.length===0;default:return!1}}};function _3(){W.useState(new Set(["principles"]));const[t,e]=W.useState("principles"),[n,s]=W.useState(""),i=Ms.principles.filter(p=>p.title.toLowerCase().includes(n.toLowerCase())||p.description.toLowerCase().includes(n.toLowerCase())),a=Object.entries(Ms.guidelines).filter(([p,v])=>v.title.toLowerCase().includes(n.toLowerCase())||v.whyMatters&&v.whyMatters.toLowerCase().includes(n.toLowerCase())),o=p=>r.jsx("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500 hover:shadow-md transition-shadow",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("h4",{className:"font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[r.jsx(Y1,{className:"h-5 w-5"}),p.title]}),r.jsx("p",{className:"text-blue-800 mb-2",children:p.description}),r.jsxs("div",{className:"bg-blue-100 p-3 rounded",children:[r.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Implementazione:"}),r.jsx("p",{className:"text-sm text-blue-800",children:p.implementation})]})]}),r.jsx(Cn,{className:"h-6 w-6 text-blue-600 flex-shrink-0 ml-2"})]})},p.id),l=(p,v)=>r.jsxs("div",{className:"mb-6 p-4 bg-green-50 rounded-lg border-l-4 border-green-500",children:[r.jsxs("h4",{className:"font-semibold text-green-900 mb-3 flex items-center gap-2",children:[d(p),v.title]}),v.frequency&&r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-sm font-medium text-green-800",children:"Frequenza:"}),r.jsx("p",{className:"text-green-700",children:v.frequency})]}),v.criticalPoints&&r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-sm font-medium text-green-800",children:"Punti di Controllo:"}),r.jsx("div",{className:"space-y-2",children:v.criticalPoints.map((m,N)=>r.jsxs("div",{className:"bg-green-100 p-2 rounded",children:[r.jsx("p",{className:"font-medium text-green-900",children:m.name}),r.jsxs("p",{className:"text-sm text-green-800",children:["Range: ",m.range.min,"°C - ",m.range.max||"∞","°C"]}),r.jsx("p",{className:"text-sm text-green-700",children:m.description})]},N))})]}),v.zones&&r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-sm font-medium text-green-800",children:"Zone e Frequenza:"}),r.jsx("div",{className:"space-y-2",children:v.zones.map((m,N)=>r.jsxs("div",{className:"bg-green-100 p-2 rounded",children:[r.jsx("p",{className:"font-medium text-green-900",children:m.name}),r.jsxs("p",{className:"text-sm text-green-800",children:["Frequenza: ",m.frequency]}),r.jsxs("p",{className:"text-sm text-green-700",children:["Prodotti: ",m.products.join(", ")]})]},N))})]}),v.roles&&r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-sm font-medium text-green-800",children:"Ruoli e Responsabilità:"}),r.jsx("div",{className:"space-y-2",children:v.roles.map((m,N)=>r.jsxs("div",{className:"bg-green-100 p-2 rounded",children:[r.jsx("p",{className:"font-medium text-green-900",children:m.name}),r.jsxs("div",{className:"text-sm text-green-800",children:[r.jsx("p",{children:"Responsabilità:"}),r.jsx("ul",{className:"list-disc list-inside ml-2",children:m.responsibilities.map((S,k)=>r.jsx("li",{children:S},k))})]})]},N))})]}),v.correctiveActions&&r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-sm font-medium text-green-800",children:"Azioni Correttive:"}),r.jsx("ul",{className:"list-disc list-inside space-y-1",children:v.correctiveActions.map((m,N)=>r.jsx("li",{className:"text-green-700",children:m},N))})]}),v.whyMatters&&r.jsxs("div",{className:"bg-green-100 p-3 rounded",children:[r.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Perché è importante:"}),r.jsx("p",{className:"text-sm text-green-800",children:v.whyMatters})]})]},v.id),c=(p,v)=>r.jsxs("div",{className:"mb-4 p-4 bg-orange-50 rounded-lg border-l-4 border-orange-500",children:[r.jsxs("h4",{className:"font-semibold text-orange-900 mb-3 flex items-center gap-2",children:[r.jsx($s,{className:"h-5 w-5"}),f(p)]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-sm font-medium text-orange-800",children:"Dati obbligatori:"}),r.jsx("ul",{className:"list-disc list-inside space-y-1",children:v.mandatory.map((m,N)=>r.jsx("li",{className:"text-orange-700",children:m},N))})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-sm font-medium text-orange-800",children:"Validazione:"}),r.jsx("p",{className:"text-orange-700",children:v.validation})]}),v.blocking&&v.blocking.length>0&&r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-sm font-medium text-orange-800",children:"Blocca sezioni:"}),r.jsx("p",{className:"text-orange-700",children:v.blocking.join(", ")})]}),r.jsxs("div",{className:"bg-orange-100 p-3 rounded",children:[r.jsx("p",{className:"text-sm font-medium text-orange-900 mb-1",children:"Perché è importante:"}),r.jsx("p",{className:"text-sm text-orange-800",children:v.whyMatters})]})]},p),d=p=>({temperature:r.jsx(ds,{className:"h-5 w-5"}),cleaning:r.jsx(uf,{className:"h-5 w-5"}),staff:r.jsx(Ai,{className:"h-5 w-5"}),products:r.jsx(Un,{className:"h-5 w-5"}),suppliers:r.jsx(ko,{className:"h-5 w-5"}),nonConformity:r.jsx(xn,{className:"h-5 w-5"})})[p]||r.jsx($s,{className:"h-5 w-5"}),f=p=>({refrigerators:"Gestione Frigoriferi",temperature:"Registrazione Temperature",staff:"Gestione Personale",cleaning:"Gestione Pulizie",products:"Gestione Prodotti",suppliers:"Gestione Fornitori",nonConformity:"Gestione Non Conformità"})[p]||p;return r.jsxs("div",{className:"space-y-6",children:[r.jsx(Je,{children:r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center gap-3 text-2xl",children:[r.jsx($h,{className:"h-8 w-8 text-blue-600"}),"Manuale HACCP - Guida Completa"]}),r.jsx("p",{className:"text-gray-600",children:"Riferimento completo per normative HACCP e procedure operative"})]})}),r.jsxs(s0,{value:t,onValueChange:e,className:"w-full",children:[r.jsxs(gf,{className:"grid w-full grid-cols-3",children:[r.jsx(Gr,{value:"principles",children:"Principi Base"}),r.jsx(Gr,{value:"guidelines",children:"Linee Guida"}),r.jsx(Gr,{value:"requirements",children:"Requisiti"})]}),r.jsx(Wr,{value:"principles",className:"space-y-4",children:r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Y1,{className:"h-6 w-6 text-blue-600"}),"Principi Fondamentali HACCP"]}),r.jsx("p",{className:"text-gray-600",children:"Questi principi garantiscono la conformità alle normative di sicurezza alimentare"}),r.jsxs("div",{className:"mt-4 relative",children:[r.jsx("input",{type:"text",placeholder:"Cerca nei principi...",value:n,onChange:p=>s(p.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),n&&r.jsx("button",{onClick:()=>s(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r.jsx(X,{className:"h-4 w-4"})})]})]}),r.jsx(Xe,{children:i.map(o)})]})}),r.jsx(Wr,{value:"guidelines",className:"space-y-4",children:r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx($h,{className:"h-6 w-6 text-green-600"}),"Linee Guida Operative"]}),r.jsx("p",{className:"text-gray-600",children:"Procedure dettagliate per ogni area operativa"})]}),r.jsx(Xe,{children:a.map(([p,v])=>l(p,v))})]})}),r.jsx(Wr,{value:"requirements",className:"space-y-4",children:r.jsxs(Je,{children:[r.jsxs(yt,{children:[r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Cn,{className:"h-6 w-6 text-orange-600"}),"Requisiti Minimi e Validazioni"]}),r.jsx("p",{className:"text-gray-600",children:"Dati obbligatori e controlli automatici per ogni sezione"})]}),r.jsx(Xe,{children:Object.entries(Ms.requirements).map(([p,v])=>c(p,v))})]})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx($s,{className:"h-6 w-6 text-purple-600"}),"Informazioni Importanti"]})}),r.jsx(Xe,{children:r.jsx("div",{className:"space-y-3",children:Object.entries(Ms.educationalMessages).map(([p,v])=>r.jsx("div",{className:"p-3 bg-purple-50 rounded-lg border-l-4 border-purple-500",children:r.jsx("p",{className:"text-purple-800",children:v})},p))})})]}),r.jsx(Je,{children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"text-center text-sm text-gray-500",children:[r.jsxs("p",{children:["Versione ",Ms.version," • Ultimo aggiornamento: ",Ms.lastUpdated]}),r.jsx("p",{className:"mt-1",children:"Questo manuale è conforme alle normative HACCP vigenti"})]})})})]})}const Wc=["haccp-temperatures","haccp-refrigerators","haccp-staff","haccp-cleaning","haccp-products","haccp-departments","haccp-users","haccp-actions","haccp-roles","haccp-suppliers","haccp-onboarding","haccp-presets","haccp-dev-mode"];function C3({currentUser:t,isAdmin:e=!1}){const[n,s]=W.useState({autoBackupEnabled:!1,autoBackupFrequency:"weekly",lastBackupDate:null,nextBackupDate:null}),[i,a]=W.useState([]),[o,l]=W.useState(!1),[c,d]=W.useState(!1);W.useEffect(()=>{const m=localStorage.getItem("haccp-backup-settings");if(m)try{const S=JSON.parse(m);s(k=>({...k,...S}))}catch(S){is("Errore nel caricamento impostazioni backup:",S)}const N=localStorage.getItem("haccp-backup-history");if(N)try{a(JSON.parse(N))}catch(S){is("Errore nel caricamento cronologia backup:",S)}},[]),W.useEffect(()=>{localStorage.setItem("haccp-backup-settings",JSON.stringify(n))},[n]),W.useEffect(()=>{if(n.autoBackupEnabled&&n.lastBackupDate){const m=new Date(n.lastBackupDate),N=new Date(m);n.autoBackupFrequency==="weekly"?N.setDate(N.getDate()+7):n.autoBackupFrequency==="monthly"&&N.setMonth(N.getMonth()+1),s(S=>({...S,nextBackupDate:N.toISOString()}))}},[n.autoBackupEnabled,n.lastBackupDate,n.autoBackupFrequency]);const f=async()=>{l(!0);try{const m={version:"1.0",timestamp:new Date().toISOString(),exportedBy:(t==null?void 0:t.name)||"unknown",data:{}};for(const b of Wc){const j=localStorage.getItem(b);if(j)try{m.data[b]=JSON.parse(j)}catch(z){zp(`Errore nel parsing ${b}:`,z),m.data[b]=j}}const N=new Blob([JSON.stringify(m,null,2)],{type:"application/json"}),S=URL.createObjectURL(N),k=document.createElement("a");k.href=S,k.download=`haccp-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(S);const y={id:Date.now().toString(),type:"manual",timestamp:new Date().toISOString(),user:(t==null?void 0:t.name)||"unknown",size:N.size,success:!0};a(b=>[y,...b.slice(0,9)]),localStorage.setItem("haccp-backup-history",JSON.stringify([y,...i.slice(0,9)])),alert(`✅ Export completato con successo!

📁 File scaricato nella cartella Download
💾 Tutti i dati HACCP sono stati esportati`)}catch(m){is("Errore durante export:",m),alert(`❌ Errore durante l'export dei dati

Controlla la console per maggiori dettagli`)}finally{l(!1)}},p=async m=>{const N=m.target.files[0];if(N){d(!0);try{const S=await N.text(),k=JSON.parse(S);if(!k.version||!k.data||!k.timestamp)throw new Error("Formato file non valido. Il file deve contenere version, data e timestamp.");const y=Object.keys(k.data);if(!confirm(`⚠️ ATTENZIONE: Stai per importare dati HACCP!

📊 Dati trovati: ${y.length} chiavi
📅 Data export: ${new Date(k.timestamp).toLocaleString("it-IT")}
👤 Esportato da: ${k.exportedBy||"sconosciuto"}

⚠️ Questa operazione sovrascriverà i dati esistenti!

Procedere con l'import?`)){d(!1);return}const j={};for(const K of Wc){const P=localStorage.getItem(K);P&&(j[K]=P)}const z={version:"1.0",timestamp:new Date().toISOString(),type:"pre-import-backup",data:j};localStorage.setItem("haccp-pre-import-backup",JSON.stringify(z));let H=0;for(const[K,P]of Object.entries(k.data))if(Wc.includes(K))try{typeof P=="string"?localStorage.setItem(K,P):localStorage.setItem(K,JSON.stringify(P)),H++}catch($){zp(`Errore nell'import di ${K}:`,$)}const Z={id:Date.now().toString(),type:"import",timestamp:new Date().toISOString(),user:(t==null?void 0:t.name)||"unknown",importedKeys:H,success:!0,sourceFile:N.name};a(K=>[Z,...K.slice(0,9)]),localStorage.setItem("haccp-backup-history",JSON.stringify([Z,...i.slice(0,9)])),alert(`✅ Import completato con successo!

📊 Chiavi importate: ${H}/${Object.keys(k.data).length}
💾 Backup pre-import salvato come 'haccp-pre-import-backup'

🔄 Ricarica la pagina per applicare le modifiche`),setTimeout(()=>{window.location.reload()},2e3)}catch(S){is("Errore durante import:",S),alert(`❌ Errore durante l'import:

${S.message}

Controlla che il file sia un backup HACCP valido.`)}finally{d(!1),m.target.value=""}}},v=async()=>{try{await f(),s(N=>({...N,lastBackupDate:new Date().toISOString()}));const m={id:Date.now().toString(),type:"auto",timestamp:new Date().toISOString(),user:"Sistema",success:!0};a(N=>[m,...N.slice(0,9)]),localStorage.setItem("haccp-backup-history",JSON.stringify([m,...i.slice(0,9)]))}catch(m){is("Errore backup automatico:",m)}};return W.useEffect(()=>{if(n.autoBackupEnabled&&n.nextBackupDate){const m=new Date,N=new Date(n.nextBackupDate);m>=N&&v()}},[n.autoBackupEnabled,n.nextBackupDate]),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Backup e Export Dati"}),r.jsx("p",{className:"text-gray-600",children:"💾 Gestisci il backup e l'export dei dati HACCP per garantire la sicurezza e la tracciabilità"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx(Je,{children:r.jsxs(Xe,{className:"p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.filter(m=>m.success).length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Backup Completati"})]})}),r.jsx(Je,{children:r.jsxs(Xe,{className:"p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.filter(m=>m.type==="auto").length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Backup Automatici"})]})}),r.jsx(Je,{children:r.jsxs(Xe,{className:"p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.filter(m=>m.type==="import").length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Import Completati"})]})})]}),e&&r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(os,{className:"h-5 w-5"}),"Backup Automatico"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium",children:"Abilita Backup Automatico"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Crea automaticamente backup periodici per garantire la sicurezza dei dati"})]}),r.jsx(le,{variant:n.autoBackupEnabled?"default":"outline",onClick:()=>s(m=>({...m,autoBackupEnabled:!m.autoBackupEnabled})),className:"flex items-center gap-2",children:n.autoBackupEnabled?r.jsxs(r.Fragment,{children:[r.jsx(Cn,{className:"h-4 w-4"}),"Abilitato"]}):r.jsxs(r.Fragment,{children:[r.jsx(xn,{className:"h-4 w-4"}),"Disabilitato"]})})]}),n.autoBackupEnabled&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium",children:"Frequenza Backup"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Quanto spesso creare backup automatici"})]}),r.jsxs("select",{value:n.autoBackupFrequency,onChange:m=>s(N=>({...N,autoBackupFrequency:m.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"weekly",children:"Settimanale"}),r.jsx("option",{value:"monthly",children:"Mensile"})]})]}),n.lastBackupDate&&r.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[r.jsx($s,{className:"h-4 w-4"}),r.jsx("span",{className:"font-medium",children:"Ultimo backup:"}),r.jsx("span",{children:new Date(n.lastBackupDate).toLocaleString("it-IT")})]}),n.nextBackupDate&&r.jsxs("div",{className:"text-blue-700 text-sm mt-1",children:["Prossimo backup: ",new Date(n.nextBackupDate).toLocaleString("it-IT")]})]})]})]})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Bs,{className:"h-5 w-5"}),"Export Dati"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-gray-600",children:"📊 Esporta tutti i dati HACCP in formato JSON per backup, migrazione o condivisione. Include temperature, pulizie, inventario, staff e tutte le configurazioni."}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(le,{onClick:f,disabled:o,className:"flex items-center gap-2",children:[o?r.jsx(dh,{className:"h-4 w-4 animate-spin"}):r.jsx(Bs,{className:"h-4 w-4"}),o?"Esportando...":"Export Completo JSON"]}),r.jsxs("span",{className:"text-sm text-gray-500",children:[Wc.length," chiavi dati incluse"]})]}),r.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[r.jsx(Cn,{className:"h-4 w-4"}),r.jsx("span",{className:"font-medium",children:"Dati inclusi nell'export:"})]}),r.jsx("div",{className:"text-green-700 text-sm mt-2 grid grid-cols-2 gap-2",children:Wc.map(m=>r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(bN,{className:"h-3 w-3"}),m.replace("haccp-","")]},m))})]})]})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(uu,{className:"h-5 w-5"}),"Import Dati"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-gray-600",children:"📥 Importa dati HACCP da un file di backup JSON. ⚠️ Questa operazione sovrascriverà i dati esistenti!"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"file",accept:".json",onChange:p,className:"hidden",id:"import-file"}),r.jsx("label",{htmlFor:"import-file",children:r.jsxs(le,{as:"span",disabled:c,className:"flex items-center gap-2 cursor-pointer",children:[c?r.jsx(dh,{className:"h-4 w-4 animate-spin"}):r.jsx(uu,{className:"h-4 w-4"}),c?"Importando...":"Seleziona File JSON"]})}),c&&r.jsx("span",{className:"text-sm text-gray-500",children:"Import in corso..."})]}),r.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[r.jsx(xn,{className:"h-4 w-4"}),r.jsx("span",{className:"font-medium",children:"Attenzione Import:"})]}),r.jsxs("ul",{className:"text-yellow-700 text-sm mt-2 space-y-1",children:[r.jsx("li",{children:"• I dati esistenti verranno sovrascritti"}),r.jsx("li",{children:"• Verrà creato un backup automatico pre-import"}),r.jsx("li",{children:"• Solo file JSON HACCP validi sono accettati"}),r.jsx("li",{children:"• La pagina verrà ricaricata dopo l'import"})]})]})]})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Eu,{className:"h-5 w-5"}),"Cronologia Backup"]})}),r.jsx(Xe,{children:i.length===0?r.jsxs("div",{className:"text-center py-6 text-gray-500",children:[r.jsx(Eu,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),r.jsx("p",{children:"Nessun backup registrato"}),r.jsx("p",{className:"text-sm",children:"I backup appariranno qui dopo aver eseguito export o import"})]}):r.jsx("div",{className:"space-y-3",children:i.map(m=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-2 rounded-full ${m.type==="auto"?"bg-blue-100 text-blue-600":m.type==="import"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"}`,children:m.type==="auto"?r.jsx(dh,{className:"h-4 w-4"}):m.type==="import"?r.jsx(uu,{className:"h-4 w-4"}):r.jsx(Bs,{className:"h-4 w-4"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:m.type==="auto"?"Backup Automatico":m.type==="import"?"Import Dati":"Export Manuale"}),r.jsxs("div",{className:"text-sm text-gray-600",children:[new Date(m.timestamp).toLocaleString("it-IT")," • ",m.user]}),m.sourceFile&&r.jsxs("div",{className:"text-xs text-gray-500",children:["File: ",m.sourceFile]})]})]}),r.jsx("div",{className:"flex items-center gap-2",children:m.success?r.jsx(Cn,{className:"h-5 w-5 text-green-600"}):r.jsx(xn,{className:"h-5 w-5 text-red-600"})})]},m.id))})})]})]})}function k3({currentUser:t,isAdmin:e=!1,onSettingsChange:n}){const[s,i]=W.useState(!1),[a,o]=W.useState({keepPhotosLocal:!1,keepDocsLocal:!0,keepDataLocal:!0,autoShareTemperatures:!0,autoShareInventory:!0,autoShareCleaning:!0,autoShareStaff:e,keepDaysLocal:7,maxPhotosLocal:e?100:20}),[l,c]=W.useState({usedSpace:"45 MB",availableSpace:"2.1 GB",photosCount:23,docsCount:156}),[d]=W.useState(()=>S3("demo-pizzeria"));W.useEffect(()=>{const m=localStorage.getItem("haccp-data-settings");m&&o({...a,...JSON.parse(m)});const N=d.getStorageStats();c({usedSpace:N.localSpace,availableSpace:"2.1 GB",photosCount:N.photosCount,docsCount:N.documentsCount})},[d]);const f=(m,N)=>{const S={...a,[m]:N};o(S),localStorage.setItem("haccp-data-settings",JSON.stringify(S)),n==null||n(S)},p=({title:m,description:N,value:S,onChange:k,icon:y,adminOnly:b=!1})=>b&&!e?null:r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-white",children:[r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(y,{className:"h-5 w-5 text-blue-600 mt-0.5"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:m}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N}),b&&r.jsxs("span",{className:"inline-flex items-center gap-1 mt-1 px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded",children:[r.jsx(os,{className:"h-3 w-3"}),"Solo Amministratore"]})]})]}),r.jsx(le,{variant:"ghost",onClick:()=>k(!S),className:"p-1",children:S?r.jsx(MN,{className:"h-6 w-6 text-green-600"}):r.jsx(DN,{className:"h-6 w-6 text-gray-400"})})]}),v=({title:m,description:N,current:S,options:k,onChange:y,icon:b})=>r.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[r.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[r.jsx(b,{className:"h-5 w-5 text-blue-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-gray-900",children:m}),r.jsx("p",{className:"text-sm text-gray-600",children:N})]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:k.map(j=>r.jsx(le,{variant:S===j.value?"default":"outline",onClick:()=>y(j.value),className:"text-sm py-2",children:j.label},j.value))})]});return r.jsxs(W.Fragment,{children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"📱 Gestione Dati"}),r.jsx("p",{className:"text-gray-600",children:"Decidi cosa tenere sul tuo telefono e cosa condividere"})]}),r.jsxs(Je,{className:"bg-gradient-to-r from-green-50 to-blue-50",children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(zN,{className:"h-5 w-5"}),"Spazio sul Tuo Telefono"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l.usedSpace}),r.jsx("p",{className:"text-xs text-gray-600",children:"Usato dall'app"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:l.availableSpace}),r.jsx("p",{className:"text-xs text-gray-600",children:"Spazio libero"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-orange-600",children:l.photosCount}),r.jsx("p",{className:"text-xs text-gray-600",children:"Foto salvate"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-purple-600",children:l.docsCount}),r.jsx("p",{className:"text-xs text-gray-600",children:"Documenti"})]})]})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(pl,{className:"h-5 w-5"}),"Foto e Documenti"]})}),r.jsxs(Xe,{className:"space-y-4",children:[r.jsx(p,{icon:X2,title:"Salva Foto sul Telefono",description:"Le foto delle etichette rimangono sul tuo telefono anche senza internet. Occupa più spazio ma è più veloce.",value:a.keepPhotosLocal,onChange:m=>f("keepPhotosLocal",m)}),r.jsx(p,{icon:SN,title:"Salva Documenti sul Telefono",description:"Tieni una copia di ricette, procedure e documenti sul telefono per consultarli anche offline.",value:a.keepDocsLocal,onChange:m=>f("keepDocsLocal",m)}),r.jsx(v,{icon:Xc,title:"Quante Foto Tenere",description:"Numero massimo di foto da tenere salvate sul telefono",current:a.maxPhotosLocal,onChange:m=>f("maxPhotosLocal",m),options:[{value:10,label:"10 foto"},{value:50,label:"50 foto"},{value:100,label:"100 foto"}]})]})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Q1,{className:"h-5 w-5"}),"Condivisione Automatica"]})}),r.jsxs(Xe,{className:"space-y-4",children:[r.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:r.jsxs("p",{className:"text-sm text-blue-800",children:["💡 ",r.jsx("strong",{children:"Cosa significa:"})," Se attivi queste opzioni, le modifiche che fai verranno condivise automaticamente con i colleghi appena hai internet."]})}),r.jsx(p,{icon:ds,title:"Condividi Temperature Automaticamente",description:"Le temperature dei frigoriferi vengono condivise subito con tutti. Importante per la sicurezza alimentare.",value:a.autoShareTemperatures,onChange:m=>f("autoShareTemperatures",m)}),r.jsx(p,{icon:Un,title:"Condividi Inventario Automaticamente",description:"Quando aggiungi o modifichi prodotti, tutti vedono subito le modifiche.",value:a.autoShareInventory,onChange:m=>f("autoShareInventory",m)}),r.jsx(p,{icon:Cn,title:"Condividi Pulizie Automaticamente",description:"Le attività di pulizia completate vengono condivise subito con il team.",value:a.autoShareCleaning,onChange:m=>f("autoShareCleaning",m)}),r.jsx(p,{icon:Ai,title:"Condividi Gestione Staff",description:"Modifiche a dipendenti, ruoli e permessi vengono condivise automaticamente.",value:a.autoShareStaff,onChange:m=>f("autoShareStaff",m),adminOnly:!0})]})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Xc,{className:"h-5 w-5"}),"Quanto Tenere sul Telefono"]})}),r.jsxs(Xe,{className:"space-y-4",children:[r.jsx(v,{icon:Xc,title:"Giorni di Dati da Tenere",description:"Quanti giorni di temperature, pulizie e inventario tenere salvati sul telefono",current:a.keepDaysLocal,onChange:m=>f("keepDaysLocal",m),options:[{value:3,label:"3 giorni"},{value:7,label:"1 settimana"},{value:30,label:"1 mese"}]}),r.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx($s,{className:"h-4 w-4 text-blue-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Perché è importante?"}),r.jsxs("ul",{className:"text-xs text-gray-600 mt-1 space-y-1",children:[r.jsxs("li",{children:["• 📱 ",r.jsx("strong",{children:"Meno giorni"})," = telefono più veloce e più spazio libero"]}),r.jsxs("li",{children:["• 📊 ",r.jsx("strong",{children:"Più giorni"})," = puoi vedere dati anche senza internet"]}),r.jsxs("li",{children:["• ☁️ ",r.jsx("strong",{children:"Tutti i dati"})," rimangono sempre salvati online"]})]})]})]})})]})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsx(Nt,{children:"🚀 Azioni Rapide"})}),r.jsx(Xe,{children:r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs(le,{variant:"outline",className:"flex items-center gap-2",onClick:async()=>{try{const m=await d.cleanupCloudStorage();if(m.success){alert(`✅ ${m.message}
💾 Spazio liberato: ${m.spaceSaved}`);const N=d.getStorageStats();c(S=>({...S,usedSpace:N.localSpace}))}}catch{alert("❌ Errore durante la pulizia dello spazio")}},children:[r.jsx(Xc,{className:"h-4 w-4"}),"Libera Spazio"]}),r.jsxs(le,{variant:"outline",className:"flex items-center gap-2",onClick:async()=>{var m;try{alert("🔄 Sto sincronizzando tutto..."),await new Promise(S=>setTimeout(S,1500));const N=await d.getRecentChanges();N.success&&alert(`✅ Sincronizzazione completata!
👥 Trovate ${((m=N.changes)==null?void 0:m.length)||0} modifiche dai colleghi`)}catch{alert("❌ Errore durante la sincronizzazione")}},children:[r.jsx(Q1,{className:"h-4 w-4"}),"Sincronizza Ora"]})]})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Bs,{className:"h-5 w-5"}),"Backup e Export Dati"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-gray-600",children:"💾 Gestisci il backup e l'export dei dati HACCP per garantire la sicurezza e la tracciabilità. Esporta tutti i dati in formato JSON o importa da backup esistenti."}),r.jsx(C3,{currentUser:t,isAdmin:e})]})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(ko,{className:"h-5 w-5"}),"Gestione Fornitori"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-gray-600",children:"📋 Gestisci i fornitori per garantire la tracciabilità HACCP e la sicurezza alimentare. Mantieni aggiornate le informazioni sui fornitori per la compliance normativa."}),r.jsx(Iy,{currentUser:t})]})})]}),r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx($h,{className:"h-5 w-5"}),"Manuale HACCP"]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-gray-600",children:"Consulta la guida completa per normative HACCP e procedure operative. Questo manuale ti aiuterà a comprendere i requisiti e implementare correttamente le procedure."}),r.jsxs(le,{variant:"outline",className:"flex items-center gap-2 w-full",onClick:()=>i(!0),children:[r.jsx($h,{className:"h-4 w-4"}),"Apri Manuale HACCP"]})]})})]})]}),s&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl h-full max-h-[90vh] overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Manuale HACCP"}),r.jsx(le,{variant:"outline",size:"sm",onClick:()=>i(!1),children:"✕ Chiudi"})]}),r.jsx("div",{className:"overflow-y-auto h-full p-4",children:r.jsx(_3,{})})]})})]})}function A3({isOpen:t,onClose:e,onLogin:n,users:s,onAddUser:i}){const[a,o]=W.useState(""),[l,c]=W.useState(""),[d,f]=W.useState(!1),[p,v]=W.useState(!1),[m,N]=W.useState(""),[S,k]=W.useState({name:"",pin:"",role:"employee",department:""}),[y,b]=W.useState([]),[j,z]=W.useState([]);W.useEffect(()=>{const $=localStorage.getItem("haccp-departments"),re=localStorage.getItem("haccp-departments-version"),A=["Banconisti","Cuochi","Amministrazione"];if(re!=="2.0"||!$)b(A),z(A);else try{const R=JSON.parse($).filter(ie=>ie.isCustom).map(ie=>ie.name),V=[...R];A.forEach(ie=>{R.includes(ie)||V.push(ie)}),b(V),z(A)}catch(C){is("Errore nel caricamento reparti:",C),b(A),z(A)}},[]),W.useEffect(()=>{if(s.length>0&&!a){const $=s.find(re=>re.name==="Admin"&&re.pin==="0000");$&&(o($.id),c("0000"),Se("✅ Login precompilato: Admin / 0000"))}},[s,a]);const H=()=>{if(!a||!l){N("Seleziona utente e inserisci PIN");return}const $=s.find(re=>re.id===a);if(!$){N("Utente non trovato");return}if($.pin!==l){N("PIN non corretto");return}n($),K()},Z=()=>{if(!S.name.trim()||!S.pin.trim()){N("Nome e PIN sono obbligatori");return}if(S.pin.length!==4){N("Il PIN deve essere di 4 cifre");return}if(s.some($=>$.pin===S.pin)){N("PIN già in uso, scegline un altro");return}i(S),f(!1),k({name:"",pin:"",role:"employee",department:""}),N("")},K=()=>{o(""),c(""),N(""),f(!1),v(!1)},P=()=>{K(),e()};return t?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[r.jsx("h2",{className:"text-xl font-semibold",children:d?"Aggiungi Nuovo Utente":"Inizia il Turno"}),r.jsx(le,{variant:"ghost",size:"sm",onClick:P,children:r.jsx(dn,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"p-6",children:[m&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:m}),d?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"new-name",children:"Nome Completo"}),r.jsx(At,{id:"new-name",value:S.name,onChange:$=>k({...S,name:$.target.value}),placeholder:"es. Mario Rossi"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"new-pin",children:"PIN (4 cifre)"}),r.jsx(At,{id:"new-pin",type:"password",value:S.pin,onChange:$=>{const re=$.target.value.replace(/\D/g,"").slice(0,4);k({...S,pin:re})},maxLength:4,placeholder:"••••"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"new-role",children:"Ruolo"}),r.jsxs("select",{id:"new-role",value:S.role,onChange:$=>k({...S,role:$.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"-- Seleziona ruolo --"}),r.jsx("option",{value:"dipendente",children:"Dipendente (Staff Fisso) (Consigliato)"}),r.jsx("option",{value:"responsabile",children:"Responsabile (Consigliato)"}),r.jsx("option",{value:"collaboratore",children:"Collaboratore Occasionale (Consigliato)"}),r.jsx("option",{value:"admin",children:"Amministratore (Consigliato)"})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:`I ruoli contrassegnati come "Consigliato" sono provvisori e verranno sostituiti dalle categorie create dall'amministratore.`})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"new-department",children:"Reparto"}),r.jsxs("select",{id:"new-department",value:S.department,onChange:$=>k({...S,department:$.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"-- Seleziona reparto --"}),y.map($=>{const re=j.includes($);return r.jsxs("option",{value:$,children:[$," ",re?"(Consigliato)":""]},$)})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:`I reparti contrassegnati come "Consigliato" sono provvisori e verranno sostituiti dalle categorie create dall'amministratore.`})]}),r.jsxs("div",{className:"flex gap-3 pt-4",children:[r.jsxs(le,{onClick:Z,className:"flex-1",disabled:!S.name.trim()||S.pin.length!==4,children:[r.jsx(or,{className:"mr-2 h-4 w-4"}),"Crea Utente"]}),r.jsx(le,{variant:"outline",onClick:()=>{f(!1),N("")},children:"Indietro"})]})]}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"user-select",children:"Seleziona Utente"}),r.jsxs("select",{id:"user-select",value:a,onChange:$=>{o($.target.value),N("")},className:"mt-1 block w-full rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"-- Scegli utente --"}),s.map($=>r.jsxs("option",{value:$.id,children:[$.name," (",$.department,")",$.role==="admin"&&" - Admin"]},$.id))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"pin",children:"PIN (4 cifre)"}),r.jsxs("div",{className:"relative",children:[r.jsx(At,{id:"pin",type:p?"text":"password",value:l,onChange:$=>{const re=$.target.value.replace(/\D/g,"").slice(0,4);c(re),N("")},maxLength:4,placeholder:"••••",className:"pr-10"}),r.jsx(le,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>v(!p),children:p?r.jsx(NN,{className:"h-4 w-4"}):r.jsx(Ep,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"flex gap-3 pt-4",children:[r.jsxs(le,{onClick:H,className:"flex-1",disabled:!a||l.length!==4,children:[r.jsx(RN,{className:"mr-2 h-4 w-4"}),"Entra"]}),r.jsx(le,{variant:"outline",onClick:P,children:"Annulla"})]}),r.jsx("div",{className:"pt-4 border-t",children:r.jsxs(le,{variant:"outline",size:"sm",onClick:()=>f(!0),className:"w-full",children:[r.jsx(or,{className:"mr-2 h-4 w-4"}),"Aggiungi Nuovo Utente"]})})]})]})]})}):null}function P3({activeTab:t,temperatures:e}){const[n,s]=W.useState(!1);W.useEffect(()=>{s(t==="temperature")},[t]);const i=()=>{if(typeof window.jspdf>"u"){alert("Errore: Librerie PDF non caricate. Ricarica la pagina e riprova.");return}if(e.length===0){alert("Nessuna temperatura registrata da esportare.");return}try{const a=["Posizione","Temperatura","Orario"],o=[];e.forEach(v=>{o.push([v.location,`${v.temperature}°C`,v.time])});const{jsPDF:l}=window.jspdf,c=new l;c.setFontSize(18),c.text("Report: Temperature HACCP",14,22),c.setFontSize(12);const d=new Date().toLocaleDateString("it-IT");c.text(`Data esportazione: ${d}`,14,32),c.text(`Totale rilevazioni: ${e.length}`,14,40),c.autoTable({startY:50,head:[a],body:o,theme:"striped",styles:{fontSize:10,cellPadding:3},headStyles:{fillColor:[25,118,210],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},columnStyles:{0:{cellWidth:60},1:{cellWidth:40,halign:"center"},2:{cellWidth:50}}});const f=c.internal.getNumberOfPages();c.setFontSize(8);for(let v=1;v<=f;v++)c.setPage(v),c.text(`Mini-ePackPro HACCP - Pagina ${v} di ${f}`,14,c.internal.pageSize.height-10);const p=`report_Temperature_${new Date().toISOString().slice(0,10)}.pdf`;c.save(p)}catch(a){is("PDF export error:",a),alert("Errore durante l'esportazione del PDF. Riprova.")}};return n?r.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:r.jsxs(le,{onClick:i,className:"bg-primary-500 hover:bg-primary-600 text-white shadow-lg hover:shadow-xl transition-all duration-300 flex items-center gap-2 px-6 py-3 rounded-xl",size:"lg",children:[r.jsx(jN,{className:"h-5 w-5"}),r.jsx("span",{className:"hidden sm:inline",children:"Esporta Temperature in PDF"}),r.jsx("span",{className:"sm:hidden",children:"PDF"})]})}):null}const L3=()=>({"haccp-roles":[],"haccp-suppliers":[],"haccp-onboarding":{currentStep:"preset",completedSteps:[],progress:0,startedAt:new Date().toISOString(),lastActivity:new Date().toISOString()},"haccp-presets":[],"haccp-dev-mode":{enabled:!1,features:[],bypassOnboarding:!1,showDebugInfo:!1,lastToggled:new Date().toISOString()}}),I3=()=>{try{if(new URLSearchParams(window.location.search).get("dev")==="1"){const e={enabled:!0,features:["bypass-onboarding","show-debug-info"],bypassOnboarding:!0,showDebugInfo:!0,lastToggled:new Date().toISOString(),reason:"Attivato via URL parameter"};return localStorage.setItem("haccp-dev-mode",JSON.stringify(e)),console.log("🚀 Dev mode attivato via URL parameter"),!0}}catch(t){console.warn("Errore nell'inizializzazione dev mode:",t)}return!1},Du="haccp-dev-mode",cc=()=>{try{const t=localStorage.getItem(Du);if(t&&t!=="undefined"&&t!=="null"&&t!=="[object Object]"){const e=JSON.parse(t);return e&&typeof e=="object"&&e.enabled===!0}}catch(t){console.warn("Errore nel parsing dev mode:",t),localStorage.removeItem(Du),localStorage.removeItem("haccp-dev-mode"),localStorage.removeItem("haccp-dev-mode-version")}return!1},T3=(t=null,e="")=>{const n=cc(),s=t!==null?t:!n,i={enabled:s,features:s?["bypass-onboarding","show-debug-info"]:[],bypassOnboarding:s,showDebugInfo:s,lastToggled:new Date().toISOString(),reason:e||(s?"Attivato manualmente":"Disattivato manualmente")};try{return localStorage.setItem(Du,JSON.stringify(i)),s&&!n&&window.location.reload(),s}catch(a){return console.error("Errore nel salvataggio dev mode:",a),!1}},l0=()=>{try{const t=localStorage.getItem(Du);if(t&&t!=="undefined"&&t!=="null"){const e=JSON.parse(t);if(e&&typeof e=="object")return e}}catch(t){console.warn("Errore nel parsing dev mode settings:",t),localStorage.removeItem(Du)}return{enabled:!1,features:[],bypassOnboarding:!1,showDebugInfo:!1,lastToggled:null,reason:null}},Zy=t=>cc()?l0().features.includes(t):!1,E3=()=>cc()&&Zy("bypass-onboarding"),z3=()=>cc()&&Zy("show-debug-info"),O3=()=>z3()?{timestamp:new Date().toISOString(),userAgent:navigator.userAgent,localStorage:{keys:Object.keys(localStorage),size:new Blob(Object.values(localStorage)).size},sessionStorage:{keys:Object.keys(sessionStorage),size:new Blob(Object.values(sessionStorage)).size},url:window.location.href,devMode:l0()}:null,D3=()=>{if(!cc())return!1;try{return["haccp-dev-mode","haccp-onboarding","haccp-presets"].forEach(e=>{localStorage.removeItem(e)}),!0}catch(t){return console.error("Errore nella pulizia dati dev:",t),!1}};function Rx(){const[t,e]=W.useState(!1),[n,s]=W.useState(!1),[i,a]=W.useState(!1),[o,l]=W.useState(null);if(W.useEffect(()=>{const v=()=>{const N=cc();e(N),N&&l(l0())};v();const m=N=>{N.key==="haccp-dev-mode"&&v()};return window.addEventListener("storage",m),()=>{window.removeEventListener("storage",m)}},[]),!t)return null;const c=()=>{T3(!1,"Disattivato via banner")},d=async()=>{confirm(`⚠️ ATTENZIONE: Stai per rimuovere tutti i dati di sviluppo.

Questo rimuoverà:
• Modalità dev
• Onboarding
• Preset

I dati HACCP (temperature, pulizie, inventario) NON verranno toccati.

Procedere?`)&&(D3()?(alert(`✅ Dati di sviluppo rimossi con successo!

La modalità dev è stata disattivata.`),window.location.reload()):alert("❌ Errore nella rimozione dei dati di sviluppo"))},f=()=>{window.location.reload()},p=O3();return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-yellow-500 text-yellow-900 px-4 py-2 shadow-lg",children:r.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(xn,{className:"h-5 w-5"}),r.jsx("span",{className:"font-bold",children:"DEV MODE ATTIVO"}),r.jsx("span",{className:"text-sm opacity-75",children:"• Onboarding bypassato • Debug info • Testing features"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>a(!i),className:"p-1 hover:bg-yellow-400 rounded transition-colors",title:"Mostra info debug",children:r.jsx($s,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>s(!n),className:"p-1 hover:bg-yellow-400 rounded transition-colors",title:"Impostazioni dev",children:r.jsx(os,{className:"h-4 w-4"})}),r.jsx("button",{onClick:f,className:"p-1 hover:bg-yellow-400 rounded transition-colors",title:"Ricarica pagina",children:r.jsx(dh,{className:"h-4 w-4"})}),r.jsx("button",{onClick:c,className:"p-1 hover:bg-yellow-400 rounded transition-colors",title:"Disattiva dev mode",children:r.jsx(dn,{className:"h-4 w-4"})})]})]})}),i&&p&&r.jsxs("div",{className:"fixed top-16 left-4 right-4 z-40 bg-white border border-yellow-300 rounded-lg shadow-xl p-4 max-h-96 overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"font-bold text-yellow-800 flex items-center gap-2",children:[r.jsx($s,{className:"h-5 w-5"}),"Debug Info"]}),r.jsx("button",{onClick:()=>a(!1),className:"p-1 hover:bg-gray-100 rounded",children:r.jsx(dn,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"space-y-3 text-sm",children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Timestamp:"})," ",p.timestamp]}),r.jsxs("div",{children:[r.jsx("strong",{children:"URL:"})," ",p.url]}),r.jsxs("div",{children:[r.jsx("strong",{children:"User Agent:"})," ",p.userAgent]}),r.jsxs("div",{children:[r.jsx("strong",{children:"LocalStorage:"})," ",p.localStorage.keys.length," chiavi, ",Math.round(p.localStorage.size/1024)," KB"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"SessionStorage:"})," ",p.sessionStorage.keys.length," chiavi, ",Math.round(p.sessionStorage.size/1024)," KB"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Dev Mode Settings:"}),r.jsx("pre",{className:"mt-1 p-2 bg-gray-100 rounded text-xs overflow-x-auto",children:JSON.stringify(p.devMode,null,2)})]})]})]}),n&&r.jsxs("div",{className:"fixed top-16 left-4 right-4 z-40 bg-white border border-yellow-300 rounded-lg shadow-xl p-4 max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"font-bold text-yellow-800 flex items-center gap-2",children:[r.jsx(os,{className:"h-5 w-5"}),"Impostazioni Dev Mode"]}),r.jsx("button",{onClick:()=>s(!1),className:"p-1 hover:bg-gray-100 rounded",children:r.jsx(dn,{className:"h-4 w-4"})})]}),o&&r.jsxs("div",{className:"space-y-3 text-sm",children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Stato:"}),r.jsx("span",{className:"ml-2 px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:"ATTIVO"})]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Attivato il:"})," ",new Date(o.lastToggled).toLocaleString("it-IT")]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Motivo:"})," ",o.reason]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Features:"}),r.jsx("div",{className:"mt-1 space-y-1",children:o.features.map(v=>r.jsx("div",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:v},v))})]}),r.jsxs("div",{className:"pt-3 border-t",children:[r.jsxs("button",{onClick:d,className:"w-full px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors flex items-center justify-center gap-2",children:[r.jsx(tr,{className:"h-4 w-4"}),"Rimuovi Dati Dev"]}),r.jsx("p",{className:"text-xs text-gray-600 mt-1 text-center",children:"Rimuove solo i dati di sviluppo, mantiene i dati HACCP"})]})]})]}),r.jsx("div",{className:"h-16"})]})}const M3=({currentStep:t,completedSteps:e,onStepClick:n,steps:s})=>{const i=(c,d)=>{(c===0||e.has(d))&&n(c)},a=(c,d)=>c===0||e.has(d),o=c=>e.has(c),l=c=>c===t;return r.jsx("div",{className:"flex items-center justify-center space-x-2 mb-6",children:s.map((c,d)=>{const f=a(d,c.id),p=o(c.id),v=l(d);return r.jsxs("div",{className:"flex items-center",children:[r.jsx("button",{onClick:()=>i(d,c.id),disabled:!f,className:`
                w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium
                transition-all duration-200 ease-in-out
                ${v?"bg-blue-600 text-white shadow-lg scale-110":p?"bg-green-500 text-white hover:bg-green-600 hover:scale-105 cursor-pointer":f?"bg-gray-200 text-gray-600 hover:bg-gray-300 hover:scale-105 cursor-pointer":"bg-gray-100 text-gray-400 cursor-not-allowed"}
                ${f?"hover:shadow-md":""}
              `,title:v?`Step corrente: ${c.title}`:p?`Vai allo step ${d+1}: ${c.title}`:d===0?`Step ${d+1}: ${c.title}`:`Completa gli step precedenti per accedere a: ${c.title}`,children:p?r.jsx(Cn,{className:"h-5 w-5"}):f?d+1:r.jsx(_N,{className:"h-4 w-4"})}),d<s.length-1&&r.jsx("div",{className:`
                  w-8 h-0.5 mx-1
                  ${p?"bg-green-500":"bg-gray-300"}
                `})]},c.id)})})},R3=({formData:t,setFormData:e,currentStep:n,validateStep:s,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{var p,v,m,N,S,k,y,b,j,z;const[c,d]=W.useState(null),f=H=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(H);return W.useEffect(()=>{var Z;const H=((Z=t.business)==null?void 0:Z.email)||"";H.length>0?d(f(H)):d(null)},[(p=t.business)==null?void 0:p.email]),(v=t.business)!=null&&v.companyName&&((m=t.business)!=null&&m.address)&&((N=t.business)!=null&&N.email),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Informazioni Attività"}),r.jsx("p",{className:"text-gray-600",children:"Configura i dati base della tua attività"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"businessName",children:"Nome Attività *"}),r.jsx(At,{id:"businessName",value:((S=t.business)==null?void 0:S.companyName)||"",onChange:H=>e(Z=>({...Z,business:{...Z.business,companyName:H.target.value}})),placeholder:"Es. Pizzeria Bella Napoli",className:"mt-1"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"vatNumber",children:"P.IVA"}),r.jsx(At,{id:"vatNumber",value:((k=t.business)==null?void 0:k.vatNumber)||"",onChange:H=>e(Z=>({...Z,business:{...Z.business,vatNumber:H.target.value}})),placeholder:"11 caratteri max",maxLength:11,className:"mt-1"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx(Ke,{htmlFor:"address",children:"Indirizzo *"}),r.jsxs("div",{className:"flex gap-2 mt-1",children:[r.jsx(At,{id:"address",value:((y=t.business)==null?void 0:y.address)||"",onChange:H=>e(Z=>({...Z,business:{...Z.business,address:H.target.value}})),placeholder:"Via Roma 123, Milano",className:"flex-1"}),r.jsx(le,{variant:"outline",size:"sm",onClick:async()=>{if(navigator.geolocation)try{const H=event.target.closest("button"),Z=H.innerHTML;H.innerHTML='<div class="animate-spin h-4 w-4 border-2 border-blue-600 border-t-transparent rounded-full"></div>',H.disabled=!0;const K=await new Promise((A,C)=>{navigator.geolocation.getCurrentPosition(A,C,{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}),{latitude:P,longitude:$}=K.coords,re=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${P}&lon=${$}&zoom=18&addressdetails=1`);if(re.ok){const A=await re.json();if(A.display_name&&A.address){const C=A.address,R=C.road||"",V=C.house_number||"",ie=C.postcode||"",Q=C.city||C.town||C.village||"",te=C.state||"",L=[R,V,Q,te].filter(Boolean).join(", ");e(Y=>({...Y,business:{...Y.business,address:L,via:R,civico:V,cap:ie,citta:Q,provincia:te,coordinates:{lat:P,lon:$}}})),H.innerHTML='<div class="text-green-600">✓</div>',setTimeout(()=>{H.innerHTML=Z,H.disabled=!1},2e3)}}else throw new Error("Errore nel reverse geocoding")}catch(H){is("Errore geolocalizzazione:",H),alert("Errore nella geolocalizzazione: "+H.message);const Z=event.target.closest("button");Z.innerHTML=originalContent,Z.disabled=!1}else alert("Geolocalizzazione non supportata dal browser")},children:r.jsx(PN,{className:"h-4 w-4"})})]}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"💡 Clicca il pulsante GPS per rilevare automaticamente la tua posizione e compilare l'indirizzo"}),((b=t.business)==null?void 0:b.address)&&r.jsx("div",{className:"space-y-2 mt-2",children:r.jsxs("div",{className:"flex items-start gap-2 p-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:[r.jsx("div",{className:"text-yellow-600 mt-0.5",children:"⚠️"}),r.jsxs("div",{className:"text-sm text-yellow-800",children:[r.jsx("p",{className:"font-medium",children:"Verifica il numero civico!"}),r.jsx("p",{className:"text-sm mt-1",children:"La geolocalizzazione ha un margine di errore di 5-15 metri. Controlla che il numero civico sia corretto e modificalo se necessario."})]})]})})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"phone",children:"Telefono"}),r.jsx(At,{id:"phone",value:((j=t.business)==null?void 0:j.phone)||"",onChange:H=>e(Z=>({...Z,business:{...Z.business,phone:H.target.value}})),placeholder:"+39 123 456 7890",className:"mt-1"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"email",children:"Email *"}),r.jsxs("div",{className:"relative mt-1",children:[r.jsx(At,{id:"email",type:"email",value:((z=t.business)==null?void 0:z.email)||"",onChange:H=>e(Z=>({...Z,business:{...Z.business,email:H.target.value}})),placeholder:"info@pizzeria.it",className:`pr-10 ${c===!0?"border-green-500 focus:border-green-500 focus:ring-green-500":c===!1?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300"}`}),c===!0&&r.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:r.jsx(Cn,{className:"h-5 w-5 text-green-500"})}),c===!1&&r.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:r.jsx(iy,{className:"h-5 w-5 text-red-500"})})]}),c===!1&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Inserisci un indirizzo email valido (es. info@pizzeria.it)"})]})]}),r.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx($s,{className:"h-5 w-5 text-blue-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-blue-900",children:"Campi Obbligatori"}),r.jsx("p",{className:"text-sm text-blue-800 mt-1",children:'Vengono indicati con asterisco " * "'})]})]})})]})},F3=({formData:t,setFormData:e,currentStep:n,validateStep:s,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{const[c,d]=W.useState(""),[f,p]=W.useState([{id:"cucina",name:"Cucina",enabled:!0,isCustom:!1,required:!1},{id:"bancone",name:"Bancone",enabled:!0,isCustom:!1,required:!1},{id:"sala",name:"Sala",enabled:!0,isCustom:!1,required:!1},{id:"magazzino",name:"Magazzino",enabled:!0,isCustom:!1,required:!1}]);W.useEffect(()=>{var y;if((y=t.departments)!=null&&y.list&&t.departments.list.length>0){const b=t.departments.list,z=[{id:"cucina",name:"Cucina",enabled:!0,isCustom:!1,required:!1},{id:"bancone",name:"Bancone",enabled:!0,isCustom:!1,required:!1},{id:"sala",name:"Sala",enabled:!0,isCustom:!1,required:!1},{id:"magazzino",name:"Magazzino",enabled:!0,isCustom:!1,required:!1}].map(Z=>{const K=b.find(P=>P.id===Z.id);return K?{...K,required:!1}:Z}),H=b.filter(Z=>Z.isCustom);p([...z,...H])}},[]);const v=y=>{p(b=>b.map(j=>j.id===y?{...j,enabled:!j.enabled}:j))},m=()=>{if(c.trim()){const y={id:`custom-${Date.now()}`,name:c.trim(),enabled:!0,isCustom:!0};p(b=>[...b,y]),d("")}},N=y=>{p(b=>b.filter(j=>j.id!==y))},S=f.filter(y=>y.enabled).length,k=S>0;return W.useEffect(()=>{e(y=>({...y,departments:{list:f,enabledCount:S}}))},[f,S,e]),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Reparti"}),r.jsx("p",{className:"text-gray-600",children:"Organizza la struttura operativa della tua attività"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:"Reparti Standard"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:f.filter(y=>!y.isCustom&&y&&y.id&&y.name&&typeof y.name=="string").map(y=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsx("span",{className:"font-medium",children:y.name||"Nome non disponibile"}),r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:y.enabled,onChange:()=>v(y.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-600",children:y.enabled?"Attivo":"Inattivo"})]})]},y.id))})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:"Aggiungi Reparto Personalizzato"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(At,{value:c,onChange:y=>d(y.target.value),placeholder:"Nome del nuovo reparto",className:"flex-1"}),r.jsxs(le,{onClick:m,disabled:!c.trim(),variant:"outline",size:"sm",children:[r.jsx(or,{className:"h-4 w-4 mr-1"}),"Aggiungi"]})]})]}),f.filter(y=>y.isCustom).length>0&&r.jsxs("div",{className:"space-y-3",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:"Reparti Personalizzati"}),f.filter(y=>y.isCustom&&y&&y.id&&y.name&&typeof y.name=="string").map(y=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-gray-50",children:[r.jsx("span",{className:"font-medium",children:y.name||"Nome non disponibile"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:y.enabled,onChange:()=>v(y.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-600",children:y.enabled?"Attivo":"Inattivo"})]}),r.jsx(le,{onClick:()=>N(y.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:r.jsx(dn,{className:"h-4 w-4"})})]})]},y.id))]}),r.jsx("div",{className:`p-4 rounded-lg ${k?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${k?"bg-green-500":"bg-yellow-500"} text-white text-sm font-bold`,children:S}),r.jsxs("div",{children:[k&&r.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),r.jsxs("p",{className:`font-medium ${k?"text-green-900":"text-yellow-900"}`,children:["Reparti attivi: ",S]}),r.jsx("p",{className:`text-sm ${k?"text-green-800":"text-yellow-800"}`,children:k?"✅ Requisito soddisfatto! Puoi procedere.":"⚠️ Devi attivare almeno 1 reparto per continuare."})]})]})})]})},B3=({formData:t,setFormData:e,currentStep:n,setCurrentStep:s,validateStep:i,confirmStep:a,markStepAsUnconfirmed:o,isStepConfirmed:l,canConfirmStep:c})=>{var te;const[d,f]=W.useState(((te=t.staff)==null?void 0:te.staffMembers)||[]),[p,v]=W.useState(!1),[m,N]=W.useState(null),{formRef:S,scrollToForm:k}=Ja(p,"staff-add-form");W.useEffect(()=>{p&&k()},[p,k]);const[y,b]=W.useState({}),[j,z]=W.useState({name:"",surname:"",role:"",categories:[""],haccpExpiry:""});W.useEffect(()=>{var L;(L=t.staff)!=null&&L.staffMembers&&t.staff.staffMembers.length>0&&f(t.staff.staffMembers)},[t.staff]);const H=["Amministratore","Responsabile","Dipendente","Collaboratore Occasionale / Part-time"],Z=["Cuochi","Banconisti","Camerieri","Social & Media Manager","Amministratore","Altro"],K=()=>{z({name:"",surname:"",role:"",categories:[""],haccpExpiry:""}),N(null)},P=L=>L.some(Y=>Y!=="Social & Media Manager"&&Y!=="Altro"),$=()=>{z(L=>({...L,categories:[...L.categories,""]}))},re=L=>{j.categories.length>1&&z(Y=>({...Y,categories:Y.categories.filter((G,ce)=>ce!==L)}))},A=(L,Y)=>{z(G=>({...G,categories:G.categories.map((ce,_)=>_===L?Y:ce)}))},C=()=>{const L=[...new Set(j.categories.filter(Y=>Y.trim()))];if(j.name&&j.surname&&j.role&&L.length>0){const Y={id:Date.now(),name:j.name,surname:j.surname,role:j.role,categories:L,primaryCategory:L[0],fullName:`${j.name} ${j.surname}`,haccpExpiry:P(L)&&j.haccpExpiry?j.haccpExpiry:""},G=[...d,Y];f(G),e(ce=>({...ce,staff:{...ce.staff,staffMembers:G}})),l(n)&&o(n),K(),v(!1),b({})}},R=L=>{z({name:L.name,surname:L.surname,role:L.role||"",categories:L.categories&&L.categories.length>0?L.categories:[L.category||""],haccpExpiry:L.haccpExpiry}),N(L),v(!0)},V=()=>{const L=[...new Set(j.categories.filter(Y=>Y.trim()))];if(j.name&&j.surname&&j.role&&L.length>0){const Y=d.map(G=>G.id===m.id?{...G,name:j.name,surname:j.surname,role:j.role,categories:L,primaryCategory:L[0],fullName:`${j.name} ${j.surname}`,haccpExpiry:P(L)&&j.haccpExpiry?j.haccpExpiry:""}:G);f(Y),e(G=>({...G,staff:{...G.staff,staffMembers:Y}})),l(n)&&o(n),K(),v(!1),b({})}},ie=L=>{const Y=d.filter(G=>G.id!==L);f(Y),e(G=>({...G,staff:{...G.staff,staffMembers:Y}})),l(n)&&o(n),b({})},Q=()=>d.length===0?!1:d.every(L=>L.fullName&&L.fullName.trim().length>=3&&L.role&&(L.categories&&L.categories.length>0||L.category));return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Staff e Ruoli"}),r.jsx("p",{className:"text-gray-600",children:"Registra il personale e assegna responsabilità"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:"Membri dello Staff"}),r.jsxs(le,{onClick:()=>v(!0),variant:"outline",size:"sm",children:[r.jsx(or,{className:"h-4 w-4 mr-1"}),"Aggiungi Staff"]})]}),d.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("p",{children:"Nessun membro dello staff registrato"}),r.jsx("p",{className:"text-sm",children:'Clicca "Aggiungi Staff" per iniziare'})]}):r.jsx("div",{className:"space-y-3",children:d.map((L,Y)=>r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-gray-50",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:L.fullName||"Nome non disponibile"}),r.jsx("p",{className:"text-sm text-gray-600",children:L.role}),r.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(L.categories&&L.categories.length>0?L.categories:[L.category||"Non assegnato"]).map((G,ce)=>r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:G},ce))})]}),L.haccpExpiry&&r.jsxs("div",{className:"text-sm text-gray-600",children:["HACCP: ",L.haccpExpiry]})]})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{onClick:()=>R(L),variant:"outline",size:"sm",children:r.jsx(ci,{className:"h-4 w-4"})}),r.jsx(le,{onClick:()=>ie(L.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:r.jsx(tr,{className:"h-4 w-4"})})]})]}),(y[`staff_${Y}_name`]||y[`staff_${Y}_role`]||y[`staff_${Y}_category`])&&r.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"text-sm text-red-800",children:[y[`staff_${Y}_name`]&&r.jsxs("p",{children:["• ",y[`staff_${Y}_name`]]}),y[`staff_${Y}_role`]&&r.jsxs("p",{children:["• ",y[`staff_${Y}_role`]]}),y[`staff_${Y}_category`]&&r.jsxs("p",{children:["• ",y[`staff_${Y}_category`]]})]})})]},L.id))})]}),p&&r.jsxs("div",{ref:S,id:"staff-add-form",className:"border rounded-lg p-4 bg-white",children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:m?"Modifica Membro":"Aggiungi Nuovo Membro"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"name",children:"Nome *"}),r.jsx(At,{id:"name",value:j.name,onChange:L=>z(Y=>({...Y,name:L.target.value})),placeholder:"Nome",className:"mt-1"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"surname",children:"Cognome *"}),r.jsx(At,{id:"surname",value:j.surname,onChange:L=>z(Y=>({...Y,surname:L.target.value})),placeholder:"Cognome",className:"mt-1"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"role",children:"Ruolo *"}),r.jsxs("select",{id:"role",value:j.role,onChange:L=>z(Y=>({...Y,role:L.target.value})),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Seleziona ruolo"}),H.map(L=>r.jsx("option",{value:L,children:L},L))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"categories",children:"Categorie *"}),r.jsxs("div",{className:"space-y-2",children:[j.categories.map((L,Y)=>r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsxs("select",{value:L,onChange:G=>A(Y,G.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:Y===0,children:[r.jsx("option",{value:"",children:"Seleziona una categoria..."}),Z.map(G=>r.jsx("option",{value:G,children:G},G))]}),j.categories.length>1&&r.jsx(le,{type:"button",onClick:()=>re(Y),variant:"outline",size:"sm",className:"h-10 w-10 p-0 text-red-600 hover:text-red-800",children:"✕"})]},Y)),r.jsx(le,{type:"button",onClick:$,variant:"outline",size:"sm",className:"w-full",children:"+ Aggiungi Categoria"})]})]}),P(j.categories)&&r.jsxs("div",{className:"md:col-span-2",children:[r.jsx(Ke,{htmlFor:"haccpExpiry",children:"Scadenza Attestato HACCP"}),r.jsx(At,{id:"haccpExpiry",type:"date",value:j.haccpExpiry,onChange:L=>z(Y=>({...Y,haccpExpiry:L.target.value})),className:"mt-1"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(le,{variant:"outline",onClick:()=>{v(!1),K()},children:"Annulla"}),r.jsx(le,{onClick:m?V:C,disabled:!j.name||!j.surname||!j.role||j.categories.every(L=>!L.trim()),children:m?"Aggiorna":"Aggiungi"})]})]}),r.jsx("div",{className:`p-4 rounded-lg ${l(n)?"bg-green-50 border border-green-200":Q()?"bg-blue-50 border border-blue-200":"bg-yellow-50 border border-yellow-200"}`,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${l(n)?"bg-green-500":Q()?"bg-blue-500":"bg-yellow-500"} text-white text-sm font-bold`,children:d.length}),r.jsxs("div",{children:[l(n)&&r.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),r.jsxs("p",{className:`font-medium ${l(n)?"text-green-900":Q()?"text-blue-900":"text-yellow-900"}`,children:["Membri registrati: ",d.length]}),r.jsx("p",{className:`text-sm ${l(n)?"text-green-800":Q()?"text-blue-800":"text-yellow-800"}`,children:l(n)?"✅ Step confermato! Puoi procedere al prossimo step.":Q()?'🔵 Dati validi! Clicca "Conferma Dati Staff" per confermare.':"⚠️ Devi registrare almeno un membro con tutti i campi obbligatori."})]})]})}),y.staff&&r.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"text-sm text-red-800",children:[r.jsx("p",{className:"font-medium",children:"❌ Errore generale:"}),r.jsxs("p",{children:["• ",y.staff]})]})})]})},$3=({formData:t,setFormData:e,currentStep:n,validateStep:s,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{var ie,Q;const[c,d]=W.useState([]),[f,p]=W.useState(!1),[v,m]=W.useState(null),{formRef:N,scrollToForm:S}=Ja(f,"conservation-step-form");W.useEffect(()=>{f&&S()},[f,S]);const[k,y]=W.useState({}),[b,j]=W.useState({name:"",location:"",targetTemp:"",selectedCategories:[],isAbbattitore:!1}),z=((ie=t.departments)==null?void 0:ie.list)||[];(Q=t.staff)!=null&&Q.staffMembers,Se("🔍 ConservationStep - formData:",t),Se("🔍 ConservationStep - departments:",z);const H=z.length>0?z.filter(te=>te&&te.enabled).map(te=>te.name||te):["Cucina","Bancone","Sala","Magazzino"];Se("🔍 ConservationStep - availableDepartments:",H),W.useEffect(()=>{var te;if((te=t.conservation)!=null&&te.points&&t.conservation.points.length>0){const L=t.conservation.points.map(Y=>Y.targetTemp&&Y.selectedCategories&&Y.selectedCategories.length>0?{...Y,compliance:K(Y.targetTemp,Y.selectedCategories)}:Y);d(L)}},[t.conservation]);const Z=()=>{j({name:"",location:"",targetTemp:"",selectedCategories:[],isAbbattitore:!1}),m(null)},K=(te,L=[])=>{const Y=parseFloat(te);if(isNaN(Y))return{compliant:!1,message:"Temperatura non valida",type:"error"};if(L.length>0){const G=Vr.tolerance;let ce=!1;for(let I=0;I<L.length;I++){for(let q=I+1;q<L.length;q++){const oe=Vr.categories.find(ge=>ge.id===L[I]),fe=Vr.categories.find(ge=>ge.id===L[q]);if(oe&&fe){const ge=oe.minTemp-G,Te=oe.maxTemp+G,Ee=fe.minTemp-G,Fe=fe.maxTemp+G;if(Te<Ee||Fe<ge){ce=!0;break}}}if(ce)break}if(ce)return{compliant:!1,message:"❌ Categorie incompatibili selezionate",type:"error",color:"red"};let _=!0,J=!0,M=[];for(const I of L){const q=Vr.categories.find(oe=>oe.id===I);if(q){const oe=Y>=q.minTemp&&Y<=q.maxTemp,fe=q.minTemp-G,ge=q.maxTemp+G,Te=Y>=fe&&Y<=ge;oe||(_=!1,Te||(J=!1,M.push(q.name)))}}return _?{compliant:!0,message:"✅ Valore temperatura valido per tutte le categorie",type:"compliant",color:"green"}:J?{compliant:!0,message:"Temperatura impostata entro i limiti accettabili (0,5°C di differenza) per tutte le categorie",type:"warning",color:"yellow"}:{compliant:!1,message:`❌ Fuori range HACCP per: ${M.join(", ")}`,type:"error",color:"red"}}return Y<-30||Y>80?{compliant:!1,message:"Range temperatura fuori limiti operativi",type:"error",color:"red"}:{compliant:!0,message:"✅ Valore temperatura valido",type:"compliant",color:"green"}},P=te=>{if(!te.selectedCategories||te.selectedCategories.length===0)return null;const L=parseFloat(te.targetTemp);if(isNaN(L))return null;const Y=Vr.categories.find(I=>I.id===te.selectedCategories[0]);if(!Y)return null;const G=Vr.tolerance,ce=Y.minTemp,_=Y.maxTemp,J=ce-G,M=_+G;if(L>=ce&&L<=_)return null;if(L>=J&&L<=M){const I=(ce+_)/2;return L<I?`Aumenta la temperatura verso ${I.toFixed(1)}°C per ottimizzare la conservazione`:`Diminuisci la temperatura verso ${I.toFixed(1)}°C per ottimizzare la conservazione`}return L<J?`Aumenta la temperatura al range ottimale ${ce}-${_}°C`:L>M?`Diminuisci la temperatura al range ottimale ${ce}-${_}°C`:null},$=()=>{if(b.name&&b.location&&b.targetTemp&&b.selectedCategories.length>0){let te=b.selectedCategories||[];if(b.isAbbattitore){const G=["abbattitore_menu","abbattitore_esposizione"];te=[...te,...G]}const L=K(b.targetTemp,te),Y={...b,selectedCategories:te,compliance:L};if(v){const G=c.map(ce=>ce.id===v?{...ce,...Y}:ce);d(G),e(ce=>({...ce,conservation:{points:G,count:G.length}}))}else{const G={id:Date.now(),...Y},ce=[...c,G];d(ce),e(_=>({..._,conservation:{points:ce,count:ce.length}}))}Z(),p(!1),a(n)}},re=te=>{const L=c.filter(Y=>Y.id!==te);Se("🗑️ ConservationStep - Eliminando punto:",{pointId:te,pointsBefore:c.length,pointsAfter:L.length}),d(L),e(Y=>({...Y,conservation:{points:L,count:L.length}})),a(n),Se("🔄 ConservationStep - Validazione dopo eliminazione:",{remainingPoints:L.length,hasNonCompliant:L.some(Y=>!C(Y)),canProceed:L.length>0&&L.every(Y=>Y.name&&Y.location&&Y.targetTemp&&Y.selectedCategories&&Y.selectedCategories.length>0)&&!L.some(Y=>!C(Y))})},A=te=>{const L=c.find(Y=>Y.id===te);L&&(j({name:L.name,location:L.location,targetTemp:L.targetTemp,selectedCategories:L.selectedCategories||[],isAbbattitore:L.isAbbattitore||!1}),m(te),p(!0))},C=te=>!te.targetTemp||!te.selectedCategories||te.selectedCategories.length===0?!1:K(te.targetTemp,te.selectedCategories).compliant,R=c.some(te=>!C(te)),V=c.length>0&&c.every(te=>te.name&&te.location&&te.targetTemp&&te.selectedCategories&&te.selectedCategories.length>0)&&!R;return W.useEffect(()=>{Se("🔄 ConservationStep - Punti aggiornati, ricalcolo validazione:",{pointsCount:c.length,hasNonCompliant:R,canProceed:V})},[c,R,V]),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Punti di Conservazione"}),r.jsx("p",{className:"text-gray-600",children:"Configura frigoriferi e aree di stoccaggio"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:"Punti di Conservazione"}),r.jsxs(le,{onClick:()=>{Se("🔄 Pulsante Aggiungi cliccato");try{Z(),p(!0),Se("✅ Form resettato e showAddForm impostato a true")}catch(te){is("❌ Errore nel pulsante Aggiungi:",te)}},variant:"outline",size:"sm",className:"flex items-center gap-2 px-3 py-2 text-sm font-medium whitespace-nowrap min-w-fit",children:[r.jsx(or,{className:"h-4 w-4 flex-shrink-0"}),r.jsx("span",{className:"hidden sm:inline",children:"Aggiungi Nuovo Punto di Conservazione"}),r.jsx("span",{className:"sm:hidden",children:"Aggiungi Punto"})]})]}),f&&r.jsxs("div",{ref:N,id:"conservation-step-form",className:"border rounded-lg p-4 bg-white mb-6",children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:v?"Modifica Punto di Conservazione":"Aggiungi Nuovo Punto di Conservazione"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"name",children:"Nome Punto di Conservazione *"}),r.jsx(At,{id:"name",value:b.name,onChange:te=>{j(L=>({...L,name:te.target.value})),a(n)},placeholder:"Es. Frigo A, Freezer, Abbattitore",className:"mt-1"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"location",children:"Luogo *"}),r.jsxs("select",{id:"location",value:b.location,onChange:te=>{j(L=>({...L,location:te.target.value})),a(n)},className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Seleziona reparto"}),H.map(te=>r.jsx("option",{value:te,children:te},te))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"targetTemp",children:"Temperatura Punto di Conservazione (°C) *"}),r.jsx(At,{id:"targetTemp",type:"number",min:"-30",max:"80",step:"0.1",value:b.targetTemp,onChange:te=>{j(L=>({...L,targetTemp:te.target.value})),a(n)},placeholder:"4",className:"mt-1"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx(Ke,{children:"Categorie Prodotti *"}),r.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-3 gap-2",children:Vr.categories.map(te=>r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:b.selectedCategories.includes(te.id),onChange:L=>{const Y=L.target.checked?[...b.selectedCategories,te.id]:b.selectedCategories.filter(G=>G!==te.id);j(G=>({...G,selectedCategories:Y})),a(n)},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),r.jsxs("span",{className:"text-sm",children:[te.icon," ",te.name]})]},te.id))})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(le,{variant:"outline",onClick:()=>{p(!1),m(null),j({name:"",location:"",targetTemp:"",selectedCategories:[],isAbbattitore:!1})},children:"Annulla"}),r.jsx(le,{onClick:$,disabled:!b.name||!b.location||!b.targetTemp||b.selectedCategories.length===0,children:v?"Salva Modifiche":"Aggiungi Punto"})]})]}),c.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(ds,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"Nessun punto di conservazione configurato"}),r.jsx("p",{className:"text-sm",children:'Clicca "Aggiungi Nuovo Punto di Conservazione" per iniziare'})]}):r.jsx("div",{className:"space-y-3",children:c.map(te=>{var L,Y,G,ce,_;return r.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[r.jsx("h5",{className:"font-medium",children:te.name||"Nome non disponibile"}),r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:te.location})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Temperatura:"}),r.jsxs("p",{className:"font-medium",children:[te.targetTemp,"°C"]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"HACCP:"}),r.jsxs("div",{className:`flex items-center gap-1 ${((L=te.compliance)==null?void 0:L.type)==="compliant"?"text-green-600":((Y=te.compliance)==null?void 0:Y.type)==="warning"?"text-yellow-600":"text-red-600"}`,children:[((G=te.compliance)==null?void 0:G.type)==="compliant"?"✅":((ce=te.compliance)==null?void 0:ce.type)==="warning"?"⚠️":"❌",r.jsx("span",{className:"text-xs",children:((_=te.compliance)==null?void 0:_.message)||"Non validato"})]})]})]}),te.selectedCategories&&te.selectedCategories.length>0&&r.jsxs("div",{className:"mt-2",children:[r.jsx("span",{className:"text-gray-600 text-sm",children:"Categorie:"}),r.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:te.selectedCategories.map(J=>{const M=Vr.categories.find(I=>I.id===J);return M?r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:M.name||"Categoria non disponibile"},J):null})})]}),(()=>{const J=P(te);return J?r.jsxs("div",{className:"mt-2",children:[r.jsx("span",{className:"text-gray-600 text-sm",children:"Suggerimenti:"}),r.jsx("div",{className:"mt-1 p-2 bg-blue-50 border border-blue-200 rounded text-sm text-blue-700",children:J})]}):null})()]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{onClick:()=>A(te.id),variant:"outline",size:"sm",className:"text-blue-600 hover:text-blue-700",children:r.jsx(ci,{className:"h-4 w-4"})}),r.jsx(le,{onClick:()=>re(te.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:r.jsx(dn,{className:"h-4 w-4"})})]})]})},te.id)})})]}),r.jsx("div",{className:`p-4 rounded-lg ${V?"bg-green-50 border border-green-200":R?"bg-red-50 border border-red-200":"bg-yellow-50 border border-yellow-200"}`,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${V?"bg-green-500":R?"bg-red-500":"bg-yellow-500"} text-white text-sm font-bold`,children:c.length}),r.jsxs("div",{children:[V&&r.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),r.jsxs("p",{className:`font-medium ${V?"text-green-900":R?"text-red-900":"text-yellow-900"}`,children:["Punti configurati: ",c.length]}),r.jsx("p",{className:`text-sm ${V?"text-green-800":"text-red-800"}`,children:V?"✅ Tutti i punti di conservazione sono HACCP compliant! Puoi procedere al prossimo step.":R?"❌ Non puoi procedere: alcuni punti di conservazione non rispettano i range di temperatura per TUTTE le categorie selezionate. Correggi le temperature o rimuovi le categorie incompatibili.":"⚠️ Devi configurare almeno un punto di conservazione con tutti i campi obbligatori."})]})]})}),Object.keys(k).length>0&&r.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"text-sm text-red-800",children:[r.jsx("p",{className:"font-medium",children:"❌ Errori di validazione:"}),Object.entries(k).map(([te,L])=>r.jsxs("p",{children:["• ",L]},te))]})})]})},q3=t=>!t||t.length===0?[]:[...new Set(t.map(n=>n.role).filter(Boolean))].map(n=>({value:n.toLowerCase().replace(/\s+/g,"_"),label:n})),U3=(t,e=null)=>{if(!t||t.length===0)return[];let n=t;if(e){const i=e.toLowerCase().replace(/\s+/g,"_");n=t.filter(a=>{var l;return((l=a.role)==null?void 0:l.toLowerCase().replace(/\s+/g,"_"))===i})}return[...new Set(n.flatMap(i=>i.categories||[]).filter(Boolean))].map(i=>({value:i.toLowerCase().replace(/\s+/g,"_"),label:i}))},H3=(t,e=null,n=null)=>{if(!t||t.length===0)return[];let s=t;if(e){const i=e.toLowerCase().replace(/\s+/g,"_");s=s.filter(a=>{var l;return((l=a.role)==null?void 0:l.toLowerCase().replace(/\s+/g,"_"))===i})}if(n){const i=n.toLowerCase().replace(/\s+/g,"_");s=s.filter(a=>a.categories&&a.categories.some(o=>(o==null?void 0:o.toLowerCase().replace(/\s+/g,"_"))===i))}return s},e5=Da.forwardRef(({conservationPoint:t,staffMembers:e=[],onSave:n,onCancel:s,isOpen:i=!1,existingData:a=null},o)=>{const[l,c]=W.useState({[Gt.TEMPERATURE_MONITORING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[Gt.SANITIZATION]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[Gt.DEFROSTING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]}}),[d,f]=W.useState({[Gt.TEMPERATURE_MONITORING]:!1,[Gt.SANITIZATION]:!1,[Gt.DEFROSTING]:!1}),[p,v]=W.useState({}),[m,N]=W.useState(!1);Se("🔍 MaintenanceForm - Available data:",{staffMembers:e.length}),W.useEffect(()=>{var P,$;i&&(Se("🔍 MaintenanceForm opened with data:",{conservationPoint:t,staffMembers:e.length,staffMembersData:e,existingData:a}),a?(Se("📝 Caricamento dati esistenti per modifica"),c(a),f({[Gt.TEMPERATURE_MONITORING]:((P=a[Gt.TEMPERATURE_MONITORING])==null?void 0:P.frequency)==="custom_days",[Gt.SANITIZATION]:(($=a[Gt.SANITIZATION])==null?void 0:$.frequency)==="custom_days",[Gt.DEFROSTING]:!1})):(Se("🆕 Reset per nuovo punto di conservazione"),c({[Gt.TEMPERATURE_MONITORING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[Gt.SANITIZATION]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[Gt.DEFROSTING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]}}),f({[Gt.TEMPERATURE_MONITORING]:!1,[Gt.SANITIZATION]:!1,[Gt.DEFROSTING]:!1})),v({}))},[i,t,e,a]);const S=(P,$,re)=>{xl(`🔄 updateMaintenanceField: ${P}.${$} = ${re}`),c(A=>{const R={...A[P],[$]:re};return $==="frequency"?R.selected_days=[]:$==="assigned_role"?(R.assigned_category="",R.assigned_staff_ids=[]):$==="assigned_category"&&(R.assigned_staff_ids=[]),{...A,[P]:R}})},k=(P,$)=>{c(re=>{const A=re[P].assigned_staff_ids||[],C=A.includes($)?A.filter(R=>R!==$):[...A,$];return{...re,[P]:{...re[P],assigned_staff_ids:C}}})},y=P=>{f($=>({...$,[P]:!$[P]})),c($=>({...$,[P]:{...$[P],frequency:"",selected_days:[]}}))},b=(P,$)=>{c(re=>{const A=re[P].selected_days||[],R=A.includes($)?A.filter(V=>V!==$):[...A,$];return{...re,[P]:{...re[P],selected_days:R,frequency:R.length>0?"custom_days":""}}})},j=P=>{const $=l[P],re=$.assigned_role,A=$.assigned_category;if(!re&&!A)return Se("🔍 getFilteredStaff Debug: Mostrando tutti i dipendenti"),e;const C=H3(e,re,A);return Se("🔍 getFilteredStaff Debug:",{taskType:P,role:re,category:A,filteredCount:C.length,filtered:C.map(R=>`${R.name} ${R.surname}`)}),C},z=()=>{const P={};return Object.values(Gt).forEach($=>{const re=l[$],A=WN($,re);A.isValid||(P[$]=A.errors)}),v(P),Object.keys(P).length===0},H=async()=>{if(z()){N(!0);try{const P=Object.values(Gt).map($=>{const re=l[$];return{id:`${t.id}_${$}_${Date.now()}`,conservation_point_id:t.id,conservation_point_name:t.name,task_type:$,task_name:X1($),frequency:re.frequency,selected_days:re.selected_days||[],assigned_role:re.assigned_role,assigned_category:re.assigned_category,assigned_staff_ids:re.assigned_staff_ids||[],is_active:!0,created_at:new Date().toISOString()}});await n(P)}catch(P){is("Errore durante il salvataggio:",P)}finally{N(!1)}}},Z=P=>{switch(P){case Gt.TEMPERATURE_MONITORING:return r.jsx(ds,{className:"w-5 h-5 text-blue-500"});case Gt.SANITIZATION:return r.jsx(wN,{className:"w-5 h-5 text-green-500"});case Gt.DEFROSTING:return r.jsx(ON,{className:"w-5 h-5 text-cyan-500"});default:return r.jsx(xn,{className:"w-5 h-5 text-gray-500"})}},K=P=>{const $=l[P],re=p[P]||[],A=JN(P),C=q3(e),R=U3(e,$.assigned_role),V=j(P);return r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[Z(P),r.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:X1(P)}),re.length===0&&$.frequency&&$.assigned_role&&$.assigned_category&&r.jsx(Cn,{className:"w-5 h-5 text-green-500"})]}),re.length>0&&r.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(xn,{className:"w-4 h-4 text-red-500"}),r.jsx("span",{className:"text-sm text-red-700 font-medium",children:"Configurazione incompleta"})]}),r.jsx("ul",{className:"mt-2 text-sm text-red-600",children:re.map((ie,Q)=>r.jsxs("li",{children:["• ",ie]},Q))})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx(Ke,{htmlFor:`${P}-frequency`,className:"text-sm font-medium text-gray-700",children:"Frequenza *"}),(P===Gt.SANITIZATION||P===Gt.TEMPERATURE_MONITORING)&&r.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[r.jsx("input",{type:"checkbox",id:`${P}-custom-days`,checked:d[P],onChange:()=>y(P),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("label",{htmlFor:`${P}-custom-days`,className:"cursor-pointer",children:"Seleziona giorni della settimana"})]})]}),d[P]?r.jsxs("div",{className:"mt-1 border border-gray-300 rounded-md p-3 bg-gray-50",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Seleziona i giorni:"}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:VN.map(ie=>{var Q;return r.jsxs("label",{className:"flex items-center space-x-2 text-base",children:[r.jsx("input",{type:"checkbox",checked:((Q=$.selected_days)==null?void 0:Q.includes(ie.value))||!1,onChange:()=>b(P,ie.value),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"text-gray-700 font-medium",children:ie.label})]},ie.value)})}),$.selected_days&&$.selected_days.length>0&&r.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:["Giorni selezionati: ",$.selected_days.length]})]}):r.jsxs("select",{id:`${P}-frequency`,value:$.frequency,onChange:ie=>S(P,"frequency",ie.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Seleziona frequenza"}),A.map(ie=>r.jsx("option",{value:ie.value,children:ie.label},ie.value))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:`${P}-role`,className:"text-sm font-medium text-gray-700",children:"Ruolo *"}),r.jsxs("select",{id:`${P}-role`,value:$.assigned_role,onChange:ie=>S(P,"assigned_role",ie.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Seleziona ruolo"}),C.map(ie=>r.jsx("option",{value:ie.value,children:ie.label},ie.value))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:`${P}-category`,className:"text-sm font-medium text-gray-700",children:"Categoria (Opzionale)"}),r.jsxs("select",{id:`${P}-category`,value:$.assigned_category,onChange:ie=>S(P,"assigned_category",ie.target.value),disabled:!$.assigned_role,className:`mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${$.assigned_role?"":"bg-gray-100 cursor-not-allowed"}`,children:[r.jsx("option",{value:"",children:$.assigned_role?"Seleziona categoria":"Prima seleziona ruolo"}),R.map(ie=>r.jsx("option",{value:ie.value,children:ie.label},ie.value))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{className:"text-sm font-medium text-gray-700",children:"Dipendenti Specifici *"}),V.length>0?r.jsx("div",{className:"mt-2 max-h-32 overflow-y-auto border border-gray-200 rounded-md p-2 bg-white",children:V.map(ie=>{var Q;return r.jsxs("label",{className:"flex items-center gap-2 p-1 hover:bg-gray-50 rounded",children:[r.jsx("input",{type:"checkbox",checked:((Q=$.assigned_staff_ids)==null?void 0:Q.includes(ie.id))||!1,onChange:()=>k(P,ie.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsxs("span",{className:"text-sm text-gray-700",children:[ie.name," ",ie.surname]})]},ie.id)})}):r.jsx("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-md",children:r.jsx("p",{className:"text-sm text-gray-500",children:$.assigned_role&&$.assigned_category?"Nessun dipendente trovato per la combinazione ruolo/categoria selezionata":"Seleziona ruolo e categoria per filtrare i dipendenti, oppure seleziona direttamente i dipendenti"})})]})]})]},P)};return i?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{ref:o,id:"tasks-maintenance-form",className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Configura Manutenzione"}),r.jsxs("p",{className:"text-2xl text-gray-700",children:["Punto di Conservazione: ",r.jsx("span",{className:"font-bold text-blue-600",children:t==null?void 0:t.name})]})]}),r.jsx("div",{className:"absolute top-4 right-4",children:r.jsx(le,{onClick:s,variant:"outline",size:"sm",className:"p-2",children:r.jsx(dn,{className:"w-4 h-4"})})}),r.jsxs("div",{className:"space-y-6",children:[K(Gt.TEMPERATURE_MONITORING),K(Gt.SANITIZATION),K(Gt.DEFROSTING),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(xn,{className:"w-5 h-5 text-blue-600"}),r.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:"Manutenzione Obbligatoria"})]}),r.jsxs("p",{className:"text-sm text-blue-700",children:["Configura le tre attività di manutenzione obbligatorie per questo punto di conservazione. Ogni attività deve avere ",r.jsx("strong",{children:"frequenza"})," e ",r.jsx("strong",{children:"almeno uno tra Ruolo o Dipendenti Specifici"})," assegnati.",r.jsx("br",{}),r.jsx("span",{className:"text-xs text-blue-600 mt-1 block",children:"💡 Per Sanificazione e Rilevamento Temperatura puoi selezionare giorni specifici della settimana."})]})]})]}),r.jsxs("div",{className:"flex gap-4 pt-6 border-t border-gray-200 mt-6",children:[r.jsx(le,{onClick:H,disabled:m,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3",children:m?"Salvataggio...":"Salva Manutenzione"}),r.jsx(le,{onClick:s,variant:"outline",className:"flex-1 py-3",disabled:m,children:"Annulla"})]})]})}):null});e5.displayName="MaintenanceForm";const V3=({formData:t,setFormData:e,currentStep:n,validateStep:s,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{var He,it,rt,mt,bt;const[c,d]=W.useState([]),[f,p]=W.useState(!1),[v,m]=W.useState("generic"),[N,S]=W.useState(null),[k,y]=W.useState({}),[b,j]=W.useState({name:"",assignedRole:"",assignedEmployee:"",frequency:""}),[z,H]=W.useState(!1),[Z,K]=W.useState(null),[P,$]=W.useState(null),[re,A]=W.useState([]),[C,R]=W.useState(!1),{formRef:V,scrollToForm:ie}=Ja(f,"tasks-generic-form"),{formRef:Q,scrollToForm:te}=Ja(z,"tasks-maintenance-form");W.useEffect(()=>{f&&ie()},[f,ie]),W.useEffect(()=>{z&&te()},[z,te]),W.useEffect(()=>{var Le,Ce;Se("🔄 TasksStep: Caricamento dati..."),Se("📋 formData.tasks:",t.tasks);const me=((Le=t.tasks)==null?void 0:Le.list)||((Ce=t.tasks)==null?void 0:Ce.tasksList)||[];me.length>0?(Se("✅ Caricando tasks:",me),d(me)):Se("⚠️ Nessun task trovato in formData.tasks")},[t.tasks]);const L=async()=>{R(!0);try{const me=await Pm.getMaintenanceTasks();if(me.success){const Le=me.data.reduce((Me,Ne)=>{const gt=Ne.conservation_point_id;return Me[gt]||(Me[gt]={conservation_point_id:gt,conservation_point_name:Ne.conservation_point_name,tasks:[]}),Me[gt].tasks.push(Ne),Me},{}),Ce=Object.values(Le);A(Ce),e(Me=>({...Me,savedMaintenances:Ce})),xl("✅ Manutenzioni caricate:",Ce)}}catch(me){errorLog("❌ Errore nel caricamento manutenzioni:",me)}finally{R(!1)}};W.useEffect(()=>{L(),Y()},[]);const Y=()=>{try{const me=localStorage.getItem("haccp-maintenance-tasks");if(me){const Ce=JSON.parse(me).reduce((Ne,gt)=>{const et=gt.conservation_point_id;return Ne[et]||(Ne[et]={conservation_point_id:et,conservation_point_name:gt.conservation_point_name,tasks:[]}),Ne[et].tasks.push(gt),Ne},{}),Me=Object.values(Ce);A(Me),e(Ne=>({...Ne,savedMaintenances:Me})),xl("✅ Manutenzioni precompilate caricate:",Me)}}catch(me){errorLog("❌ Errore nel caricamento manutenzioni precompilate:",me)}};W.useEffect(()=>{var me,Le;((Le=(me=t.conservation)==null?void 0:me.points)==null?void 0:Le.length)>0&&(Se("🔄 Ricaricamento manutenzioni per punti di conservazione..."),L())},[(He=t.conservation)==null?void 0:He.points]),W.useEffect(()=>{if(f&&(Se("🔄 Form aperto, controllando dati disponibili..."),Se("📋 formData.tasks:",t.tasks),Se("📋 tasks locali:",c),c.length>0)){const me=c[0];Se("🔄 Precompilando con task locale:",me),j({name:me.name||"",assignedRole:me.assignedRole||"",assignedEmployee:me.assignedEmployee||"",frequency:me.frequency||""})}},[f]);const G=((it=t.conservation)==null?void 0:it.count)||0,ce=c.filter(me=>{const Le=me.name.toLowerCase(),Ce=Le.includes("rilevamento temperature")||Le.includes("rilevamento temperatura")||Le.includes("temperature")||Le.includes("temperatura")||Le.includes("monitoraggio");return Se(`🌡️ Task "${me.name}": isTemperatureTask=${Ce}`),Ce}).length,_=re.flatMap(me=>me.tasks).filter(me=>me.task_type==="temperature_monitoring").length,J=ce+_;Se(`📊 Temperature tasks count: ${J}, Total tasks: ${c.length}`),Se(`🌡️ Generic temperature tasks: ${ce}`),Se(`🌡️ Maintenance temperature tasks: ${_}`),Se("📋 All tasks:",c),W.useEffect(()=>{e(me=>({...me,tasks:{list:c,count:c.length}}))},[c,e]);const M=["Giornalmente","Settimanalmente","Mensilmente","Annualmente"],I=()=>{j({name:"",assignedRole:"",assignedEmployee:"",frequency:""}),S(null)},q=me=>v==="generic"?"Sanificazione Superfici Bancone / Chiusura di Cassa alle 23:55 / Pulizia dei Tavoli della Sala":me?`Rilevamento temperatura ${me.name}`:"Rilevamento temperatura",oe=()=>{var Le;const me=((Le=t.conservation)==null?void 0:Le.points)||[];return Se("🏢 Conservation points:",me),me},fe=me=>{if(Se(`🔍 Checking point ${me.id} (${me.name}) for maintenance tasks...`),Se("📋 Saved maintenances:",re),re.some(et=>et.conservation_point_id===me.id&&et.tasks.length>=3))return Se(`✅ Point ${me.id} (${me.name}) has maintenance tasks in database`),!0;Se(`❌ Point ${me.id} (${me.name}) has NO maintenance tasks in database`);const Ce=c.filter(et=>{const ut=et.name.toLowerCase(),ye=ut.includes(me.id.toString()),Re=ut.includes(me.name.toLowerCase());return ye||Re}),Me=Ce.some(et=>{const ut=et.name.toLowerCase();return ut.includes("rilevamento temperature")||ut.includes("rilevamento temperatura")||ut.includes("temperature")||ut.includes("temperatura")||ut.includes("monitoraggio")}),Ne=Ce.some(et=>{const ut=et.name.toLowerCase();return ut.includes("sanificazione")||ut.includes("sanitizzazione")||ut.includes("pulizia")}),gt=Ce.some(et=>{const ut=et.name.toLowerCase();return ut.includes("sbrinamento")||ut.includes("sbrinare")||ut.includes("defrosting")});return Se(`🔍 Checking point ${me.id} (${me.name}): hasTemperatureTask=${Me}, hasSanitizationTask=${Ne}, hasDefrostingTask=${gt}`),Me&&Ne&&gt},ge=()=>J>=G,Te=()=>c.length>0,Ee=()=>ge()&&Te();W.useEffect(()=>{if(f)if(v==="maintenance"){const Le=oe().filter(Ce=>!fe(Ce));if(Le.length>0){const Ce=Le[0];j(Me=>({...Me,name:q(Ce)}))}}else j({name:"",assignedRole:"",assignedEmployee:"",frequency:""})},[f,v]);const Fe=()=>{if(!b.name||b.name.trim().length<5){y({name:"Nome attività deve essere di almeno 5 caratteri"});return}if(b.name&&b.assignedRole&&b.frequency){const me={id:Date.now(),name:b.name.trim(),assignedRole:b.assignedRole,assignedEmployee:b.assignedEmployee||null,frequency:b.frequency};Se("➕ Aggiungendo nuova attività:",me),d(Le=>{const Ce=[...Le,me];return Se("📋 Lista attività aggiornata:",Ce),Ce}),I(),p(!1),y({})}},qe=me=>{d(Le=>Le.filter(Ce=>Ce.id!==me))},ct=async me=>{try{xl("💾 Salvataggio manutenzioni:",me);const Le=await Pm.saveMaintenanceTasks(me);Le.success?(xl("✅ Manutenzioni salvate con successo"),await L(),H(!1),K(null),$(null),alert("Manutenzioni configurate con successo!")):(errorLog("❌ Errore nel salvataggio:",Le.error),alert("Errore nel salvataggio delle manutenzioni"))}catch(Le){errorLog("❌ Errore durante il salvataggio:",Le),alert("Errore durante il salvataggio delle manutenzioni")}},_e=()=>{H(!1),K(null),$(null)},ae=me=>({Giornalmente:"daily",Settimanale:"weekly",Mensile:"monthly",Semestrale:"semiannual",Annuale:"annual","Giorni specifici":"custom_days"})[me]||me,St=me=>{K({id:me.conservation_point_id,name:me.conservation_point_name});const Le={[Gt.TEMPERATURE_MONITORING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[Gt.SANITIZATION]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]},[Gt.DEFROSTING]:{frequency:"",selected_days:[],assigned_role:"",assigned_category:"",assigned_staff_ids:[]}};me.tasks.forEach(Ce=>{const Me=Ce.task_type;Le[Me]&&(Le[Me]={frequency:ae(Ce.frequency)||"",selected_days:Ce.selected_days||[],assigned_role:Ce.assigned_role||"",assigned_category:Ce.assigned_category||"",assigned_staff_ids:Ce.assigned_staff_ids||[]})}),$(Le),H(!0)},st=async me=>{const Le=`Sei sicuro di voler eliminare tutte le manutenzioni per "${me.conservation_point_name}"?

Questa azione non può essere annullata.`;if(window.confirm(Le))try{const Ce=await Pm.deleteMaintenanceTasksByConservationPoint(me.conservation_point_id);Ce.success?(xl("✅ Manutenzioni eliminate con successo"),await L(),alert("Manutenzioni eliminate con successo!")):(errorLog("❌ Errore nell'eliminazione:",Ce.error),alert("Errore nell'eliminazione delle manutenzioni"))}catch(Ce){errorLog("❌ Errore durante l'eliminazione:",Ce),alert("Errore durante l'eliminazione delle manutenzioni")}},$e=(me,Le=[])=>{switch(me){case"daily":return"Giornalmente";case"weekly":return"Settimanale";case"monthly":return"Mensile";case"semiannual":return"Semestrale";case"annual":return"Annuale";case"custom_days":case"Giorni specifici":if(Le&&Le.length>0){const Ce={monday:"Lunedì",tuesday:"Martedì",wednesday:"Mercoledì",thursday:"Giovedì",friday:"Venerdì",saturday:"Sabato",sunday:"Domenica"};return Le.map(Me=>Ce[Me]).join(", ")}return"Giorni specifici";default:return me}},Ye=me=>{var Me;return!me||me.length===0?"":(((Me=t.staff)==null?void 0:Me.staffMembers)||[]).filter(Ne=>me.includes(Ne.id)).map(Ne=>`${Ne.name} ${Ne.surname}`).join(", ")},Ge=Ee();return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Mansioni e Attività"}),r.jsx("p",{className:"text-gray-600",children:"Assegna compiti al personale"})]}),(()=>{const me=oe(),Le=me.filter(Ce=>!fe(Ce));return Se("🔍 Missing tasks check:",{conservationPoints:me.map(Ce=>({id:Ce.id,name:Ce.name})),missingTasks:Le.map(Ce=>({id:Ce.id,name:Ce.name})),allTasks:c.map(Ce=>({name:Ce.name,assignedRole:Ce.assignedRole}))}),Le.length>0?r.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(xn,{className:"h-5 w-5 text-yellow-600"}),r.jsx("h4",{className:"font-medium text-yellow-900",children:"Punti di Conservazione senza Mansioni"})]}),r.jsx("p",{className:"text-sm text-yellow-800 mb-3",children:"I seguenti punti di conservazione necessitano delle 3 mansioni obbligatorie (Rilevamento Temperatura, Sanificazione, Sbrinamento):"}),r.jsx("div",{className:"space-y-2",children:Le.map(Ce=>r.jsxs("div",{className:"flex items-center justify-between p-2 bg-yellow-100 rounded",children:[r.jsx("span",{className:"text-sm font-medium",children:Ce.name}),r.jsx(le,{onClick:()=>{K(Ce),H(!0)},size:"sm",className:"bg-yellow-600 hover:bg-yellow-700 text-white",children:"Aggiungi Mansione"})]},Ce.id))})]}):null})(),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:"Attività e Mansioni"}),r.jsxs(le,{onClick:()=>{m("generic"),p(!0)},variant:"outline",size:"sm",children:[r.jsx(or,{className:"h-4 w-4 mr-1"}),"Aggiungi Nuova Attività"]})]}),re.length>0&&r.jsx("div",{className:"space-y-3 mb-6",children:re.map(me=>r.jsx("div",{className:"border rounded-lg p-4 bg-yellow-50 border-yellow-200",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("h4",{className:"text-base font-semibold text-yellow-900 mb-3",children:["Manutenzioni (",me.conservation_point_name,")"]}),r.jsx("div",{className:"space-y-3",children:me.tasks.map(Le=>r.jsxs("div",{className:"text-base",children:[r.jsxs("div",{className:"font-medium text-gray-800 mb-2",children:[Le.task_name,":"]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-gray-600",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium",children:"Frequenza:"}),r.jsx("span",{className:"ml-1 text-gray-700",children:$e(Le.frequency,Le.selected_days)})]}),Le.assigned_role&&r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium",children:"Ruolo:"}),r.jsx("span",{className:"ml-1 text-gray-700",children:Le.assigned_role})]}),Le.assigned_category&&r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium",children:"Categoria:"}),r.jsx("span",{className:"ml-1 text-gray-700",children:Le.assigned_category})]}),Le.assigned_staff_ids&&Le.assigned_staff_ids.length>0&&r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium",children:"Staff:"}),r.jsx("span",{className:"ml-1 text-gray-700",children:Ye(Le.assigned_staff_ids)})]})]})]},Le.id))})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{onClick:()=>St(me),variant:"outline",size:"sm",className:"text-blue-600 hover:text-blue-700",children:r.jsx(ci,{className:"h-4 w-4"})}),r.jsx(le,{onClick:()=>st(me),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:r.jsx(tr,{className:"h-4 w-4"})})]})]})},me.conservation_point_id))}),c.length===0&&re.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(ey,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"Nessuna attività configurata"}),r.jsx("p",{className:"text-sm",children:'Clicca "Aggiungi Nuova Attività" per iniziare'})]}):c.length>0&&r.jsx("div",{className:"space-y-3",children:c.map(me=>r.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[r.jsx("h5",{className:"font-medium",children:me.name}),r.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:$e(me.frequency)})]}),r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsx("span",{className:"font-medium",children:"Assegnato a:"})," ",me.assignedRole,me.assignedEmployee&&r.jsxs("span",{className:"ml-2 text-blue-600",children:["(",me.assignedEmployee,")"]})]}),me.name.toLowerCase().includes("rilevamento temperature")&&r.jsx("div",{className:"mt-2 text-sm text-blue-600",children:"🌡️ Attività di monitoraggio temperature"})]}),r.jsx("div",{className:"flex gap-2",children:r.jsx(le,{onClick:()=>qe(me.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",children:r.jsx(dn,{className:"h-4 w-4"})})})]})},me.id))})]}),f&&r.jsxs("div",{ref:V,id:"tasks-generic-form",className:"border rounded-lg p-4 bg-white",children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Aggiungi Nuova Attività"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx(Ke,{htmlFor:"name",children:"Nome Attività *"}),r.jsx(At,{id:"name",value:b.name,onChange:me=>{j(Le=>({...Le,name:me.target.value})),k.name&&y(Le=>({...Le,name:null}))},placeholder:"",className:`mt-1 ${k.name?"border-red-500 focus:border-red-500 focus:ring-red-500":""}`}),k.name&&r.jsxs("p",{className:"text-sm text-red-500 mt-1",children:["⚠️ ",k.name]}),r.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Suggerimento: ",q()]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"assignedRole",children:"Assegna Mansione a: *"}),r.jsxs("select",{id:"assignedRole",value:b.assignedRole,onChange:me=>j(Le=>({...Le,assignedRole:me.target.value,assignedEmployee:""})),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Seleziona categoria"}),r.jsx("option",{value:"Amministratore",children:"Amministratore"}),r.jsx("option",{value:"Cuochi",children:"Cuochi"}),r.jsx("option",{value:"Banconisti",children:"Banconisti"}),r.jsx("option",{value:"Camerieri",children:"Camerieri"}),r.jsx("option",{value:"Responsabile",children:"Responsabile"}),r.jsx("option",{value:"Dipendente",children:"Dipendente"})]}),!b.assignedRole&&r.jsx("p",{className:"text-sm text-red-500 mt-1",children:"⚠️ Seleziona una categoria per procedere"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"assignedEmployee",children:"Dipendente Specifico (Opzionale)"}),r.jsxs("select",{id:"assignedEmployee",value:b.assignedEmployee,onChange:me=>j(Le=>({...Le,assignedEmployee:me.target.value})),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:!b.assignedRole,children:[r.jsx("option",{value:"",children:"Seleziona dipendente specifico"}),(mt=(rt=t.staff)==null?void 0:rt.staffMembers)==null?void 0:mt.filter(me=>{var Le;return["Responsabile","Dipendente","Amministratore"].includes(b.assignedRole)?me.role===b.assignedRole:((Le=me.categories)==null?void 0:Le.includes(b.assignedRole))||me.primaryCategory===b.assignedRole}).map(me=>{var Le;return r.jsxs("option",{value:me.fullName||me.name,children:[me.fullName||me.name," - ",me.role," (",me.primaryCategory||((Le=me.categories)==null?void 0:Le[0]),")"]},me.id)})]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"frequency",children:"Frequenza *"}),r.jsxs("select",{id:"frequency",value:b.frequency,onChange:me=>j(Le=>({...Le,frequency:me.target.value})),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Seleziona frequenza"}),M.map(me=>r.jsx("option",{value:me,children:me},me))]})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(le,{variant:"outline",onClick:()=>{p(!1),I()},children:"Annulla"}),r.jsx(le,{onClick:Fe,disabled:!b.name||!b.assignedRole||!b.frequency,children:"Aggiungi Attività"})]})]}),r.jsx("div",{className:`p-4 rounded-lg ${Ge?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${Ge?"bg-green-500":"bg-yellow-500"} text-white text-sm font-bold`,children:c.length+re.length}),r.jsxs("div",{children:[Ge&&r.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),r.jsxs("p",{className:`font-medium ${Ge?"text-green-900":"text-yellow-900"}`,children:["Attività configurate: ",c.length+re.length]}),r.jsx("p",{className:`text-sm ${Ge?"text-green-800":"text-yellow-800"}`,children:Ge?"✅ Tutti i requisiti sono soddisfatti! Puoi procedere al prossimo step.":!ge()&&!Te()?"⚠️ Devi configurare le manutenzioni per tutti i punti di conservazione e aggiungere almeno un'attività generale.":ge()?"⚠️ Devi aggiungere almeno un'attività generale.":"⚠️ Devi configurare le manutenzioni per tutti i punti di conservazione."})]})]})}),!Ge&&r.jsxs("div",{className:"p-4 bg-red-50 border-2 border-red-300 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(xn,{className:"h-5 w-5 text-red-600"}),r.jsx("h4",{className:"font-bold text-red-900",children:"Non puoi procedere al prossimo step"})]}),r.jsx("p",{className:"text-sm text-red-800 mb-2",children:"Ci sono errori che devi correggere prima di poter continuare:"}),r.jsxs("ul",{className:"text-sm text-red-700 list-disc list-inside space-y-1",children:[c.some(me=>me.name&&me.name.trim().length<5)&&r.jsx("li",{children:"Alcune attività hanno nomi troppo corti (minimo 5 caratteri)"}),!ge()&&r.jsx("li",{children:"Devi configurare le manutenzioni per tutti i punti di conservazione"}),!Te()&&r.jsx("li",{children:"Devi aggiungere almeno un'attività generale"})]})]}),c.some(me=>me.name&&me.name.trim().length<5)&&r.jsxs("div",{className:"p-4 bg-red-50 border-2 border-red-300 rounded-lg mb-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(xn,{className:"h-6 w-6 text-red-600"}),r.jsx("h4",{className:"text-lg font-bold text-red-900",children:"⚠️ ERRORE DI VALIDAZIONE"})]}),r.jsxs("div",{className:"bg-red-100 p-3 rounded-md mb-3",children:[r.jsx("p",{className:"text-base font-semibold text-red-900 mb-2",children:"Non puoi procedere al prossimo step perché alcune attività hanno nomi troppo corti!"}),r.jsx("p",{className:"text-sm text-red-800 mb-2",children:"Per procedere, devi correggere i seguenti problemi:"}),r.jsxs("ul",{className:"text-sm text-red-700 list-disc list-inside space-y-1 font-medium",children:[r.jsx("li",{children:"Il nome di ogni attività deve essere di almeno 5 caratteri"}),r.jsx("li",{children:"Modifica o elimina le attività con nomi troppo corti"}),r.jsx("li",{children:'Esempio di nome valido: "Pulizia bancone cucina"'})]})]}),r.jsxs("div",{className:"text-sm text-red-700",children:[r.jsx("strong",{children:"Attività con problemi:"}),r.jsx("ul",{className:"list-disc list-inside mt-1",children:c.filter(me=>me.name&&me.name.trim().length<5).map((me,Le)=>r.jsxs("li",{children:['"',me.name,'" (solo ',me.name.trim().length," caratteri - ne servono almeno 5)"]},Le))})]})]}),Object.keys(k).length>0&&r.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"text-sm text-red-800",children:[r.jsx("p",{className:"font-medium",children:"❌ Errori di validazione:"}),Object.entries(k).map(([me,Le])=>r.jsxs("p",{children:["• ",Le]},me))]})}),r.jsx(e5,{ref:Q,conservationPoint:Z,staffMembers:((bt=t.staff)==null?void 0:bt.staffMembers)||[],onSave:ct,onCancel:_e,isOpen:z,existingData:P})]})},G3=({formData:t,setFormData:e,currentStep:n,validateStep:s,confirmStep:i,markStepAsUnconfirmed:a,isStepConfirmed:o,canConfirmStep:l})=>{var V,ie;const[c,d]=W.useState([]),[f,p]=W.useState(!1),[v,m]=W.useState(null),{formRef:N,scrollToForm:S}=Ja(f,"inventory-step-form");W.useEffect(()=>{f&&S()},[f,S]);const[k,y]=W.useState({}),[b,j]=W.useState({name:"",type:"",expiryDate:"",position:"",allergens:[]}),z=()=>{var Q;return(Q=t.conservation)!=null&&Q.points&&t.conservation.points.length>0?t.conservation.points:[{id:1,name:"Frigo A",minTemp:2,maxTemp:4},{id:2,name:"Freezer",minTemp:-18,maxTemp:-15},{id:3,name:"Abbattitore",minTemp:0,maxTemp:3}]};W.useEffect(()=>{var te,L;let Q=[];if((te=t.products)!=null&&te.productsList&&t.products.productsList.length>0?Q=t.products.productsList:(L=t.inventory)!=null&&L.products&&t.inventory.products.length>0&&(Q=t.inventory.products),Q.length>0){const Y=Q.map(G=>!G.compliance&&G.type&&G.position?{...G,compliance:P(G.type,G.position)}:G);d(Y)}},[]),W.useEffect(()=>{var Q;if(c.length>0&&((Q=t.conservation)!=null&&Q.points)&&c.some(L=>L.type&&L.position&&!L.compliance)){const L=c.map(Y=>Y.type&&Y.position&&!Y.compliance?{...Y,compliance:P(Y.type,Y.position)}:Y);d(L)}},[(V=t.conservation)==null?void 0:V.points]),W.useEffect(()=>{e(Q=>({...Q,products:{productsList:c,count:c.length}}))},[c,e]);const H=["Latticini e Formaggi","Carni Fresche","Pesce e Frutti di Mare","Verdure e Ortaggi","Frutta","Prodotti da Forno","Bevande","Altro"],Z=[{id:"glutine",name:"Glutine",icon:"🌾"},{id:"latte",name:"Latte",icon:"🥛"},{id:"uova",name:"Uova",icon:"🥚"},{id:"pesce",name:"Pesce",icon:"🐟"},{id:"crostacei",name:"Crostacei",icon:"🦐"},{id:"frutta_secca",name:"Frutta a guscio",icon:"🥜"},{id:"arachidi",name:"Arachidi",icon:"🥜"},{id:"soia",name:"Soia",icon:"🫘"},{id:"sedano",name:"Sedano",icon:"🥬"},{id:"senape",name:"Senape",icon:"🌶️"},{id:"sesamo",name:"Sesamo",icon:"⚪"},{id:"solfiti",name:"Solfiti",icon:"🧪"},{id:"lupini",name:"Lupini",icon:"🫘"},{id:"molluschi",name:"Molluschi",icon:"🦪"}],K=()=>{j({name:"",type:"",expiryDate:"",position:"",allergens:[]}),m(null)},P=W.useCallback((Q,te)=>{const L=z().find(Y=>Y.id===parseInt(te)||Y.name===te);return L?Q==="Latticini e Formaggi"&&(L.minTemp>5||L.maxTemp>5)?{compliant:!1,message:"Temperatura troppo alta per latticini"}:Q==="Carni Fresche"&&(L.minTemp>7||L.maxTemp>7)?{compliant:!1,message:"Temperatura troppo alta per carni fresche"}:Q==="Pesce e Frutti di Mare"&&(L.minTemp>2||L.maxTemp>2)?{compliant:!1,message:"Temperatura troppo alta per pesce"}:{compliant:!0,message:"Posizione conforme HACCP per questo tipo di prodotto"}:{compliant:!1,message:"Posizione non valida"}},[(ie=t.conservation)==null?void 0:ie.points]),$=()=>{if(b.name&&b.type&&b.expiryDate&&b.position){const Q=P(b.type,b.position);if(v)d(te=>te.map(L=>L.id===v?{...L,...b,compliance:Q}:L));else{const te={id:Date.now(),...b,compliance:Q};d(L=>[...L,te])}K(),p(!1)}},re=Q=>{d(te=>te.filter(L=>L.id!==Q))},A=Q=>{const te=c.find(L=>L.id===Q);te&&(j({name:te.name,type:te.type,expiryDate:te.expiryDate,position:te.position,allergens:te.allergens||[]}),m(Q),p(!0))},C=Q=>{j(te=>({...te,allergens:te.allergens.includes(Q)?te.allergens.filter(L=>L!==Q):[...te.allergens,Q]}))},R=c.length>0&&c.every(Q=>Q.name&&Q.type&&Q.expiryDate&&Q.position);return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Inventario Prodotti"}),r.jsx("p",{className:"text-gray-600",children:"Gestisci prodotti e allergeni"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:"Prodotti nell'Inventario"}),r.jsxs(le,{onClick:()=>{K(),p(!0)},variant:"outline",size:"sm",children:[r.jsx(or,{className:"h-4 w-4 mr-1"}),"Aggiungi Prodotto"]})]}),f&&r.jsxs("div",{ref:N,id:"inventory-step-form",className:"border rounded-lg p-4 bg-white mb-6",children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:v?"Modifica Prodotto":"Aggiungi Nuovo Prodotto"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"name",children:"Nome Prodotto *"}),r.jsx(At,{id:"name",value:b.name,onChange:Q=>{j(te=>({...te,name:Q.target.value})),a(n)},placeholder:"Es. Mozzarella, Prosciutto, Pomodori",className:"mt-1"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"type",children:"Tipo Prodotto *"}),r.jsxs("select",{id:"type",value:b.type,onChange:Q=>{j(te=>({...te,type:Q.target.value})),a(n)},className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Seleziona tipo"}),H.map(Q=>r.jsx("option",{value:Q,children:Q},Q))]})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"expiryDate",children:"Data di Scadenza *"}),r.jsx(At,{id:"expiryDate",type:"date",value:b.expiryDate,onChange:Q=>{j(te=>({...te,expiryDate:Q.target.value})),a(n)},className:"mt-1"})]}),r.jsxs("div",{children:[r.jsx(Ke,{htmlFor:"position",children:"Posizione di Conservazione *"}),r.jsxs("select",{id:"position",value:b.position,onChange:Q=>{j(te=>({...te,position:Q.target.value})),a(n)},className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"Seleziona posizione"}),z().map(Q=>r.jsxs("option",{value:Q.id,children:[Q.name," (",Q.targetTemp,"°C)"]},Q.id))]})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx(Ke,{children:"Allergeni"}),r.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-2",children:Z.map(Q=>r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:b.allergens.includes(Q.id),onChange:()=>C(Q.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),r.jsxs("span",{className:"text-sm",children:[Q.icon," ",Q.name]})]},Q.id))})]})]}),b.type&&b.position&&r.jsxs("div",{className:"mt-4 p-3 rounded-lg bg-gray-50",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(xn,{className:"h-4 w-4"}),r.jsx("span",{className:"font-medium",children:"Validazione HACCP:"})]}),(()=>{const Q=P(b.type,b.position);return r.jsxs("div",{className:`mt-2 flex items-center gap-2 ${Q.compliant?"text-green-600":"text-red-600"}`,children:[Q.compliant?"✅":"⚠️",r.jsx("span",{className:"text-sm",children:Q.message})]})})()]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(le,{variant:"outline",onClick:()=>{p(!1),K()},children:"Annulla"}),r.jsx(le,{onClick:$,disabled:!b.name||!b.type||!b.expiryDate||!b.position,children:v?"Salva Modifiche":"Aggiungi Prodotto"})]})]}),c.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Un,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"Nessun prodotto registrato"}),r.jsx("p",{className:"text-sm",children:'Clicca "Aggiungi Prodotto" per iniziare'})]}):r.jsx("div",{className:"space-y-3",children:c.map(Q=>{var te,L,Y;return r.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[r.jsx("h5",{className:"font-medium",children:Q.name}),r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:Q.type})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Scadenza:"}),r.jsx("p",{className:"font-medium",children:Q.expiryDate})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Posizione:"}),r.jsx("p",{className:"font-medium",children:Q.position})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Allergeni:"}),r.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Q.allergens.map(G=>{const ce=Z.find(_=>_.id===G);return ce?r.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:[ce.icon," ",ce.name]},G):null})})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"HACCP:"}),r.jsxs("div",{className:`flex items-center gap-1 ${(te=Q.compliance)!=null&&te.compliant?"text-green-600":"text-red-600"}`,children:[(L=Q.compliance)!=null&&L.compliant?"✅":"⚠️",r.jsx("span",{className:"text-xs",children:((Y=Q.compliance)==null?void 0:Y.message)||"Non validato"})]})]})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(le,{onClick:()=>A(Q.id),variant:"outline",size:"sm",className:"text-blue-600 hover:text-blue-700",title:"Modifica prodotto",children:r.jsx(ci,{className:"h-4 w-4"})}),r.jsx(le,{onClick:()=>re(Q.id),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",title:"Elimina prodotto",children:r.jsx(dn,{className:"h-4 w-4"})})]})]})},Q.id)})})]}),r.jsx("div",{className:`p-4 rounded-lg ${R?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${R?"bg-green-500":"bg-yellow-500"} text-white text-sm font-bold`,children:c.length}),r.jsxs("div",{children:[R&&r.jsx("h3",{className:"text-lg font-bold text-green-900 mb-2",children:"Configurazione Completata"}),r.jsxs("p",{className:`font-medium ${R?"text-green-900":"text-yellow-900"}`,children:["Prodotti registrati: ",c.length]}),r.jsx("p",{className:`text-sm ${R?"text-green-800":"text-yellow-800"}`,children:R?"✅ Tutti i prodotti hanno i campi obbligatori compilati!":"⚠️ Devi registrare almeno un prodotto con tutti i campi obbligatori."})]})]})}),Object.keys(k).length>0&&r.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"text-sm text-red-800",children:[r.jsx("p",{className:"font-medium",children:"❌ Errori di validazione:"}),Object.entries(k).map(([Q,te])=>r.jsxs("p",{children:["• ",te]},Q))]})})]})},W3=(t,e)=>{const n=parseFloat(t);if(isNaN(n))return{compliant:!1,message:"Temperatura non valida"};if(e.length>0){const s=Vr.tolerance;let i=!1;for(let l=0;l<e.length;l++){for(let c=l+1;c<e.length;c++){const d=Vr.categories.find(p=>p.id===e[l]),f=Vr.categories.find(p=>p.id===e[c]);if(d&&f){const p=d.minTemp-s,v=d.maxTemp+s,m=f.minTemp-s,N=f.maxTemp+s;if(v<m||N<p){i=!0;break}}}if(i)break}if(i)return{compliant:!1,message:"Categorie incompatibili selezionate"};let a=!0,o=!0;for(const l of e){const c=Vr.categories.find(d=>d.id===l);if(c){const d=n>=c.minTemp&&n<=c.maxTemp,f=c.minTemp-s,p=c.maxTemp+s,v=n>=f&&n<=p;d||(a=!1),v||(o=!1)}}return a?{compliant:!0,message:"Conforme HACCP"}:o?{compliant:!0,message:"Temperatura impostata entro i limiti accettabili (0,5°C di differenza)"}:{compliant:!1,message:"Fuori range HACCP per le categorie selezionate"}}return{compliant:!0,message:"Conforme HACCP"}},Ca=[{id:"business",title:"Informazioni Attività",description:"Configura i dati base della tua attività",icon:Tu,component:R3},{id:"departments",title:"Reparti",description:"Organizza la struttura operativa",icon:Tu,component:F3},{id:"staff",title:"Staff e Ruoli",description:"Registra il personale e assegna responsabilità",icon:Ai,component:B3},{id:"conservation",title:"Punti di Conservazione",description:"Configura frigoriferi e aree di stoccaggio",icon:ds,component:$3},{id:"tasks",title:"Mansioni e Attività",description:"Assegna compiti al personale",icon:ey,component:V3},{id:"inventory",title:"Inventario Prodotti",description:"Gestisci prodotti e allergeni",icon:Un,component:G3}];function J3({isOpen:t,onClose:e,onComplete:n}){const[s,i]=W.useState(0),a=G=>{Se(`🚨 setCurrentStep chiamato: ${s} → ${G}`),Se("🚨 Stack trace:",new Error().stack),i(G)},[o,l]=W.useState(new Set),[c,d]=W.useState(new Set),[f,p]=W.useState({business:{},departments:{},staff:{},conservation:{},tasks:{},inventory:{}}),{alertModal:v,confirmModal:m,promptModal:N,closeAlert:S,closeConfirm:k,closePrompt:y,alertSuccess:b,alertError:j,alertWarning:z,confirmDelete:H,confirmAction:Z}=rc(),K=(G,ce)=>{var J,M,I,q,oe,fe,ge,Te,Ee,Fe,qe,ct,_e,ae,St,st,$e,Ye,Ge,He,it,rt,mt,bt;const _={};if(G===0&&((M=(J=ce.business)==null?void 0:J.companyName)!=null&&M.trim()||(_.businessName="Il nome attività è obbligatorio"),(q=(I=ce.business)==null?void 0:I.address)!=null&&q.trim()||(_.address="L'indirizzo è obbligatorio"),(fe=(oe=ce.business)==null?void 0:oe.email)!=null&&fe.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ce.business.email)||(_.email="Inserisci una email valida (formato: nome@dominio.com)"):_.email="L'email è obbligatoria",(Te=(ge=ce.business)==null?void 0:ge.companyName)!=null&&Te.trim()&&ce.business.companyName.trim().length<3&&(_.businessName="Il nome attività deve essere di almeno 3 caratteri"),(Fe=(Ee=ce.business)==null?void 0:Ee.address)!=null&&Fe.trim()&&ce.business.address.trim().length<10&&(_.address="L'indirizzo deve essere di almeno 10 caratteri"),(ct=(qe=ce.business)==null?void 0:qe.companyName)!=null&&ct.trim()&&ce.business.companyName.trim().toLowerCase().length<3&&(_.businessName="Il nome attività deve essere di almeno 3 caratteri"),!((ae=(_e=ce.business)==null?void 0:_e.phone)!=null&&ae.trim())&&!((st=(St=ce.business)==null?void 0:St.email)!=null&&st.trim())&&(_.contactInfo="Devi fornire almeno un metodo di contatto (telefono o email)")),G===1){const Le=((($e=ce.departments)==null?void 0:$e.list)||[]).filter(Ce=>Ce.enabled);if(Le.length<1)_.departments="Devi attivare almeno 1 reparto per procedere";else{Le.forEach((Ne,gt)=>{var et;(!((et=Ne.name)!=null&&et.trim())||Ne.name.trim().length<2)&&(_[`department_${gt}_name`]="Nome reparto deve essere di almeno 2 caratteri")});const Ce=Le.map(Ne=>Ne.name.toLowerCase().trim()),Me=new Set(Ce);Ce.length!==Me.size&&(_.departmentNames="I nomi dei reparti devono essere unici")}}if(G===2){const me=((Ye=ce.staff)==null?void 0:Ye.staffMembers)||[];if(me.length===0)_.staff="Devi aggiungere almeno un membro dello staff";else{me.forEach((Me,Ne)=>{var et;(et=Me.fullName)!=null&&et.trim()?Me.fullName.trim().length<3&&(_[`staff_${Ne}_name`]="Nome deve essere di almeno 3 caratteri"):_[`staff_${Ne}_name`]="Nome obbligatorio",Me.role?["Amministratore","Responsabile","Dipendente","Collaboratore Occasionale / Part-time"].includes(Me.role)||(_[`staff_${Ne}_role`]="Ruolo non valido - seleziona un ruolo valido"):_[`staff_${Ne}_role`]="Ruolo obbligatorio";const gt=Me.categories&&Me.categories.length>0?Me.categories:Me.category?[Me.category]:[];if(gt.length===0)_[`staff_${Ne}_category`]="Categoria obbligatoria";else{const ut=["Cuochi","Banconisti","Camerieri","Social & Media Manager","Amministratore","Altro"];gt.forEach(ye=>{ut.includes(ye)||(_[`staff_${Ne}_category`]="Categoria non valida - seleziona una categoria valida")})}});const Le=me.map(Me=>Me.fullName.toLowerCase().trim()),Ce=new Set(Le);Le.length!==Ce.size&&(_.staffNames="I nomi dei membri dello staff devono essere unici")}}if(G===3){const me=((Ge=ce.conservation)==null?void 0:Ge.points)||[];if(Se("🔍 OnboardingWizard: Validating step 3 (Conservation)"),Se("🔍 OnboardingWizard: data.conservation:",ce.conservation),Se("🔍 OnboardingWizard: conservationPoints:",me),me.length===0)Se("❌ OnboardingWizard: No conservation points found, adding error"),_.conservation="Devi aggiungere almeno un punto di conservazione";else{me.forEach((Me,Ne)=>{var gt,et;if((gt=Me.name)!=null&&gt.trim()?Me.name.trim().length<2&&(_[`conservation_${Ne}_name`]="Nome deve essere di almeno 2 caratteri"):_[`conservation_${Ne}_name`]="Nome obbligatorio",Me.location?(((et=ce.departments)==null?void 0:et.list)||[]).find(Re=>Re.name===Me.location&&Re.enabled)||(_[`conservation_${Ne}_location`]="Posizione non valida - seleziona un reparto attivo"):_[`conservation_${Ne}_location`]="Posizione obbligatoria",!Me.targetTemp)_[`conservation_${Ne}_temperature`]="Temperatura target obbligatoria";else{const ut=parseFloat(Me.targetTemp);isNaN(ut)&&(_[`conservation_${Ne}_temperature`]="Temperatura non valida")}if(!Me.selectedCategories||Me.selectedCategories.length===0)_[`conservation_${Ne}_categories`]="Categorie prodotti obbligatorie";else{const ut=["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","frozen","deep_frozen","dry_goods","hot_holding","chilled_ready","fresh_beverages"];if(Me.selectedCategories.forEach(ye=>{ut.includes(ye)||(_[`conservation_${Ne}_categories`]="Categoria non valida - seleziona categorie valide")}),Me.targetTemp&&Me.selectedCategories.length>0){const ye=W3(Me.targetTemp,Me.selectedCategories);ye.compliant||(_[`conservation_${Ne}_haccp`]=`Non conforme HACCP: ${ye.message}. La temperatura deve essere compatibile con TUTTE le categorie selezionate.`)}}});const Le=me.map(Me=>Me.name.toLowerCase().trim()),Ce=new Set(Le);Le.length!==Ce.size&&(_.conservationNames="I nomi dei punti di conservazione devono essere unici")}}if(G===4){const me=((He=ce.tasks)==null?void 0:He.list)||[],Le=ce.savedMaintenances||[],Ce=((it=ce.conservation)==null?void 0:it.points)||[];Se("🔍 OnboardingWizard Step 4 Validation:"),Se("📋 tasksList:",me.length,"tasks"),Se("📋 savedMaintenances:",Le.length,"groups"),Se("📋 conservationPoints:",Ce.length);const Me=Le.flatMap(et=>et.tasks).filter(et=>et.task_type==="temperature_monitoring"),Ne=Me.length>=Ce.length,gt=me.length>0;if(Se("🌡️ Maintenance validation:"),Se("📋 temperatureMaintenances:",Me.length),Se("📋 conservationPoints:",Ce.length),Se("📋 hasAllMaintenanceTasks:",Ne),Se("📋 hasGeneralTasks:",gt),!Ne&&!gt?_.tasks="Devi configurare le manutenzioni per tutti i punti di conservazione e aggiungere almeno un'attività generale":Ne?gt?Se("✅ Step 4 validation passed!"):_.tasks="Devi aggiungere almeno un'attività generale":_.tasks="Devi configurare le manutenzioni per tutti i punti di conservazione",me.length>0){me.forEach((ye,Re)=>{var xt;(xt=ye.name)!=null&&xt.trim()?ye.name.trim().length<5&&(_[`task_${Re}_name`]="Nome attività deve essere di almeno 5 caratteri"):_[`task_${Re}_name`]="Nome attività obbligatorio",ye.assignedRole||(_[`task_${Re}_assigned`]="Assegnazione obbligatoria"),ye.frequency?["Giornalmente","Settimanalmente","Mensilmente","Annualmente"].includes(ye.frequency)||(_[`task_${Re}_frequency`]="Frequenza non valida - seleziona una frequenza valida"):_[`task_${Re}_frequency`]="Frequenza obbligatoria"});const et=me.map(ye=>ye.name.toLowerCase().trim()),ut=new Set(et);if(Se("🔍 Debug nomi attività generali:"),Se("📋 taskNames (generiche):",et),Se("📋 uniqueTaskNames:",Array.from(ut)),Se("📋 taskNames.length:",et.length),Se("📋 uniqueTaskNames.size:",ut.size),et.length!==ut.size){Se("❌ NOMI DUPLICATI TROVATI NELLE ATTIVITÀ GENERALI!");const ye=et.filter((Re,xt)=>et.indexOf(Re)!==xt);Se("❌ Duplicati:",ye),_.taskNames="I nomi delle attività generali devono essere unici"}}}if(G===5){const me=((rt=ce.products)==null?void 0:rt.productsList)||((mt=ce.inventory)==null?void 0:mt.products)||[];if(Se("🔍 OnboardingWizard: Validating step 5 (Inventory)"),Se("🔍 OnboardingWizard: data.products:",ce.products),Se("🔍 OnboardingWizard: productsList:",me),me.length===0)Se("❌ OnboardingWizard: No products found, adding error"),_.inventory="Devi aggiungere almeno un prodotto";else{me.forEach((Ne,gt)=>{var et;if((et=Ne.name)!=null&&et.trim()?Ne.name.trim().length<2&&(_[`product_${gt}_name`]="Nome prodotto deve essere di almeno 2 caratteri"):_[`product_${gt}_name`]="Nome prodotto obbligatorio",Ne.type?["Latticini e Formaggi","Carni Fresche","Pesce e Frutti di Mare","Verdure e Ortaggi","Frutta","Prodotti da Forno","Bevande","Altro"].includes(Ne.type)||(_[`product_${gt}_type`]="Tipologia non valida - seleziona una tipologia valida"):_[`product_${gt}_type`]="Tipologia obbligatoria",!Ne.expiryDate)_[`product_${gt}_expiry`]="Data scadenza obbligatoria";else{const ut=new Date(Ne.expiryDate),ye=new Date;ye.setHours(0,0,0,0),ut<ye&&(_[`product_${gt}_expiry`]="La data di scadenza deve essere nel futuro")}Ne.position||(_[`product_${gt}_position`]="Posizione obbligatoria")});const Le=((bt=ce.conservation)==null?void 0:bt.points)||[];Le.length===0?_.conservationRequired="Devi prima configurare i punti di conservazione per assegnare i prodotti":me.forEach((Ne,gt)=>{Le.find(ut=>ut.id===parseInt(Ne.position)||ut.name===Ne.position)||(_[`product_${gt}_position`]="Posizione non valida - seleziona un punto di conservazione esistente")});const Ce=me.map(Ne=>Ne.name.toLowerCase().trim()),Me=new Set(Ce);Ce.length!==Me.size&&(_.productNames="I nomi dei prodotti devono essere unici")}}return _},P=G=>{var J,M,I,q,oe;const ce=K(G,f),_=Object.keys(ce).length===0;if(G===4&&(Se("🔍 DEBUG PULSANTE AVANTI - Step 4 (Mansioni e Attività):"),Se("🔍 errors:",ce),Se("🔍 errors.length:",Object.keys(ce).length),Se("🔍 isValid:",_),Se("🔍 formData.tasks:",f.tasks),Se("🔍 formData.savedMaintenances:",f.savedMaintenances),Se("🔍 formData.conservation:",f.conservation),Object.keys(ce).length>0&&(Se("❌ ERRORI DETTAGLIATI STEP 4:"),Object.entries(ce).forEach(([fe,ge])=>{Se(`❌ ${fe}: ${ge}`)}))),G===3&&(Se("🔍 DEBUG PULSANTE AVANTI - Step 3 (Punti di Conservazione):"),Se("🔍 errors:",ce),Se("🔍 errors.length:",Object.keys(ce).length),Se("🔍 isValid:",_),Se("🔍 formData.conservation:",f.conservation),Se("🔍 conservation.points:",(J=f.conservation)==null?void 0:J.points),Se("🔍 conservation.count:",(M=f.conservation)==null?void 0:M.count),Object.keys(ce).length>0&&(Se("❌ ERRORI DETTAGLIATI:"),Object.entries(ce).forEach(([fe,ge])=>{Se(`❌ ${fe}: ${ge}`)}),(q=(I=f.conservation)==null?void 0:I.points)!=null&&q[0]))){const fe=f.conservation.points[0];Se("🔍 PUNTO DI CONSERVAZIONE DETTAGLIATO:"),Se("🔍 point.name:",fe.name),Se("🔍 point.location:",fe.location),Se("🔍 point.targetTemp:",fe.targetTemp),Se("🔍 point.selectedCategories:",fe.selectedCategories),Se("🔍 point.selectedCategories type:",typeof fe.selectedCategories),Se("🔍 point.selectedCategories length:",(oe=fe.selectedCategories)==null?void 0:oe.length);const ge=["fresh_dairy","fresh_meat","fresh_fish","fresh_produce","fresh_fruits","frozen","deep_frozen","dry_goods","hot_holding","chilled_ready","fresh_beverages"];Se("🔍 CATEGORIE VALIDE:",ge),Se("🔍 CATEGORIE SELEZIONATE:",fe.selectedCategories),fe.selectedCategories.forEach((Te,Ee)=>{const Fe=ge.includes(Te);Se(`🔍 Categoria ${Ee}: "${Te}" - ${Fe?"VALIDA":"NON VALIDA"}`)})}return _},$=G=>{const ce=K(G,f);return Object.keys(ce).length===0},re=G=>c.has(G),A=G=>(Se(`🔍 confirmStep chiamato per step ${G}`),Se(`🔍 Stato prima: currentStep=${s}, confirmedSteps=${Array.from(c)}`),P(G)?(Se(`✅ Step ${G} valido, marcando come confermato`),d(ce=>new Set([...ce,G])),Se(`✅ Step ${G} confermato con successo`),!0):(Se(`❌ Step ${G} non valido`),!1)),C=G=>{d(ce=>{const _=new Set(ce);return _.delete(G),_})},R=()=>{const G={currentStep:s,completedSteps:Array.from(o),confirmedSteps:Array.from(c),formData:f,lastActivity:new Date().toISOString()};localStorage.setItem("haccp-onboarding-new",JSON.stringify(G))},V=G=>{Se(`🔍 goToStep chiamato per step ${G}`),G>=0&&G<Ca.length?(a(G),R(),Se(`✅ Navigazione diretta completata a step ${G+1}`)):Se(`❌ Step ${G} non valido`)},ie=()=>{var G,ce;if(Se("🔍 nextStep chiamato"),Se(`🔍 Stato: currentStep=${s}`),s<Ca.length-1){const _=K(s,f);Object.keys(_).length===0?(Se(`✅ Step ${s} valido, navigando al prossimo`),l(J=>new Set([...J,s])),d(J=>new Set([...J,s])),a(s+1),R(),Se(`✅ Navigazione completata a step ${s+1}`)):(Se(`❌ Step ${s} non valido:`,_),Se("❌ Errori dettagliati:",Object.entries(_).map(([J,M])=>`${J}: ${M}`)),Se("❌ Errori completi:",_),Se(`🔍 FormData per step ${s}:`,f),s===3&&(Se("🔍 DEBUG STEP 3 (Punti di Conservazione):"),Se("🔍 data.conservation:",f.conservation),Se("🔍 conservation.points:",(G=f.conservation)==null?void 0:G.points),Se("🔍 conservation.count:",(ce=f.conservation)==null?void 0:ce.count)),j(`Ci sono errori di validazione:
${Object.values(_).join(`
`)}`))}else Se("❌ Ultimo step raggiunto, navigazione non possibile")},Q=()=>{s>0&&(a(s-1),R())},te=()=>{const G=K(s,f);Object.keys(G).length===0?(Se("✅ Ultimo step valido, completando onboarding"),l(ce=>new Set([...ce,s])),R(),n&&n(f)):(Se("❌ Ultimo step non valido:",G),j(`Ci sono errori di validazione:
${Object.values(G).join(`
`)}`))};if(Da.useEffect(()=>{const G=localStorage.getItem("haccp-onboarding-new");if(G)try{const ce=JSON.parse(G);a(ce.currentStep||0),l(new Set(ce.completedSteps||[])),d(new Set(ce.confirmedSteps||[])),p(ce.formData||f)}catch(ce){zp("Errore nel caricamento progresso onboarding:",ce)}},[]),!t)return null;const L=Ca[s].component,Y=s===Ca.length-1;return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"p-6 border-b",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Configurazione Iniziale HACCP"}),r.jsx(le,{variant:"outline",onClick:e,children:"Chiudi"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[r.jsxs("span",{children:["Progresso: ",Math.round(Math.min(o.size/Ca.length*100,100)),"%"]}),r.jsxs("span",{children:["Step ",s+1," di ",Ca.length]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(o.size/Ca.length*100,100)}%`}})})]}),r.jsx("div",{className:"mt-4",children:r.jsx(M3,{currentStep:s,completedSteps:o,onStepClick:V,steps:Ca})})]}),r.jsx("div",{className:"p-6",children:r.jsx(L,{formData:f,setFormData:p,currentStep:s,setCurrentStep:a,onComplete:n,validateStep:K,confirmStep:A,markStepAsUnconfirmed:C,isStepConfirmed:re,canConfirmStep:$})}),r.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-between",children:[r.jsxs(le,{variant:"outline",onClick:Q,disabled:s===0,children:[r.jsx(gN,{className:"h-4 w-4 mr-2"}),"Precedente"]}),r.jsx("div",{className:"flex gap-2",children:Y?r.jsxs(le,{onClick:te,className:"bg-green-600 hover:bg-green-700",children:[r.jsx(Cn,{className:"h-4 w-4 mr-2"}),"Completa Configurazione"]}):r.jsxs(le,{onClick:ie,disabled:!P(s),className:`${P(s)?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:["Avanti",r.jsx(Q2,{className:"h-4 w-4 ml-2"})]})})]}),r.jsx(sc,{isOpen:v.isOpen,onClose:S,title:v.title,message:v.message,type:v.type,confirmText:v.confirmText,onConfirm:v.onConfirm}),r.jsx(ic,{isOpen:m.isOpen,onClose:k,title:m.title,message:m.message,type:m.type,confirmText:m.confirmText,cancelText:m.cancelText,onConfirm:m.onConfirm,onCancel:m.onCancel}),r.jsx(ac,{isOpen:N.isOpen,onClose:y,title:N.title,message:N.message,placeholder:N.placeholder,defaultValue:N.defaultValue,type:N.type,confirmText:N.confirmText,cancelText:N.cancelText,validation:N.validation,onConfirm:N.onConfirm,onCancel:N.onCancel})]})})}function K3({isOpen:t,onClose:e,missingRequirements:n=[],suggestions:s=[],onFixRequirement:i}){if(!t)return null;const a=o=>{i&&i(o),e()};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:e}),r.jsxs("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl shadow-2xl transform transition-transform duration-300 ease-out",children:[r.jsx("div",{className:"flex justify-center pt-3 pb-2",children:r.jsx("div",{className:"w-12 h-1 bg-gray-300 rounded-full"})}),r.jsx("div",{className:"px-6 pb-4 border-b",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(xn,{className:"h-6 w-6 text-orange-500"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Prerequisiti Richiesti"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Completa questi passaggi per accedere alla sezione"})]})]}),r.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(dn,{className:"h-5 w-5"})})]})}),r.jsxs("div",{className:"px-6 py-4 max-h-96 overflow-y-auto",children:[r.jsx("div",{className:"space-y-4",children:n.map((o,l)=>{const c=s.find(d=>d.requirement===o);return r.jsx(Je,{className:"border-orange-200 bg-orange-50",children:r.jsx(Xe,{className:"p-4",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:r.jsx("span",{className:"text-sm font-medium text-orange-600",children:l+1})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium text-orange-900 mb-2",children:(c==null?void 0:c.action)||`Completa ${o}`}),(c==null?void 0:c.description)&&r.jsx("p",{className:"text-sm text-orange-800 mb-3",children:c.description}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs(le,{size:"sm",onClick:()=>a(o),className:"bg-orange-600 hover:bg-orange-700 text-white",children:[r.jsx(Q2,{className:"h-4 w-4 mr-1"}),"Risolvi"]}),r.jsxs("div",{className:"flex items-center gap-1 text-xs text-orange-700",children:[r.jsx($s,{className:"h-3 w-3"}),r.jsxs("span",{children:["Priorità: ",(c==null?void 0:c.priority)==="high"?"Alta":"Media"]})]})]})]})]})})},l)})}),r.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx($s,{className:"h-5 w-5 text-blue-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"Perché questi prerequisiti sono importanti?"}),r.jsx("p",{className:"text-sm text-blue-800",children:"I prerequisiti garantiscono che la tua struttura HACCP sia completa e funzionale. Ogni elemento contribuisce alla sicurezza alimentare e alla compliance normativa."})]})]})})]}),r.jsx("div",{className:"px-6 py-4 border-t bg-gray-50",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx(le,{variant:"outline",onClick:e,className:"flex-1",children:"Chiudi"}),r.jsxs(le,{onClick:()=>{i&&i("onboarding"),e()},className:"flex-1",children:[r.jsx(Cn,{className:"h-4 w-4 mr-2"}),"Avvia Onboarding"]})]})})]})]})}const Y3=({onResetApp:t,onOpenOnboarding:e,showResetApp:n=!1})=>r.jsxs("div",{className:"flex gap-2",children:[n&&r.jsxs(le,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Reset completo dell'app (solo sviluppo)",children:[r.jsx(ry,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Reset App"}),r.jsx("span",{className:"sm:hidden",children:"Reset"})]}),r.jsxs(le,{onClick:e,variant:"outline",size:"sm",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Riapri l'onboarding",children:[r.jsx(Ai,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Riapri Onboarding"}),r.jsx("span",{className:"sm:hidden",children:"Onboarding"})]})]}),Q3=({onPrefillOnboarding:t,onResetOnboarding:e,isDevMode:n=!1})=>r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2 text-green-600 hover:text-green-700 hover:bg-green-50 flex-1 sm:flex-none",title:"Precompila onboarding con dati di test",children:[r.jsx(Ai,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Precompila"}),r.jsx("span",{className:"sm:hidden",children:"Precompila"})]}),r.jsxs(le,{onClick:e,variant:"outline",size:"sm",className:"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50 flex-1 sm:flex-none",title:"Reset completo onboarding e app",children:[r.jsx(ry,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Reset Onboarding"}),r.jsx("span",{className:"sm:hidden",children:"Reset"})]})]}),X3=({onExportData:t,onImportData:e})=>r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(le,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(Bs,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Esporta"}),r.jsx("span",{className:"sm:hidden",children:"Export"})]}),r.jsxs("label",{className:"cursor-pointer",children:[r.jsx(le,{variant:"outline",size:"sm",className:"flex items-center gap-2",asChild:!0,children:r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx(uu,{className:"h-4 w-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Importa"}),r.jsx("span",{className:"sm:hidden",children:"Import"})]})}),r.jsx("input",{type:"file",accept:".json",onChange:e,className:"hidden"})]})]});function Z3(){var ut;const[t,e]=W.useState("dashboard"),[n,s]=W.useState([]),[i,a]=W.useState([]),[o,l]=W.useState([]),[c,d]=W.useState([]),[f,p]=W.useState([]),[v,m]=W.useState([]),[N,S]=W.useState([]),[k,y]=W.useState(null),[b,j]=W.useState([]),[z,H]=W.useState(!1),[Z,K]=W.useState(!0),[P,$]=W.useState(()=>{const ye=localStorage.getItem("haccp-last-check");return ye?JSON.parse(ye):{}}),{alertModal:re,confirmModal:A,promptModal:C,closeAlert:R,closeConfirm:V,closePrompt:ie,alertSuccess:Q,alertError:te,alertWarning:L,confirmDelete:Y,confirmAction:G}=rc(),[ce,_]=W.useState([]);W.useState(()=>localStorage.getItem("haccp-last-sync")||null);const[J,M]=W.useState(()=>localStorage.getItem("haccp-company-id")||"demo-pizzeria"),[I,q]=W.useState(!1),[oe,fe]=W.useState(!1),[ge,Te]=W.useState(!1),[Ee,Fe]=W.useState({users:[],departments:[],refrigerators:[],staff:[],cleaning:[],inventory:[]}),qe={isOnboardingComplete:!0,currentSectionAccess:{isEnabled:!0,message:null},missingRequirements:[],onboardingProgress:100,canAccessSection:()=>({isEnabled:!0,message:null}),areRequirementsMet:()=>!0,getMissingRequirements:()=>[],getNextOnboardingStep:()=>null,getOnboardingProgress:()=>100,validateField:()=>null,getEducationalMessage:()=>"",getSuggestions:()=>[],validateConservationPoint:()=>({isValid:!0,errors:[],warnings:[]}),getEducationalMessages:()=>[],onboardingStatus:{isComplete:!0,progress:100,nextStep:null},sectionAccess:{isEnabled:!0,message:null}},ct=()=>{var wt,Ze,dt,Xt,Dt;const ye=JSON.parse(localStorage.getItem("haccp-users")||"[]");let Re=[];const xt=JSON.parse(localStorage.getItem("haccp-refrigerators")||"[]"),vt=JSON.parse(localStorage.getItem("haccp-staff")||"[]"),jt=JSON.parse(localStorage.getItem("haccp-cleaning")||"[]"),Ot=JSON.parse(localStorage.getItem("haccp-products")||"[]");try{Re=JSON.parse(localStorage.getItem("haccp-departments")||"[]")}catch(Mt){console.warn("Errore nel parsing departments:",Mt),Re=[]}if(Re.some(Mt=>Mt&&Mt.name&&(Mt.name==="Amministratori"||Mt.name==="Responsabili"||Mt.name==="Dipendenti"||Mt.name==="Collaboratore Occasionale"||/^\d+$/.test(Mt.name)||Mt.name.length<3))||Re.length===0){Se("🧹 Rilevati reparti corrotti, ricaricamento dall'onboarding...");const Mt=localStorage.getItem("haccp-onboarding-new")||localStorage.getItem("haccp-onboarding");if(Se("🔍 Dati onboarding trovati:",typeof Mt,Mt),Mt)try{let an;if(typeof Mt=="string")try{Mt==="[object Object]"?(console.warn('Rilevata stringa corrotta "[object Object]", usando oggetto vuoto'),an={formData:{departments:{list:[]}}}):an=JSON.parse(Mt)}catch(_t){console.warn("Errore parsing JSON, usando oggetto vuoto:",_t),an={formData:{departments:{list:[]}}}}else an=Mt;const ht=((wt=an.departments)==null?void 0:wt.list)||((dt=(Ze=an.formData)==null?void 0:Ze.departments)==null?void 0:dt.list);ht&&(Re=ht.filter(_t=>_t&&_t.enabled).map(_t=>({id:_t.id||Date.now()+Math.random(),name:_t.name||"Reparto non disponibile",enabled:!0,isCustom:_t.isCustom||!1,createdAt:new Date().toISOString()})),m(Re),localStorage.setItem("haccp-departments",JSON.stringify(Re)),Se("✅ Reparti corretti caricati dall'onboarding:",Re))}catch(an){console.warn("Errore nel caricamento reparti dall'onboarding:",an)}}const It=localStorage.getItem("haccp-onboarding-new");if(It)try{let Mt;if(typeof It=="string")try{Mt=JSON.parse(It)}catch(ht){console.warn("Errore parsing JSON, usando oggetto vuoto:",ht),Mt={formData:{departments:{list:[]}}}}else Mt=It;const an=(Dt=(Xt=Mt.formData)==null?void 0:Xt.departments)==null?void 0:Dt.list;if(an&&an.length>0){const ht=an.filter(_t=>_t&&_t.enabled).map(_t=>({id:_t.id||Date.now()+Math.random(),name:_t.name||"Reparto non disponibile",enabled:!0,isCustom:_t.isCustom||!1,createdAt:new Date().toISOString()}));(Re.length===0||JSON.stringify(Re)!==JSON.stringify(ht))&&(m(ht),localStorage.setItem("haccp-departments",JSON.stringify(ht)),Se("✅ Reparti precompilati caricati:",ht))}}catch(Mt){console.warn("Errore nel caricamento reparti precompilati:",Mt)}Fe({users:ye,departments:Re,refrigerators:xt,staff:vt,cleaning:jt,inventory:Ot})},_e=()=>{Y(`⚠️ ATTENZIONE: Questo cancellerà TUTTI i dati dell'app!

Sei sicuro di voler procedere?`,()=>{localStorage.clear(),sessionStorage.clear(),localStorage.removeItem("haccp-onboarding"),localStorage.removeItem("haccp-onboarding-new"),window.location.reload()})},ae=()=>{Se("🔄 Precompilando onboarding con dati di test..."),Se("🧹 Pulizia completa localStorage..."),localStorage.clear(),sessionStorage.clear(),localStorage.removeItem("haccp-onboarding"),localStorage.removeItem("haccp-onboarding-new"),localStorage.removeItem("haccp-departments"),localStorage.removeItem("haccp-staff"),localStorage.removeItem("haccp-refrigerators"),localStorage.removeItem("haccp-cleaning"),localStorage.removeItem("haccp-products"),localStorage.removeItem("haccp-temperatures"),localStorage.removeItem("haccp-product-labels"),localStorage.removeItem("haccp-users"),localStorage.removeItem("haccp-current-user");const ye={business:{companyName:"Al Ritrovo SRL",address:"Via centotrecento 1/1b Bologna 40128",vatNumber:"001255668899101",email:"000@gmail.com",phone:"0511234567"},departments:{list:[{id:"cucina",name:"Cucina",description:"Area di preparazione e cottura",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Reparto principale",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"bancone",name:"Bancone",description:"Area di servizio e preparazione",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Area servizio",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"sala",name:"Sala",description:"Area di servizio clienti",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Area clienti",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"magazzino",name:"Magazzino",description:"Area di stoccaggio e conservazione",location:"Seminterrato",manager:"Matteo Cavallaro",notes:"Magazzino principale",enabled:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"magazzino-b",name:"Magazzino B",description:"Magazzino secondario",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Magazzino secondario",enabled:!0,isCustom:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"},{id:"sala-b",name:"Sala B",description:"Sala secondaria",location:"Piano terra",manager:"Matteo Cavallaro",notes:"Sala secondaria",enabled:!0,isCustom:!0,createdAt:new Date().toISOString(),createdBy:"Sistema"}],enabledCount:6},staff:{staffMembers:[{id:"staff_001",name:"Matteo",surname:"Cavallaro",fullName:"Matteo Cavallaro",role:"Responsabile",categories:["Banconisti","Amministratore"],certification:"HACCP Avanzato",notes:"Responsabile generale",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")},{id:"staff_002",name:"Fabrizio",surname:"Dettori",fullName:"Fabrizio Dettori",role:"Responsabile",categories:["Amministratore","Camerieri"],certification:"HACCP Base",notes:"Responsabile sala e amministrazione",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")},{id:"staff_003",name:"Paolo",surname:"Dettori",fullName:"Paolo Dettori",role:"Amministratore",categories:["Amministratore","Cuochi"],certification:"HACCP Avanzato",notes:"Amministratore e responsabile cucina",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")},{id:"staff_004",name:"Eddy",surname:"TheQueen",fullName:"Eddy TheQueen",role:"Dipendente",categories:["Banconisti"],certification:"HACCP Base",notes:"Addetto bancone",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")},{id:"staff_005",name:"Elena",surname:"Guaitoli",fullName:"Elena Guaitoli",role:"Dipendente",categories:["Social & Media Manager","Banconisti"],certification:"HACCP Base",notes:"Social media e bancone",addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT")}]},conservation:{points:[{id:"conservation-1",name:"Frigo A",location:"Cucina",targetTemp:2,selectedCategories:["fresh_dairy","fresh_produce","fresh_meat"]},{id:"conservation-2",name:"Frigo Bancone 1",location:"Bancone",targetTemp:6,selectedCategories:["fresh_beverages","chilled_ready"]},{id:"conservation-3",name:"Frigo Bancone 2",location:"Bancone",targetTemp:5,selectedCategories:["fresh_beverages","chilled_ready"]},{id:"conservation-4",name:"Frigo Bancone 3",location:"Bancone",targetTemp:5,selectedCategories:["fresh_beverages","chilled_ready"]},{id:"conservation-5",name:"Frigo B",location:"Cucina",targetTemp:-18,selectedCategories:["frozen"]},{id:"conservation-6",name:"Frigo C",location:"Cucina",targetTemp:-22,selectedCategories:["deep_frozen"]},{id:"conservation-7",name:"Frigo D",location:"Cucina",targetTemp:-18,selectedCategories:["frozen"]}],count:7},tasks:{list:[{id:"task_001",name:"Carico Frigoriferi Bancone",assignedRole:"Banconisti",assignedEmployee:null,frequency:"Giornalmente"}],count:1},maintenance:{list:[{id:"maintenance_001",conservation_point_id:"conservation-1",conservation_point_name:"Frigo A",task_type:"temperature_monitoring",task_name:"Monitoraggio Temperatura",frequency:"daily",assigned_role:"Responsabile",assigned_employee:"Matteo Cavallaro",instructions:"Verificare temperatura ogni 4 ore e registrare su registro HACCP",is_mandatory:!0,created_at:new Date().toISOString()},{id:"maintenance_002",conservation_point_id:"conservation-1",conservation_point_name:"Frigo A",task_type:"cleaning",task_name:"Pulizia e Sanificazione",frequency:"weekly",assigned_role:"Responsabile",assigned_employee:"Matteo Cavallaro",instructions:"Pulizia completa con detergente e sanificazione con alcool",is_mandatory:!0,created_at:new Date().toISOString()},{id:"maintenance_003",conservation_point_id:"conservation-1",conservation_point_name:"Frigo A",task_type:"defrosting",task_name:"Sbrinamento",frequency:"monthly",assigned_role:"Responsabile",assigned_employee:"Matteo Cavallaro",instructions:"Sbrinamento completo e pulizia delle serpentine",is_mandatory:!0,created_at:new Date().toISOString()},{id:"maintenance_004",conservation_point_id:"conservation-2",conservation_point_name:"Frigo Bancone 1",task_type:"temperature_monitoring",task_name:"Monitoraggio Temperatura",frequency:"daily",assigned_role:"Banconisti",assigned_employee:"Eddy TheQueen",instructions:"Verificare temperatura ogni 2 ore durante il servizio",is_mandatory:!0,created_at:new Date().toISOString()},{id:"maintenance_005",conservation_point_id:"conservation-2",conservation_point_name:"Frigo Bancone 1",task_type:"cleaning",task_name:"Pulizia e Sanificazione",frequency:"daily",assigned_role:"Banconisti",assigned_employee:"Eddy TheQueen",instructions:"Pulizia giornaliera con detergente neutro",is_mandatory:!0,created_at:new Date().toISOString()},{id:"maintenance_006",conservation_point_id:"conservation-2",conservation_point_name:"Frigo Bancone 1",task_type:"defrosting",task_name:"Sbrinamento",frequency:"weekly",assigned_role:"Responsabile",assigned_employee:"Matteo Cavallaro",instructions:"Sbrinamento settimanale e controllo funzionamento",is_mandatory:!0,created_at:new Date().toISOString()}],count:6},products:{productsList:[{id:"product_001",name:"Acqua nat 0,5",type:"Bevande",expiryDate:"2030-03-22",position:"Frigo A",allergens:[]}],count:1}},Re={currentStep:0,completedSteps:[0,1,2,3,4,5],confirmedSteps:[0,1,2,3,4,5],formData:ye,lastActivity:new Date().toISOString()};localStorage.setItem("haccp-onboarding-new",JSON.stringify(Re));const xt={id:"admin_001",name:"Admin",pin:"0000",role:"admin",department:"Amministrazione",createdAt:new Date().toISOString()};localStorage.setItem("haccp-users",JSON.stringify([xt])),localStorage.setItem("haccp-current-user",JSON.stringify(xt));const jt=[{id:"conservation-1_temperature_monitoring_001",conservation_point_id:"conservation-1",conservation_point_name:"Frigo A",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Responsabile",assigned_category:"Banconisti",assigned_staff_ids:["staff_001"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-1_sanitization_001",conservation_point_id:"conservation-1",conservation_point_name:"Frigo A",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["tuesday","thursday"],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-1_defrosting_001",conservation_point_id:"conservation-1",conservation_point_name:"Frigo A",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Semestrale (ogni 6 mesi)",selected_days:[],assigned_role:"Responsabile",assigned_category:"Amministratore",assigned_staff_ids:["staff_002"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-2_temperature_monitoring_001",conservation_point_id:"conservation-2",conservation_point_name:"Frigo Bancone 1",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Dipendente",assigned_category:"Banconisti",assigned_staff_ids:["staff_004"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-2_sanitization_001",conservation_point_id:"conservation-2",conservation_point_name:"Frigo Bancone 1",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["monday","wednesday"],assigned_role:"Dipendente",assigned_category:"Social & Media Manager",assigned_staff_ids:["staff_005"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-2_defrosting_001",conservation_point_id:"conservation-2",conservation_point_name:"Frigo Bancone 1",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Annuale",selected_days:[],assigned_role:"Dipendente",assigned_category:"Banconisti",assigned_staff_ids:["staff_004"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-3_temperature_monitoring_001",conservation_point_id:"conservation-3",conservation_point_name:"Frigo Bancone 2",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Responsabile",assigned_category:"Banconisti",assigned_staff_ids:["staff_001"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-3_sanitization_001",conservation_point_id:"conservation-3",conservation_point_name:"Frigo Bancone 2",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["friday"],assigned_role:"Dipendente",assigned_category:"Banconisti",assigned_staff_ids:["staff_004"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-3_defrosting_001",conservation_point_id:"conservation-3",conservation_point_name:"Frigo Bancone 2",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Annuale",selected_days:[],assigned_role:"Dipendente",assigned_category:"Social & Media Manager",assigned_staff_ids:["staff_005"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-4_temperature_monitoring_001",conservation_point_id:"conservation-4",conservation_point_name:"Frigo Bancone 3",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Dipendente",assigned_category:"Social & Media Manager",assigned_staff_ids:["staff_005"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-4_sanitization_001",conservation_point_id:"conservation-4",conservation_point_name:"Frigo Bancone 3",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["thursday"],assigned_role:"Responsabile",assigned_category:"Banconisti",assigned_staff_ids:["staff_001"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-4_defrosting_001",conservation_point_id:"conservation-4",conservation_point_name:"Frigo Bancone 3",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Annuale",selected_days:[],assigned_role:"Dipendente",assigned_category:"Banconisti",assigned_staff_ids:["staff_004"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-5_temperature_monitoring_001",conservation_point_id:"conservation-5",conservation_point_name:"Frigo B",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"custom_days",selected_days:["monday"],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-5_sanitization_001",conservation_point_id:"conservation-5",conservation_point_name:"Frigo B",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["monday","thursday"],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-5_defrosting_001",conservation_point_id:"conservation-5",conservation_point_name:"Frigo B",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Semestrale (ogni 6 mesi)",selected_days:[],assigned_role:"Responsabile",assigned_category:"Amministratore",assigned_staff_ids:["staff_002"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-6_temperature_monitoring_001",conservation_point_id:"conservation-6",conservation_point_name:"Frigo C",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-6_sanitization_001",conservation_point_id:"conservation-6",conservation_point_name:"Frigo C",task_type:"sanitization",task_name:"Sanificazione",frequency:"custom_days",selected_days:["wednesday"],assigned_role:"Responsabile",assigned_category:"Amministratore",assigned_staff_ids:["staff_002"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-6_defrosting_001",conservation_point_id:"conservation-6",conservation_point_name:"Frigo C",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Semestrale (ogni 6 mesi)",selected_days:[],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-7_temperature_monitoring_001",conservation_point_id:"conservation-7",conservation_point_name:"Frigo D",task_type:"temperature_monitoring",task_name:"Rilevamento Temperatura",frequency:"Mensile",selected_days:[],assigned_role:"Amministratore",assigned_category:"Cuochi",assigned_staff_ids:["staff_003"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-7_sanitization_001",conservation_point_id:"conservation-7",conservation_point_name:"Frigo D",task_type:"sanitization",task_name:"Sanificazione",frequency:"Settimanale",selected_days:[],assigned_role:"Dipendente",assigned_category:"Social & Media Manager",assigned_staff_ids:["staff_005"],is_active:!0,created_at:new Date().toISOString()},{id:"conservation-7_defrosting_001",conservation_point_id:"conservation-7",conservation_point_name:"Frigo D",task_type:"defrosting",task_name:"Sbrinamento",frequency:"Annuale",selected_days:[],assigned_role:"Responsabile",assigned_category:"Amministratore",assigned_staff_ids:["staff_002"],is_active:!0,created_at:new Date().toISOString()}].map(Ot=>({...Ot,company_id:J}));localStorage.setItem("haccp-maintenance-tasks",JSON.stringify(jt)),Se("✅ Onboarding precompilato con i tuoi dati"),Se("✅ Dati di accesso precompilati: Admin / 0000"),Se("✅ Manutenzioni precompilate: 21 attività per 7 punti di conservazione"),Se("🔑 Company ID utilizzato:",J),Se("💾 Manutenzioni salvate in localStorage:",jt.length,"task"),Se("🔍 Verifica localStorage:",JSON.parse(localStorage.getItem("haccp-maintenance-tasks")||"[]").length,"task trovati"),Q(`✅ Onboarding precompilato con successo!

Dati caricati:
- Al Ritrovo SRL
- 6 Reparti
- 5 Membri staff (Matteo, Fabrizio, Paolo, Eddy, Elena)
- 7 Punti di conservazione (Frigo A, Bancone 1-3, Frigo B-D)
- 21 Attività di manutenzione preconfigurate
- 1 Attività generica (Carico Frigoriferi Bancone)
- Acqua nat 0,5L

Clicca "Riapri Onboarding" per vedere i dati!`)},St=()=>{Y(`⚠️ ATTENZIONE: Questo cancellerà TUTTI i dati dell'onboarding e dell'app!

Sei sicuro di voler procedere?`,()=>{localStorage.removeItem("haccp-onboarding"),localStorage.removeItem("haccp-onboarding-new"),localStorage.removeItem("haccp-departments"),localStorage.removeItem("haccp-staff"),localStorage.removeItem("haccp-refrigerators"),localStorage.removeItem("haccp-cleaning"),localStorage.removeItem("haccp-products"),localStorage.removeItem("haccp-users"),localStorage.removeItem("haccp-temperatures"),localStorage.removeItem("haccp-product-labels"),localStorage.removeItem("haccp-maintenance-tasks"),m([]),d([]),l([]),a([]),p([]),j([]),s([]),S([]),fe(!1),console.log("🧹 Onboarding e app completamente resettati");const ye=[{id:"admin-1",name:"Admin",pin:"0000",role:"admin",department:"Amministrazione",createdAt:new Date().toISOString(),isActive:!0}];localStorage.setItem("haccp-users",JSON.stringify(ye)),localStorage.setItem("haccp-current-user",JSON.stringify(ye[0])),console.log("✅ Dati di accesso ricreati: Admin / 0000"),window.location.reload()})};W.useEffect(()=>{},[]),W.useEffect(()=>{const ye=L3();Object.entries(ye).forEach(([Xt,Dt])=>{localStorage.getItem(Xt)||localStorage.setItem(Xt,Dt)}),I3(),ct();const Re=localStorage.getItem("haccp-temperatures"),xt=localStorage.getItem("haccp-cleaning"),vt=localStorage.getItem("haccp-refrigerators"),jt=localStorage.getItem("haccp-staff"),Ot=localStorage.getItem("haccp-products"),en=localStorage.getItem("haccp-departments"),It=localStorage.getItem("haccp-product-labels"),wt=localStorage.getItem("haccp-users");localStorage.getItem("haccp-current-user");try{Re&&s(JSON.parse(Re)),xt&&a(JSON.parse(xt)),vt&&l(JSON.parse(vt)),jt&&d(JSON.parse(jt)),Ot&&p(JSON.parse(Ot)),en&&m(JSON.parse(en)),It&&S(JSON.parse(It))}catch(Xt){console.warn("Errore nel parsing dei dati:",Xt),localStorage.removeItem("haccp-temperatures"),localStorage.removeItem("haccp-cleaning"),localStorage.removeItem("haccp-refrigerators"),localStorage.removeItem("haccp-staff"),localStorage.removeItem("haccp-products"),localStorage.removeItem("haccp-departments"),localStorage.removeItem("haccp-product-labels")}if(wt)try{j(JSON.parse(wt))}catch(Xt){console.warn("Errore nel parsing users:",Xt),localStorage.removeItem("haccp-users")}else{const Xt={id:"admin_001",name:"Admin",pin:"0000",role:"admin",department:"Amministrazione",createdAt:new Date().toISOString()};j([Xt]),localStorage.setItem("haccp-users",JSON.stringify([Xt]))}const Ze=localStorage.getItem("haccp-show-chat-icon");if(Ze!==null)try{K(JSON.parse(Ze))}catch(Xt){console.warn("Errore nel parsing chat icon pref:",Xt),localStorage.removeItem("haccp-show-chat-icon")}const dt=Xt=>{if(Xt.key==="haccp-show-chat-icon")try{K(JSON.parse(Xt.newValue))}catch(Dt){console.warn("Errore nel parsing chat icon pref change:",Dt)}};return window.addEventListener("storage",dt),()=>{window.removeEventListener("storage",dt)}},[]),W.useEffect(()=>{},[f,n,i,c,N]),W.useEffect(()=>{localStorage.setItem("haccp-temperatures",JSON.stringify(n))},[n]),W.useEffect(()=>{localStorage.setItem("haccp-refrigerators",JSON.stringify(o))},[o]),W.useEffect(()=>{localStorage.setItem("haccp-cleaning",JSON.stringify(i))},[i]),W.useEffect(()=>{localStorage.setItem("haccp-staff",JSON.stringify(c))},[c]),W.useEffect(()=>{localStorage.setItem("haccp-products",JSON.stringify(f))},[f]),W.useEffect(()=>{localStorage.setItem("haccp-departments",JSON.stringify(v))},[v]),W.useEffect(()=>{localStorage.setItem("haccp-product-labels",JSON.stringify(N))},[N]);const st=ye=>{y(ye),H(!1),localStorage.setItem("haccp-current-user",JSON.stringify(ye));const Re={id:Date.now(),timestamp:new Date().toISOString(),user:ye.id,userName:ye.name,type:"login",description:`Accesso di ${ye.name}`};try{const xt=JSON.parse(localStorage.getItem("haccp-actions")||"[]");xt.push(Re),localStorage.setItem("haccp-actions",JSON.stringify(xt))}catch(xt){console.warn("Errore nel parsing actions:",xt),localStorage.removeItem("haccp-actions")}},$e=()=>{const ye={dashboard:0,cleaning:0,inventory:0,labels:0,staff:0,refrigerators:0},Re=P.cleaning||"2000-01-01T00:00:00.000Z",xt=i.filter(_t=>new Date(_t.createdAt||_t.timestamp)>new Date(Re)).length;ye.cleaning+=xt;const vt=P.inventory||"2000-01-01T00:00:00.000Z",jt=new Date,Ot=new Date(jt.getTime()+3*24*60*60*1e3),en=new Date(jt.getTime()+4*24*60*60*1e3),It=f.filter(_t=>{const Mn=new Date(_t.expiryDate);return Mn>=Ot&&Mn<=en}).length,wt=f.filter(_t=>new Date(_t.createdAt||_t.addedDate)>new Date(vt)).length;ye.inventory+=It+wt;const Ze=P.labels||"2000-01-01T00:00:00.000Z",dt=N.filter(_t=>new Date(_t.createdAt||"2000-01-01")>new Date(Ze)).length;ye.labels+=dt;const Xt=P.staff||"2000-01-01T00:00:00.000Z",Dt=c&&Array.isArray(c)?c.filter(_t=>_t&&new Date(_t.addedDate||_t.createdAt||"2000-01-01")>new Date(Xt)).length:0;ye.staff+=Dt;const Mt=P.refrigerators||"2000-01-01T00:00:00.000Z",an=n.filter(_t=>{const Pn=new Date(_t.timestamp)>new Date(Mt),Sn=_t.status==="warning"||_t.status==="danger";return Pn&&Sn}).length;ye.refrigerators+=an;const ht=f.filter(_t=>{const Mn=new Date(_t.expiryDate),Pn=new Date;return Mn.setHours(0,0,0,0),Pn.setHours(0,0,0,0),Mn.getTime()===Pn.getTime()}).length;return ye.dashboard=ht+an,ye},Ye=ye=>{const Re={...P,[ye]:new Date().toISOString()};$(Re),localStorage.setItem("haccp-last-check",JSON.stringify(Re))},Ge=$e(),He=({hasNotification:ye,className:Re=""})=>ye?r.jsx("div",{className:`absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full ${Re}`}):null,it=(ye,Re,xt=null)=>{const vt={id:xt||`${ye}_${Date.now()}`,type:ye,data:Re,timestamp:new Date().toISOString(),userId:k==null?void 0:k.id,userName:k==null?void 0:k.name};_(jt=>[...jt.filter(en=>!(en.type===ye&&en.id===vt.id)),vt])},rt=(ye,Re,xt)=>{console.log("🎯 TRACKING:",ye,"with",(Re==null?void 0:Re.length)||0,"items"),it(ye,Re,xt)};W.useEffect(()=>{f.length>0&&k&&(console.log("📦 Products changed:",f.length,"items"),rt("inventory",f,"auto-inventory"))},[f,k]),W.useEffect(()=>{n.length>0&&k&&(console.log("🌡️ Temperatures changed:",n.length,"items"),rt("temperatures",n,"auto-temperatures"))},[n,k]),W.useEffect(()=>{i.length>0&&k&&(console.log("🧹 Cleaning changed:",i.length,"items"),rt("cleaning",i,"auto-cleaning"))},[i,k]),W.useEffect(()=>{c.length>0&&k&&(console.log("👥 Staff changed:",c.length,"items"),rt("staff",c,"auto-staff"))},[c,k]),W.useEffect(()=>{console.log("📋 PENDING CHANGES:",ce.length,ce)},[ce]);const mt=()=>{if(k){const ye={id:Date.now(),timestamp:new Date().toISOString(),user:k.id,userName:k.name,type:"logout",description:`Disconnessione di ${k.name}`};try{const Re=JSON.parse(localStorage.getItem("haccp-actions")||"[]");Re.push(ye),localStorage.setItem("haccp-actions",JSON.stringify(Re))}catch(Re){console.warn("Errore nel parsing actions logout:",Re),localStorage.removeItem("haccp-actions")}}y(null),e("dashboard"),localStorage.removeItem("haccp-current-user")},bt=ye=>{const Re={...ye,id:`user_${Date.now()}`,createdAt:new Date().toISOString()},xt=[...b,Re];j(xt),localStorage.setItem("haccp-users",JSON.stringify(xt));const vt={id:`staff_${Date.now()}`,name:ye.name,role:ye.role==="admin"?"Amministratore":ye.role==="dipendente"?"Dipendente":ye.role==="responsabile"?"Responsabile":ye.role==="collaboratore"?"Collaboratore Occasionale":"Dipendente",department:ye.department||"Non assegnato",certification:"",notes:`Utente registrato il ${new Date().toLocaleDateString("it-IT")}`,addedDate:new Date().toLocaleDateString("it-IT"),addedTime:new Date().toLocaleString("it-IT"),isRegisteredUser:!0,userId:Re.id},jt=[...c,vt];d(jt),localStorage.setItem("haccp-staff",JSON.stringify(jt))},me=()=>k&&k.role==="admin",Ce=(()=>{const ye=n.filter(Ot=>Ot.status==="ok").length,Re=n.filter(Ot=>Ot.status==="danger").length,xt=i.filter(Ot=>!Ot.completed).length,vt=new Date,jt=f.filter(Ot=>{const It=new Date(Ot.expiryDate)-vt,wt=Math.ceil(It/(1e3*60*60*24));return wt<=7&&wt>=0}).length;return{temperatureOk:ye,temperatureProblems:Re,cleaningPending:xt,expiringToday:jt}})(),Me=()=>{const ye={temperatures:n,cleaningTasks:i,staff:c,products:f,departments:v,productLabels:N,exportDate:new Date().toISOString()},Re=new Blob([JSON.stringify(ye,null,2)],{type:"application/json"}),xt=URL.createObjectURL(Re),vt=document.createElement("a");vt.href=xt,vt.download=`haccp-data-${new Date().toISOString().split("T")[0]}.json`,vt.click(),URL.revokeObjectURL(xt)},Ne=ye=>{const Re=ye.target.files[0];if(!Re)return;const xt=new FileReader;xt.onload=vt=>{try{const jt=JSON.parse(vt.target.result);jt.temperatures&&(s(jt.temperatures),localStorage.setItem("haccp-temperatures",JSON.stringify(jt.temperatures))),jt.cleaningTasks&&(a(jt.cleaningTasks),localStorage.setItem("haccp-cleaning",JSON.stringify(jt.cleaningTasks))),jt.staff&&(d(jt.staff),localStorage.setItem("haccp-staff",JSON.stringify(jt.staff))),jt.products&&(p(jt.products),localStorage.setItem("haccp-products",JSON.stringify(jt.products))),jt.departments&&(m(jt.departments),localStorage.setItem("haccp-departments",JSON.stringify(jt.departments))),jt.productLabels&&(S(jt.productLabels),localStorage.setItem("haccp-product-labels",JSON.stringify(jt.productLabels))),Q("Dati importati con successo!")}catch(jt){te("Errore durante l'importazione del file"),console.error("Import error:",jt)}},xt.readAsText(Re)};W.useEffect(()=>{if(k&&!oe){if(E3()){fe(!0);return}const ye=localStorage.getItem("haccp-onboarding");if(ye&&ye!=="undefined"&&ye!=="null"&&ye!=="[object Object]")try{const Re=JSON.parse(ye);if(Re&&typeof Re=="object"&&Re.completed){fe(!0);return}}catch(Re){console.warn("Errore nel parsing onboarding:",Re),localStorage.removeItem("haccp-onboarding")}q(!0)}},[k,oe]);const gt=ye=>{var xt,vt,jt,Ot,en;q(!1),fe(!0);const Re={...ye,completed:!0,completedAt:new Date().toISOString()};if(localStorage.setItem("haccp-onboarding",JSON.stringify(Re)),ye.business&&localStorage.setItem("haccp-business-info",JSON.stringify(ye.business)),(xt=ye.departments)!=null&&xt.list){const It=ye.departments.list.filter(wt=>wt&&wt.enabled).map(wt=>({id:wt.id||Date.now()+Math.random(),name:wt.name||"Reparto non disponibile",enabled:!0,isCustom:wt.isCustom||!1,createdAt:new Date().toISOString()}));m(It),localStorage.setItem("haccp-departments",JSON.stringify(It))}if((vt=ye.staff)!=null&&vt.staffMembers){const It=ye.staff.staffMembers.map(wt=>({...wt,id:wt.id||Date.now()+Math.random(),createdAt:new Date().toISOString()}));d(It),localStorage.setItem("haccp-staff",JSON.stringify(It))}if((jt=ye.conservation)!=null&&jt.points){const It=ye.conservation.points.map(wt=>({...wt,id:wt.id||Date.now()+Math.random(),createdAt:new Date().toISOString()}));l(It),localStorage.setItem("haccp-refrigerators",JSON.stringify(It))}if((Ot=ye.tasks)!=null&&Ot.list){const It=ye.tasks.list.map(wt=>({...wt,id:wt.id||Date.now()+Math.random(),createdAt:new Date().toISOString()}));a(It),localStorage.setItem("haccp-cleaning",JSON.stringify(It))}if((en=ye.inventory)!=null&&en.products){const It=ye.inventory.products.map(wt=>({...wt,id:wt.id||Date.now()+Math.random(),createdAt:new Date().toISOString()}));p(It),localStorage.setItem("haccp-products",JSON.stringify(It))}ye.preset&&localStorage.setItem("haccp-presets",JSON.stringify({selected:ye.preset,applied:!0,appliedAt:new Date().toISOString()})),ct()};W.useEffect(()=>{},[]);const et=ye=>{if(ye==="onboarding")q(!0);else switch(ye){case"departments":e("management");break;case"refrigerators":e("refrigerators");break;case"staff":e("management");break;default:e("dashboard")}};return k?r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(Rx,{}),r.jsxs("div",{className:"container mx-auto px-4 py-8",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Business HACCP Manager"}),r.jsxs("p",{className:"text-gray-600",children:["Benvenuto, ",r.jsxs("span",{className:"font-['Dancing_Script'] font-semibold text-2xl text-purple-600",children:[k.name," - ",k.role==="admin"?"Admin":"Dipendente"]})]}),(()=>{var xt;const ye=localStorage.getItem("haccp-onboarding-new");if(!ye||ye==="[object Object]")return null;let Re={};try{Re=((xt=JSON.parse(ye).formData)==null?void 0:xt.business)||{}}catch(vt){return console.error("Errore parsing onboarding data:",vt),null}return Re.companyName?r.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[r.jsx("p",{className:"font-medium text-gray-900",children:Re.companyName}),Re.address&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Re.address}),Re.email&&r.jsx("p",{className:"text-xs text-gray-500",children:Re.email}),Re.phone&&r.jsx("p",{className:"text-xs text-gray-500",children:Re.phone})]}):null})()]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[r.jsx(Y3,{onResetApp:_e,onOpenOnboarding:()=>q(!0),showResetApp:!1}),r.jsx(Q3,{onPrefillOnboarding:ae,onResetOnboarding:St,isDevMode:!1}),r.jsx(X3,{onExportData:Me,onImportData:Ne})]})]}),r.jsxs(s0,{value:t,onValueChange:ye=>{e(ye),Ye(ye)},children:[r.jsxs(gf,{className:`grid w-full ${me()?"grid-cols-3 sm:grid-cols-4 md:grid-cols-6":"grid-cols-3 sm:grid-cols-4 md:grid-cols-5"} gap-1 mb-8`,children:[r.jsxs(Gr,{value:"dashboard",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Home",children:[r.jsx(Tp,{className:"h-4 w-4"}),r.jsx("span",{className:"sm:hidden",children:"Home"}),r.jsx("span",{className:"hidden sm:inline",children:"Home"}),r.jsx(He,{hasNotification:Ge.dashboard>0})]}),r.jsxs(Gr,{value:"refrigerators",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Punti di Conservazione",children:[r.jsx(ds,{className:"h-4 w-4"}),r.jsx("span",{className:"sm:hidden text-xs",children:"Frigo"}),r.jsx("span",{className:"hidden sm:inline",children:"Punti di Conservazione"}),r.jsx(He,{hasNotification:Ge.refrigerators>0})]}),r.jsxs(Gr,{value:"cleaning",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Attività e Mansioni",children:[r.jsx(uf,{className:"h-4 w-4"}),r.jsx("span",{className:"sm:hidden text-xs",children:"Attività"}),r.jsx("span",{className:"hidden sm:inline",children:"Attività e Mansioni"}),r.jsx(He,{hasNotification:Ge.cleaning>0})]}),r.jsxs(Gr,{value:"inventory",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Inventario",children:[r.jsx(Un,{className:"h-4 w-4"}),r.jsx("span",{className:"sm:hidden text-xs",children:"Stock"}),r.jsx("span",{className:"hidden sm:inline",children:"Inventario"}),r.jsx(He,{hasNotification:Ge.inventory>0})]}),r.jsxs(Gr,{value:"management",className:"flex items-center gap-1 md:gap-2 text-sm relative",title:"Gestione e AI",children:[r.jsx(Ai,{className:"h-4 w-4"}),r.jsx("span",{className:"sm:hidden text-xs",children:"Gestione"}),r.jsx("span",{className:"hidden sm:inline",children:"Gestione e AI"}),r.jsx(He,{hasNotification:Ge.staff>0})]}),r.jsxs(Gr,{value:"data-settings",className:"flex items-center gap-1 md:gap-2 text-sm",title:"Impostazioni e Dati",children:[r.jsx(os,{className:"h-4 w-4"}),r.jsx("span",{className:"sm:hidden text-xs",children:"Settings"}),r.jsx("span",{className:"hidden sm:inline",children:"Impostazioni e Dati"})]}),r.jsx("div",{className:"flex flex-col gap-1",children:r.jsxs(le,{variant:"outline",size:"sm",onClick:mt,className:"flex items-center gap-1 md:gap-2 text-sm h-9 px-3",title:"Esci",children:[r.jsx(kN,{className:"h-4 w-4"}),r.jsx("span",{className:"sm:hidden text-xs",children:"Exit"}),r.jsx("span",{className:"hidden sm:inline",children:"Esci"})]})})]}),r.jsx(Wr,{value:"dashboard",children:r.jsx("div",{className:"space-y-6",children:r.jsx(BN,{temperatures:n,cleaning:i,products:f,staff:c,currentUser:k})})}),r.jsx(Wr,{value:"refrigerators",children:r.jsx(gS,{temperatures:n,setTemperatures:ye=>{s(ye),rt("temperatures",ye)},currentUser:k,refrigerators:o,setRefrigerators:ye=>{l(ye),rt("refrigerators",ye)},departments:v,setDepartments:ye=>{m(ye),rt("departments",ye)}})}),r.jsx(Wr,{value:"cleaning",children:r.jsx(UN,{cleaning:i,setCleaning:ye=>{a(ye),rt("cleaning",ye)},currentUser:k,departments:v})}),r.jsx(Wr,{value:"inventory",children:r.jsx(v3,{products:f,setProducts:ye=>{p(ye),rt("inventory",ye)},currentUser:k,refrigerators:o})}),r.jsx(Wr,{value:"data-settings",children:r.jsx(k3,{currentUser:k,isAdmin:me(),onSettingsChange:ye=>{console.log("📱 Impostazioni dati aggiornate:",ye)}})}),me()&&r.jsx(Wr,{value:"management",children:r.jsxs("div",{className:"space-y-6",children:[r.jsx(yS,{staff:c,setStaff:ye=>{d(ye),rt("staff",ye)},users:b,setUsers:j,currentUser:k,isAdmin:me(),departments:oe?v:[],setDepartments:ye=>{m(ye),rt("departments",ye)},products:f,temperatures:n,cleaning:i,productLabels:N,setProductLabels:S}),r.jsx(w3,{temperatures:n,setTemperatures:s,cleaning:i,setCleaning:a,products:f,setProducts:p,refrigerators:o,setRefrigerators:l})]})})]}),r.jsx(P3,{activeTab:t,temperatures:n}),k&&Z&&r.jsx(y3,{currentUser:k,currentSection:t,products:f,temperatures:n,cleaning:i,staff:c,onAction:ye=>{console.log("AI Action:",ye)}}),k&&r.jsx(b3,{products:f,onRecipeSuggestion:ye=>{console.log("Recipe suggestions:",ye)}}),r.jsx(N3,{}),I&&r.jsx(J3,{isOpen:I,onClose:()=>q(!1),onComplete:gt,currentData:Ee}),r.jsx(K3,{isOpen:ge,onClose:()=>Te(!1),missingRequirements:qe.missingRequirements,suggestions:qe.getSuggestions(),onFixRequirement:et}),r.jsx(sc,{isOpen:re.isOpen,onClose:R,title:re.title,message:re.message,type:re.type,confirmText:re.confirmText,onConfirm:re.onConfirm}),r.jsx(ic,{isOpen:A.isOpen,onClose:V,title:A.title,message:A.message,type:A.type,confirmText:A.confirmText,cancelText:A.cancelText,onConfirm:A.onConfirm,onCancel:A.onCancel}),r.jsx(ac,{isOpen:C.isOpen,onClose:ie,title:C.title,message:C.message,placeholder:C.placeholder,defaultValue:C.defaultValue,type:C.type,confirmText:C.confirmText,cancelText:C.cancelText,validation:C.validation,onConfirm:C.onConfirm,onCancel:C.onCancel})]})]}):r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(Rx,{}),r.jsxs("div",{className:"container mx-auto px-4 py-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Business HACCP Manager"}),r.jsx("p",{className:"text-gray-600",children:"Sistema di Gestione HACCP per Ristoranti"})]}),r.jsx("div",{className:"max-w-4xl mx-auto mb-8",children:r.jsxs(Je,{children:[r.jsx(yt,{children:r.jsxs(Nt,{className:"flex items-center gap-2",children:[r.jsx(Tp,{className:"h-5 w-5"}),"Report Giornalieri - ",new Date().toLocaleDateString("it-IT")]})}),r.jsx(Xe,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:Ce.temperatureOk}),r.jsx("div",{className:"text-sm text-green-700",children:"Temperature OK"})]}),r.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:Ce.temperatureProblems}),r.jsx("div",{className:"text-sm text-red-700",children:"Problemi Temp."})]}),r.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Ce.cleaningPending}),r.jsx("div",{className:"text-sm text-yellow-700",children:"Pulizie Pending"})]}),r.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Ce.expiringToday}),r.jsx("div",{className:"text-sm text-blue-700",children:"Scadenze Prodotti"})]})]})})]})}),r.jsx("div",{className:"max-w-md mx-auto mb-4",children:r.jsx(Je,{children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"flex gap-2 justify-center",children:[r.jsxs(le,{onClick:Me,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(Bs,{className:"h-4 w-4"}),"Esporta"]}),r.jsxs("label",{className:"cursor-pointer",children:[r.jsx(le,{variant:"outline",size:"sm",className:"flex items-center gap-2",asChild:!0,children:r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx(uu,{className:"h-4 w-4"}),"Importa"]})}),r.jsx("input",{type:"file",accept:".json",onChange:Ne,className:"hidden"})]})]})})})}),r.jsxs("div",{className:"max-w-md mx-auto",children:[b.length>1&&r.jsx(Je,{className:"mb-4",children:r.jsx(Xe,{className:"pt-6",children:r.jsxs("div",{className:"text-center text-gray-600",children:[r.jsx("div",{className:"text-sm",children:"Ultimo accesso:"}),r.jsx("div",{className:"font-semibold",children:(ut=b[b.length-1])==null?void 0:ut.name})]})})}),r.jsx("div",{className:"text-center",children:r.jsxs(le,{size:"lg",className:"text-lg px-8 py-4",onClick:()=>H(!0),children:[r.jsx(CN,{className:"mr-2 h-5 w-5"}),"🚀 INIZIA TURNO"]})})]})]}),r.jsx(A3,{isOpen:z,onClose:()=>H(!1),onLogin:st,users:b,onAddUser:bt})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered: ",t),t.addEventListener("updatefound",()=>{const e=t.installing;e.addEventListener("statechange",()=>{e.state==="installed"&&navigator.serviceWorker.controller&&confirm("Nuova versione disponibile. Ricaricare la pagina?")&&window.location.reload()})})}).catch(t=>{console.log("SW registration failed: ",t)})});Fm.createRoot(document.getElementById("root")).render(r.jsx(Da.StrictMode,{children:r.jsx(Z3,{})}));export{hn as _,qs as c,R5 as g};
